!function(e){function t(t,n,i,o){var r={data:o||0===o||!1===o?o:n?n.data:{},_wrap:n?n._wrap:null,tmpl:null,parent:n||null,nodes:[],calls:c,nest:d,wrap:u,html:h,update:p};return t&&e.extend(r,t,{nodes:[],parent:n}),i&&(r.tmpl=i,r._ctnt=r._ctnt||r.tmpl(e,r),r.key=++C,(E.length?w:y)[C]=r),r}function n(t,o,r){var a,s=r?e.map(r,function(e){return"string"==typeof e?t.key?e.replace(/(<\w+)(?=[\s>])(?![^>]*_tmplitem)([^>]*)/g,"$1 "+v+'="'+t.key+'" $2'):e:n(e,t,e._ctnt)}):t;return o?s:((s=s.join("")).replace(/^\s*([^<\s][^<]*)?(<[\w\W]+>)([^>]*[^>\s])?\s*$/,function(t,n,o,r){l(a=e(o).get()),n&&(a=i(n).concat(a)),r&&(a=a.concat(i(r)))}),a||i(s))}function i(t){var n=document.createElement("div");return n.innerHTML=t,e.makeArray(n.childNodes)}function o(t){return new Function("jQuery","$item","var $=jQuery,call,__=[],$data=$item.data;with($data){__.push('"+e.trim(t).replace(/([\\'])/g,"\\$1").replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\t/g,"\\t").replace(/\$\{([^\}]*)\}/g,"{{= $1}}").replace(/\{\{(\/?)(\w+|.)(?:\(((?:[^\}]|\}(?!\}))*?)?\))?(?:\s+(.*?)?)?(\(((?:[^\}]|\}(?!\}))*?)\))?\s*\}\}/g,function(t,n,i,o,r,s,l){var c,d,u,h=e.tmpl.tag[i];if(!h)throw"Unknown template tag: "+i;return c=h._default||[],s&&!/\w$/.test(r)&&(r+=s,s=""),r?(r=a(r),l=l?","+a(l)+")":s?")":"",d=s?r.indexOf(".")>-1?r+a(s):"("+r+").call($item"+l:r,u=s?d:"(typeof("+r+")==='function'?("+r+").call($item):("+r+"))"):u=d=c.$1||"null",o=a(o),"');"+h[n?"close":"open"].split("$notnull_1").join(r?"typeof("+r+")!=='undefined' && ("+r+")!=null":"true").split("$1a").join(u).split("$1").join(d).split("$2").join(o||c.$2||"")+"__.push('"})+"');}return __;")}function r(t,i){t._wrap=n(t,!0,e.isArray(i)?i:[m.test(i)?i:e(i).html()]).join("")}function a(e){return e?e.replace(/\\'/g,"'").replace(/\\\\/g,"\\"):null}function s(e){var t=document.createElement("div");return t.appendChild(e.cloneNode(!0)),t.innerHTML}function l(n){function i(n){function i(e){a=d[e+=c]=d[e]||t(a,y[a.parent.key+c]||a.parent)}var o,r,a,s,l=n;if(s=n.getAttribute(v)){for(;l.parentNode&&1===(l=l.parentNode).nodeType&&!(o=l.getAttribute(v)););o!==s&&(l=l.parentNode?11===l.nodeType?0:l.getAttribute(v)||0:0,(a=y[s])||(a=w[s],(a=t(a,y[l]||w[l])).key=++C,y[C]=a),x&&i(s)),n.removeAttribute(v)}else x&&(a=e.data(n,"tmplItem"))&&(i(a.key),y[a.key]=a,l=(l=e.data(n.parentNode,"tmplItem"))?l.key:0);if(a){for(r=a;r&&r.key!=l;)r.nodes.push(n),r=r.parent;delete a._ctnt,delete a._wrap,e.data(n,"tmplItem",a)}}var o,r,a,s,l,c="_"+x,d={};for(a=0,s=n.length;a<s;a++)if(1===(o=n[a]).nodeType){for(l=(r=o.getElementsByTagName("*")).length-1;l>=0;l--)i(r[l]);i(o)}}function c(e,t,n,i){if(!e)return E.pop();E.push({_:e,tmpl:t,item:this,data:n,options:i})}function d(t,n,i){return e.tmpl(e.template(t),n,i,this)}function u(t,n){var i=t.options||{};return i.wrapped=n,e.tmpl(e.template(t.tmpl),t.data,i,t.item)}function h(t,n){var i=this._wrap;return e.map(e(e.isArray(i)?i.join(""):i).filter(t||"*"),function(e){return n?e.innerText||e.textContent:e.outerHTML||s(e)})}function p(){var t=this.nodes;e.tmpl(null,null,null,this).insertBefore(t[0]),e(t).remove()}var f,g=e.fn.domManip,v="_tmplitem",m=/^[^<]*(<[\w\W]+>)[^>]*$|\{\{\! /,y={},w={},b={key:0,data:{}},C=0,x=0,E=[];e.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,n){e.fn[t]=function(i){var o,r,a,s,l=[],c=e(i),d=1===this.length&&this[0].parentNode;if(f=y||{},d&&11===d.nodeType&&1===d.childNodes.length&&1===c.length)c[n](this[0]),l=this;else{for(r=0,a=c.length;r<a;r++)x=r,o=(r>0?this.clone(!0):this).get(),e(c[r])[n](o),l=l.concat(o);x=0,l=this.pushStack(l,t,c.selector)}return s=f,f=null,e.tmpl.complete(s),l}}),e.fn.extend({tmpl:function(t,n,i){return e.tmpl(this[0],t,n,i)},tmplItem:function(){return e.tmplItem(this[0])},template:function(t){return e.template(t,this[0])},domManip:function(t,n,i){if(t[0]&&e.isArray(t[0])){for(var o,r=e.makeArray(arguments),a=t[0],s=a.length,l=0;l<s&&!(o=e.data(a[l++],"tmplItem")););o&&x&&(r[2]=function(t){e.tmpl.afterManip(this,t,i)}),g.apply(this,r)}else g.apply(this,arguments);return x=0,!f&&e.tmpl.complete(y),this}}),e.extend({tmpl:function(i,o,a,s){var l,c=!s;if(c)s=b,i=e.template[i]||e.template(null,i),w={};else if(!i)return i=s.tmpl,y[s.key]=s,s.nodes=[],s.wrapped&&r(s,s.wrapped),e(n(s,null,s.tmpl(e,s)));return i?("function"==typeof o&&(o=o.call(s||{})),a&&a.wrapped&&r(a,a.wrapped),l=e.isArray(o)?e.map(o,function(e){return e?t(a,s,i,e):null}):[t(a,s,i,o)],c?e(n(s,null,l)):l):[]},tmplItem:function(t){var n;for(t instanceof e&&(t=t[0]);t&&1===t.nodeType&&!(n=e.data(t,"tmplItem"))&&(t=t.parentNode););return n||b},template:function(t,n){return n?("string"==typeof n?n=o(n):n instanceof e&&(n=n[0]||{}),n.nodeType&&(n=e.data(n,"tmpl")||e.data(n,"tmpl",o(n.innerHTML))),"string"==typeof t?e.template[t]=n:n):t?"string"!=typeof t?e.template(null,t):e.template[t]||e.template(null,m.test(t)?t:e(t)):null},encode:function(e){return(""+e).split("<").join("&lt;").split(">").join("&gt;").split('"').join("&#34;").split("'").join("&#39;")}}),e.extend(e.tmpl,{tag:{tmpl:{_default:{$2:"null"},open:"if($notnull_1){__=__.concat($item.nest($1,$2));}"},wrap:{_default:{$2:"null"},open:"$item.calls(__,$1,$2);__=[];",close:"call=$item.calls();__=call._.concat($item.wrap(call,__));"},each:{_default:{$2:"$index, $value"},open:"if($notnull_1){$.each($1a,function($2){with(this){",close:"}});}"},if:{open:"if(($notnull_1) && $1a){",close:"}"},else:{_default:{$1:"true"},open:"}else if(($notnull_1) && $1a){"},html:{open:"if($notnull_1){__.push($1a);}"},"=":{_default:{$1:"$data"},open:"if($notnull_1){__.push($.encode($1a));}"},"!":{open:""}},complete:function(){y={}},afterManip:function(t,n,i){var o=11===n.nodeType?e.makeArray(n.childNodes):1===n.nodeType?[n]:[];i.call(t,n),l(o),x++}})}(jQuery),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e){e.extend(e.fn,{validate:function(t){if(this.length){var n=e.data(this[0],"validator");return n||(this.attr("novalidate","novalidate"),n=new e.validator(t,this[0]),e.data(this[0],"validator",n),n.settings.onsubmit&&(this.validateDelegate(":submit","click",function(t){n.settings.submitHandler&&(n.submitButton=t.target),e(t.target).hasClass("cancel")&&(n.cancelSubmit=!0),void 0!==e(t.target).attr("formnovalidate")&&(n.cancelSubmit=!0)}),this.submit(function(t){function i(){var i,o;return!n.settings.submitHandler||(n.submitButton&&(i=e("<input type='hidden'/>").attr("name",n.submitButton.name).val(e(n.submitButton).val()).appendTo(n.currentForm)),o=n.settings.submitHandler.call(n,n.currentForm,t),n.submitButton&&i.remove(),void 0!==o&&o)}return n.settings.debug&&t.preventDefault(),n.cancelSubmit?(n.cancelSubmit=!1,i()):n.form()?n.pendingRequest?(n.formSubmitted=!0,!1):i():(n.focusInvalid(),!1)})),n)}t&&t.debug&&window.console&&console.warn("Nothing selected, can't validate, returning nothing.")},valid:function(){var t,n;return e(this[0]).is("form")?t=this.validate().form():(t=!0,n=e(this[0].form).validate(),this.each(function(){t=n.element(this)&&t})),t},removeAttrs:function(t){var n={},i=this;return e.each(t.split(/\s/),function(e,t){n[t]=i.attr(t),i.removeAttr(t)}),n},rules:function(t,n){var i,o,r,a,s,l,c=this[0];if(t)switch(i=e.data(c.form,"validator").settings,o=i.rules,r=e.validator.staticRules(c),t){case"add":e.extend(r,e.validator.normalizeRule(n)),delete r.messages,o[c.name]=r,n.messages&&(i.messages[c.name]=e.extend(i.messages[c.name],n.messages));break;case"remove":return n?(l={},e.each(n.split(/\s/),function(t,n){l[n]=r[n],delete r[n],"required"===n&&e(c).removeAttr("aria-required")}),l):(delete o[c.name],r)}return(a=e.validator.normalizeRules(e.extend({},e.validator.classRules(c),e.validator.attributeRules(c),e.validator.dataRules(c),e.validator.staticRules(c)),c)).required&&(s=a.required,delete a.required,a=e.extend({required:s},a),e(c).attr("aria-required","true")),a.remote&&(s=a.remote,delete a.remote,a=e.extend(a,{remote:s})),a}}),e.extend(e.expr[":"],{blank:function(t){return!e.trim(""+e(t).val())},filled:function(t){return!!e.trim(""+e(t).val())},unchecked:function(t){return!e(t).prop("checked")}}),e.validator=function(t,n){this.settings=e.extend(!0,{},e.validator.defaults,t),this.currentForm=n,this.init()},e.validator.format=function(t,n){return 1===arguments.length?function(){var n=e.makeArray(arguments);return n.unshift(t),e.validator.format.apply(this,n)}:(arguments.length>2&&n.constructor!==Array&&(n=e.makeArray(arguments).slice(1)),n.constructor!==Array&&(n=[n]),e.each(n,function(e,n){t=t.replace(new RegExp("\\{"+e+"\\}","g"),function(){return n})}),t)},e.extend(e.validator,{defaults:{messages:{},groups:{},rules:{},errorClass:"error",validClass:"valid",errorElement:"label",focusCleanup:!1,focusInvalid:!0,errorContainer:e([]),errorLabelContainer:e([]),onsubmit:!0,ignore:":hidden",ignoreTitle:!1,onfocusin:function(e){this.lastActive=e,this.settings.focusCleanup&&(this.settings.unhighlight&&this.settings.unhighlight.call(this,e,this.settings.errorClass,this.settings.validClass),this.hideThese(this.errorsFor(e)))},onfocusout:function(e){this.checkable(e)||!(e.name in this.submitted)&&this.optional(e)||this.element(e)},onkeyup:function(e,t){9===t.which&&""===this.elementValue(e)||(e.name in this.submitted||e===this.lastElement)&&this.element(e)},onclick:function(e){e.name in this.submitted?this.element(e):e.parentNode.name in this.submitted&&this.element(e.parentNode)},highlight:function(t,n,i){"radio"===t.type?this.findByName(t.name).addClass(n).removeClass(i):e(t).addClass(n).removeClass(i)},unhighlight:function(t,n,i){"radio"===t.type?this.findByName(t.name).removeClass(n).addClass(i):e(t).removeClass(n).addClass(i)}},setDefaults:function(t){e.extend(e.validator.defaults,t)},messages:{required:"This field is required.",remote:"Please fix this field.",email:"Please enter a valid email address.",url:"Please enter a valid URL.",date:"Please enter a valid date.",dateISO:"Please enter a valid date ( ISO ).",number:"Please enter a valid number.",digits:"Please enter only digits.",creditcard:"Please enter a valid credit card number.",equalTo:"Please enter the same value again.",maxlength:e.validator.format("Please enter no more than {0} characters."),minlength:e.validator.format("Please enter at least {0} characters."),rangelength:e.validator.format("Please enter a value between {0} and {1} characters long."),range:e.validator.format("Please enter a value between {0} and {1}."),max:e.validator.format("Please enter a value less than or equal to {0}."),min:e.validator.format("Please enter a value greater than or equal to {0}.")},autoCreateRanges:!1,prototype:{init:function(){function t(t){var n=e.data(this[0].form,"validator"),i="on"+t.type.replace(/^validate/,""),o=n.settings;o[i]&&!this.is(o.ignore)&&o[i].call(n,this[0],t)}this.labelContainer=e(this.settings.errorLabelContainer),this.errorContext=this.labelContainer.length&&this.labelContainer||e(this.currentForm),this.containers=e(this.settings.errorContainer).add(this.settings.errorLabelContainer),this.submitted={},this.valueCache={},this.pendingRequest=0,this.pending={},this.invalid={},this.reset();var n,i=this.groups={};e.each(this.settings.groups,function(t,n){"string"==typeof n&&(n=n.split(/\s/)),e.each(n,function(e,n){i[n]=t})}),n=this.settings.rules,e.each(n,function(t,i){n[t]=e.validator.normalizeRule(i)}),e(this.currentForm).validateDelegate(":text, [type='password'], [type='file'], select, textarea, [type='number'], [type='search'] ,[type='tel'], [type='url'], [type='email'], [type='datetime'], [type='date'], [type='month'], [type='week'], [type='time'], [type='datetime-local'], [type='range'], [type='color'], [type='radio'], [type='checkbox']","focusin focusout keyup",t).validateDelegate("select, option, [type='radio'], [type='checkbox']","click",t),this.settings.invalidHandler&&e(this.currentForm).bind("invalid-form.validate",this.settings.invalidHandler),e(this.currentForm).find("[required], [data-rule-required], .required").attr("aria-required","true")},form:function(){return this.checkForm(),e.extend(this.submitted,this.errorMap),this.invalid=e.extend({},this.errorMap),this.valid()||e(this.currentForm).triggerHandler("invalid-form",[this]),this.showErrors(),this.valid()},checkForm:function(){this.prepareForm();for(var e=0,t=this.currentElements=this.elements();t[e];e++)this.check(t[e]);return this.valid()},element:function(t){var n=this.clean(t),i=this.validationTargetFor(n),o=!0;return this.lastElement=i,void 0===i?delete this.invalid[n.name]:(this.prepareElement(i),this.currentElements=e(i),(o=!1!==this.check(i))?delete this.invalid[i.name]:this.invalid[i.name]=!0),e(t).attr("aria-invalid",!o),this.numberOfInvalids()||(this.toHide=this.toHide.add(this.containers)),this.showErrors(),o},showErrors:function(t){if(t){e.extend(this.errorMap,t),this.errorList=[];for(var n in t)this.errorList.push({message:t[n],element:this.findByName(n)[0]});this.successList=e.grep(this.successList,function(e){return!(e.name in t)})}this.settings.showErrors?this.settings.showErrors.call(this,this.errorMap,this.errorList):this.defaultShowErrors()},resetForm:function(){e.fn.resetForm&&e(this.currentForm).resetForm(),this.submitted={},this.lastElement=null,this.prepareForm(),this.hideErrors(),this.elements().removeClass(this.settings.errorClass).removeData("previousValue").removeAttr("aria-invalid")},numberOfInvalids:function(){return this.objectLength(this.invalid)},objectLength:function(e){var t,n=0;for(t in e)n++;return n},hideErrors:function(){this.hideThese(this.toHide)},hideThese:function(e){e.not(this.containers).text(""),this.addWrapper(e).hide()},valid:function(){return 0===this.size()},size:function(){return this.errorList.length},focusInvalid:function(){if(this.settings.focusInvalid)try{e(this.findLastActive()||this.errorList.length&&this.errorList[0].element||[]).filter(":visible").focus().trigger("focusin")}catch(e){}},findLastActive:function(){var t=this.lastActive;return t&&1===e.grep(this.errorList,function(e){return e.element.name===t.name}).length&&t},elements:function(){var t=this,n={};return e(this.currentForm).find("input, select, textarea").not(":submit, :reset, :image, [disabled], [readonly]").not(this.settings.ignore).filter(function(){return!this.name&&t.settings.debug&&window.console&&console.error("%o has no name assigned",this),!(this.name in n||!t.objectLength(e(this).rules()))&&(n[this.name]=!0,!0)})},clean:function(t){return e(t)[0]},errors:function(){var t=this.settings.errorClass.split(" ").join(".");return e(this.settings.errorElement+"."+t,this.errorContext)},reset:function(){this.successList=[],this.errorList=[],this.errorMap={},this.toShow=e([]),this.toHide=e([]),this.currentElements=e([])},prepareForm:function(){this.reset(),this.toHide=this.errors().add(this.containers)},prepareElement:function(e){this.reset(),this.toHide=this.errorsFor(e)},elementValue:function(t){var n,i=e(t),o=t.type;return"radio"===o||"checkbox"===o?e("input[name='"+t.name+"']:checked").val():"number"===o&&void 0!==t.validity?!t.validity.badInput&&i.val():"string"==typeof(n=i.val())?n.replace(/\r/g,""):n},check:function(t){t=this.validationTargetFor(this.clean(t));var n,i,o,r=e(t).rules(),a=e.map(r,function(e,t){return t}).length,s=!1,l=this.elementValue(t);for(i in r){o={method:i,parameters:r[i]};try{if("dependency-mismatch"===(n=e.validator.methods[i].call(this,l,t,o.parameters))&&1===a){s=!0;continue}if(s=!1,"pending"===n)return void(this.toHide=this.toHide.not(this.errorsFor(t)));if(!n)return this.formatAndAdd(t,o),!1}catch(e){throw this.settings.debug&&window.console&&console.log("Exception occurred when checking element "+t.id+", check the '"+o.method+"' method.",e),e}}if(!s)return this.objectLength(r)&&this.successList.push(t),!0},customDataMessage:function(t,n){return e(t).data("msg"+n.charAt(0).toUpperCase()+n.substring(1).toLowerCase())||e(t).data("msg")},customMessage:function(e,t){var n=this.settings.messages[e];return n&&(n.constructor===String?n:n[t])},findDefined:function(){for(var e=0;e<arguments.length;e++)if(void 0!==arguments[e])return arguments[e]},defaultMessage:function(t,n){return this.findDefined(this.customMessage(t.name,n),this.customDataMessage(t,n),!this.settings.ignoreTitle&&t.title||void 0,e.validator.messages[n],"<strong>Warning: No message defined for "+t.name+"</strong>")},formatAndAdd:function(t,n){var i=this.defaultMessage(t,n.method),o=/\$?\{(\d+)\}/g;"function"==typeof i?i=i.call(this,n.parameters,t):o.test(i)&&(i=e.validator.format(i.replace(o,"{$1}"),n.parameters)),this.errorList.push({message:i,element:t,method:n.method}),this.errorMap[t.name]=i,this.submitted[t.name]=i},addWrapper:function(e){return this.settings.wrapper&&(e=e.add(e.parent(this.settings.wrapper))),e},defaultShowErrors:function(){var e,t,n;for(e=0;this.errorList[e];e++)n=this.errorList[e],this.settings.highlight&&this.settings.highlight.call(this,n.element,this.settings.errorClass,this.settings.validClass),this.showLabel(n.element,n.message);if(this.errorList.length&&(this.toShow=this.toShow.add(this.containers)),this.settings.success)for(e=0;this.successList[e];e++)this.showLabel(this.successList[e]);if(this.settings.unhighlight)for(e=0,t=this.validElements();t[e];e++)this.settings.unhighlight.call(this,t[e],this.settings.errorClass,this.settings.validClass);this.toHide=this.toHide.not(this.toShow),this.hideErrors(),this.addWrapper(this.toShow).show()},validElements:function(){return this.currentElements.not(this.invalidElements())},invalidElements:function(){return e(this.errorList).map(function(){return this.element})},showLabel:function(t,n){var i,o,r,a=this.errorsFor(t),s=this.idOrName(t),l=e(t).attr("aria-describedby");a.length?(a.removeClass(this.settings.validClass).addClass(this.settings.errorClass),a.html(n)):(i=a=e("<"+this.settings.errorElement+">").attr("id",s+"-error").addClass(this.settings.errorClass).html(n||""),this.settings.wrapper&&(i=a.hide().show().wrap("<"+this.settings.wrapper+"/>").parent()),this.labelContainer.length?this.labelContainer.append(i):this.settings.errorPlacement?this.settings.errorPlacement(i,e(t)):i.insertAfter(t),a.is("label")?a.attr("for",s):0===a.parents("label[for='"+s+"']").length&&(r=a.attr("id").replace(/(:|\.|\[|\])/g,"\\$1"),l?l.match(new RegExp("\\b"+r+"\\b"))||(l+=" "+r):l=r,e(t).attr("aria-describedby",l),(o=this.groups[t.name])&&e.each(this.groups,function(t,n){n===o&&e("[name='"+t+"']",this.currentForm).attr("aria-describedby",a.attr("id"))}))),!n&&this.settings.success&&(a.text(""),"string"==typeof this.settings.success?a.addClass(this.settings.success):this.settings.success(a,t)),this.toShow=this.toShow.add(a)},errorsFor:function(t){var n=this.idOrName(t),i=e(t).attr("aria-describedby"),o="label[for='"+n+"'], label[for='"+n+"'] *";return i&&(o=o+", #"+i.replace(/\s+/g,", #")),this.errors().filter(o)},idOrName:function(e){return this.groups[e.name]||(this.checkable(e)?e.name:e.id||e.name)},validationTargetFor:function(t){return this.checkable(t)&&(t=this.findByName(t.name)),e(t).not(this.settings.ignore)[0]},checkable:function(e){return/radio|checkbox/i.test(e.type)},findByName:function(t){return e(this.currentForm).find("[name='"+t+"']")},getLength:function(t,n){switch(n.nodeName.toLowerCase()){case"select":return e("option:selected",n).length;case"input":if(this.checkable(n))return this.findByName(n.name).filter(":checked").length}return t.length},depend:function(e,t){return!this.dependTypes[typeof e]||this.dependTypes[typeof e](e,t)},dependTypes:{boolean:function(e){return e},string:function(t,n){return!!e(t,n.form).length},function:function(e,t){return e(t)}},optional:function(t){var n=this.elementValue(t);return!e.validator.methods.required.call(this,n,t)&&"dependency-mismatch"},startRequest:function(e){this.pending[e.name]||(this.pendingRequest++,this.pending[e.name]=!0)},stopRequest:function(t,n){this.pendingRequest--,this.pendingRequest<0&&(this.pendingRequest=0),delete this.pending[t.name],n&&0===this.pendingRequest&&this.formSubmitted&&this.form()?(e(this.currentForm).submit(),this.formSubmitted=!1):!n&&0===this.pendingRequest&&this.formSubmitted&&(e(this.currentForm).triggerHandler("invalid-form",[this]),this.formSubmitted=!1)},previousValue:function(t){return e.data(t,"previousValue")||e.data(t,"previousValue",{old:null,valid:!0,message:this.defaultMessage(t,"remote")})}},classRuleSettings:{required:{required:!0},email:{email:!0},url:{url:!0},date:{date:!0},dateISO:{dateISO:!0},number:{number:!0},digits:{digits:!0},creditcard:{creditcard:!0}},addClassRules:function(t,n){t.constructor===String?this.classRuleSettings[t]=n:e.extend(this.classRuleSettings,t)},classRules:function(t){var n={},i=e(t).attr("class");return i&&e.each(i.split(" "),function(){this in e.validator.classRuleSettings&&e.extend(n,e.validator.classRuleSettings[this])}),n},attributeRules:function(t){var n,i,o={},r=e(t),a=t.getAttribute("type");for(n in e.validator.methods)"required"===n?(""===(i=t.getAttribute(n))&&(i=!0),i=!!i):i=r.attr(n),/min|max/.test(n)&&(null===a||/number|range|text/.test(a))&&(i=Number(i)),i||0===i?o[n]=i:a===n&&"range"!==a&&(o[n]=!0);return o.maxlength&&/-1|2147483647|524288/.test(o.maxlength)&&delete o.maxlength,o},dataRules:function(t){var n,i,o={},r=e(t);for(n in e.validator.methods)void 0!==(i=r.data("rule"+n.charAt(0).toUpperCase()+n.substring(1).toLowerCase()))&&(o[n]=i);return o},staticRules:function(t){var n={},i=e.data(t.form,"validator");return i.settings.rules&&(n=e.validator.normalizeRule(i.settings.rules[t.name])||{}),n},normalizeRules:function(t,n){return e.each(t,function(i,o){if(!1!==o){if(o.param||o.depends){var r=!0;switch(typeof o.depends){case"string":r=!!e(o.depends,n.form).length;break;case"function":r=o.depends.call(n,n)}r?t[i]=void 0===o.param||o.param:delete t[i]}}else delete t[i]}),e.each(t,function(i,o){t[i]=e.isFunction(o)?o(n):o}),e.each(["minlength","maxlength"],function(){t[this]&&(t[this]=Number(t[this]))}),e.each(["rangelength","range"],function(){var n;t[this]&&(e.isArray(t[this])?t[this]=[Number(t[this][0]),Number(t[this][1])]:"string"==typeof t[this]&&(n=t[this].replace(/[\[\]]/g,"").split(/[\s,]+/),t[this]=[Number(n[0]),Number(n[1])]))}),e.validator.autoCreateRanges&&(null!=t.min&&null!=t.max&&(t.range=[t.min,t.max],delete t.min,delete t.max),null!=t.minlength&&null!=t.maxlength&&(t.rangelength=[t.minlength,t.maxlength],delete t.minlength,delete t.maxlength)),t},normalizeRule:function(t){if("string"==typeof t){var n={};e.each(t.split(/\s/),function(){n[this]=!0}),t=n}return t},addMethod:function(t,n,i){e.validator.methods[t]=n,e.validator.messages[t]=void 0!==i?i:e.validator.messages[t],n.length<3&&e.validator.addClassRules(t,e.validator.normalizeRule(t))},methods:{required:function(t,n,i){if(!this.depend(i,n))return"dependency-mismatch";if("select"===n.nodeName.toLowerCase()){var o=e(n).val();return o&&o.length>0}return this.checkable(n)?this.getLength(t,n)>0:e.trim(t).length>0},email:function(e,t){return this.optional(t)||/^[a-zA-Z0-9.!#$%&'*+\/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*$/.test(e)},url:function(e,t){return this.optional(t)||/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i.test(e)},date:function(e,t){return this.optional(t)||!/Invalid|NaN/.test(new Date(e).toString())},dateISO:function(e,t){return this.optional(t)||/^\d{4}[\/\-](0?[1-9]|1[012])[\/\-](0?[1-9]|[12][0-9]|3[01])$/.test(e)},number:function(e,t){return this.optional(t)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(e)},digits:function(e,t){return this.optional(t)||/^\d+$/.test(e)},creditcard:function(e,t){if(this.optional(t))return"dependency-mismatch";if(/[^0-9 \-]+/.test(e))return!1;var n,i,o=0,r=0,a=!1;if((e=e.replace(/\D/g,"")).length<13||e.length>19)return!1;for(n=e.length-1;n>=0;n--)i=e.charAt(n),r=parseInt(i,10),a&&(r*=2)>9&&(r-=9),o+=r,a=!a;return o%10==0},minlength:function(t,n,i){var o=e.isArray(t)?t.length:this.getLength(t,n);return this.optional(n)||o>=i},maxlength:function(t,n,i){var o=e.isArray(t)?t.length:this.getLength(t,n);return this.optional(n)||o<=i},rangelength:function(t,n,i){var o=e.isArray(t)?t.length:this.getLength(t,n);return this.optional(n)||o>=i[0]&&o<=i[1]},min:function(e,t,n){return this.optional(t)||e>=n},max:function(e,t,n){return this.optional(t)||e<=n},range:function(e,t,n){return this.optional(t)||e>=n[0]&&e<=n[1]},equalTo:function(t,n,i){var o=e(i);return this.settings.onfocusout&&o.unbind(".validate-equalTo").bind("blur.validate-equalTo",function(){e(n).valid()}),t===o.val()},remote:function(t,n,i){if(this.optional(n))return"dependency-mismatch";var o,r,a=this.previousValue(n);return this.settings.messages[n.name]||(this.settings.messages[n.name]={}),a.originalMessage=this.settings.messages[n.name].remote,this.settings.messages[n.name].remote=a.message,i="string"==typeof i&&{url:i}||i,a.old===t?a.valid:(a.old=t,o=this,this.startRequest(n),r={},r[n.name]=t,e.ajax(e.extend(!0,{url:i,mode:"abort",port:"validate"+n.name,dataType:"json",data:r,context:o.currentForm,success:function(i){var r,s,l,c=!0===i||"true"===i;o.settings.messages[n.name].remote=a.originalMessage,c?(l=o.formSubmitted,o.prepareElement(n),o.formSubmitted=l,o.successList.push(n),delete o.invalid[n.name],o.showErrors()):(r={},s=i||o.defaultMessage(n,"remote"),r[n.name]=a.message=e.isFunction(s)?s(t):s,o.invalid[n.name]=!0,o.showErrors(r)),a.valid=c,o.stopRequest(n,c)}},i)),"pending")}}}),e.format=function(){throw"$.format has been deprecated. Please use $.validator.format instead."};var t,n={};e.ajaxPrefilter?e.ajaxPrefilter(function(e,t,i){var o=e.port;"abort"===e.mode&&(n[o]&&n[o].abort(),n[o]=i)}):(t=e.ajax,e.ajax=function(i){var o=("mode"in i?i:e.ajaxSettings).mode,r=("port"in i?i:e.ajaxSettings).port;return"abort"===o?(n[r]&&n[r].abort(),n[r]=t.apply(this,arguments),n[r]):t.apply(this,arguments)}),e.extend(e.fn,{validateDelegate:function(t,n,i){return this.bind(n,function(n){var o=e(n.target);if(o.is(t))return i.apply(o,arguments)})}})}),function(e){"function"==typeof define&&define.amd?define(["jquery"],e):e(jQuery)}(function(e,t){var n=0,i=Array.prototype.slice,o=e.cleanData;e.cleanData=function(t){for(var n,i=0;null!=(n=t[i]);i++)try{e(n).triggerHandler("remove")}catch(e){}o(t)},e.widget=function(t,n,i){var o,r,a,s,l={},c=t.split(".")[0];t=t.split(".")[1],o=c+"-"+t,i||(i=n,n=e.Widget),e.expr[":"][o.toLowerCase()]=function(t){return!!e.data(t,o)},e[c]=e[c]||{},r=e[c][t],a=e[c][t]=function(e,t){if(!this._createWidget)return new a(e,t);arguments.length&&this._createWidget(e,t)},e.extend(a,r,{version:i.version,_proto:e.extend({},i),_childConstructors:[]}),(s=new n).options=e.widget.extend({},s.options),e.each(i,function(t,i){e.isFunction(i)?l[t]=function(){var e=function(){return n.prototype[t].apply(this,arguments)},o=function(e){return n.prototype[t].apply(this,e)};return function(){var t,n=this._super,r=this._superApply;return this._super=e,this._superApply=o,t=i.apply(this,arguments),this._super=n,this._superApply=r,t}}():l[t]=i}),a.prototype=e.widget.extend(s,{widgetEventPrefix:r?s.widgetEventPrefix||t:t},l,{constructor:a,namespace:c,widgetName:t,widgetFullName:o}),r?(e.each(r._childConstructors,function(t,n){var i=n.prototype;e.widget(i.namespace+"."+i.widgetName,a,n._proto)}),delete r._childConstructors):n._childConstructors.push(a),e.widget.bridge(t,a)},e.widget.extend=function(n){for(var o,r,a=i.call(arguments,1),s=0,l=a.length;s<l;s++)for(o in a[s])r=a[s][o],a[s].hasOwnProperty(o)&&r!==t&&(e.isPlainObject(r)?n[o]=e.isPlainObject(n[o])?e.widget.extend({},n[o],r):e.widget.extend({},r):n[o]=r);return n},e.widget.bridge=function(n,o){var r=o.prototype.widgetFullName||n;e.fn[n]=function(a){var s="string"==typeof a,l=i.call(arguments,1),c=this;return a=!s&&l.length?e.widget.extend.apply(null,[a].concat(l)):a,s?this.each(function(){var i,o=e.data(this,r);return o?e.isFunction(o[a])&&"_"!==a.charAt(0)?(i=o[a].apply(o,l))!==o&&i!==t?(c=i&&i.jquery?c.pushStack(i.get()):i,!1):void 0:e.error("no such method '"+a+"' for "+n+" widget instance"):e.error("cannot call methods on "+n+" prior to initialization; attempted to call method '"+a+"'")}):this.each(function(){var t=e.data(this,r);t?t.option(a||{})._init():e.data(this,r,new o(a,this))}),c}},e.Widget=function(){},e.Widget._childConstructors=[],e.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(t,i){i=e(i||this.defaultElement||this)[0],this.element=e(i),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=e.widget.extend({},this.options,this._getCreateOptions(),t),this.bindings=e(),this.hoverable=e(),this.focusable=e(),i!==this&&(e.data(i,this.widgetFullName,this),this._on(!0,this.element,{remove:function(e){e.target===i&&this.destroy()}}),this.document=e(i.style?i.ownerDocument:i.document||i),this.window=e(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:e.noop,_getCreateEventData:e.noop,_create:e.noop,_init:e.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(e.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:e.noop,widget:function(){return this.element},option:function(n,i){var o,r,a,s=n;if(0===arguments.length)return e.widget.extend({},this.options);if("string"==typeof n)if(s={},o=n.split("."),n=o.shift(),o.length){for(r=s[n]=e.widget.extend({},this.options[n]),a=0;a<o.length-1;a++)r[o[a]]=r[o[a]]||{},r=r[o[a]];if(n=o.pop(),1===arguments.length)return r[n]===t?null:r[n];r[n]=i}else{if(1===arguments.length)return this.options[n]===t?null:this.options[n];s[n]=i}return this._setOptions(s),this},_setOptions:function(e){var t;for(t in e)this._setOption(t,e[t]);return this},_setOption:function(e,t){return this.options[e]=t,"disabled"===e&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!t).attr("aria-disabled",t),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(t,n,i){var o,r=this;"boolean"!=typeof t&&(i=n,n=t,t=!1),i?(n=o=e(n),this.bindings=this.bindings.add(n)):(i=n,n=this.element,o=this.widget()),e.each(i,function(i,a){function s(){if(t||!0!==r.options.disabled&&!e(this).hasClass("ui-state-disabled"))return("string"==typeof a?r[a]:a).apply(r,arguments)}"string"!=typeof a&&(s.guid=a.guid=a.guid||s.guid||e.guid++);var l=i.match(/^(\w+)\s*(.*)$/),c=l[1]+r.eventNamespace,d=l[2];d?o.delegate(d,c,s):n.bind(c,s)})},_off:function(e,t){t=(t||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,e.unbind(t).undelegate(t)},_delay:function(e,t){var n=this;return setTimeout(function(){return("string"==typeof e?n[e]:e).apply(n,arguments)},t||0)},_hoverable:function(t){this.hoverable=this.hoverable.add(t),this._on(t,{mouseenter:function(t){e(t.currentTarget).addClass("ui-state-hover")},mouseleave:function(t){e(t.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(t){this.focusable=this.focusable.add(t),this._on(t,{focusin:function(t){e(t.currentTarget).addClass("ui-state-focus")},focusout:function(t){e(t.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(t,n,i){var o,r,a=this.options[t];if(i=i||{},n=e.Event(n),n.type=(t===this.widgetEventPrefix?t:this.widgetEventPrefix+t).toLowerCase(),n.target=this.element[0],r=n.originalEvent)for(o in r)o in n||(n[o]=r[o]);return this.element.trigger(n,i),!(e.isFunction(a)&&!1===a.apply(this.element[0],[n].concat(i))||n.isDefaultPrevented())}},e.each({show:"fadeIn",hide:"fadeOut"},function(t,n){e.Widget.prototype["_"+t]=function(i,o,r){"string"==typeof o&&(o={effect:o});var a,s=o?!0===o||"number"==typeof o?n:o.effect||n:t;"number"==typeof(o=o||{})&&(o={duration:o}),a=!e.isEmptyObject(o),o.complete=r,o.delay&&i.delay(o.delay),a&&e.effects&&e.effects.effect[s]?i[t](o):s!==t&&i[s]?i[s](o.duration,o.easing,r):i.queue(function(n){e(this)[t](),r&&r.call(i[0]),n()})}})}),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery"],e):e(window.jQuery)}(function(e){"use strict";var t=0;e.ajaxTransport("iframe",function(n){if(n.async){var i,o,r,a=n.initialIframeSrc||"javascript:false;";return{send:function(s,l){(i=e('<form style="display:none;"></form>')).attr("accept-charset",n.formAcceptCharset),r=/\?/.test(n.url)?"&":"?","DELETE"===n.type?(n.url=n.url+r+"_method=DELETE",n.type="POST"):"PUT"===n.type?(n.url=n.url+r+"_method=PUT",n.type="POST"):"PATCH"===n.type&&(n.url=n.url+r+"_method=PATCH",n.type="POST"),o=e('<iframe src="'+a+'" name="iframe-transport-'+(t+=1)+'"></iframe>').bind("load",function(){var t,r=e.isArray(n.paramName)?n.paramName:[n.paramName];o.unbind("load").bind("load",function(){var t;try{if(!(t=o.contents()).length||!t[0].firstChild)throw new Error}catch(e){t=void 0}l(200,"success",{iframe:t}),e('<iframe src="'+a+'"></iframe>').appendTo(i),window.setTimeout(function(){i.remove()},0)}),i.prop("target",o.prop("name")).prop("action",n.url).prop("method",n.type),n.formData&&e.each(n.formData,function(t,n){e('<input type="hidden"/>').prop("name",n.name).val(n.value).appendTo(i)}),n.fileInput&&n.fileInput.length&&"POST"===n.type&&(t=n.fileInput.clone(),n.fileInput.after(function(e){return t[e]}),n.paramName&&n.fileInput.each(function(t){e(this).prop("name",r[t]||n.paramName)}),i.append(n.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data"),n.fileInput.removeAttr("form")),i.submit(),t&&t.length&&n.fileInput.each(function(n,i){var o=e(t[n]);e(i).prop("name",o.prop("name")).attr("form",o.attr("form")),o.replaceWith(i)})}),i.append(o).appendTo(document.body)},abort:function(){o&&o.unbind("load").prop("src",a),i&&i.remove()}}}}),e.ajaxSetup({converters:{"iframe text":function(t){return t&&e(t[0].body).text()},"iframe json":function(t){return t&&e.parseJSON(e(t[0].body).text())},"iframe html":function(t){return t&&e(t[0].body).html()},"iframe xml":function(t){var n=t&&t[0];return n&&e.isXMLDoc(n)?n:e.parseXML(n.XMLDocument&&n.XMLDocument.xml||e(n.body).html())},"iframe script":function(t){return t&&e.globalEval(e(t[0].body).text())}}})}),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery","jquery.ui.widget"],e):e(window.jQuery)}(function(e){"use strict";e.support.fileInput=!(new RegExp("(Android (1\\.[0156]|2\\.[01]))|(Windows Phone (OS 7|8\\.0))|(XBLWP)|(ZuneWP)|(WPDesktop)|(w(eb)?OSBrowser)|(webOS)|(Kindle/(1\\.0|2\\.[05]|3\\.0))").test(window.navigator.userAgent)||e('<input type="file">').prop("disabled")),e.support.xhrFileUpload=!(!window.ProgressEvent||!window.FileReader),e.support.xhrFormDataFileUpload=!!window.FormData,e.support.blobSlice=window.Blob&&(Blob.prototype.slice||Blob.prototype.webkitSlice||Blob.prototype.mozSlice),e.widget("blueimp.fileupload",{options:{dropZone:e(document),pasteZone:e(document),fileInput:void 0,replaceFileInput:!0,paramName:void 0,singleFileUploads:!0,limitMultiFileUploads:void 0,limitMultiFileUploadSize:void 0,limitMultiFileUploadSizeOverhead:512,sequentialUploads:!1,limitConcurrentUploads:void 0,forceIframeTransport:!1,redirect:void 0,redirectParamName:void 0,postMessage:void 0,multipart:!0,maxChunkSize:void 0,uploadedBytes:void 0,recalculateProgress:!0,progressInterval:100,bitrateInterval:500,autoUpload:!0,messages:{uploadedBytes:"Uploaded bytes exceed file size"},i18n:function(t,n){return t=this.messages[t]||t.toString(),n&&e.each(n,function(e,n){t=t.replace("{"+e+"}",n)}),t},formData:function(e){return e.serializeArray()},add:function(t,n){if(t.isDefaultPrevented())return!1;(n.autoUpload||!1!==n.autoUpload&&e(this).fileupload("option","autoUpload"))&&n.process().done(function(){n.submit()})},processData:!1,contentType:!1,cache:!1},_specialOptions:["fileInput","dropZone","pasteZone","multipart","forceIframeTransport"],_blobSlice:e.support.blobSlice&&function(){return(this.slice||this.webkitSlice||this.mozSlice).apply(this,arguments)},_BitrateTimer:function(){this.timestamp=Date.now?Date.now():(new Date).getTime(),this.loaded=0,this.bitrate=0,this.getBitrate=function(e,t,n){var i=e-this.timestamp;return(!this.bitrate||!n||i>n)&&(this.bitrate=(t-this.loaded)*(1e3/i)*8,this.loaded=t,this.timestamp=e),this.bitrate}},_isXHRUpload:function(t){return!t.forceIframeTransport&&(!t.multipart&&e.support.xhrFileUpload||e.support.xhrFormDataFileUpload)},_getFormData:function(t){var n;return"function"===e.type(t.formData)?t.formData(t.form):e.isArray(t.formData)?t.formData:"object"===e.type(t.formData)?(n=[],e.each(t.formData,function(e,t){n.push({name:e,value:t})}),n):[]},_getTotal:function(t){var n=0;return e.each(t,function(e,t){n+=t.size||1}),n},_initProgressObject:function(t){var n={loaded:0,total:0,bitrate:0};t._progress?e.extend(t._progress,n):t._progress=n},_initResponseObject:function(e){var t;if(e._response)for(t in e._response)e._response.hasOwnProperty(t)&&delete e._response[t];else e._response={}},_onProgress:function(t,n){if(t.lengthComputable){var i,o=Date.now?Date.now():(new Date).getTime();if(n._time&&n.progressInterval&&o-n._time<n.progressInterval&&t.loaded!==t.total)return;n._time=o,i=Math.floor(t.loaded/t.total*(n.chunkSize||n._progress.total))+(n.uploadedBytes||0),this._progress.loaded+=i-n._progress.loaded,this._progress.bitrate=this._bitrateTimer.getBitrate(o,this._progress.loaded,n.bitrateInterval),n._progress.loaded=n.loaded=i,n._progress.bitrate=n.bitrate=n._bitrateTimer.getBitrate(o,i,n.bitrateInterval),this._trigger("progress",e.Event("progress",{delegatedEvent:t}),n),this._trigger("progressall",e.Event("progressall",{delegatedEvent:t}),this._progress)}},_initProgressListener:function(t){var n=this,i=t.xhr?t.xhr():e.ajaxSettings.xhr();i.upload&&(e(i.upload).bind("progress",function(e){var i=e.originalEvent;e.lengthComputable=i.lengthComputable,e.loaded=i.loaded,e.total=i.total,n._onProgress(e,t)}),t.xhr=function(){return i})},_isInstanceOf:function(e,t){return Object.prototype.toString.call(t)==="[object "+e+"]"},_initXHRData:function(t){var n,i=this,o=t.files[0],r=t.multipart||!e.support.xhrFileUpload,a="array"===e.type(t.paramName)?t.paramName[0]:t.paramName;t.headers=e.extend({},t.headers),t.contentRange&&(t.headers["Content-Range"]=t.contentRange),r&&!t.blob&&this._isInstanceOf("File",o)||(t.headers["Content-Disposition"]='attachment; filename="'+encodeURI(o.name)+'"'),r?e.support.xhrFormDataFileUpload&&(t.postMessage?(n=this._getFormData(t),t.blob?n.push({name:a,value:t.blob}):e.each(t.files,function(i,o){n.push({name:"array"===e.type(t.paramName)&&t.paramName[i]||a,value:o})})):(i._isInstanceOf("FormData",t.formData)?n=t.formData:(n=new FormData,e.each(this._getFormData(t),function(e,t){n.append(t.name,t.value)})),t.blob?n.append(a,t.blob,o.name):e.each(t.files,function(o,r){(i._isInstanceOf("File",r)||i._isInstanceOf("Blob",r))&&n.append("array"===e.type(t.paramName)&&t.paramName[o]||a,r,r.uploadName||r.name)})),t.data=n):(t.contentType=o.type||"application/octet-stream",t.data=t.blob||o),t.blob=null},_initIframeSettings:function(t){var n=e("<a></a>").prop("href",t.url).prop("host");t.dataType="iframe "+(t.dataType||""),t.formData=this._getFormData(t),t.redirect&&n&&n!==location.host&&t.formData.push({name:t.redirectParamName||"redirect",value:t.redirect})},_initDataSettings:function(e){this._isXHRUpload(e)?(this._chunkedUpload(e,!0)||(e.data||this._initXHRData(e),this._initProgressListener(e)),e.postMessage&&(e.dataType="postmessage "+(e.dataType||""))):this._initIframeSettings(e)},_getParamName:function(t){var n=e(t.fileInput),i=t.paramName;return i?e.isArray(i)||(i=[i]):(i=[],n.each(function(){for(var t=e(this),n=t.prop("name")||"files[]",o=(t.prop("files")||[1]).length;o;)i.push(n),o-=1}),i.length||(i=[n.prop("name")||"files[]"])),i},_initFormSettings:function(t){t.form&&t.form.length||(t.form=e(t.fileInput.prop("form")),t.form.length||(t.form=e(this.options.fileInput.prop("form")))),t.paramName=this._getParamName(t),t.url||(t.url=t.form.prop("action")||location.href),t.type=(t.type||"string"===e.type(t.form.prop("method"))&&t.form.prop("method")||"").toUpperCase(),"POST"!==t.type&&"PUT"!==t.type&&"PATCH"!==t.type&&(t.type="POST"),t.formAcceptCharset||(t.formAcceptCharset=t.form.attr("accept-charset"))},_getAJAXSettings:function(t){var n=e.extend({},this.options,t);return this._initFormSettings(n),this._initDataSettings(n),n},_getDeferredState:function(e){return e.state?e.state():e.isResolved()?"resolved":e.isRejected()?"rejected":"pending"},_enhancePromise:function(e){return e.success=e.done,e.error=e.fail,e.complete=e.always,e},_getXHRPromise:function(t,n,i){var o=e.Deferred(),r=o.promise();return n=n||this.options.context||r,!0===t?o.resolveWith(n,i):!1===t&&o.rejectWith(n,i),r.abort=o.promise,this._enhancePromise(r)},_addConvenienceMethods:function(t,n){var i=this,o=function(t){return e.Deferred().resolveWith(i,t).promise()};n.process=function(t,r){return(t||r)&&(n._processQueue=this._processQueue=(this._processQueue||o([this])).pipe(function(){return n.errorThrown?e.Deferred().rejectWith(i,[n]).promise():o(arguments)}).pipe(t,r)),this._processQueue||o([this])},n.submit=function(){return"pending"!==this.state()&&(n.jqXHR=this.jqXHR=!1!==i._trigger("submit",e.Event("submit",{delegatedEvent:t}),this)&&i._onSend(t,this)),this.jqXHR||i._getXHRPromise()},n.abort=function(){return this.jqXHR?this.jqXHR.abort():(this.errorThrown="abort",i._trigger("fail",null,this),i._getXHRPromise(!1))},n.state=function(){return this.jqXHR?i._getDeferredState(this.jqXHR):this._processQueue?i._getDeferredState(this._processQueue):void 0},n.processing=function(){return!this.jqXHR&&this._processQueue&&"pending"===i._getDeferredState(this._processQueue)},n.progress=function(){return this._progress},n.response=function(){return this._response}},_getUploadedBytes:function(e){var t=e.getResponseHeader("Range"),n=t&&t.split("-"),i=n&&n.length>1&&parseInt(n[1],10);return i&&i+1},_chunkedUpload:function(t,n){t.uploadedBytes=t.uploadedBytes||0;var i,o,r=this,a=t.files[0],s=a.size,l=t.uploadedBytes,c=t.maxChunkSize||s,d=this._blobSlice,u=e.Deferred(),h=u.promise();return!(!(this._isXHRUpload(t)&&d&&(l||c<s))||t.data)&&(!!n||(l>=s?(a.error=t.i18n("uploadedBytes"),this._getXHRPromise(!1,t.context,[null,"error",a.error])):(o=function(){var n=e.extend({},t),h=n._progress.loaded;n.blob=d.call(a,l,l+c,a.type),n.chunkSize=n.blob.size,n.contentRange="bytes "+l+"-"+(l+n.chunkSize-1)+"/"+s,r._initXHRData(n),r._initProgressListener(n),i=(!1!==r._trigger("chunksend",null,n)&&e.ajax(n)||r._getXHRPromise(!1,n.context)).done(function(i,a,c){l=r._getUploadedBytes(c)||l+n.chunkSize,h+n.chunkSize-n._progress.loaded&&r._onProgress(e.Event("progress",{lengthComputable:!0,loaded:l-n.uploadedBytes,total:l-n.uploadedBytes}),n),t.uploadedBytes=n.uploadedBytes=l,n.result=i,n.textStatus=a,n.jqXHR=c,r._trigger("chunkdone",null,n),r._trigger("chunkalways",null,n),l<s?o():u.resolveWith(n.context,[i,a,c])}).fail(function(e,t,i){n.jqXHR=e,n.textStatus=t,n.errorThrown=i,r._trigger("chunkfail",null,n),r._trigger("chunkalways",null,n),u.rejectWith(n.context,[e,t,i])})},this._enhancePromise(h),h.abort=function(){return i.abort()},o(),h)))},_beforeSend:function(e,t){0===this._active&&(this._trigger("start"),this._bitrateTimer=new this._BitrateTimer,this._progress.loaded=this._progress.total=0,this._progress.bitrate=0),this._initResponseObject(t),this._initProgressObject(t),t._progress.loaded=t.loaded=t.uploadedBytes||0,t._progress.total=t.total=this._getTotal(t.files)||1,t._progress.bitrate=t.bitrate=0,this._active+=1,this._progress.loaded+=t.loaded,this._progress.total+=t.total},_onDone:function(t,n,i,o){var r=o._progress.total,a=o._response;o._progress.loaded<r&&this._onProgress(e.Event("progress",{lengthComputable:!0,loaded:r,total:r}),o),a.result=o.result=t,a.textStatus=o.textStatus=n,a.jqXHR=o.jqXHR=i,this._trigger("done",null,o)},_onFail:function(e,t,n,i){var o=i._response;i.recalculateProgress&&(this._progress.loaded-=i._progress.loaded,this._progress.total-=i._progress.total),o.jqXHR=i.jqXHR=e,o.textStatus=i.textStatus=t,o.errorThrown=i.errorThrown=n,this._trigger("fail",null,i)},_onAlways:function(e,t,n,i){this._trigger("always",null,i)},_onSend:function(t,n){n.submit||this._addConvenienceMethods(t,n);var i,o,r,a,s=this,l=s._getAJAXSettings(n),c=function(){return s._sending+=1,l._bitrateTimer=new s._BitrateTimer,i=i||((o||!1===s._trigger("send",e.Event("send",{delegatedEvent:t}),l))&&s._getXHRPromise(!1,l.context,o)||s._chunkedUpload(l)||e.ajax(l)).done(function(e,t,n){s._onDone(e,t,n,l)}).fail(function(e,t,n){s._onFail(e,t,n,l)}).always(function(e,t,n){if(s._onAlways(e,t,n,l),s._sending-=1,s._active-=1,l.limitConcurrentUploads&&l.limitConcurrentUploads>s._sending)for(var i=s._slots.shift();i;){if("pending"===s._getDeferredState(i)){i.resolve();break}i=s._slots.shift()}0===s._active&&s._trigger("stop")})};return this._beforeSend(t,l),this.options.sequentialUploads||this.options.limitConcurrentUploads&&this.options.limitConcurrentUploads<=this._sending?(this.options.limitConcurrentUploads>1?(r=e.Deferred(),this._slots.push(r),a=r.pipe(c)):(this._sequence=this._sequence.pipe(c,c),a=this._sequence),a.abort=function(){return o=[void 0,"abort","abort"],i?i.abort():(r&&r.rejectWith(l.context,o),c())},this._enhancePromise(a)):c()},_onAdd:function(t,n){var i,o,r,a,s=this,l=!0,c=e.extend({},this.options,n),d=n.files,u=d.length,h=c.limitMultiFileUploads,p=c.limitMultiFileUploadSize,f=c.limitMultiFileUploadSizeOverhead,g=0,v=this._getParamName(c),m=0;if(!p||u&&void 0!==d[0].size||(p=void 0),(c.singleFileUploads||h||p)&&this._isXHRUpload(c))if(c.singleFileUploads||p||!h)if(!c.singleFileUploads&&p)for(r=[],i=[],a=0;a<u;a+=1)g+=d[a].size+f,(a+1===u||g+d[a+1].size+f>p||h&&a+1-m>=h)&&(r.push(d.slice(m,a+1)),(o=v.slice(m,a+1)).length||(o=v),i.push(o),m=a+1,g=0);else i=v;else for(r=[],i=[],a=0;a<u;a+=h)r.push(d.slice(a,a+h)),(o=v.slice(a,a+h)).length||(o=v),i.push(o);else r=[d],i=[v];return n.originalFiles=d,e.each(r||d,function(o,a){var c=e.extend({},n);return c.files=r?a:[a],c.paramName=i[o],s._initResponseObject(c),s._initProgressObject(c),s._addConvenienceMethods(t,c),l=s._trigger("add",e.Event("add",{delegatedEvent:t}),c)}),l},_replaceFileInput:function(t){var n=t.clone(!0);e("<form></form>").append(n)[0].reset(),t.after(n).detach(),e.cleanData(t.unbind("remove")),this.options.fileInput=this.options.fileInput.map(function(e,i){return i===t[0]?n[0]:i}),t[0]===this.element[0]&&(this.element=n)},_handleFileTreeEntry:function(t,n){var i,o=this,r=e.Deferred(),a=function(e){e&&!e.entry&&(e.entry=t),r.resolve([e])},s=function(e){o._handleFileTreeEntries(e,n+t.name+"/").done(function(e){r.resolve(e)}).fail(a)},l=function(){i.readEntries(function(e){e.length?(c=c.concat(e),l()):s(c)},a)},c=[];return n=n||"",t.isFile?t._file?(t._file.relativePath=n,r.resolve(t._file)):t.file(function(e){e.relativePath=n,r.resolve(e)},a):t.isDirectory?(i=t.createReader(),l()):r.resolve([]),r.promise()},_handleFileTreeEntries:function(t,n){var i=this;return e.when.apply(e,e.map(t,function(e){return i._handleFileTreeEntry(e,n)})).pipe(function(){return Array.prototype.concat.apply([],arguments)})},_getDroppedFiles:function(t){var n=(t=t||{}).items;return n&&n.length&&(n[0].webkitGetAsEntry||n[0].getAsEntry)?this._handleFileTreeEntries(e.map(n,function(e){var t;return e.webkitGetAsEntry?((t=e.webkitGetAsEntry())&&(t._file=e.getAsFile()),t):e.getAsEntry()})):e.Deferred().resolve(e.makeArray(t.files)).promise()},_getSingleFileInputFiles:function(t){var n,i,o=(t=e(t)).prop("webkitEntries")||t.prop("entries");if(o&&o.length)return this._handleFileTreeEntries(o);if((n=e.makeArray(t.prop("files"))).length)void 0===n[0].name&&n[0].fileName&&e.each(n,function(e,t){t.name=t.fileName,t.size=t.fileSize});else{if(!(i=t.prop("value")))return e.Deferred().resolve([]).promise();n=[{name:i.replace(/^.*\\/,"")}]}return e.Deferred().resolve(n).promise()},_getFileInputFiles:function(t){return t instanceof e&&1!==t.length?e.when.apply(e,e.map(t,this._getSingleFileInputFiles)).pipe(function(){return Array.prototype.concat.apply([],arguments)}):this._getSingleFileInputFiles(t)},_onChange:function(t){var n=this,i={fileInput:e(t.target),form:e(t.target.form)};this._getFileInputFiles(i.fileInput).always(function(o){i.files=o,n.options.replaceFileInput&&n._replaceFileInput(i.fileInput),!1!==n._trigger("change",e.Event("change",{delegatedEvent:t}),i)&&n._onAdd(t,i)})},_onPaste:function(t){var n=t.originalEvent&&t.originalEvent.clipboardData&&t.originalEvent.clipboardData.items,i={files:[]};n&&n.length&&(e.each(n,function(e,t){var n=t.getAsFile&&t.getAsFile();n&&i.files.push(n)}),!1!==this._trigger("paste",e.Event("paste",{delegatedEvent:t}),i)&&this._onAdd(t,i))},_onDrop:function(t){t.dataTransfer=t.originalEvent&&t.originalEvent.dataTransfer;var n=this,i=t.dataTransfer,o={};i&&i.files&&i.files.length&&(t.preventDefault(),this._getDroppedFiles(i).always(function(i){o.files=i,!1!==n._trigger("drop",e.Event("drop",{delegatedEvent:t}),o)&&n._onAdd(t,o)}))},_onDragOver:function(t){t.dataTransfer=t.originalEvent&&t.originalEvent.dataTransfer;var n=t.dataTransfer;n&&-1!==e.inArray("Files",n.types)&&!1!==this._trigger("dragover",e.Event("dragover",{delegatedEvent:t}))&&(t.preventDefault(),n.dropEffect="copy")},_initEventHandlers:function(){this._isXHRUpload(this.options)&&(this._on(this.options.dropZone,{dragover:this._onDragOver,drop:this._onDrop}),this._on(this.options.pasteZone,{paste:this._onPaste})),e.support.fileInput&&this._on(this.options.fileInput,{change:this._onChange})},_destroyEventHandlers:function(){this._off(this.options.dropZone,"dragover drop"),this._off(this.options.pasteZone,"paste"),this._off(this.options.fileInput,"change")},_setOption:function(t,n){var i=-1!==e.inArray(t,this._specialOptions);i&&this._destroyEventHandlers(),this._super(t,n),i&&(this._initSpecialOptions(),this._initEventHandlers())},_initSpecialOptions:function(){var t=this.options;void 0===t.fileInput?t.fileInput=this.element.is('input[type="file"]')?this.element:this.element.find('input[type="file"]'):t.fileInput instanceof e||(t.fileInput=e(t.fileInput)),t.dropZone instanceof e||(t.dropZone=e(t.dropZone)),t.pasteZone instanceof e||(t.pasteZone=e(t.pasteZone))},_getRegExp:function(e){var t=e.split("/"),n=t.pop();return t.shift(),new RegExp(t.join("/"),n)},_isRegExpOption:function(t,n){return"url"!==t&&"string"===e.type(n)&&/^\/.*\/[igm]{0,3}$/.test(n)},_initDataAttributes:function(){var t=this,n=this.options,i=e(this.element[0].cloneNode(!1));e.each(i.data(),function(e,o){var r="data-"+e.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase();i.attr(r)&&(t._isRegExpOption(e,o)&&(o=t._getRegExp(o)),n[e]=o)})},_create:function(){this._initDataAttributes(),this._initSpecialOptions(),this._slots=[],this._sequence=this._getXHRPromise(!0),this._sending=this._active=0,this._initProgressObject(this),this._initEventHandlers()},active:function(){return this._active},progress:function(){return this._progress},add:function(t){var n=this;t&&!this.options.disabled&&(t.fileInput&&!t.files?this._getFileInputFiles(t.fileInput).always(function(e){t.files=e,n._onAdd(null,t)}):(t.files=e.makeArray(t.files),this._onAdd(null,t)))},send:function(t){if(t&&!this.options.disabled){if(t.fileInput&&!t.files){var n,i,o=this,r=e.Deferred(),a=r.promise();return a.abort=function(){return i=!0,n?n.abort():(r.reject(null,"abort","abort"),a)},this._getFileInputFiles(t.fileInput).always(function(e){i||(e.length?(t.files=e,(n=o._onSend(null,t)).then(function(e,t,n){r.resolve(e,t,n)},function(e,t,n){r.reject(e,t,n)})):r.reject())}),this._enhancePromise(a)}if(t.files=e.makeArray(t.files),t.files.length)return this._onSend(null,t)}return this._getXHRPromise(!1,t&&t.context)}})}),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery","./jquery.fileupload"],e):e(window.jQuery)}(function(e){"use strict";var t=e.blueimp.fileupload.prototype.options.add;e.widget("blueimp.fileupload",e.blueimp.fileupload,{options:{processQueue:[],add:function(n,i){var o=e(this);i.process(function(){return o.fileupload("process",i)}),t.call(this,n,i)}},processActions:{},_processFile:function(t,n){var i=this,o=e.Deferred().resolveWith(i,[t]).promise();return this._trigger("process",null,t),e.each(t.processQueue,function(t,r){var a=function(t){return n.errorThrown?e.Deferred().rejectWith(i,[n]).promise():i.processActions[r.action].call(i,t,r)};o=o.pipe(a,r.always&&a)}),o.done(function(){i._trigger("processdone",null,t),i._trigger("processalways",null,t)}).fail(function(){i._trigger("processfail",null,t),i._trigger("processalways",null,t)}),o},_transformProcessQueue:function(t){var n=[];e.each(t.processQueue,function(){var i={},o=this.action,r=!0===this.prefix?o:this.prefix;e.each(this,function(n,o){"string"===e.type(o)&&"@"===o.charAt(0)?i[n]=t[o.slice(1)||(r?r+n.charAt(0).toUpperCase()+n.slice(1):n)]:i[n]=o}),n.push(i)}),t.processQueue=n},processing:function(){return this._processing},process:function(t){var n=this,i=e.extend({},this.options,t);return i.processQueue&&i.processQueue.length&&(this._transformProcessQueue(i),0===this._processing&&this._trigger("processstart"),e.each(t.files,function(o){var r=o?e.extend({},i):i,a=function(){return t.errorThrown?e.Deferred().rejectWith(n,[t]).promise():n._processFile(r,t)};r.index=o,n._processing+=1,n._processingQueue=n._processingQueue.pipe(a,a).always(function(){n._processing-=1,0===n._processing&&n._trigger("processstop")})})),this._processingQueue},_create:function(){this._super(),this._processing=0,this._processingQueue=e.Deferred().resolveWith(this).promise()}})}),function(e){"use strict";"function"==typeof define&&define.amd?define(["jquery","./jquery.fileupload-process"],e):e(window.jQuery)}(function(e){"use strict";e.blueimp.fileupload.prototype.options.processQueue.push({action:"validate",always:!0,acceptFileTypes:"@",maxFileSize:"@",minFileSize:"@",maxNumberOfFiles:"@",disabled:"@disableValidation"}),e.widget("blueimp.fileupload",e.blueimp.fileupload,{options:{getNumberOfFiles:e.noop,messages:{maxNumberOfFiles:"Maximum number of files exceeded",acceptFileTypes:"File type not allowed",maxFileSize:"File is too large",minFileSize:"File is too small"}},processActions:{validate:function(t,n){if(n.disabled)return t;var i,o=e.Deferred(),r=this.options,a=t.files[t.index];return(n.minFileSize||n.maxFileSize)&&(i=a.size),"number"===e.type(n.maxNumberOfFiles)&&(r.getNumberOfFiles()||0)+t.files.length>n.maxNumberOfFiles?a.error=r.i18n("maxNumberOfFiles"):!n.acceptFileTypes||n.acceptFileTypes.test(a.type)||n.acceptFileTypes.test(a.name)?i>n.maxFileSize?a.error=r.i18n("maxFileSize"):"number"===e.type(i)&&i<n.minFileSize?a.error=r.i18n("minFileSize"):delete a.error:a.error=r.i18n("acceptFileTypes"),a.error||t.files.error?(t.files.error=!0,o.rejectWith(this,[t])):o.resolveWith(this,[t]),o.promise()}}})});var cytoscape;!function(e){"use strict";var t=cytoscape=function(){return cytoscape.init.apply(cytoscape,arguments)};t.version="2.3.7",t.init=function(e){return void 0===e&&(e={}),t.is.plainObject(e)?new t.Core(e):t.is.string(e)?t.extension.apply(t.extension,arguments):void 0},t.fn={},"undefined"!=typeof module&&module.exports&&(module.exports=cytoscape),"undefined"!=typeof define&&define.amd&&define("cytoscape",function(){return cytoscape}),e&&(e.cytoscape=cytoscape)}("undefined"==typeof window?null:window),function(e,t){"use strict";e.is={defined:function(e){return null!=e},string:function(e){return null!=e&&"string"==typeof e},fn:function(e){return null!=e&&"function"==typeof e},array:function(e){return Array.isArray?Array.isArray(e):null!=e&&e instanceof Array},plainObject:function(t){return null!=t&&typeof t==typeof{}&&!e.is.array(t)&&t.constructor===Object},number:function(e){return null!=e&&"number"==typeof e&&!isNaN(e)},integer:function(t){return e.is.number(t)&&Math.floor(t)===t},color:function(e){return null!=e&&"string"==typeof e&&""!==$.Color(e).toString()},bool:function(e){return null!=e&&typeof e==typeof!0},elementOrCollection:function(t){return e.is.element(t)||e.is.collection(t)},element:function(t){return t instanceof e.Element&&t._private.single},collection:function(t){return t instanceof e.Collection&&!t._private.single},core:function(t){return t instanceof e.Core},style:function(t){return t instanceof e.Style},stylesheet:function(t){return t instanceof e.Stylesheet},event:function(t){return t instanceof e.Event},emptyString:function(t){return!t||!(!e.is.string(t)||""!==t&&!t.match(/^\s+$/))},nonemptyString:function(t){return!(!t||!e.is.string(t)||""===t||t.match(/^\s+$/))},domElement:function(e){return"undefined"!=typeof HTMLElement&&e instanceof HTMLElement},boundingBox:function(t){return e.is.plainObject(t)&&e.is.number(t.x1)&&e.is.number(t.x2)&&e.is.number(t.y1)&&e.is.number(t.y2)},touch:function(){return t&&("ontouchstart"in t||t.DocumentTouch&&document instanceof DocumentTouch)},gecko:function(){return"undefined"!=typeof InstallTrigger||"MozAppearance"in document.documentElement.style},webkit:function(){return"undefined"!=typeof webkitURL||"WebkitAppearance"in document.documentElement.style},chromium:function(){return"undefined"!=typeof chrome},khtml:function(){return navigator.vendor.match(/kde/i)},khtmlEtc:function(){return e.is.khtml()||e.is.webkit()||e.is.blink()},trident:function(){return"undefined"!=typeof ActiveXObject||!1},windows:function(){return"undefined"!=typeof navigator&&navigator.appVersion.match(/Win/i)},mac:function(){return"undefined"!=typeof navigator&&navigator.appVersion.match(/Mac/i)},linux:function(){return"undefined"!=typeof navigator&&navigator.appVersion.match(/Linux/i)},unix:function(){return"undefined"!=typeof navigator&&navigator.appVersion.match(/X11/i)}}}(cytoscape,"undefined"==typeof window?null:window),function(e,t){"use strict";e.util={extend:function(){var t,n,i,o,r,a,s=arguments[0]||{},l=1,c=arguments.length,d=!1;for("boolean"==typeof s&&(d=s,s=arguments[1]||{},l=2),"object"==typeof s||e.is.fn(s)||(s={}),c===l&&(s=this,--l);l<c;l++)if(null!=(t=arguments[l]))for(n in t)i=s[n],s!==(o=t[n])&&(d&&o&&(e.is.plainObject(o)||(r=e.is.array(o)))?(r?(r=!1,a=i&&e.is.array(i)?i:[]):a=i&&e.is.plainObject(i)?i:{},s[n]=e.util.extend(d,a,o)):void 0!==o&&(s[n]=o));return s},require:function(n,i,o){var r;o=e.util.extend({msgIfNotFound:!0},o);var a=!1,s=function(e){a=!0,i(e)},l=function(e){"undefined"!=typeof module&&module.exports&&require&&(r=require(n)),void 0!==r&&s(r),e&&e()},c=function(){a||d(u)},d=function(e){"undefined"!=typeof define&&define.amd&&require&&require([n],function(t){void 0!==(r=t)&&s(r),e&&e()})},u=function(){!a&&o.msgIfNotFound&&e.util.error("Cytoscape.js tried to pull in dependency `"+n+"` but no module (i.e. CommonJS, AMD, or window) was found")};!function(e){t&&(r=t[n]),void 0!==r&&s(r),e&&e()}(function(){a||l(c)})},requires:function(t,n){for(var i=[],o=[],r=function(){for(var e=0;e<t.length;e++)if(!o[e])return;n.apply(n,i)},a=0;a<t.length;a++)!function(){var n=t[a],s=a;e.util.require(n,function(e){i[s]=e,o[s]=!0,r()})}()},throttle:function(t,n,i){var o=!0,r=!0;return!1===i?o=!1:e.is.plainObject(i)&&(o="leading"in i?i.leading:o,r="trailing"in i?i.trailing:r),i=i||{},i.leading=o,i.maxWait=n,i.trailing=r,e.util.debounce(t,n,i)},now:function(){return+new Date},debounce:function(t,n,i){var o,r,a,s,l,c,d,u=0,h=!1,p=!0;if(e.is.fn(t)){if(n=Math.max(0,n)||0,!0===i){var f=!0;p=!1}else e.is.plainObject(i)&&(f=i.leading,h="maxWait"in i&&(Math.max(n,i.maxWait)||0),p="trailing"in i?i.trailing:p);var g=function(){var i=n-(e.util.now()-s);if(i<=0){r&&clearTimeout(r);var h=d;r=c=d=void 0,h&&(u=e.util.now(),a=t.apply(l,o),c||r||(o=l=null))}else c=setTimeout(g,i)},v=function(){c&&clearTimeout(c),r=c=d=void 0,(p||h!==n)&&(u=e.util.now(),a=t.apply(l,o),c||r||(o=l=null))};return function(){if(o=arguments,s=e.util.now(),l=this,d=p&&(c||!f),!1===h)var i=f&&!c;else{r||f||(u=s);var m=h-(s-u),y=m<=0;y?(r&&(r=clearTimeout(r)),u=s,a=t.apply(l,o)):r||(r=setTimeout(v,m))}return y&&c?c=clearTimeout(c):c||n===h||(c=setTimeout(g,n)),i&&(y=!0,a=t.apply(l,o)),!y||c||r||(o=l=null),a}}},error:function(e){if(!console)throw e;if(console.error)console.error.apply(console,arguments);else{if(!console.log)throw e;console.log.apply(console,arguments)}},clone:function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t},copy:function(t){return null==t?t:e.is.array(t)?t.slice():e.is.plainObject(t)?e.util.clone(t):t},makeBoundingBox:function(e){if(null!=e.x1&&null!=e.y1){if(null!=e.x2&&null!=e.y2&&e.x2>=e.x1&&e.y2>=e.y1)return{x1:e.x1,y1:e.y1,x2:e.x2,y2:e.y2,w:e.x2-e.x1,h:e.y2-e.y1};if(null!=e.w&&null!=e.h&&e.w>=0&&e.h>=0)return{x1:e.x1,y1:e.y1,x2:e.x1+e.w,y2:e.y1+e.h,w:e.w,h:e.h}}},mapEmpty:function(e){var t=!0;if(null!=e)for(var n in e){t=!1;break}return t},pushMap:function(t){var n=e.util.getMap(t);null==n?e.util.setMap($.extend({},t,{value:[t.value]})):n.push(t.value)},setMap:function(t){for(var n=t.map,i=t.keys,o=i.length,r=0;r<o;r++){var a=i[r];e.is.plainObject(a)&&e.util.error("Tried to set map with object key"),r<i.length-1?(null==n[a]&&(n[a]={}),n=n[a]):n[a]=t.value}},getMap:function(t){for(var n=t.map,i=t.keys,o=i.length,r=0;r<o;r++){var a=i[r];if(e.is.plainObject(a)&&e.util.error("Tried to get map with object key"),null==(n=n[a]))return n}return n},deleteMap:function(t){for(var n=t.map,i=t.keys,o=i.length,r=t.keepChildren,a=0;a<o;a++){var s=i[a];if(e.is.plainObject(s)&&e.util.error("Tried to delete map with object key"),a===t.keys.length-1)if(r)for(var l in n)r[l]||(n[l]=void 0);else n[s]=void 0;else n=n[s]}},capitalize:function(t){return e.is.emptyString(t)?t:t.charAt(0).toUpperCase()+t.substring(1)},camel2dash:function(e){for(var t=[],n=0;n<e.length;n++){var i=e[n],o=i.toLowerCase();i!==o?(t.push("-"),t.push(o)):t.push(i)}return t.length===e.length?e:t.join("")},dash2camel:function(e){for(var t=[],n=!1,i=0;i<e.length;i++){var o=e[i];"-"===o?n=!0:(n?t.push(o.toUpperCase()):t.push(o),n=!1)}return t.join("")},trim:function(e){var t,n;for(t=0;t<e.length&&" "===e[t];t++);for(n=e.length-1;n>t&&" "===e[n];n--);return e.substring(t,n+1)},hex2tuple:function(e){if((4===e.length||7===e.length)&&"#"===e[0]){var t,n,i;return 4===e.length?(t=parseInt(e[1]+e[1],16),n=parseInt(e[2]+e[2],16),i=parseInt(e[3]+e[3],16)):(t=parseInt(e[1]+e[2],16),n=parseInt(e[3]+e[4],16),i=parseInt(e[5]+e[6],16)),[t,n,i]}},hsl2tuple:function(t){function n(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+6*(t-e)*n:n<.5?t:n<2/3?e+(t-e)*(2/3-n)*6:e}var i,o,r,a,s,l,c,d,u=new RegExp("^"+e.util.regex.hsla+"$").exec(t);if(u){if((o=parseInt(u[1]))<0?o=(360- -1*o%360)%360:o>360&&(o%=360),o/=360,(r=parseFloat(u[2]))<0||r>100)return;if(r/=100,(a=parseFloat(u[3]))<0||a>100)return;if(a/=100,void 0!==(s=u[4])&&((s=parseFloat(s))<0||s>1))return;if(0===r)l=c=d=Math.round(255*a);else{var h=a<.5?a*(1+r):a+r-a*r,p=2*a-h;l=Math.round(255*n(p,h,o+1/3)),c=Math.round(255*n(p,h,o)),d=Math.round(255*n(p,h,o-1/3))}i=[l,c,d,s]}return i},rgb2tuple:function(t){var n,i=new RegExp("^"+e.util.regex.rgba+"$").exec(t);if(i){n=[];for(var o=[],r=1;r<=3;r++){var a=i[r];if("%"===a[a.length-1]&&(o[r]=!0),a=parseFloat(a),o[r]&&(a=a/100*255),a<0||a>255)return;n.push(Math.floor(a))}var s=o[1]||o[2]||o[3],l=o[1]&&o[2]&&o[3];if(s&&!l)return;var c=i[4];if(void 0!==c){if((c=parseFloat(c))<0||c>1)return;n.push(c)}}return n},colorname2tuple:function(t){return e.util.colors[t.toLowerCase()]},color2tuple:function(t){return(e.is.array(t)?t:null)||e.util.colorname2tuple(t)||e.util.hex2tuple(t)||e.util.rgb2tuple(t)||e.util.hsl2tuple(t)},tuple2hex:function(e){function t(e){var t=e.toString(16);return 1===t.length&&(t="0"+t),t}var n=e[0],i=e[1],o=e[2];return"#"+t(n)+t(i)+t(o)},colors:{transparent:[0,0,0,0],aliceblue:[240,248,255],antiquewhite:[250,235,215],aqua:[0,255,255],aquamarine:[127,255,212],azure:[240,255,255],beige:[245,245,220],bisque:[255,228,196],black:[0,0,0],blanchedalmond:[255,235,205],blue:[0,0,255],blueviolet:[138,43,226],brown:[165,42,42],burlywood:[222,184,135],cadetblue:[95,158,160],chartreuse:[127,255,0],chocolate:[210,105,30],coral:[255,127,80],cornflowerblue:[100,149,237],cornsilk:[255,248,220],crimson:[220,20,60],cyan:[0,255,255],darkblue:[0,0,139],darkcyan:[0,139,139],darkgoldenrod:[184,134,11],darkgray:[169,169,169],darkgreen:[0,100,0],darkgrey:[169,169,169],darkkhaki:[189,183,107],darkmagenta:[139,0,139],darkolivegreen:[85,107,47],darkorange:[255,140,0],darkorchid:[153,50,204],darkred:[139,0,0],darksalmon:[233,150,122],darkseagreen:[143,188,143],darkslateblue:[72,61,139],darkslategray:[47,79,79],darkslategrey:[47,79,79],darkturquoise:[0,206,209],darkviolet:[148,0,211],deeppink:[255,20,147],deepskyblue:[0,191,255],dimgray:[105,105,105],dimgrey:[105,105,105],dodgerblue:[30,144,255],firebrick:[178,34,34],floralwhite:[255,250,240],forestgreen:[34,139,34],fuchsia:[255,0,255],gainsboro:[220,220,220],ghostwhite:[248,248,255],gold:[255,215,0],goldenrod:[218,165,32],gray:[128,128,128],grey:[128,128,128],green:[0,128,0],greenyellow:[173,255,47],honeydew:[240,255,240],hotpink:[255,105,180],indianred:[205,92,92],indigo:[75,0,130],ivory:[255,255,240],khaki:[240,230,140],lavender:[230,230,250],lavenderblush:[255,240,245],lawngreen:[124,252,0],lemonchiffon:[255,250,205],lightblue:[173,216,230],lightcoral:[240,128,128],lightcyan:[224,255,255],lightgoldenrodyellow:[250,250,210],lightgray:[211,211,211],lightgreen:[144,238,144],lightgrey:[211,211,211],lightpink:[255,182,193],lightsalmon:[255,160,122],lightseagreen:[32,178,170],lightskyblue:[135,206,250],lightslategray:[119,136,153],lightslategrey:[119,136,153],lightsteelblue:[176,196,222],lightyellow:[255,255,224],lime:[0,255,0],limegreen:[50,205,50],linen:[250,240,230],magenta:[255,0,255],maroon:[128,0,0],mediumaquamarine:[102,205,170],mediumblue:[0,0,205],mediumorchid:[186,85,211],mediumpurple:[147,112,219],mediumseagreen:[60,179,113],mediumslateblue:[123,104,238],mediumspringgreen:[0,250,154],mediumturquoise:[72,209,204],mediumvioletred:[199,21,133],midnightblue:[25,25,112],mintcream:[245,255,250],mistyrose:[255,228,225],moccasin:[255,228,181],navajowhite:[255,222,173],navy:[0,0,128],oldlace:[253,245,230],olive:[128,128,0],olivedrab:[107,142,35],orange:[255,165,0],orangered:[255,69,0],orchid:[218,112,214],palegoldenrod:[238,232,170],palegreen:[152,251,152],paleturquoise:[175,238,238],palevioletred:[219,112,147],papayawhip:[255,239,213],peachpuff:[255,218,185],peru:[205,133,63],pink:[255,192,203],plum:[221,160,221],powderblue:[176,224,230],purple:[128,0,128],red:[255,0,0],rosybrown:[188,143,143],royalblue:[65,105,225],saddlebrown:[139,69,19],salmon:[250,128,114],sandybrown:[244,164,96],seagreen:[46,139,87],seashell:[255,245,238],sienna:[160,82,45],silver:[192,192,192],skyblue:[135,206,235],slateblue:[106,90,205],slategray:[112,128,144],slategrey:[112,128,144],snow:[255,250,250],springgreen:[0,255,127],steelblue:[70,130,180],tan:[210,180,140],teal:[0,128,128],thistle:[216,191,216],tomato:[255,99,71],turquoise:[64,224,208],violet:[238,130,238],wheat:[245,222,179],white:[255,255,255],whitesmoke:[245,245,245],yellow:[255,255,0],yellowgreen:[154,205,50]}},e.util.regex={},e.util.regex.number="(?:[-]?\\d*\\.\\d+|[-]?\\d+|[-]?\\d*\\.\\d+[eE]\\d+)",e.util.regex.rgba="rgb[a]?\\(("+e.util.regex.number+"[%]?)\\s*,\\s*("+e.util.regex.number+"[%]?)\\s*,\\s*("+e.util.regex.number+"[%]?)(?:\\s*,\\s*("+e.util.regex.number+"))?\\)",e.util.regex.rgbaNoBackRefs="rgb[a]?\\((?:"+e.util.regex.number+"[%]?)\\s*,\\s*(?:"+e.util.regex.number+"[%]?)\\s*,\\s*(?:"+e.util.regex.number+"[%]?)(?:\\s*,\\s*(?:"+e.util.regex.number+"))?\\)",e.util.regex.hsla="hsl[a]?\\(("+e.util.regex.number+")\\s*,\\s*("+e.util.regex.number+"[%])\\s*,\\s*("+e.util.regex.number+"[%])(?:\\s*,\\s*("+e.util.regex.number+"))?\\)",e.util.regex.hslaNoBackRefs="hsl[a]?\\((?:"+e.util.regex.number+")\\s*,\\s*(?:"+e.util.regex.number+"[%])\\s*,\\s*(?:"+e.util.regex.number+"[%])(?:\\s*,\\s*(?:"+e.util.regex.number+"))?\\)",e.util.regex.hex3="\\#[0-9a-fA-F]{3}",e.util.regex.hex6="\\#[0-9a-fA-F]{6}";var n=t?t.requestAnimationFrame||t.mozRequestAnimationFrame||t.webkitRequestAnimationFrame||t.msRequestAnimationFrame:null;n=n||function(e){e&&setTimeout(e,1e3/60)},e.util.requestAnimationFrame=function(e){n(e)}}(cytoscape,"undefined"==typeof window?null:window),function(e){"use strict";e.math={},e.math.signum=function(e){return e>0?1:e<0?-1:0},e.math.distance=function(e,t){var n=t.x-e.x,i=t.y-e.y;return Math.sqrt(n*n+i*i)},e.math.qbezierAt=function(e,t,n,i){return(1-i)*(1-i)*e+2*(1-i)*i*t+i*i*n},e.math.qbezierPtAt=function(t,n,i,o){return{x:e.math.qbezierAt(t.x,n.x,i.x,o),y:e.math.qbezierAt(t.y,n.y,i.y,o)}},e.math.boundingBoxesIntersect=function(e,t){return!(e.x1>t.x2)&&(!(t.x1>e.x2)&&(!(e.x2<t.x1)&&(!(t.x2<e.x1)&&(!(e.y2<t.y1)&&(!(t.y2<e.y1)&&(!(e.y1>t.y2)&&!(t.y1>e.y2)))))))},e.math.inBoundingBox=function(e,t,n){return e.x1<=t&&t<=e.x2&&e.y1<=n&&n<=e.y2},e.math.pointInBoundingBox=function(e,t){return this.inBoundingBox(e,t.x,t.y)},e.math.roundRectangleIntersectLine=function(e,t,n,i,o,r,a){var s,l=this.getRoundRectangleRadius(o,r),c=o/2,d=r/2,u=n-c+l-a,h=i-d-a,p=n+c-l+a,f=h;if((s=this.finiteLinesIntersect(e,t,n,i,u,h,p,f,!1)).length>0)return s;var g=n+c+a,v=i-d+l-a,m=g,y=i+d-l+a;if((s=this.finiteLinesIntersect(e,t,n,i,g,v,m,y,!1)).length>0)return s;var w=n-c+l-a,b=i+d+a,C=n+c-l+a,x=b;if((s=this.finiteLinesIntersect(e,t,n,i,w,b,C,x,!1)).length>0)return s;var E=n-c-a,_=i-d+l-a,S=E,k=i+d-l+a;if((s=this.finiteLinesIntersect(e,t,n,i,E,_,S,k,!1)).length>0)return s;var T,D=n-c+l,R=i-d+l;if((T=this.intersectLineCircle(e,t,n,i,D,R,l+a)).length>0&&T[0]<=D&&T[1]<=R)return[T[0],T[1]];var P=n+c-l,A=i-d+l;if((T=this.intersectLineCircle(e,t,n,i,P,A,l+a)).length>0&&T[0]>=P&&T[1]<=A)return[T[0],T[1]];var N=n+c-l,M=i+d-l;if((T=this.intersectLineCircle(e,t,n,i,N,M,l+a)).length>0&&T[0]>=N&&T[1]>=M)return[T[0],T[1]];var O=n-c+l,I=i+d-l;return(T=this.intersectLineCircle(e,t,n,i,O,I,l+a)).length>0&&T[0]<=O&&T[1]>=I?[T[0],T[1]]:[]},e.math.roundRectangleIntersectBox=function(e,t,n,i,o,r,a,s,l){var c=this.getRoundRectangleRadius(o,r),d=a-o/2-l,u=s-r/2+c-l,h=a+o/2+l,p=s+r/2-c+l,f=a-o/2+c-l,g=s-r/2-l,v=a+o/2-c+l,m=s+r/2+l,y=Math.min(e,n),w=Math.max(e,n),b=Math.min(t,i),C=Math.max(t,i);return!(w<d)&&(!(y>h)&&(!(C<g)&&(!(b>m)&&(d>=y&&d<=w&&u>=b&&u<=C||(h>=y&&h<=w&&u>=b&&u<=C||(h>=y&&h<=w&&p>=b&&p<=C||(d>=y&&d<=w&&p>=b&&p<=C||(y>=d&&y<=h&&b>=u&&b<=p||(w>=d&&w<=h&&b>=u&&b<=p||(w>=d&&w<=h&&C>=u&&C<=p||(y>=d&&y<=h&&C>=u&&C<=p||(f>=y&&f<=w&&g>=b&&g<=C||(v>=y&&v<=w&&g>=b&&g<=C||(v>=y&&v<=w&&m>=b&&m<=C||(f>=y&&f<=w&&m>=b&&m<=C||(y>=f&&y<=v&&b>=g&&b<=m||(w>=f&&w<=v&&b>=g&&b<=m||(w>=f&&w<=v&&C>=g&&C<=m||(y>=f&&y<=v&&C>=g&&C<=m||(!!this.boxIntersectEllipse(y,b,w,C,l,2*c,2*c,f+l,u+l)||(!!this.boxIntersectEllipse(y,b,w,C,l,2*c,2*c,v-l,u+l)||(!!this.boxIntersectEllipse(y,b,w,C,l,2*c,2*c,v-l,p-l)||!!this.boxIntersectEllipse(y,b,w,C,l,2*c,2*c,f+l,p-l)))))))))))))))))))))))},e.math.checkInBoundingCircle=function(e,t,n,i,o,r,a,s){return e=(e-a)/(o+i),t=(t-s)/(r+i),e*e+t*t<=n},e.math.boxInBezierVicinity=function(e,t,n,i,o,r,a,s,l,c,d){var u=.25*o+.5*a+.25*l,h=.25*r+.5*s+.25*c,p=Math.min(e,n)-d,f=Math.min(t,i)-d,g=Math.max(e,n)+d,v=Math.max(t,i)+d;if(o>=p&&o<=g&&r>=f&&r<=v)return 1;if(l>=p&&l<=g&&c>=f&&c<=v)return 1;if(u>=p&&u<=g&&h>=f&&h<=v)return 1;if(a>=p&&a<=g&&s>=f&&s<=v)return 1;var m=Math.min(o,u,l),y=Math.min(r,h,c),w=Math.max(o,u,l),b=Math.max(r,h,c);return m>g||w<p||y>v||b<f?0:1},e.math.checkBezierInBox=function(t,n,i,o,r,a,s,l,c,d,u){for(var h=0;h<=1;h+=.25)if(!function(u){var h=e.math.qbezierAt(r,s,c,u),p=e.math.qbezierAt(a,l,d,u);return t<=h&&h<=i&&n<=p&&p<=o}(h))return!1;return!0},e.math.checkStraightEdgeInBox=function(e,t,n,i,o,r,a,s,l){return e<=o&&o<=n&&e<=a&&a<=n&&t<=r&&r<=i&&t<=s&&s<=i},e.math.checkStraightEdgeCrossesBox=function(e,t,n,i,o,r,a,s,l){var c,d,u=Math.min(e,n)-l,h=Math.min(t,i)-l,p=Math.max(e,n)+l,f=Math.max(t,i)+l,g=a-o,v=o,m=s-r,y=r;if(Math.abs(g)<1e-4)return o>=u&&o<=p&&Math.min(r,s)<=h&&Math.max(r,s)>=f;var w=(u-v)/g;if(w>0&&w<=1&&(c=m*w+y)>=h&&c<=f)return!0;var b=(p-v)/g;if(b>0&&b<=1&&(c=m*b+y)>=h&&c<=f)return!0;var C=(h-y)/m;if(C>0&&C<=1&&(d=g*C+v)>=u&&d<=p)return!0;var x=(f-y)/m;return x>0&&x<=1&&(d=g*x+v)>=u&&d<=p},e.math.checkBezierCrossesBox=function(e,t,n,i,o,r,a,s,l,c,d){var u=Math.min(e,n)-d,h=Math.min(t,i)-d,p=Math.max(e,n)+d,f=Math.max(t,i)+d;if(o>=u&&o<=p&&r>=h&&r<=f)return!0;if(l>=u&&l<=p&&c>=h&&c<=f)return!0;var g=o-2*a+l,v=-2*o+2*a,m=o,y=[];if(Math.abs(g)<1e-4){var w=(u-o)/v,b=(p-o)/v;y.push(w,b)}else{var C,x,E=v*v-4*g*(m-u);E>0&&(C=(-v+(F=Math.sqrt(E)))/(2*g),x=(-v-F)/(2*g),y.push(C,x));var _,S,k=v*v-4*g*(m-p);k>0&&(_=(-v+(F=Math.sqrt(k)))/(2*g),S=(-v-F)/(2*g),y.push(_,S))}y.sort(function(e,t){return e-t});var T=r-2*s+c,D=-2*r+2*s,R=r,P=[];if(Math.abs(T)<1e-4){var A=(h-r)/D,N=(f-r)/D;P.push(A,N)}else{var M,O,I=D*D-4*T*(R-h);I>0&&(M=(-D+(F=Math.sqrt(I)))/(2*T),O=(-D-F)/(2*T),P.push(M,O));var L,H,B=D*D-4*T*(R-f);if(B>0){var F=Math.sqrt(B);L=(-D+F)/(2*T),H=(-D-F)/(2*T),P.push(L,H)}}P.sort(function(e,t){return e-t});for(var z=0;z<y.length;z+=2)for(var V=1;V<P.length;V+=2)if(y[z]<P[V]&&P[V]>=0&&y[z]<=1&&y[z+1]>P[V-1]&&P[V-1]<=1&&y[z+1]>=0)return!0;return!1},e.math.inLineVicinity=function(e,t,n,i,o,r,a){var s=a,l=Math.min(n,o),c=Math.max(n,o),d=Math.min(i,r),u=Math.max(i,r);return l-s<=e&&e<=c+s&&d-s<=t&&t<=u+s},e.math.inBezierVicinity=function(e,t,n,i,o,r,a,s,l){var c={x1:Math.min(n,a,o),x2:Math.max(n,a,o),y1:Math.min(i,s,r),y2:Math.max(i,s,r)};return!(e<c.x1||e>c.x2||t<c.y1||t>c.y2)},e.math.solveCubic=function(e,t,n,i,o){var r,a,s,l,c,d,u,h;return a=(3*(n/=e)-(t/=e)*t)/9,s=-27*(i/=e)+t*(9*n-t*t*2),s/=54,r=a*a*a+s*s,o[1]=0,u=t/3,r>0?(c=s+Math.sqrt(r),c=c<0?-Math.pow(-c,1/3):Math.pow(c,1/3),d=s-Math.sqrt(r),d=d<0?-Math.pow(-d,1/3):Math.pow(d,1/3),o[0]=-u+c+d,u+=(c+d)/2,o[4]=o[2]=-u,u=Math.sqrt(3)*(-d+c)/2,o[3]=u,void(o[5]=-u)):(o[5]=o[3]=0,0===r?(h=s<0?-Math.pow(-s,1/3):Math.pow(s,1/3),o[0]=2*h-u,void(o[4]=o[2]=-(h+u))):(l=(a=-a)*a*a,l=Math.acos(s/Math.sqrt(l)),h=2*Math.sqrt(a),o[0]=-u+h*Math.cos(l/3),o[2]=-u+h*Math.cos((l+2*Math.PI)/3),void(o[4]=-u+h*Math.cos((l+4*Math.PI)/3))))},e.math.sqDistanceToQuadraticBezier=function(e,t,n,i,o,r,a,s){var l=1*n*n-4*n*o+2*n*a+4*o*o-4*o*a+a*a+i*i-4*i*r+2*i*s+4*r*r-4*r*s+s*s,c=9*n*o-3*n*n-3*n*a-6*o*o+3*o*a+9*i*r-3*i*i-3*i*s-6*r*r+3*r*s,d=3*n*n-6*n*o+n*a-n*e+2*o*o+2*o*e-a*e+3*i*i-6*i*r+i*s-i*t+2*r*r+2*r*t-s*t,u=1*n*o-n*n+n*e-o*e+i*r-i*i+i*t-r*t,h=[];this.solveCubic(l,c,d,u,h);for(var p=[],f=0;f<6;f+=2)Math.abs(h[f+1])<1e-7&&h[f]>=0&&h[f]<=1&&p.push(h[f]);p.push(1),p.push(0);for(var g,v,m,y=-1,w=0;w<p.length;w++)g=Math.pow(1-p[w],2)*n+2*(1-p[w])*p[w]*o+p[w]*p[w]*a,v=Math.pow(1-p[w],2)*i+2*(1-p[w])*p[w]*r+p[w]*p[w]*s,m=Math.pow(g-e,2)+Math.pow(v-t,2),y>=0?m<y&&(y=m,p[w]):(y=m,p[w]);return y},e.math.sqDistanceToFiniteLine=function(e,t,n,i,o,r){var a=[e-n,t-i],s=[o-n,r-i],l=s[0]*s[0]+s[1]*s[1],c=a[0]*a[0]+a[1]*a[1],d=a[0]*s[0]+a[1]*s[1],u=d*d/l;return d<0?c:u>l?(e-o)*(e-o)+(t-r)*(t-r):c-u},e.math.pointInsidePolygon=function(e,t,n,i,o,r,a,s,l){var c=new Array(n.length),d=Math.asin(s[1]/Math.sqrt(s[0]*s[0]+s[1]*s[1]));s[0]<0?d+=Math.PI/2:d=-d-Math.PI/2;for(var u=Math.cos(-d),h=Math.sin(-d),p=0;p<c.length/2;p++)c[2*p]=r/2*(n[2*p]*u-n[2*p+1]*h),c[2*p+1]=a/2*(n[2*p+1]*u+n[2*p]*h),c[2*p]+=i,c[2*p+1]+=o;var f;if(l>0){var g=this.expandPolygon(c,-l);f=this.joinLines(g)}else f=c;for(var v,m,y,w,b,C=0,p=0;p<f.length/2;p++)if(v=f[2*p],m=f[2*p+1],p+1<f.length/2?(y=f[2*(p+1)],w=f[2*(p+1)+1]):(y=f[2*(p+1-f.length/2)],w=f[2*(p+1-f.length/2)+1]),v==e&&y==e);else{if(!(v>=e&&e>=y||v<=e&&e<=y))continue;(b=(e-v)/(y-v)*(w-m)+m)>t&&C++,b<t&&0}return C%2!=0},e.math.joinLines=function(e){for(var t,n,i,o,r,a,s,l,c=new Array(e.length/2),d=0;d<e.length/4;d++){t=e[4*d],n=e[4*d+1],i=e[4*d+2],o=e[4*d+3],d<e.length/4-1?(r=e[4*(d+1)],a=e[4*(d+1)+1],s=e[4*(d+1)+2],l=e[4*(d+1)+3]):(r=e[0],a=e[1],s=e[2],l=e[3]);var u=this.finiteLinesIntersect(t,n,i,o,r,a,s,l,!0);c[2*d]=u[0],c[2*d+1]=u[1]}return c},e.math.expandPolygon=function(e,t){for(var n,i,o,r,a=new Array(2*e.length),s=0;s<e.length/2;s++){n=e[2*s],i=e[2*s+1],s<e.length/2-1?(o=e[2*(s+1)],r=e[2*(s+1)+1]):(o=e[0],r=e[1]);var l=r-i,c=-(o-n),d=Math.sqrt(l*l+c*c),u=l/d,h=c/d;a[4*s]=n+u*t,a[4*s+1]=i+h*t,a[4*s+2]=o+u*t,a[4*s+3]=r+h*t}return a},e.math.intersectLineEllipse=function(e,t,n,i,o,r){var a=n-e,s=i-t;a/=o,s/=r;var l=Math.sqrt(a*a+s*s),c=l-1;if(c<0)return[];var d=c/l;return[(n-e)*d+e,(i-t)*d+t]},e.math.dotProduct=function(e,t){if(2!=e.length||2!=t.length)throw"dot product: arguments are not vectors";return e[0]*t[0]+e[1]*t[1]},e.math.intersectLineCircle=function(e,t,n,i,o,r,a){var s=[n-e,i-t],l=[e-o,t-r],c=s[0]*s[0]+s[1]*s[1],d=2*(l[0]*s[0]+l[1]*s[1]),u=d*d-4*c*(l[0]*l[0]+l[1]*l[1]-a*a);if(u<0)return[];var h=(-d+Math.sqrt(u))/(2*c),p=(-d-Math.sqrt(u))/(2*c),f=Math.min(h,p),g=Math.max(h,p),v=[];if(f>=0&&f<=1&&v.push(f),g>=0&&g<=1&&v.push(g),0===v.length)return[];var m=v[0]*s[0]+e,y=v[0]*s[1]+t;return v.length>1?v[0]==v[1]?[m,y]:[m,y,v[1]*s[0]+e,v[1]*s[1]+t]:[m,y]},e.math.findCircleNearPoint=function(e,t,n,i,o){var r=i-e,a=o-t,s=Math.sqrt(r*r+a*a);return[e+r/s*n,t+a/s*n]},e.math.findMaxSqDistanceToOrigin=function(e){for(var t,n=1e-6,i=0;i<e.length/2;i++)(t=e[2*i]*e[2*i]+e[2*i+1]*e[2*i+1])>n&&(n=t);return n},e.math.finiteLinesIntersect=function(e,t,n,i,o,r,a,s,l){var c=(a-o)*(t-r)-(s-r)*(e-o),d=(n-e)*(t-r)-(i-t)*(e-o),u=(s-r)*(n-e)-(a-o)*(i-t);if(0!==u){var h=c/u,p=d/u;return 0<=h&&h<=1&&0<=p&&p<=1?[e+h*(n-e),t+h*(i-t)]:l?[e+h*(n-e),t+h*(i-t)]:[]}return 0===c||0===d?[e,n,a].sort()[1]===a?[a,s]:[e,n,o].sort()[1]===o?[o,r]:[o,a,n].sort()[1]===n?[n,i]:[]:[]},e.math.boxIntersectEllipse=function(e,t,n,i,o,r,a,s,l){if(n<e){var c=e;e=n,n=c}if(i<t){var d=t;t=i,i=d}var u=[s-r/2-o,l],h=[s+r/2+o,l],p=[s,l-a/2-o],f=[s,l+a/2+o];return!(n<u[0])&&(!(e>h[0])&&(!(t>f[1])&&(!(i<p[1])&&(e<=h[0]&&h[0]<=n&&t<=h[1]&&h[1]<=i||(e<=u[0]&&u[0]<=n&&t<=u[1]&&u[1]<=i||(e<=p[0]&&p[0]<=n&&t<=p[1]&&p[1]<=i||(e<=f[0]&&f[0]<=n&&t<=f[1]&&f[1]<=i||(e=(e-s)/(r/2+o),n=(n-s)/(r/2+o),t=(t-l)/(a/2+o),i=(i-l)/(a/2+o),e*e+t*t<=1||(n*n+t*t<=1||(n*n+i*i<=1||e*e+i*i<=1))))))))))},e.math.boxIntersectPolygon=function(t,n,i,o,r,a,s,l,c,d,u){if(i<t){var h=t;t=i,i=h}if(o<n){var p=n;n=o,o=p}var f=new Array(r.length),g=Math.asin(d[1]/Math.sqrt(d[0]*d[0]+d[1]*d[1]));d[0]<0?g+=Math.PI/2:g=-g-Math.PI/2;for(var v=Math.cos(-g),m=Math.sin(-g),y=0;y<f.length/2;y++)f[2*y]=a/2*(r[2*y]*v-r[2*y+1]*m),f[2*y+1]=s/2*(r[2*y+1]*v+r[2*y]*m),f[2*y]+=l,f[2*y+1]+=c;for(var w=f[0],b=f[0],C=f[1],x=f[1],y=1;y<f.length/2;y++)f[2*y]>b&&(b=f[2*y]),f[2*y]<w&&(w=f[2*y]),f[2*y+1]>x&&(x=f[2*y+1]),f[2*y+1]<C&&(C=f[2*y+1]);if(i<w-u)return!1;if(t>b+u)return!1;if(o<C-u)return!1;if(n>x+u)return!1;var E;if(u>0){var _=e.math.expandPolygon(f,-u);E=e.math.joinLines(_)}else E=f;for(y=0;y<f.length/2;y++)if(t<=f[2*y]&&f[2*y]<=i&&n<=f[2*y+1]&&f[2*y+1]<=o)return!0;for(y=0;y<E.length/2;y++){var S,k,T=E[2*y],D=E[2*y+1];if(y<E.length/2-1?(S=E[2*(y+1)],k=E[2*(y+1)+1]):(S=E[0],k=E[1]),e.math.finiteLinesIntersect(T,D,S,k,t,n,i,n,!1).length>0)return!0;if(e.math.finiteLinesIntersect(T,D,S,k,t,o,i,o,!1).length>0)return!0;if(e.math.finiteLinesIntersect(T,D,S,k,t,n,t,o,!1).length>0)return!0;if(e.math.finiteLinesIntersect(T,D,S,k,i,n,i,o,!1).length>0)return!0}return!1},e.math.polygonIntersectLine=function(t,n,i,o,r,a,s,l){for(var c,d=[],u=new Array(i.length),h=0;h<u.length/2;h++)u[2*h]=i[2*h]*a+o,u[2*h+1]=i[2*h+1]*s+r;var p;if(l>0){var f=e.math.expandPolygon(u,-l);p=e.math.joinLines(f)}else p=u;for(var g,v,m,y,h=0;h<p.length/2;h++)g=p[2*h],v=p[2*h+1],h<p.length/2-1?(m=p[2*(h+1)],y=p[2*(h+1)+1]):(m=p[0],y=p[1]),0!==(c=this.finiteLinesIntersect(t,n,o,r,g,v,m,y)).length&&d.push(c[0],c[1]);return d},e.math.shortenIntersection=function(e,t,n){var i=[e[0]-t[0],e[1]-t[1]],o=Math.sqrt(i[0]*i[0]+i[1]*i[1]),r=(o-n)/o;return r<0&&(r=1e-5),[t[0]+r*i[0],t[1]+r*i[1]]},e.math.generateUnitNgonPointsFitToSquare=function(t,n){var i=e.math.generateUnitNgonPoints(t,n);return i=e.math.fitPolygonToSquare(i)},e.math.fitPolygonToSquare=function(e){for(var t,n,i=e.length/2,o=1/0,r=1/0,a=-1/0,s=-1/0,l=0;l<i;l++)t=e[2*l],n=e[2*l+1],o=Math.min(o,t),a=Math.max(a,t),r=Math.min(r,n),s=Math.max(s,n);for(var c=2/(a-o),d=2/(s-r),l=0;l<i;l++)t=e[2*l]=e[2*l]*c,n=e[2*l+1]=e[2*l+1]*d,o=Math.min(o,t),a=Math.max(a,t),r=Math.min(r,n),s=Math.max(s,n);if(r<-1)for(l=0;l<i;l++)n=e[2*l+1]=e[2*l+1]+(-1-r);return e},e.math.generateUnitNgonPoints=function(e,t){var n=1/e*2*Math.PI,i=e%2==0?Math.PI/2+n/2:Math.PI/2;i+=t;for(var o,r=new Array(2*e),a=0;a<e;a++)o=a*n+i,r[2*a]=Math.cos(o),r[2*a+1]=Math.sin(-o);return r},e.math.getRoundRectangleRadius=function(e,t){return Math.min(e/4,t/4,8)}}(cytoscape),function(e){"use strict";function t(t,n,i){var o={};switch(o[n]=i,t){case"core":case"collection":e.fn[t](o)}if("layout"===t){for(var a=i.prototype,s=["stop"],l=0;l<s.length;l++){var c=s[l];a[c]=a[c]||function(){return this}}a.start&&!a.run?a.run=function(){return this.start(),this}:!a.start&&a.run&&(a.start=function(){return this.run(),this}),a.on=e.define.on({layout:!0}),a.one=e.define.on({layout:!0,unbindSelfOnTrigger:!0}),a.once=e.define.on({layout:!0,unbindAllBindersOnTrigger:!0}),a.off=e.define.off({layout:!0}),a.trigger=e.define.trigger({layout:!0}),a.bind=a.on,a.unbind=a.off}return e.util.setMap({map:r,keys:[t,n],value:i})}function n(t,n){return e.util.getMap({map:r,keys:[t,n]})}function i(t,n,i,o,r){return e.util.setMap({map:a,keys:[t,n,i,o],value:r})}function o(t,n,i,o){return e.util.getMap({map:a,keys:[t,n,i,o]})}var r={};e.extensions=r;var a={};e.modules=a,e.extension=function(){return 2==arguments.length?n.apply(this,arguments):3==arguments.length?t.apply(this,arguments):4==arguments.length?o.apply(this,arguments):5==arguments.length?i.apply(this,arguments):void e.util.error("Invalid extension access syntax")}}(cytoscape),function(e,t){"use strict";if(e){var n=function(e){return e[0]._cyreg=e[0]._cyreg||{}};e.fn.cytoscape=function(i){var o=e(this);if("get"===i)return n(o).cy;if(t.is.fn(i)){var r=i,a=n(o).cy;if(a&&a.isReady())a.trigger("ready",[],r);else{var s=n(o);(s.readies=s.readies||[]).push(r)}}else if(t.is.plainObject(i))return o.each(function(){var t=e.extend({},i,{container:e(this)[0]});cytoscape(t)})},e.cytoscape=cytoscape,null==e.fn.cy&&null==e.cy&&(e.fn.cy=e.fn.cytoscape,e.cy=e.cytoscape)}}("undefined"!=typeof jQuery?jQuery:null,cytoscape),function(e){"use strict";function t(){return!1}function n(){return!0}e.Event=function(i,o){if(!(this instanceof e.Event))return new e.Event(i,o);i&&i.type?(this.originalEvent=i,this.type=i.type,this.isDefaultPrevented=i.defaultPrevented?n:t):this.type=i,o&&(this.type=void 0!==o.type?o.type:this.type,this.cy=o.cy,this.cyTarget=o.cyTarget,this.cyPosition=o.cyPosition,this.cyRenderedPosition=o.cyRenderedPosition,this.namespace=o.namespace,this.layout=o.layout,this.data=o.data),this.timeStamp=i&&i.timeStamp||+new Date},e.Event.prototype={preventDefault:function(){this.isDefaultPrevented=n;var e=this.originalEvent;e&&e.preventDefault&&e.preventDefault()},stopPropagation:function(){this.isPropagationStopped=n;var e=this.originalEvent;e&&e.stopPropagation&&e.stopPropagation()},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=n,this.stopPropagation()},isDefaultPrevented:t,isPropagationStopped:t,isImmediatePropagationStopped:t}}(cytoscape),function(e){"use strict";e.define={data:function(t){var n={field:"data",bindingEvent:"data",allowBinding:!1,allowSetting:!1,allowGetting:!1,settingEvent:"data",settingTriggersEvent:!1,triggerFnName:"trigger",immutableKeys:{},updateStyle:!1,onSet:function(e){},canSet:function(e){return!0}};return t=e.util.extend({},n,t),function(n,i){var o=t,r=this,a=void 0!==r.length,s=a?r:[r],l=a?r[0]:r;if(e.is.string(n)){if(o.allowGetting&&void 0===i){return l&&(v=l._private[o.field][n]),v}if(o.allowSetting&&void 0!==i&&(f=!o.immutableKeys[n])){for(var c=0,d=s.length;c<d;c++)o.canSet(s[c])&&(s[c]._private[o.field][n]=i);o.updateStyle&&r.updateStyle(),o.onSet(r),o.settingTriggersEvent&&r[o.triggerFnName](o.settingEvent)}}else if(o.allowSetting&&e.is.plainObject(n)){var u,h,p=n;for(u in p){h=p[u];var f=!o.immutableKeys[u];if(f)for(var c=0,d=s.length;c<d;c++)o.canSet(s[c])&&(s[c]._private[o.field][u]=h)}o.updateStyle&&r.updateStyle(),o.onSet(r),o.settingTriggersEvent&&r[o.triggerFnName](o.settingEvent)}else if(o.allowBinding&&e.is.fn(n)){var g=n;r.bind(o.bindingEvent,g)}else if(o.allowGetting&&void 0===n){var v;return l&&(v=l._private[o.field]),v}return r}},removeData:function(t){var n={field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!1,immutableKeys:{}};return t=e.util.extend({},n,t),function(n){var i=t,o=this,r=void 0!==o.length?o:[o];if(e.is.string(n)){for(var a=n.split(/\s+/),s=a.length,l=0;l<s;l++){h=a[l];if(!e.is.emptyString(h)&&!i.immutableKeys[h])for(var c=0,d=r.length;c<d;c++)r[c]._private[i.field][h]=void 0}i.triggerEvent&&o[i.triggerFnName](i.event)}else if(void 0===n){for(var c=0,d=r.length;c<d;c++){var u=r[c]._private[i.field];for(var h in u)!i.immutableKeys[h]&&(u[h]=void 0)}i.triggerEvent&&o[i.triggerFnName](i.event)}return o}},event:{regex:/(\w+)(\.\w+)?/,optionalTypeRegex:/(\w+)?(\.\w+)?/,falseCallback:function(){return!1}},on:function(t){var n={unbindSelfOnTrigger:!1,unbindAllBindersOnTrigger:!1};return t=e.util.extend({},n,t),function(n,i,o,r){var a=this,s=void 0!==a.length?a:[a],l=e.is.string(n),c=t;if(e.is.plainObject(i)?(r=o,o=i,i=void 0):(e.is.fn(i)||!1===i)&&(r=i,o=void 0,i=void 0),(e.is.fn(o)||!1===o)&&(r=o,o=void 0),!e.is.fn(r)&&!1!==r&&l)return a;if(l){var d={};d[n]=r,n=d}for(var u in n)if(!1===(r=n[u])&&(r=e.define.event.falseCallback),e.is.fn(r)){u=u.split(/\s+/);for(var h=0;h<u.length;h++){var p=u[h];if(!e.is.emptyString(p)){var f=p.match(e.define.event.regex);if(f)for(var g=f[1],v=f[2]?f[2]:void 0,m={callback:r,data:o,delegated:!!i,selector:i,selObj:new e.Selector(i),type:g,namespace:v,unbindSelfOnTrigger:c.unbindSelfOnTrigger,unbindAllBindersOnTrigger:c.unbindAllBindersOnTrigger,binders:s},y=0;y<s.length;y++)s[y]._private.listeners.push(m)}}}return a}},off:function(t){var n={};return t=e.util.extend({},n,t),function(t,n,i){var o=this,r=void 0!==o.length?o:[o],a=e.is.string(t);if(0===arguments.length){for(f=0;f<r.length;f++)r[f]._private.listeners=[];return o}if((e.is.fn(n)||!1===n)&&(i=n,n=void 0),a){var s={};s[t]=i,t=s}for(var l in t){!1===(i=t[l])&&(i=e.define.event.falseCallback),l=l.split(/\s+/);for(var c=0;c<l.length;c++){var d=l[c];if(!e.is.emptyString(d)){var u=d.match(e.define.event.optionalTypeRegex);if(u)for(var h=u[1]?u[1]:void 0,p=u[2]?u[2]:void 0,f=0;f<r.length;f++)for(var g=r[f]._private.listeners,v=0;v<g.length;v++){var m=g[v],y=!p||p===m.namespace,w=!h||m.type===h,b=!i||i===m.callback;y&&w&&b&&(g.splice(v,1),v--)}}}}return o}},trigger:function(t){var n={};return t=e.util.extend({},n,t),function(n,i,o){var r=this,a=void 0!==r.length?r:[r],s=e.is.string(n),l=e.is.plainObject(n),c=e.is.event(n),d=this._private.cy||this,u=d.hasCompoundNodes();if(s){var h=n.split(/\s+/);n=[];for(v=0;v<h.length;v++){w=h[v];if(!e.is.emptyString(w)){var p=w.match(e.define.event.regex),f=p[1],g=p[2]?p[2]:void 0;n.push({type:f,namespace:g})}}}else l&&(n=[n]);i?e.is.array(i)||(i=[i]):i=[];for(var v=0;v<n.length;v++)for(var m=n[v],y=0;y<a.length;y++){var w,b=a[y],C=b._private.listeners,x=e.is.element(b)||t.layout;if(c?((w=m).cyTarget=w.cyTarget||b,w.cy=w.cy||d):w=new e.Event(m,{cyTarget:b,cy:d,namespace:m.namespace}),m.layout&&(w.layout=m.layout),t.layout&&(w.layout=b),w.cyPosition){var E=w.cyPosition,_=d.zoom(),S=d.pan();w.cyRenderedPosition={x:E.x*_+S.x,y:E.y*_+S.y}}o&&(C=[{namespace:w.namespace,type:w.type,callback:o}]);for(var k=0;k<C.length;k++){var T=C[k],D=!T.namespace||T.namespace===w.namespace,R=T.type===w.type,P=!T.delegated||b!==w.cyTarget&&e.is.element(w.cyTarget)&&T.selObj.matches(w.cyTarget);if(D&&R&&P){var A=[w];if(A=A.concat(i),T.data?w.data=T.data:w.data=void 0,(T.unbindSelfOnTrigger||T.unbindAllBindersOnTrigger)&&(C.splice(k,1),k--),T.unbindAllBindersOnTrigger)for(var N=T.binders,M=0;M<N.length;M++){var O=N[M];if(O&&O!==b)for(var I=O._private.listeners,L=0;L<I.length;L++)I[L]===T&&(I.splice(L,1),L--)}var H=T.delegated?w.cyTarget:b,B=T.callback.apply(H,A);(!1===B||w.isPropagationStopped())&&(x=!1,!1===B&&(w.stopPropagation(),w.preventDefault()))}}if(x){var F=u?b._private.parent:null;null!=F&&0!==F.length?(F=F[0]).trigger(w):d.trigger(w)}}return r}},animated:function(t){var n={};return t=e.util.extend({},n,t),function(){var e=this,t=void 0!==e.length?e:[e];if(!(this._private.cy||this).styleEnabled())return!1;var n=t[0];return n?n._private.animation.current.length>0:void 0}},clearQueue:function(t){var n={};return t=e.util.extend({},n,t),function(){var e=this,t=void 0!==e.length?e:[e];if(!(this._private.cy||this).styleEnabled())return this;for(var n=0;n<t.length;n++)t[n]._private.animation.queue=[];return this}},delay:function(t){var n={};return t=e.util.extend({},n,t),function(e,t){return(this._private.cy||this).styleEnabled()?(this.animate({delay:e},{duration:e,complete:t}),this):this}},animate:function(t){var n={};return t=e.util.extend({},n,t),function(e,t){var n=this,i=void 0!==n.length,o=i?n:[n],r=this._private.cy||this,a=!i,s=!a;if(!r.styleEnabled())return this;var l=+new Date,c=r.style();switch(void 0===t&&(t={}),void 0===t.duration&&(t.duration=400),t.duration){case"slow":t.duration=600;break;case"fast":t.duration=200}var d=!0;if(e)for(var u in e){d=!1;break}if(d)return this;if(e.css&&s&&(e.css=c.getValueStyle(e.css,{array:!0})),e.renderedPosition&&s){var h=e.renderedPosition,p=r.pan(),f=r.zoom();e.position={x:(h.x-p.x)/f,y:(h.y-p.y)/f}}if(e.panBy&&a){var g=e.panBy,v=r.pan();e.pan={x:v.x+g.x,y:v.y+g.y}}var m=e.center||e.centre;if(m&&a){var y=r.getCenterPan(m.eles,e.zoom);y&&(e.pan=y)}if(e.fit&&a){var w=e.fit,b=r.getFitViewport(w.eles||w.boundingBox,w.padding);b&&(e.pan=b.pan,e.zoom=b.zoom)}for(u=0;u<o.length;u++){var C=o[u];(C.animated()&&(void 0===t.queue||t.queue)?C._private.animation.queue:C._private.animation.current).push({properties:e,duration:t.duration,params:t,callTime:l})}return s&&r.addToAnimationPool(this),this}},stop:function(t){var n={};return t=e.util.extend({},n,t),function(e,t){var n=this,i=void 0!==n.length?n:[n],o=this._private.cy||this;if(!o.styleEnabled())return this;for(var r=0;r<i.length;r++){for(var a=i[r],s=a._private.animation.current,l=0;l<s.length;l++){var c=s[l];t&&(c.duration=0)}e&&(a._private.animation.queue=[]),t||(a._private.animation.current=[])}return o.notify({collection:this,type:"draw"}),this}}}}(cytoscape),function(e){"use strict";e.fn.selector=function(t,n){for(var i in t){var o=t[i];e.Selector.prototype[i]=o}},e.Selector=function(t,n){if(!(this instanceof e.Selector))return new e.Selector(t,n);void 0===n&&void 0!==t&&(n=t,t=void 0);var i=this;if(i._private={selectorText:null,invalid:!0},!n||e.is.string(n)&&n.match(/^\s*$/))null==t?i.length=0:(i[0]=a(),i[0].group=t,i.length=1);else if(e.is.element(n)){var o=new e.Collection(i.cy(),[n]);i[0]=a(),i[0].collection=o,i.length=1}else if(e.is.collection(n))i[0]=a(),i[0].collection=n,i.length=1;else if(e.is.fn(n))i[0]=a(),i[0].filter=n,i.length=1;else{if(!e.is.string(n))return void e.util.error("A selector must be created from a string; found "+n);var r=null,a=function(){return{classes:[],colonSelectors:[],data:[],group:null,ids:[],meta:[],collection:null,filter:null,parent:null,ancestor:null,subject:null,child:null,descendant:null}},s={metaChar:"[\\!\\\"\\#\\$\\%\\&\\'\\(\\)\\*\\+\\,\\.\\/\\:\\;\\<\\=\\>\\?\\@\\[\\]\\^\\`\\{\\|\\}\\~]",comparatorOp:"=|\\!=|>|>=|<|<=|\\$=|\\^=|\\*=",boolOp:"\\?|\\!|\\^",string:'"(?:\\\\"|[^"])+"|'+"'(?:\\\\'|[^'])+'",number:e.util.regex.number,meta:"degree|indegree|outdegree",separator:"\\s*,\\s*",descendant:"\\s+",child:"\\s+>\\s+",subject:"\\$"};s.variable="(?:[\\w-]|(?:\\\\"+s.metaChar+"))+",s.value=s.string+"|"+s.number,s.className=s.variable,s.id=s.variable;for(var l=function(e){return e.replace(new RegExp("\\\\("+s.metaChar+")","g"),function(e,t,n,i){return t})},c=s.comparatorOp.split("|"),d=0;d<c.length;d++){var u=c[d];s.comparatorOp+="|@"+u}for(var c=s.comparatorOp.split("|"),d=0;d<c.length;d++)(u=c[d]).indexOf("!")>=0||"="!==u&&(s.comparatorOp+="|\\!"+u);var h={group:{query:!0,regex:"(node|edge|\\*)",populate:function(e){this.group="*"==e?e:e+"s"}},state:{query:!0,regex:"(:selected|:unselected|:locked|:unlocked|:visible|:hidden|:transparent|:grabbed|:free|:removed|:inside|:grabbable|:ungrabbable|:animated|:unanimated|:selectable|:unselectable|:orphan|:nonorphan|:parent|:child|:loop|:simple|:active|:inactive|:touch)",populate:function(e){this.colonSelectors.push(e)}},id:{query:!0,regex:"\\#("+s.id+")",populate:function(e){this.ids.push(l(e))}},className:{query:!0,regex:"\\.("+s.className+")",populate:function(e){this.classes.push(l(e))}},dataExists:{query:!0,regex:"\\[\\s*("+s.variable+")\\s*\\]",populate:function(e){this.data.push({field:l(e)})}},dataCompare:{query:!0,regex:"\\[\\s*("+s.variable+")\\s*("+s.comparatorOp+")\\s*("+s.value+")\\s*\\]",populate:function(e,t,n){n=null!=new RegExp("^"+s.string+"$").exec(n)?n.substring(1,n.length-1):parseFloat(n),this.data.push({field:l(e),operator:t,value:n})}},dataBool:{query:!0,regex:"\\[\\s*("+s.boolOp+")\\s*("+s.variable+")\\s*\\]",populate:function(e,t){this.data.push({field:l(t),operator:e})}},metaCompare:{query:!0,regex:"\\[\\[\\s*("+s.meta+")\\s*("+s.comparatorOp+")\\s*("+s.number+")\\s*\\]\\]",populate:function(e,t,n){this.meta.push({field:l(e),operator:t,value:parseFloat(n)})}},nextQuery:{separator:!0,regex:s.separator,populate:function(){i[++d]=a(),r=null}},child:{separator:!0,regex:s.child,populate:function(){var e=a();e.parent=this,e.subject=r,i[d]=e}},descendant:{separator:!0,regex:s.descendant,populate:function(){var e=a();e.ancestor=this,e.subject=r,i[d]=e}},subject:{modifier:!0,regex:s.subject,populate:function(){if(null!=r&&this.subject!=this)return e.util.error("Redefinition of subject in selector `"+n+"`"),!1;r=this,this.subject=this}}},p=0;for(var f in h)h[p]=h[f],h[p].name=f,p++;h.length=p,i._private.selectorText=n;var g=n,d=0;for(i[0]=a(),function(){var e=g.match(/^\s+/);if(e){var t=e[0];g=g.substring(t.length)}}();;){var v=function(t){for(var n,i,o,r=0;r<h.length;r++){var a=h[r],s=a.name;if(!e.is.fn(t)||t(s,a)){var l=g.match(new RegExp("^"+a.regex));if(null!=l){i=l,n=a,o=s;var c=l[0];g=g.substring(c.length);break}}}return{expr:n,match:i,name:o}}();if(null==v.expr)return void e.util.error("The selector `"+n+"`is invalid");for(var m=[],p=1;p<v.match.length;p++)m.push(v.match[p]);if(!1===v.expr.populate.apply(i[d],m))return;if(g.match(/^\s*$/))break}for(i.length=d+1,p=0;p<i.length;p++){var y=i[p];if(null!=y.subject){for(;y.subject!=y;)if(null!=y.parent){var w=y.parent,b=y;b.parent=null,w.child=b,y=w}else{if(null==y.ancestor){e.util.error("When adjusting references for the selector `"+y+"`, neither parent nor ancestor was found");break}var C=y.ancestor,x=y;x.ancestor=null,C.descendant=x,y=C}i[p]=y.subject}}if(null!=t)for(p=0;p<i.length;p++){if(null!=i[p].group&&i[p].group!=t)return void e.util.error("Group `"+i[p].group+"` conflicts with implicit group `"+t+"` in selector `"+n+"`");i[p].group=t}}i._private.invalid=!1},e.selfn=e.Selector.prototype,e.selfn.size=function(){return this.length},e.selfn.eq=function(e){return this[e]},e.selfn.find=function(){};var t=function(n,i){if(null!=n.group&&"*"!=n.group&&n.group!=i._private.group)return!1;for(var o=i.cy(),r=!0,a=0;a<n.colonSelectors.length;a++){switch(n.colonSelectors[a]){case":selected":r=i.selected();break;case":unselected":r=!i.selected();break;case":selectable":r=i.selectable();break;case":unselectable":r=!i.selectable();break;case":locked":r=i.locked();break;case":unlocked":r=!i.locked();break;case":visible":r=i.visible();break;case":hidden":r=!i.visible();break;case":transparent":r=i.transparent();break;case":grabbed":r=i.grabbed();break;case":free":r=!i.grabbed();break;case":removed":r=i.removed();break;case":inside":r=!i.removed();break;case":grabbable":r=i.grabbable();break;case":ungrabbable":r=!i.grabbable();break;case":animated":r=i.animated();break;case":unanimated":r=!i.animated();break;case":parent":r=i.isNode()&&i.children().nonempty();break;case":child":case":nonorphan":r=i.isNode()&&i.parent().nonempty();break;case":orphan":r=i.isNode()&&i.parent().empty();break;case":loop":r=i.isEdge()&&i.data("source")===i.data("target");break;case":simple":r=i.isEdge()&&i.data("source")!==i.data("target");break;case":active":r=i.active();break;case":inactive":r=!i.active();break;case":touch":r=e.is.touch()}if(!r)break}if(!r)return!1;for(var s=!0,a=0;a<n.ids.length;a++){var l=n.ids[a],c=i._private.data.id;if(!(s=s&&l==c))break}if(!s)return!1;for(var d=!0,a=0;a<n.classes.length;a++){var u=n.classes[a];if(!(d=d&&i.hasClass(u)))break}if(!d)return!1;var h=function(t){for(var i=!0,o=0;o<n[t.name].length;o++){var r,a=n[t.name][o],s=a.operator,l=a.value,c=a.field;if(null!=s&&null!=l){var d=t.fieldValue(c),u=e.is.string(d)||e.is.number(d)?""+d:"",h=""+l,p=!1;s.indexOf("@")>=0&&(u=u.toLowerCase(),h=h.toLowerCase(),s=s.replace("@",""),p=!0);var f=!1,g=!1;switch(s.indexOf("!")>=0&&(s=s.replace("!",""),f=!0),p&&(l=h.toLowerCase(),d=u.toLowerCase()),s){case"*=":r=u.search(h)>=0;break;case"$=":r=null!=new RegExp(h+"$").exec(u);break;case"^=":r=null!=new RegExp("^"+h).exec(u);break;case"=":r=d===l;break;case"!=":r=d!==l;break;case">":r=f?d<=l:d>l,g=!0;break;case">=":r=f?d<l:d>=l,g=!0;break;case"<":r=f?d>=l:d<l,g=!0;break;case"<=":r=f?d>l:d<=l,g=!0;break;default:r=!1}}else if(null!=s)switch(s){case"?":r=t.fieldTruthy(c);break;case"!":r=!t.fieldTruthy(c);break;case"^":r=t.fieldUndefined(c)}else r=!t.fieldUndefined(c);if(f&&!g&&(r=!r,g=!0),!r){i=!1;break}}return i};if(!h({name:"data",fieldValue:function(e){return i._private.data[e]},fieldRef:function(e){return"element._private.data."+e},fieldUndefined:function(e){return void 0===i._private.data[e]},fieldTruthy:function(e){return!!i._private.data[e]}}))return!1;if(!h({name:"meta",fieldValue:function(e){return i[e]()},fieldRef:function(e){return"element."+e+"()"},fieldUndefined:function(e){return null==i[e]()},fieldTruthy:function(e){return!!i[e]()}}))return!1;if(null!=n.collection&&!(null!=n.collection._private.ids[i.id()]))return!1;if(null!=n.filter&&0===i.collection().filter(n.filter).size())return!1;var p=function(e,n){if(null!=e){var i=!1;if(!o.hasCompoundNodes())return!1;n=n();for(var r=0;r<n.length;r++)if(t(e,n[r])){i=!0;break}return i}return!0};return!!p(n.parent,function(){return i.parent()})&&(!!p(n.ancestor,function(){return i.parents()})&&(!!p(n.child,function(){return i.children()})&&!!p(n.descendant,function(){return i.descendants()})))};e.selfn.filter=function(n){var i=this,o=n.cy();if(i._private.invalid)return new e.Collection(o);var r=function(e,n){for(var o=0;o<i.length;o++){var r=i[o];if(t(r,n))return!0}return!1};return null==i._private.selectorText&&(r=function(){return!0}),n.filter(r)},e.selfn.matches=function(e){var n=this;if(n._private.invalid)return!1;for(var i=0;i<n.length;i++){var o=n[i];if(t(o,e))return!0}return!1},e.selfn.toString=e.selfn.selector=function(){for(var t="",n=function(t){return e.is.string(t)?t:""},i=function(e){var t="",r=n(e.group);t+=r.substring(0,r.length-1);for(l=0;l<e.data.length;l++){var a=e.data[l];a.value?t+="["+a.field+n(a.operator)+n(a.value)+"]":t+="["+n(a.operator)+a.field+"]"}for(l=0;l<e.meta.length;l++){var s=e.meta[l];t+="[["+s.field+n(s.operator)+n(s.value)+"]]"}for(l=0;l<e.colonSelectors.length;l++)t+=c=e.colonSelectors[o];for(l=0;l<e.ids.length;l++)t+=c="#"+e.ids[o];for(var l=0;l<e.classes.length;l++){var c="."+e.classes[o];t+=c}return null!=e.parent&&(t=i(e.parent)+" > "+t),null!=e.ancestor&&(t=i(e.ancestor)+" "+t),null!=e.child&&(t+=" > "+i(e.child)),null!=e.descendant&&(t+=" "+i(e.descendant)),t},o=0;o<this.length;o++){var r=this[o];t+=i(r),this.length>1&&o<this.length-1&&(t+=", ")}return t}}(cytoscape),function(e){"use strict";e.Style=function(t){if(!(this instanceof e.Style))return new e.Style(t);e.is.core(t)?(this._private={cy:t,coreStyle:{},newStyle:!0},this.length=0,this.addDefaultStylesheet()):e.util.error("A style must have a core reference")},e.style=e.Style,e.styfn=e.Style.prototype,e.fn.style=function(t,n){for(var i in t){var o=t[i];e.Style.prototype=o}},function(){var t=e.util.regex.number,n=e.util.regex.rgbaNoBackRefs,i=e.util.regex.hslaNoBackRefs,o=e.util.regex.hex3,r=e.util.regex.hex6,a=function(e){return"^"+e+"\\s*\\(\\s*([\\w\\.]+)\\s*\\)$"},s=function(e){return"^"+e+"\\s*\\(([\\w\\.]+)\\s*\\,\\s*("+t+")\\s*\\,\\s*("+t+")\\s*,\\s*("+t+"|\\w+|"+n+"|"+i+"|"+o+"|"+r+")\\s*\\,\\s*("+t+"|\\w+|"+n+"|"+i+"|"+o+"|"+r+")\\)$"};e.style.types={time:{number:!0,min:0,units:"s|ms",implicitUnits:"ms"},percent:{number:!0,min:0,max:100,units:"%"},zeroOneNumber:{number:!0,min:0,max:1,unitless:!0},nOneOneNumber:{number:!0,min:-1,max:1,unitless:!0},nonNegativeInt:{number:!0,min:0,integer:!0,unitless:!0},position:{enums:["parent","origin"]},autoSize:{number:!0,min:0,enums:["auto"]},number:{number:!0},size:{number:!0,min:0},bgSize:{number:!0,min:0,allowPercent:!0},bgPos:{number:!0,allowPercent:!0},bgRepeat:{enums:["repeat","repeat-x","repeat-y","no-repeat"]},bgFit:{enums:["none","contain","cover"]},bgClip:{enums:["none","node"]},color:{color:!0},lineStyle:{enums:["solid","dotted","dashed"]},borderStyle:{enums:["solid","dotted","dashed","double"]},curveStyle:{enums:["bezier","unbundled-bezier","haystack"]},fontFamily:{regex:"^([\\w- ]+(?:\\s*,\\s*[\\w- ]+)*)$"},fontVariant:{enums:["small-caps","normal"]},fontStyle:{enums:["italic","normal","oblique"]},fontWeight:{enums:["normal","bold","bolder","lighter","100","200","300","400","500","600","800","900",100,200,300,400,500,600,700,800,900]},textDecoration:{enums:["none","underline","overline","line-through"]},textTransform:{enums:["none","uppercase","lowercase"]},nodeShape:{enums:["rectangle","roundrectangle","ellipse","triangle","square","pentagon","hexagon","heptagon","octagon","star"]},arrowShape:{enums:["tee","triangle","triangle-tee","triangle-backcurve","half-triangle-overshot","square","circle","diamond","none"]},arrowFill:{enums:["filled","hollow"]},display:{enums:["element","none"]},visibility:{enums:["hidden","visible"]},valign:{enums:["top","center","bottom"]},halign:{enums:["left","center","right"]},text:{string:!0},data:{mapping:!0,regex:a("data")},layoutData:{mapping:!0,regex:a("layoutData")},mapData:{mapping:!0,regex:s("mapData")},mapLayoutData:{mapping:!0,regex:s("mapLayoutData")},url:{regex:"^url\\s*\\(\\s*([^\\s]+)\\s*\\s*\\)|none|(.+)$"},propList:{propList:!0},angle:{number:!0,units:"deg|rad"}};var l=e.style.types,c=e.style.properties=[{name:"text-valign",type:l.valign},{name:"text-halign",type:l.halign},{name:"color",type:l.color},{name:"content",type:l.text},{name:"text-outline-color",type:l.color},{name:"text-outline-width",type:l.size},{name:"text-outline-opacity",type:l.zeroOneNumber},{name:"text-opacity",type:l.zeroOneNumber},{name:"text-transform",type:l.textTransform},{name:"font-family",type:l.fontFamily},{name:"font-style",type:l.fontStyle},{name:"font-weight",type:l.fontWeight},{name:"font-size",type:l.size},{name:"min-zoomed-font-size",type:l.size},{name:"display",type:l.display},{name:"visibility",type:l.visibility},{name:"opacity",type:l.zeroOneNumber},{name:"z-index",type:l.nonNegativeInt},{name:"overlay-padding",type:l.size},{name:"overlay-color",type:l.color},{name:"overlay-opacity",type:l.zeroOneNumber},{name:"transition-property",type:l.propList},{name:"transition-duration",type:l.time},{name:"transition-delay",type:l.time},{name:"height",type:l.autoSize},{name:"width",type:l.autoSize},{name:"shape",type:l.nodeShape},{name:"background-color",type:l.color},{name:"background-opacity",type:l.zeroOneNumber},{name:"background-blacken",type:l.nOneOneNumber},{name:"border-color",type:l.color},{name:"border-opacity",type:l.zeroOneNumber},{name:"border-width",type:l.size},{name:"border-style",type:l.borderStyle},{name:"background-image",type:l.url},{name:"background-image-opacity",type:l.zeroOneNumber},{name:"background-position-x",type:l.bgPos},{name:"background-position-y",type:l.bgPos},{name:"background-repeat",type:l.bgRepeat},{name:"background-fit",type:l.bgFit},{name:"background-clip",type:l.bgClip},{name:"padding-left",type:l.size},{name:"padding-right",type:l.size},{name:"padding-top",type:l.size},{name:"padding-bottom",type:l.size},{name:"position",type:l.position},{name:"line-style",type:l.lineStyle},{name:"line-color",type:l.color},{name:"control-point-step-size",type:l.size},{name:"control-point-distance",type:l.number},{name:"control-point-weight",type:l.zeroOneNumber},{name:"curve-style",type:l.curveStyle},{name:"haystack-radius",type:l.zeroOneNumber},{name:"source-arrow-shape",type:l.arrowShape},{name:"target-arrow-shape",type:l.arrowShape},{name:"mid-source-arrow-shape",type:l.arrowShape},{name:"mid-target-arrow-shape",type:l.arrowShape},{name:"source-arrow-color",type:l.color},{name:"target-arrow-color",type:l.color},{name:"mid-source-arrow-color",type:l.color},{name:"mid-target-arrow-color",type:l.color},{name:"source-arrow-fill",type:l.arrowFill},{name:"target-arrow-fill",type:l.arrowFill},{name:"mid-source-arrow-fill",type:l.arrowFill},{name:"mid-target-arrow-fill",type:l.arrowFill},{name:"selection-box-color",type:l.color},{name:"selection-box-opacity",type:l.zeroOneNumber},{name:"selection-box-border-color",type:l.color},{name:"selection-box-border-width",type:l.size},{name:"active-bg-color",type:l.color},{name:"active-bg-opacity",type:l.zeroOneNumber},{name:"active-bg-size",type:l.size},{name:"outside-texture-bg-color",type:l.color},{name:"outside-texture-bg-opacity",type:l.zeroOneNumber}];e.style.pieBackgroundN=16,c.push({name:"pie-size",type:l.bgSize});for(d=1;d<=e.style.pieBackgroundN;d++)c.push({name:"pie-"+d+"-background-color",type:l.color}),c.push({name:"pie-"+d+"-background-size",type:l.percent}),c.push({name:"pie-"+d+"-background-opacity",type:l.zeroOneNumber});for(var d=0;d<c.length;d++){var u=c[d];c[u.name]=u}}(),e.styfn.addDefaultStylesheet=function(){this.selector("node, edge").css({"text-valign":"top","text-halign":"center",color:"#000","text-outline-color":"#000","text-outline-width":0,"text-outline-opacity":1,"text-opacity":1,"text-decoration":"none","text-transform":"none","font-family":"Helvetica","font-style":"normal","font-weight":"normal","font-size":16,"min-zoomed-font-size":0,visibility:"visible",display:"element",opacity:1,"z-index":0,content:"","overlay-opacity":0,"overlay-color":"#000","overlay-padding":10,"transition-property":"none","transition-duration":0,"transition-delay":0,"background-blacken":0,"background-color":"#888","background-opacity":1,"background-image":"none","background-image-opacity":1,"background-position-x":"50%","background-position-y":"50%","background-repeat":"no-repeat","background-fit":"none","background-clip":"node","border-color":"#000","border-opacity":1,"border-width":0,"border-style":"solid",height:30,width:30,shape:"ellipse","padding-top":0,"padding-bottom":0,"padding-left":0,"padding-right":0,position:"origin","pie-size":"100%","pie-1-background-color":"black","pie-2-background-color":"black","pie-3-background-color":"black","pie-4-background-color":"black","pie-5-background-color":"black","pie-6-background-color":"black","pie-7-background-color":"black","pie-8-background-color":"black","pie-9-background-color":"black","pie-10-background-color":"black","pie-11-background-color":"black","pie-12-background-color":"black","pie-13-background-color":"black","pie-14-background-color":"black","pie-15-background-color":"black","pie-16-background-color":"black","pie-1-background-size":"0%","pie-2-background-size":"0%","pie-3-background-size":"0%","pie-4-background-size":"0%","pie-5-background-size":"0%","pie-6-background-size":"0%","pie-7-background-size":"0%","pie-8-background-size":"0%","pie-9-background-size":"0%","pie-10-background-size":"0%","pie-11-background-size":"0%","pie-12-background-size":"0%","pie-13-background-size":"0%","pie-14-background-size":"0%","pie-15-background-size":"0%","pie-16-background-size":"0%","pie-1-background-opacity":1,"pie-2-background-opacity":1,"pie-3-background-opacity":1,"pie-4-background-opacity":1,"pie-5-background-opacity":1,"pie-6-background-opacity":1,"pie-7-background-opacity":1,"pie-8-background-opacity":1,"pie-9-background-opacity":1,"pie-10-background-opacity":1,"pie-11-background-opacity":1,"pie-12-background-opacity":1,"pie-13-background-opacity":1,"pie-14-background-opacity":1,"pie-15-background-opacity":1,"pie-16-background-opacity":1,"source-arrow-shape":"none","mid-source-arrow-shape":"none","target-arrow-shape":"none","mid-target-arrow-shape":"none","source-arrow-color":"#ddd","mid-source-arrow-color":"#ddd","target-arrow-color":"#ddd","mid-target-arrow-color":"#ddd","source-arrow-fill":"filled","mid-source-arrow-fill":"filled","target-arrow-fill":"filled","mid-target-arrow-fill":"filled","line-style":"solid","line-color":"#ddd","control-point-step-size":40,"control-point-weight":.5,"curve-style":"bezier","haystack-radius":.8}).selector("$node > node").css({width:"auto",height:"auto",shape:"rectangle","background-opacity":.5,"padding-top":10,"padding-right":10,"padding-left":10,"padding-bottom":10}).selector("edge").css({width:1}).selector(":active").css({"overlay-color":"black","overlay-padding":10,"overlay-opacity":.25}).selector("core").css({"selection-box-color":"#ddd","selection-box-opacity":.65,"selection-box-border-color":"#aaa","selection-box-border-width":1,"active-bg-color":"black","active-bg-opacity":.15,"active-bg-size":e.is.touch()?40:15,"outside-texture-bg-color":"#000","outside-texture-bg-opacity":.125})},e.styfn.clear=function(){for(var e=0;e<this.length;e++)this[e]=void 0;return this.length=0,this._private.newStyle=!0,this},e.styfn.resetToDefault=function(){return this.clear(),this.addDefaultStylesheet(),this},e.styfn.core=function(){return this._private.coreStyle},e.styfn.parse=function(t,n,i,o){t=e.util.camel2dash(t);var r=e.style.properties[t],a=n;if(!r)return null;if(void 0===n||null===n)return null;var s=e.is.string(n);s&&(n=e.util.trim(n));var l=r.type;if(!l)return null;if(i&&(""===n||null===n))return{name:t,value:n,bypass:!0,deleteBypass:!0};var c,d,u,h;if(!s||o);else{if((c=new RegExp(e.style.types.data.regex).exec(n))||(u=new RegExp(e.style.types.layoutData.regex).exec(n))){if(i)return!1;p=void 0!==u;return c=c||u,{name:t,value:c,strValue:""+n,mapped:p?e.style.types.layoutData:e.style.types.data,field:c[1],bypass:i,hasPie:t.match(/pie-(\d+)-background-size/)}}if((d=new RegExp(e.style.types.mapData.regex).exec(n))||(h=new RegExp(e.style.types.mapLayoutData.regex).exec(n))){if(i)return!1;var p=void 0!==h;if(d=d||h,!l.color&&!l.number)return!1;var f=this.parse(t,d[4]);if(!f||f.mapped)return!1;var g=this.parse(t,d[5]);if(!g||g.mapped)return!1;if(f.value===g.value)return!1;if(l.color){var v=f.value,m=g.value;if(!(v[0]!==m[0]||v[1]!==m[1]||v[2]!==m[2]||v[3]!==m[3]&&(null!=v[3]&&1!==v[3]||null!=m[3]&&1!==m[3])))return!1}return{name:t,value:d,strValue:""+n,mapped:p?e.style.types.mapLayoutData:e.style.types.mapData,field:d[1],fieldMin:parseFloat(d[2]),fieldMax:parseFloat(d[3]),valueMin:f.value,valueMax:g.value,bypass:i,hasPie:t.match(/pie-(\d+)-background-size/)}}}if(l.number){var y,w="px";if(l.units&&(y=l.units),l.implicitUnits&&(w=l.implicitUnits),!l.unitless)if(s){var b="px|em"+(l.allowPercent?"|\\%":"");y&&(b=y);var C=n.match("^("+e.util.regex.number+")("+b+")?$");C&&(n=C[1],y=C[2]||w)}else y&&!l.implicitUnits||(y=w);if(n=parseFloat(n),isNaN(n)&&void 0===l.enums)return null;if(isNaN(n)&&void 0!==l.enums){n=a;for(k=0;k<l.enums.length;k++)if((R=l.enums[k])===n)return{name:t,value:n,strValue:""+n,bypass:i};return null}if(l.integer&&!e.is.integer(n))return null;if(void 0!==l.min&&n<l.min||void 0!==l.max&&n>l.max)return null;var x={name:t,value:n,strValue:""+n+(y||""),units:y,bypass:i,hasPie:t.match(/pie-(\d+)-background-size/)&&null!=n&&0!==n&&""!==n};return l.unitless||"px"!==y&&"em"!==y||(x.pxValue="px"!==y&&y?this.getEmSizeInPixels()*n:n),"ms"!==y&&"s"!==y||(x.msValue="ms"===y?n:1e3*n),x}if(l.propList){var E=[],_=""+n;if("none"===_);else{for(var S=_.split(","),k=0;k<S.length;k++){var T=e.util.trim(S[k]);e.style.properties[T]&&E.push(T)}if(0===E.length)return null}return{name:t,value:E,strValue:0===E.length?"none":E.join(", "),bypass:i}}if(l.color){var D=e.util.color2tuple(n);return D?{name:t,value:D,strValue:""+n,bypass:i}:null}if(l.enums){for(k=0;k<l.enums.length;k++){var R=l.enums[k];if(R===n)return{name:t,value:n,strValue:""+n,bypass:i}}return null}if(l.regex){var P=new RegExp(l.regex).exec(n);return P?{name:t,value:P,strValue:""+n,bypass:i}:null}return l.string?{name:t,value:n,strValue:""+n,bypass:i}:null},e.styfn.selector=function(t){var n="core"===t?null:new e.Selector(t),i=this.length++;return this[i]={selector:n,properties:[],mappedProperties:[],index:i},this},e.styfn.css=function(){var t=arguments;switch(t.length){case 1:for(var n=t[0],i=0;i<e.style.properties.length;i++){var o=e.style.properties[i],r=n[o.name];void 0===r&&(r=n[e.util.dash2camel(o.name)]),void 0!==r&&this.cssRule(o.name,r)}break;case 2:this.cssRule(t[0],t[1])}return this},e.styfn.cssRule=function(e,t){var n=this.parse(e,t);if(n){var i=this.length-1;this[i].properties.push(n),this[i].properties[n.name]=n,n.hasPie&&(this._private.hasPie=!0),n.mapped&&this[i].mappedProperties.push(n),!this[i].selector&&(this._private.coreStyle[n.name]=n)}return this}}(cytoscape),function(e){"use strict";e.styfn.apply=function(e){var t=this;t._private.newStyle&&(this._private.contextStyles={},this._private.propDiffs={});for(var n=0;n<e.length;n++){var i=e[n],o=t.getContextMeta(i),r=t.getContextStyle(o),a=t.applyContextStyle(o,r,i);t.updateTransitions(i,a.diffProps),t.updateStyleHints(i)}t._private.newStyle=!1},e.styfn.getPropertiesDiff=function(e,t){var n=this,i=n._private.propDiffs=n._private.propDiffs||{},o=e+"-"+t,r=i[o];if(r)return r;for(var a=[],s={},l=0;l<n.length;l++){var c=n[l],d="t"===e[l]!==("t"===t[l]),u=c.mappedProperties.length>0;if(d||u){var h;d&&u?h=c.properties:d?h=c.properties:u&&(h=c.mappedProperties);for(var p=0;p<h.length;p++){for(var f=h[p],g=f.name,v=!1,m=l+1;m<n.length;m++){var y=n[m];if("t"===t[m]&&(v=null!=y.properties[f.name]))break}s[g]||v||(s[g]=!0,a.push(g))}}}return i[o]=a,a},e.styfn.getContextMeta=function(e){var t,n=this,i="",o=e._private.styleCxtKey||"";n._private.newStyle&&(o="");for(var r=0;r<n.length;r++){var a=n[r];i+=a.selector&&a.selector.matches(e)?"t":"f"}return t=n.getPropertiesDiff(o,i),e._private.styleCxtKey=i,{key:i,diffPropNames:t}},e.styfn.getContextStyle=function(e){var t=e.key,n=this,i=this._private.contextStyles=this._private.contextStyles||{};if(i[t])return i[t];for(var o={_private:{key:t}},r=0;r<n.length;r++){var a=n[r];if("t"===t[r])for(var s=0;s<a.properties.length;s++){var l=a.properties[s];(o[l.name]=l).context=a}}return i[t]=o,o},e.styfn.applyContextStyle=function(e,t,n){for(var i=this,o=e.diffPropNames,r={},a=0;a<o.length;a++){var s=o[a],l=t[s],c=n._private.style[s];if(l&&c!==l){var d=r[s]={prev:c};i.applyParsedProperty(n,l),d.next=n._private.style[s],d.next.bypass&&(d.next=d.next.bypassed)}}return{diffProps:r}},e.styfn.updateStyleHints=function(t){var n=t._private,i=this,o=n.style,r=!1;if("nodes"===n.group&&i._private.hasPie)for(var a=1;a<=e.style.pieBackgroundN;a++)if((d=n.style["pie-"+a+"-background-size"].value)>0){r=!0;break}n.hasPie=r;var s=o["text-transform"].strValue,l=o.content.strValue,c=o["font-style"].strValue,d=o["font-size"].pxValue+"px",u=o["font-family"].strValue,h=o["font-weight"].strValue,p=o["text-valign"].strValue,f=o["text-valign"].strValue,g=o["text-outline-width"].pxValue;n.labelKey=c+"$"+d+"$"+u+"$"+h+"$"+l+"$"+s+"$"+p+"$"+f+"$"+g,n.fontKey=c+"$"+h+"$"+d+"$"+u;var v=o.width.pxValue,m=o.height.pxValue,y=o["border-width"].pxValue;if(n.boundingBoxKey=v+"$"+m+"$"+y,"edges"===t._private.group){var w=o["control-point-step-size"].pxValue,b=o["control-point-distance"]?o["control-point-distance"].pxValue:void 0,C=o["control-point-weight"].value,x=o["curve-style"].strValue;n.boundingBoxKey+="$"+w+"$"+b+"$"+C+"$"+x}n.styleKey=Date.now()},e.styfn.applyParsedProperty=function(t,n){var i,o=n,r=t._private.style,a=e.style.properties[o.name].type,s=o.bypass,l=r[o.name],c=l&&l.bypass;if(("height"===n.name||"width"===n.name)&&"auto"===n.value&&t.isNode()&&!t.isParent())return!1;if(s&&o.deleteBypass){var d=r[o.name];return!d||!(!d.bypass||!d.bypassed)&&(r[o.name]=d.bypassed,!0)}var u=function(){e.util.error("Do not assign mappings to elements without corresponding data (e.g. ele `"+t.id()+"` for property `"+o.name+"` with data field `"+o.field+"`); try a `["+o.field+"]` selector to limit scope to elements with `"+o.field+"` defined")};switch(o.mapped){case e.style.types.mapData:case e.style.types.mapLayoutData:for(var h=o.mapped===e.style.types.mapLayoutData,p=o.field.split("."),f=h?t._private.layoutData:t._private.data,g=0;g<p.length&&f;g++)f=f[T=p[g]];var v;if((v=e.is.number(f)?(f-o.fieldMin)/(o.fieldMax-o.fieldMin):0)<0?v=0:v>1&&(v=1),a.color){var m=o.valueMin[0],y=o.valueMax[0],w=o.valueMin[1],b=o.valueMax[1],C=o.valueMin[2],x=o.valueMax[2],E=null==o.valueMin[3]?1:o.valueMin[3],_=null==o.valueMax[3]?1:o.valueMax[3],S=[Math.round(m+(y-m)*v),Math.round(w+(b-w)*v),Math.round(C+(x-C)*v),Math.round(E+(_-E)*v)];i={bypass:o.bypass,name:o.name,value:S,strValue:"rgb("+S[0]+", "+S[1]+", "+S[2]+")"}}else{if(!a.number)return!1;var k=o.valueMin+(o.valueMax-o.valueMin)*v;i=this.parse(o.name,k,o.bypass,!0)}i||(i=this.parse(o.name,l.strValue,o.bypass,!0)),i||u(),i.mapping=o,o=i;break;case e.style.types.data:case e.style.types.layoutData:for(var h=o.mapped===e.style.types.layoutData,p=o.field.split("."),f=h?t._private.layoutData:t._private.data,g=0;g<p.length&&f;g++){var T=p[g];f=f[T]}if(!(i=this.parse(o.name,f,o.bypass,!0))){var D=l?l.strValue:"";i=this.parse(o.name,D,o.bypass,!0)}i||u(),i.mapping=o,o=i;break;case void 0:break;default:return!1}return s?(o.bypassed=c?l.bypassed:l,r[o.name]=o):c?l.bypassed=o:r[o.name]=o,!0},e.styfn.update=function(){this._private.cy.elements().updateStyle()},e.styfn.updateMappers=function(t){for(var n=0;n<t.length;n++){for(var i=t[n],o=i._private.style,r=0;r<e.style.properties.length;r++){var a=o[e.style.properties[r].name];if(a&&a.mapping){var s=a.mapping;this.applyParsedProperty(i,s)}}this.updateStyleHints(i)}},e.styfn.updateTransitions=function(t,n,i){var o=this,r=t._private.style,a=r["transition-property"].value,s=r["transition-duration"].msValue,l=r["transition-delay"].msValue,c={};if(a.length>0&&s>0){for(var d=!1,u=0;u<a.length;u++){var h=a[u],p=r[h],f=n[h];if(f){var g=f.prev,v=null!=f.next?f.next:p,m=!1;g&&(e.is.number(g.pxValue)&&e.is.number(v.pxValue)?m=g.pxValue!==v.pxValue:e.is.number(g.value)&&e.is.number(v.value)?m=g.value!==v.value:e.is.array(g.value)&&e.is.array(v.value)&&(m=g.value[0]!==v.value[0]||g.value[1]!==v.value[1]||g.value[2]!==v.value[2]),m&&(c[h]=v.strValue,this.applyBypass(t,h,g.strValue),d=!0))}}if(!d)return;t._private.transitioning=!0,t.stop(),l>0&&t.delay(l),t.animate({css:c},{duration:s,queue:!1,complete:function(){i||o.removeBypasses(t,a),t._private.transitioning=!1}})}else t._private.transitioning&&(t.stop(),this.removeBypasses(t,a),t._private.transitioning=!1)}}(cytoscape),function(e){"use strict";e.styfn.applyBypass=function(t,n,i,o){var r=[];if("*"===n||"**"===n){if(void 0!==i)for(c=0;c<e.style.properties.length;c++){var n=(g=e.style.properties[c]).name;(s=this.parse(n,i,!0))&&r.push(s)}}else if(e.is.string(n))(s=this.parse(n,i,!0))&&r.push(s);else{if(!e.is.plainObject(n))return!1;var a=n;o=i;for(c=0;c<e.style.properties.length;c++)if(void 0===(i=a[n=(g=e.style.properties[c]).name])&&(i=a[e.util.dash2camel(n)]),void 0!==i){var s=this.parse(n,i,!0);s&&r.push(s)}}if(0===r.length)return!1;for(var l=!1,c=0;c<t.length;c++){for(var d,u=t[c],h=u._private.style,p={},f=0;f<r.length;f++){var g=r[f];if(o){var v=h[g.name];d=p[g.name]={prev:v}}l=this.applyParsedProperty(u,g)||l,o&&(d.next=h[g.name])}o&&this.updateTransitions(u,p,!0)}return l},e.styfn.overrideBypass=function(t,n,i){for(var o=0;o<t.length;o++){var r=t[o],a=r._private.style[e.util.camel2dash(n)];a.bypass?(a.value=i,a.pxValue=i):this.applyBypass(r,n,i)}},e.styfn.removeAllBypasses=function(t,n){for(var i=0;i<t.length;i++){for(var o=t[i],r={},a=o._private.style,s=0;s<e.style.properties.length;s++){var l=e.style.properties[s],c=l.name,d=this.parse(c,"",!0),u=a[l.name],h=r[l.name]={prev:u};this.applyParsedProperty(o,d),h.next=a[l.name]}n&&this.updateTransitions(o,r,!0)}},e.styfn.removeBypasses=function(t,n,i){for(var o=0;o<t.length;o++){for(var r=t[o],a={},s=r._private.style,l=0;l<n.length;l++){var c=n[l],d=e.style.properties[c],u=this.parse(c,"",!0),h=s[d.name],p=a[d.name]={prev:h};this.applyParsedProperty(r,u),p.next=s[d.name]}i&&this.updateTransitions(r,a,!0)}}}(cytoscape),function(e,t){"use strict";e.styfn.getEmSizeInPixels=function(){var e=this._private.cy.container();if(t&&e&&t.getComputedStyle){var n=t.getComputedStyle(e).getPropertyValue("font-size");return parseFloat(n)}return 1},e.styfn.containerCss=function(e){var n=this._private.cy.container();if(t&&n&&t.getComputedStyle)return t.getComputedStyle(n).getPropertyValue(e)},e.styfn.containerProperty=function(e){var t=this.containerCss(e);return this.parse(e,t)},e.styfn.containerPropertyAsString=function(e){var t=this.containerProperty(e);if(t)return t.strValue}}(cytoscape,"undefined"==typeof window?null:window),function(e){"use strict";e.styfn.getRenderedStyle=function(t){if(t=t[0]){for(var n={},i=t._private.style,o=this._private.cy.zoom(),r=0;r<e.style.properties.length;r++){var a=e.style.properties[r],s=i[a.name];if(s){var l=s.unitless?s.strValue:s.pxValue*o+"px";n[a.name]=l,n[e.util.dash2camel(a.name)]=l}}return n}},e.styfn.getRawStyle=function(t){if(t=t[0]){for(var n={},i=t._private.style,o=0;o<e.style.properties.length;o++){var r=e.style.properties[o],a=i[r.name];a&&(n[r.name]=a.strValue,n[e.util.dash2camel(r.name)]=a.strValue)}return n}},e.styfn.getValueStyle=function(t,n){var i,o=(n=n||{}).array?[]:{};if(i=e.is.element(t)?t._private.style:t)for(var r=0;r<e.style.properties.length;r++){var a=e.style.properties[r],s=i[a.name]||i[e.util.dash2camel(a.name)];void 0===s||e.is.plainObject(s)||(s=this.parse(a.name,s)),s&&(n.array?o.push(s):(o[a.name]=s,o[e.util.dash2camel(a.name)]=s))}return o}}(cytoscape),function(e){"use strict";e.style.applyFromJson=function(e,t){for(var n=0;n<t.length;n++){var i=t[n],o=i.selector,r=i.css;e.selector(o);for(var a in r){var s=r[a];e.css(a,s)}}return e},e.style.fromJson=function(t,n){var i=new e.Style(t);return e.style.applyFromJson(i,n),i},e.styfn.fromJson=function(t){var n=this;return n.resetToDefault(),e.style.applyFromJson(n,t),n},e.styfn.json=function(){for(var e=[],t=0;t<this.length;t++){for(var n=this[t],i=n.selector,o=n.properties,r={},a=0;a<o.length;a++){var s=o[a];r[s.name]=s.strValue}e.push({selector:i?i.toString():"core",css:r})}return e}}(cytoscape),function(e){"use strict";e.style.applyFromString=function(t,n){function i(){l=l.length>r.length?l.substr(r.length):""}function o(){a=a.length>s.length?a.substr(s.length):""}var r,a,s,l=""+n;for(l=l.replace(/[/][*](\s|.)+?[*][/]/g,"");;){var c=l.match(/^\s*$/);if(c)break;var d=l.match(/^\s*((?:.|\s)+?)\s*\{((?:.|\s)+?)\}/);if(!d){e.util.error("Halting stylesheet parsing: String stylesheet contains more to parse but no selector and block found in: "+l);break}r=d[0];var u=d[1];if(new e.Selector(u)._private.invalid&&"core"!==u)e.util.error("Skipping parsing of block: Invalid selector found in string stylesheet: "+u),i();else{var h=d[2],p=!1;a=h;for(var f=[];;){if(c=a.match(/^\s*$/))break;var g=a.match(/^\s*(.+?)\s*:\s*(.+?)\s*;/);if(!g){e.util.error("Skipping parsing of block: Invalid formatting of style property and value definitions found in:"+h),p=!0;break}s=g[0];var v=g[1],m=g[2];(w=e.style.properties[v])?t.parse(v,m)?(f.push({name:v,val:m}),o()):(e.util.error("Skipping property: Invalid property definition in: "+s),o()):(e.util.error("Skipping property: Invalid property name in: "+s),o())}if(p){i();break}t.selector(u);for(var y=0;y<f.length;y++){var w=f[y];t.css(w.name,w.val)}i()}}return t},e.style.fromString=function(t,n){var i=new e.Style(t);return e.style.applyFromString(i,n),i},e.styfn.fromString=function(t){var n=this;return n.resetToDefault(),e.style.applyFromString(n,t),n}}(cytoscape),function(e){"use strict";e.stylesheet=e.Stylesheet=function(){if(!(this instanceof e.Stylesheet))return new e.Stylesheet;this.length=0},e.Stylesheet.prototype.selector=function(e){return this[this.length++]={selector:e,properties:[]},this},e.Stylesheet.prototype.css=function(t,n){var i=this.length-1;if(e.is.string(t))this[i].properties.push({name:t,value:n});else if(e.is.plainObject(t))for(var o=t,r=0;r<e.style.properties.length;r++){var a=e.style.properties[r],s=o[a.name];if(void 0===s&&(s=o[e.util.dash2camel(a.name)]),void 0!==s){var t=a.name,n=s;this[i].properties.push({name:t,value:n})}}return this},e.Stylesheet.prototype.generateStyle=function(t){for(var n=new e.Style(t),i=0;i<this.length;i++){var o=this[i],r=o.selector,a=o.properties;n.selector(r);for(var s=0;s<a.length;s++){var l=a[s];n.css(l.name,l.value)}}return n}}(cytoscape),function(e,t){"use strict";var n=e.is.touch(),i={},o=e.util.copy(i);e.defaults=function(t){i=e.util.extend({},o,t)},e.fn.core=function(t,n){for(var i in t){var o=t[i];e.Core.prototype[i]=o}},e.Core=function(o){if(!(this instanceof e.Core))return new e.Core(o);var r=this,a=(o=e.util.extend({},i,o)).container,s=a?a._cyreg:null;if((s=s||{})&&s.cy){if(a)for(;a.firstChild;)a.removeChild(a.firstChild);s.cy.notify({type:"destroy"}),s={}}var l=s.readies=s.readies||[];a&&(a._cyreg=s),s.cy=r;var c=void 0!==t&&void 0!==a&&!o.headless,d=o;d.layout=e.util.extend({name:c?"grid":"null"},d.layout),d.renderer=e.util.extend({name:c?"canvas":"null"},d.renderer);var u=function(e,t,n){return void 0!==t?t:void 0!==n?n:e},h=this._private={container:d.container,ready:!1,initrender:!1,options:d,elements:[],id2index:{},listeners:[],aniEles:e.Collection(this),scratch:{},layout:null,renderer:null,notificationsEnabled:!0,minZoom:1e-50,maxZoom:1e50,zoomingEnabled:u(!0,d.zoomingEnabled),userZoomingEnabled:u(!0,d.userZoomingEnabled),panningEnabled:u(!0,d.panningEnabled),userPanningEnabled:u(!0,d.userPanningEnabled),boxSelectionEnabled:u(!1,d.boxSelectionEnabled),autolock:u(!1,d.autolock,d.autolockNodes),autoungrabify:u(!1,d.autoungrabify,d.autoungrabifyNodes),autounselectify:u(!1,d.autounselectify),styleEnabled:void 0===d.styleEnabled?c:d.styleEnabled,zoom:e.is.number(d.zoom)?d.zoom:1,pan:{x:e.is.plainObject(d.pan)&&e.is.number(d.pan.x)?d.pan.x:0,y:e.is.plainObject(d.pan)&&e.is.number(d.pan.y)?d.pan.y:0},animation:{current:[],queue:[]},hasCompoundNodes:!1,deferredExecQueue:[]},p=d.selectionType;h.selectionType=void 0===p||"additive"!==p&&"single"!==p?n?"additive":"single":p,e.is.number(d.minZoom)&&e.is.number(d.maxZoom)&&d.minZoom<d.maxZoom?(h.minZoom=d.minZoom,h.maxZoom=d.maxZoom):e.is.number(d.minZoom)&&void 0===d.maxZoom?h.minZoom=d.minZoom:e.is.number(d.maxZoom)&&void 0===d.minZoom&&(h.maxZoom=d.maxZoom),h.styleEnabled&&this.setStyle(d.style),r.initRenderer(e.util.extend({hideEdgesOnViewport:d.hideEdgesOnViewport,hideLabelsOnViewport:d.hideLabelsOnViewport,textureOnViewport:d.textureOnViewport,wheelSensitivity:e.is.number(d.wheelSensitivity)&&d.wheelSensitivity>0?d.wheelSensitivity:1,motionBlur:d.motionBlur,pixelRatio:e.is.number(d.pixelRatio)&&d.pixelRatio>0?d.pixelRatio:"auto"===d.pixelRatio?void 0:1,tapThreshold:u(e.is.touch()?8:4,e.is.touch()?d.touchTapThreshold:d.desktopTapThreshold)},d.renderer)),d.initrender&&(r.on("initrender",d.initrender),r.on("initrender",function(){r._private.initrender=!0})),r.load(d.elements,function(){r.startAnimationLoop(),r._private.ready=!0,e.is.fn(d.ready)&&r.on("ready",d.ready);for(var t=0;t<l.length;t++){var n=l[t];r.on("ready",n)}s&&(s.readies=[]),r.trigger("ready")},d.done)},e.corefn=e.Core.prototype,e.fn.core({isReady:function(){return this._private.ready},ready:function(e){this.isReady()?this.trigger("ready",[],e):this.on("ready",e)},initrender:function(){return this._private.initrender},destroy:function(){this.notify({type:"destroy"});var e=this.container(),t=e.parentNode;return t&&t.removeChild(e),this},getElementById:function(t){var n=this._private.id2index[t];return void 0!==n?this._private.elements[n]:new e.Collection(this)},selectionType:function(){return this._private.selectionType},hasCompoundNodes:function(){return this._private.hasCompoundNodes},styleEnabled:function(){return this._private.styleEnabled},addToPool:function(e){for(var t=this._private.elements,n=this._private.id2index,i=0;i<e.length;i++){var o=e[i],r=o._private.data.id,a=n[r];void 0!==a||(a=t.length,t.push(o),n[r]=a,o._private.index=a)}return this},removeFromPool:function(e){for(var t=this._private.elements,n=this._private.id2index,i=0;i<e.length;i++){var o=e[i]._private.data.id,r=n[o];if(void 0!==r){this._private.id2index[o]=void 0,t.splice(r,1);for(var a=r;a<t.length;a++)n[t[a]._private.data.id]--}}},container:function(){return this._private.container},options:function(){return e.util.copy(this._private.options)},json:function(e){var t={},n=this;return t.elements={},n.elements().each(function(e,n){var i=n.group();t.elements[i]||(t.elements[i]=[]),t.elements[i].push(n.json())}),this._private.styleEnabled&&(t.style=n.style().json()),t.zoomingEnabled=n._private.zoomingEnabled,t.userZoomingEnabled=n._private.userZoomingEnabled,t.zoom=n._private.zoom,t.minZoom=n._private.minZoom,t.maxZoom=n._private.maxZoom,t.panningEnabled=n._private.panningEnabled,t.userPanningEnabled=n._private.userPanningEnabled,t.pan=n._private.pan,t.boxSelectionEnabled=n._private.boxSelectionEnabled,t.layout=n._private.options.layout,t.renderer=n._private.options.renderer,t.hideEdgesOnViewport=n._private.options.hideEdgesOnViewport,t.hideLabelsOnViewport=n._private.options.hideLabelsOnViewport,t.textureOnViewport=n._private.options.textureOnViewport,t.wheelSensitivity=n._private.options.wheelSensitivity,t.motionBlur=n._private.options.motionBlur,t},defer:function(e){var t=this._private,n=t.deferredExecQueue;n.push(e),t.deferredTimeout||(t.deferredTimeout=setTimeout(function(){for(;n.length>0;)n.shift()();t.deferredTimeout=null},0))}})}(cytoscape,"undefined"==typeof window?null:window),function(e,t){"use strict";function n(e){var t=!document||"interactive"!==document.readyState&&"complete"!==document.readyState?n:e;setTimeout(t,9,e)}e.fn.core({add:function(t){var n,i=this;if(e.is.elementOrCollection(t)){var o=t;if(o._private.cy===i)n=o.restore();else{for(var r=[],a=0;a<o.length;a++){var s=o[a];r.push(s.json())}n=new e.Collection(i,r)}}else if(e.is.array(t)){r=t;n=new e.Collection(i,r)}else if(e.is.plainObject(t)&&(e.is.array(t.nodes)||e.is.array(t.edges))){for(var l=t,r=[],c=["nodes","edges"],a=0,d=c.length;a<d;a++){var u=c[a],h=l[u];if(e.is.array(h))for(var p=0,f=h.length;p<f;p++)(g=h[p]).group=u,r.push(g)}n=new e.Collection(i,r)}else{var g=t;n=new e.Element(i,g).collection()}return n},remove:function(t){if(e.is.elementOrCollection(t))t=t;else if(e.is.string(t)){var n=t;t=this.$(n)}return t.remove()},load:function(i,o,r){function a(){s.one("layoutready",function(e){s.notifications(!0),s.trigger(e),s.notify({type:"load",collection:s.elements()}),s.one("load",o),s.trigger("load")}).one("layoutstop",function(){s.one("done",r),s.trigger("done")});var t=e.util.extend({},s._private.options.layout);t.eles=s.$(),s.layout(t)}var s=this,l=s.elements();return l.length>0&&l.remove(),s.notifications(!1),null!=i&&(e.is.plainObject(i)||e.is.array(i))&&s.add(i),t?n(a):a(),this}})}(cytoscape,"undefined"==typeof window?null:window),function(e,t){"use strict";e.fn.core({animated:e.define.animated(),clearQueue:e.define.clearQueue(),delay:e.define.delay(),animate:e.define.animate(),stop:e.define.stop(),addToAnimationPool:function(e){var t=this;t.styleEnabled()&&t._private.aniEles.merge(e)},startAnimationLoop:function(){function n(){e.util.requestAnimationFrame(function(e){i(e),n()})}function i(t){function n(n,i){var s=n._private.animation.current,l=n._private.animation.queue,c=!1;if(0===s.length){var d=l.length>0?l.shift():null;d&&(d.callTime=t,s.push(d))}for(var u=[],h=s.length-1;h>=0;h--)(p=s[h]).started||o(n,p),r(n,p,t,i),p.done&&(u.push(p),s.splice(h,1)),c=!0;for(h=0;h<u.length;h++){var p=u[h],f=p.params.complete;e.is.fn(f)&&f.apply(n,[t])}return i||0!==s.length||0!==l.length||a.push(n),c}t=+new Date;for(var i=l._private.aniEles,a=[],s=0;s<i.length;s++)n(i[s]);var c=n(l,!0);if(i.length>0||c){var d;if(i.length>0){var u=i.updateCompoundBounds();d=u.length>0?i.add(u):i}l.notify({type:"draw",collection:d})}i.unmerge(a)}function o(t,n){var i=e.is.core(t),o=!i,r=t,a=l._private.style;if(o)var s=r._private.position,c={x:s.x,y:s.y},d=a.getValueStyle(r);if(i)var u=l._private.pan,h={x:u.x,y:u.y},p=l._private.zoom;n.started=!0,n.startTime=Date.now(),n.startPosition=c,n.startStyle=d,n.startPan=h,n.startZoom=p}function r(t,n,i,o){var r,c=l._private.style,d=n.properties,u=n.params,h=n.startTime,p=!o;if((r=0===n.duration?1:Math.min(1,(i-h)/n.duration))<0?r=0:r>1&&(r=1),null==d.delay){var f=n.startPosition,g=d.position,v=t._private.position;g&&p&&(a(f.x,g.x)&&(v.x=s(f.x,g.x,r)),a(f.y,g.y)&&(v.y=s(f.y,g.y,r)));var m=n.startPan,y=d.pan,w=t._private.pan,b=null!=y&&o;b&&(a(m.x,y.x)&&(w.x=s(m.x,y.x,r)),a(m.y,y.y)&&(w.y=s(m.y,y.y,r)),t.trigger("pan"));var C=n.startZoom,x=d.zoom,E=null!=x&&o;if(E&&(a(C,x)&&(t._private.zoom=s(C,x,r)),t.trigger("zoom")),(b||E)&&t.trigger("viewport"),d.css&&p)for(var _=d.css,S=0;S<_.length;S++){var k=_[S].name,T=_[S],D=s(n.startStyle[k],T,r);c.overrideBypass(t,k,D)}}return e.is.fn(u.step)&&u.step.apply(t,[i]),r>=1&&(n.done=!0),r}function a(t,n){return null!=t&&null!=n&&(!(!e.is.number(t)||!e.is.number(n))||!(!t||!n))}function s(t,n,i){i<0?i=0:i>1&&(i=1);var o,r;if(o=null!=t.pxValue||null!=t.value?null!=t.pxValue?t.pxValue:t.value:t,r=null!=n.pxValue||null!=n.value?null!=n.pxValue?n.pxValue:n.value:n,e.is.number(o)&&e.is.number(r))return o+(r-o)*i;if(e.is.number(o[0])&&e.is.number(r[0])){var a=o,s=r,l=function(e,t){var n=t-e,o=e;return Math.round(i*n+o)};return[l(a[0],s[0]),l(a[1],s[1]),l(a[2],s[2])]}}var l=this;l.styleEnabled()&&t&&n()}})}(cytoscape,"undefined"==typeof window?null:window),function(e){"use strict";e.fn.core({data:e.define.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0}),removeData:e.define.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0}),scratch:e.define.data({field:"scratch",allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!0}),removeScratch:e.define.removeData({field:"scratch",triggerEvent:!1})})}(cytoscape),function(e){"use strict";e.fn.core({on:e.define.on(),one:e.define.on({unbindSelfOnTrigger:!0}),once:e.define.on({unbindAllBindersOnTrigger:!0}),off:e.define.off(),trigger:e.define.trigger()}),e.corefn.bind=e.corefn.on,e.corefn.unbind=e.corefn.off}(cytoscape),function(e){"use strict";cytoscape.fn.core({png:function(e){var t=this._private.renderer;return e=e||{},t.png(e)}})}(),function(e){"use strict";e.fn.core({layout:function(e){return(this._private.prevLayout=null==e?this._private.prevLayout:this.initLayout(e)).run(),this},makeLayout:function(e){return this.initLayout(e)},initLayout:function(t){if(null!=t)if(null!=t.name){var n=t.name,i=e.extension("layout",n);if(null!=i){t.eles=null!=t.eles?t.eles:this.$(),e.is.string(t.eles)&&(t.eles=this.$(t.eles));var o=new i(e.util.extend({},t,{cy:this}));return e.is.plainObject(o._private)||(o._private={}),o._private.cy=this,o._private.listeners=[],o}e.util.error("Can not apply layout: No such layout `"+n+"` found; did you include its JS file?")}else e.util.error("A `name` must be specified to make a layout");else e.util.error("Layout options must be specified to make a layout")}})}(cytoscape),function(e){"use strict";e.fn.core({notify:function(e){if(this._private.batchingNotify){var t=this._private.batchNotifyEles,n=this._private.batchNotifyTypes;if(e.collection)for(var i=0;i<e.collection.length;i++){var o=e.collection[i];t.ids[o._private.id]||t.push(o)}n.ids[e.type]||n.push(e.type)}else this._private.notificationsEnabled&&this.renderer().notify(e)},notifications:function(e){var t=this._private;if(void 0===e)return t.notificationsEnabled;t.notificationsEnabled=!!e},noNotifications:function(e){this.notifications(!1),e(),this.notifications(!0)},startBatch:function(){var e=this._private;return e.batchingStyle=e.batchingNotify=!0,e.batchStyleEles=[],e.batchNotifyEles=[],e.batchNotifyTypes=[],e.batchStyleEles.ids={},e.batchNotifyEles.ids={},e.batchNotifyTypes.ids={},this},endBatch:function(){var t=this._private;return t.batchingStyle=!1,new e.Collection(this,t.batchStyleEles).updateStyle(),t.batchingNotify=!1,this.notify({type:t.batchNotifyTypes,collection:t.batchNotifyEles}),this},batch:function(e){return this.startBatch(),e(),this.endBatch(),this},batchData:function(e){var t=this;return this.batch(function(){for(var n in e){var i=e[n];t.getElementById(n).data(i)}})}})}(cytoscape),function(e){"use strict";e.fn.core({renderTo:function(e,t,n,i){return this._private.renderer.renderTo(e,t,n,i),this},renderer:function(){return this._private.renderer},forceRender:function(){return this.notify({type:"draw"}),this},resize:function(){return this.notify({type:"resize"}),this.trigger("resize"),this},initRenderer:function(t){var n=this,i=e.extension("renderer",t.name);null!=i?this._private.renderer=new i(e.util.extend({},t,{cy:n,style:n._private.style})):e.util.error("Can not initialise: No such renderer `%s` found; did you include its JS file?",t.name)}})}(cytoscape),function(e){"use strict";e.fn.core({collection:function(t){return e.is.string(t)?this.$(t):e.is.elementOrCollection(t)?t.collection():e.is.array(t)?new e.Collection(this,t):new e.Collection(this)},nodes:function(e){var t=this.$(function(){return this.isNode()});return e?t.filter(e):t},edges:function(e){var t=this.$(function(){return this.isEdge()});return e?t.filter(e):t},$:function(t){var n=new e.Collection(this,this._private.elements);return t?n.filter(t):n}}),e.corefn.elements=e.corefn.filter=e.corefn.$}(cytoscape),function(e){"use strict";e.fn.core({style:function(e){return e&&this.setStyle(e).update(),this._private.style},setStyle:function(t){var n=this._private;return e.is.stylesheet(t)?n.style=t.generateStyle(this):e.is.array(t)?n.style=e.style.fromJson(this,t):e.is.string(t)?n.style=e.style.fromString(this,t):n.style=new e.Style(this),n.style}})}(cytoscape),function(e){"use strict";e.fn.core({autolock:function(e){return void 0===e?this._private.autolock:(this._private.autolock=!!e,this)},autoungrabify:function(e){return void 0===e?this._private.autoungrabify:(this._private.autoungrabify=!!e,this)},autounselectify:function(e){return void 0===e?this._private.autounselectify:(this._private.autounselectify=!!e,this)},panningEnabled:function(e){return void 0===e?this._private.panningEnabled:(this._private.panningEnabled=!!e,this)},userPanningEnabled:function(e){return void 0===e?this._private.userPanningEnabled:(this._private.userPanningEnabled=!!e,this)},zoomingEnabled:function(e){return void 0===e?this._private.zoomingEnabled:(this._private.zoomingEnabled=!!e,this)},userZoomingEnabled:function(e){return void 0===e?this._private.userZoomingEnabled:(this._private.userZoomingEnabled=!!e,this)},boxSelectionEnabled:function(e){return void 0===e?this._private.boxSelectionEnabled:(this._private.boxSelectionEnabled=!!e,this)},pan:function(){var t,n,i,o,r,a=arguments,s=this._private.pan;switch(a.length){case 0:return s;case 1:if(e.is.string(a[0]))return t=a[0],s[t];if(e.is.plainObject(a[0])){if(!this._private.panningEnabled)return this;o=(i=a[0]).x,r=i.y,e.is.number(o)&&(s.x=o),e.is.number(r)&&(s.y=r),this.trigger("pan viewport")}break;case 2:if(!this._private.panningEnabled)return this;t=a[0],n=a[1],"x"!==t&&"y"!==t||!e.is.number(n)||(s[t]=n),this.trigger("pan viewport")}return this.notify({type:"viewport"}),this},panBy:function(t){var n,i,o,r,a,s=arguments,l=this._private.pan;if(!this._private.panningEnabled)return this;switch(s.length){case 1:e.is.plainObject(s[0])&&(r=(o=s[0]).x,a=o.y,e.is.number(r)&&(l.x+=r),e.is.number(a)&&(l.y+=a),this.trigger("pan viewport"));break;case 2:n=s[0],i=s[1],"x"!==n&&"y"!==n||!e.is.number(i)||(l[n]+=i),this.trigger("pan viewport")}return this.notify({type:"viewport"}),this},fit:function(e,t){var n=this.getFitViewport(e,t);if(n){var i=this._private;i.zoom=n.zoom,i.pan=n.pan,this.trigger("pan zoom viewport"),this.notify({type:"viewport"})}return this},getFitViewport:function(t,n){if(e.is.number(t)&&void 0===n&&(n=t,t=void 0),this._private.panningEnabled&&this._private.zoomingEnabled){var i;if(e.is.string(t)){var o=t;t=this.$(o)}else if(e.is.boundingBox(t)){var r=t;(i={x1:r.x1,y1:r.y1,x2:r.x2,y2:r.y2}).w=i.x2-i.x1,i.h=i.y2-i.y1}else e.is.elementOrCollection(t)||(t=this.elements());i=i||t.boundingBox();var a,s=this.width(),l=this.height();return n=e.is.number(n)?n:0,!isNaN(s)&&!isNaN(l)&&s>0&&l>0&&!isNaN(i.w)&&!isNaN(i.h)&&i.w>0&&i.h>0?{zoom:a=(a=(a=Math.min((s-2*n)/i.w,(l-2*n)/i.h))>this._private.maxZoom?this._private.maxZoom:a)<this._private.minZoom?this._private.minZoom:a,pan:{x:(s-a*(i.x1+i.x2))/2,y:(l-a*(i.y1+i.y2))/2}}:void 0}},minZoom:function(t){return void 0===t?this._private.minZoom:(e.is.number(t)&&(this._private.minZoom=t),this)},maxZoom:function(t){return void 0===t?this._private.maxZoom:(e.is.number(t)&&(this._private.maxZoom=t),this)},zoom:function(t){var n,i;if(void 0===t)return this._private.zoom;if(e.is.number(t))i=t;else if(e.is.plainObject(t)){if(i=t.level,t.position){var o=t.position,r=this._private.pan,a=this._private.zoom;n={x:o.x*a+r.x,y:o.y*a+r.y}}else t.renderedPosition&&(n=t.renderedPosition);if(n&&!this._private.panningEnabled)return this}if(!this._private.zoomingEnabled)return this;if(!e.is.number(i)||n&&(!e.is.number(n.x)||!e.is.number(n.y)))return this;if(i=i>this._private.maxZoom?this._private.maxZoom:i,i=i<this._private.minZoom?this._private.minZoom:i,n){var s=this._private.pan,l=this._private.zoom,c=i,d={x:-c/l*(n.x-s.x)+n.x,y:-c/l*(n.y-s.y)+n.y};this._private.zoom=i,this._private.pan=d;var u=s.x!==d.x||s.y!==d.y;this.trigger(" zoom "+(u?" pan ":"")+" viewport ")}else this._private.zoom=i,this.trigger("zoom viewport");return this.notify({type:"viewport"}),this},viewport:function(t){var n=this._private,i=!0,o=!0,r=[],a=!1,s=!1;if(!t)return this;if(e.is.number(t.zoom)||(i=!1),e.is.plainObject(t.pan)||(o=!1),!i&&!o)return this;if(i){var l=t.zoom;l<n.minZoom||l>n.maxZoom||!n.zoomingEnabled?a=!0:(n.zoom=l,r.push("zoom"))}if(o&&(!a||!t.cancelOnFailedZoom)&&n.panningEnabled){var c=t.pan;e.is.number(c.x)&&(n.pan.x=c.x,s=!1),e.is.number(c.y)&&(n.pan.y=c.y,s=!1),s||r.push("pan")}return r.length>0&&(r.push("viewport"),this.trigger(r.join(" ")),this.notify({type:"viewport"})),this},center:function(e){var t=this.getCenterPan(e);return t&&(this._private.pan=t,this.trigger("pan viewport"),this.notify({type:"viewport"})),this},getCenterPan:function(t,n){if(this._private.panningEnabled){if(e.is.string(t)){var i=t;t=this.elements(i)}else e.is.elementOrCollection(t)||(t=this.elements());var o=t.boundingBox(),r=this.width(),a=this.height();return{x:(r-(n=void 0===n?this._private.zoom:n)*(o.x1+o.x2))/2,y:(a-n*(o.y1+o.y2))/2}}},reset:function(){return this._private.panningEnabled&&this._private.zoomingEnabled?(this.viewport({pan:{x:0,y:0},zoom:1}),this):this},width:function(){var e=this._private.container;return e?e.clientWidth:1},height:function(){var e=this._private.container;return e?e.clientHeight:1},extent:function(){var e=this._private.pan,t=this._private.zoom,n=this.renderedExtent(),i={x1:(n.x1-e.x)/t,x2:(n.x2-e.x)/t,y1:(n.y1-e.y)/t,y2:(n.y2-e.y)/t};return i.w=i.x2-i.x1,i.h=i.y2-i.y1,i},renderedExtent:function(){var e=this.width(),t=this.height();return{x1:0,y1:0,x2:e,y2:t,w:e,h:t}}}),e.corefn.centre=e.corefn.center,e.corefn.autolockNodes=e.corefn.autolock,e.corefn.autoungrabifyNodes=e.corefn.autoungrabify}(cytoscape),function(e){"use strict";e.fn.collection=e.fn.eles=function(t,n){for(var i in t){var o=t[i];e.Collection.prototype[i]=o}};var t={prefix:{nodes:"n",edges:"e"},id:{nodes:0,edges:0},generate:function(t,n,i){var o=(e.is.element(n)?n._private:n).group,r=null!=i?i:this.prefix[o]+this.id[o];if(t.getElementById(r).empty())this.id[o]++;else for(;!t.getElementById(r).empty();)r=this.prefix[o]+ ++this.id[o];return r}};e.Element=function(t,n,i){if(!(this instanceof e.Element))return new e.Element(t,n,i);var o=this;if(i=!(void 0!==i&&!i),void 0!==t&&void 0!==n&&e.is.core(t))if("nodes"===n.group||"edges"===n.group){if(this.length=1,this[0]=this,this._private={cy:t,single:!0,data:n.data||{},layoutData:{},position:n.position||{},autoWidth:void 0,autoHeight:void 0,listeners:[],group:n.group,style:{},rstyle:{},styleCxts:[],removed:!0,selected:!!n.selected,selectable:void 0===n.selectable||!!n.selectable,locked:!!n.locked,grabbed:!1,grabbable:void 0===n.grabbable||!!n.grabbable,active:!1,classes:{},animation:{current:[],queue:[]},rscratch:{},scratch:{},edges:[],children:[]},n.renderedPosition){var r=n.renderedPosition,a=t.pan(),s=t.zoom();this._private.position={x:(r.x-a.x)/s,y:(r.y-a.y)/s}}if(e.is.string(n.classes))for(var l=n.classes.split(/\s+/),c=0,d=l.length;c<d;c++){var u=l[c];u&&""!==u&&(o._private.classes[u]=!0)}n.css&&t.style().applyBypass(this,n.css),(void 0===i||i)&&this.restore()}else e.util.error("An element must be of type `nodes` or `edges`; you specified `"+n.group+"`");else e.util.error("An element must have a core reference and parameters set")},e.Collection=function(n,i,o){if(!(this instanceof e.Collection))return new e.Collection(n,i);if(void 0!==n&&e.is.core(n)){var r={},a={},s=!1;if(i){if(i.length>0&&e.is.plainObject(i[0])&&!e.is.element(i[0])){s=!0;for(var l=[],c={},d=0,u=i.length;d<u;d++){var h=i[d];null==h.data&&(h.data={});var p=h.data;if(null==p.id)p.id=t.generate(n,h);else if(0!==n.getElementById(p.id).length||c[p.id])continue;var f=new e.Element(n,h,!1);l.push(f),c[p.id]=!0}i=l}}else i=[];this.length=0;for(var d=0,u=i.length;d<u;d++){var g=i[d];if(g){var v=g._private.data.id;(!o||o.unique&&!r[v])&&(r[v]=g,a[v]=this.length,this[this.length]=g,this.length++)}}this._private={cy:n,ids:r,indexes:a},s&&this.restore()}else e.util.error("A collection must have a reference to the core")},e.elefn=e.elesfn=e.Element.prototype=e.Collection.prototype,e.elesfn.cy=function(){return this._private.cy},e.elesfn.element=function(){return this[0]},e.elesfn.collection=function(){return e.is.collection(this)?this:new e.Collection(this._private.cy,[this])},e.elesfn.unique=function(){return new e.Collection(this._private.cy,this,{unique:!0})},e.elesfn.getElementById=function(t){var n=this._private.cy,i=this._private.ids[t];return i||e.Collection(n)},e.elesfn.json=function(){var t=this.element();if(null!=t){var n=t._private,i=e.util.copy({data:n.data,position:n.position,group:n.group,bypass:n.bypass,removed:n.removed,selected:n.selected,selectable:n.selectable,locked:n.locked,grabbed:n.grabbed,grabbable:n.grabbable,classes:""}),o=[];for(var r in n.classes)n.classes[r]&&o.push(r);for(var a=0;a<o.length;a++){r=o[a];i.classes+=r+(a<o.length-1?" ":"")}return i}},e.elesfn.jsons=function(){for(var e=[],t=0;t<this.length;t++){var n=this[t].json();e.push(n)}return e},e.elesfn.clone=function(){for(var t=this.cy(),n=[],i=0;i<this.length;i++){var o=this[i].json(),r=new e.Element(t,o,!1);n.push(r)}return new e.Collection(t,n)},e.elesfn.restore=function(n){var i=this,o=[],r=i.cy();void 0===n&&(n=!0);for(var a=[],s=[],l=[],c=0,d=0,u=i.length;d<u;d++)(h=i[d]).isNode()?(s.push(h),c++):(l.push(h),0);for(var d=0,u=(a=s.concat(l)).length;d<u;d++){var h=a[d];if(h.removed()){var p=h._private;if(void 0===(S=p.data).id)S.id=t.generate(r,h);else{if(e.is.emptyString(S.id)||!e.is.string(S.id)){e.util.error("Can not create element with invalid string ID `"+S.id+"`");continue}if(0!==r.getElementById(S.id).length){e.util.error("Can not create second element with ID `"+S.id+"`");continue}}var f=S.id;if(h.isEdge()){for(var g=h,v=["source","target"],m=v.length,y=!1,w=0;w<m;w++){var b=v[w],C=S[b];null==C||""===C?(e.util.error("Can not create edge `"+f+"` with unspecified "+b),y=!0):r.getElementById(C).empty()&&(e.util.error("Can not create edge `"+f+"` with nonexistant "+b+" `"+C+"`"),y=!0)}if(y)continue;var x=r.getElementById(S.source),E=r.getElementById(S.target);x._private.edges.push(g),E._private.edges.push(g),g._private.source=x,g._private.target=E}p.ids={},p.ids[f]=h,p.removed=!1,r.addToPool(h),o.push(h)}}for(d=0;d<c;d++){var _=a[d],S=_._private.data,k=_._private.data.parent;if(null!=k){var T=r.getElementById(k);if(T.empty())S.parent=void 0;else{for(var D=!1,R=T;!R.empty();){if(_.same(R)){D=!0,S.parent=void 0;break}R=R.parent()}D||(T[0]._private.children.push(_),_._private.parent=T[0],r._private.hasCompoundNodes=!0)}}}return(o=new e.Collection(r,o)).length>0&&(o.add(o.connectedNodes()).add(o.parent()).updateStyle(n),n?o.rtrigger("add"):o.trigger("add")),i},e.elesfn.removed=function(){var e=this[0];return e&&e._private.removed},e.elesfn.inside=function(){var e=this[0];return e&&!e._private.removed},e.elesfn.remove=function(t){function n(e){for(var t=e._private.edges,n=0;n<t.length;n++)o(t[n])}function i(e){for(var t=e._private.children,n=0;n<t.length;n++)o(t[n])}function o(e){c[e.id()]||(c[e.id()]=!0,e.isNode()?(l.push(e),n(e),i(e)):l.unshift(e))}function r(e,t){for(var n=e._private.edges,i=0;i<n.length;i++)if(t===n[i]){n.splice(i,1);break}}var a=this,s=[],l=[],c={},d=a._private.cy;void 0===t&&(t=!0);for(var u=0,h=a.length;u<h;u++)o(y=a[u]);for(u=0;u<l.length;u++)if((y=l[u])._private.removed=!0,d.removeFromPool(y),s.push(y),y.isEdge()){var p=y.source()[0],f=y.target()[0];r(p,y),r(f,y)}else 0!==(C=y.parent()).length&&function(e,t){t=t[0];for(var n=(e=e[0])._private.children,i=0;i<n.length;i++)if(n[i][0]===t[0]){n.splice(i,1);break}}(C,y);var g=d._private.elements;d._private.hasCompoundNodes=!1;for(u=0;u<g.length;u++)if((y=g[u]).isParent()){d._private.hasCompoundNodes=!0;break}var v=new e.Collection(this.cy(),s);v.size()>0&&(t&&this.cy().notify({type:"remove",collection:v}),v.trigger("remove"));for(var m={},u=0;u<l.length;u++){var y=l[u],w="nodes"===y._private.group,b=y._private.data.parent;if(w&&void 0!==b&&!m[b]){m[b]=!0;var C=d.getElementById(b);C&&0!==C.length&&!C._private.removed&&0===C.children().length&&C.updateStyle()}}return this},e.elesfn.move=function(e){var t=this._private.cy;if(void 0!==e.source||void 0!==e.target){var n=e.source,i=e.target,o=t.getElementById(n).length>0,r=t.getElementById(i).length>0;if(o||r){s=this.jsons();this.remove();for(d=0;d<s.length;d++)"edges"===(u=s[d]).group&&(o&&(u.data.source=n),r&&(u.data.target=i));return t.add(s)}}else if(void 0!==e.parent){var a=e.parent;if(null===a||t.getElementById(a).length>0){var s=this.jsons(),l=this.descendants(),c=l.merge(l.add(this).connectedEdges());this.remove();for(var d=0;d<this.length;d++){var u=s[d];"nodes"===u.group&&(u.data.parent=null===a?void 0:a)}}return t.add(s).merge(c.restore())}return this}}(cytoscape),function(e){"use strict";e.fn.eles({stdBreadthFirstSearch:function(t){return t=e.util.extend({},t,{std:!0}),this.breadthFirstSearch(t)},breadthFirstSearch:function(t,n,i){var o,r,a;e.is.plainObject(t)&&!e.is.elementOrCollection(t)&&(t=(o=t).roots,n=o.visit,i=o.directed,r=o.std,a=o.thisArg),i=2!==arguments.length||e.is.fn(n)?i:n,n=e.is.fn(n)?n:function(){};for(var s,l=this._private.cy,c=e.is.string(t)?this.filter(t):t,d=[],u=[],h={},p={},f={},g=0,v=this.nodes(),m=this.edges(),y=0;y<c.length;y++)c[y].isNode()&&(d.unshift(c[y]),f[c[y].id()]=!0,u.push(c[y]),p[c[y].id()]=0);for(;0!==d.length;){var w,b=p[(c=d.shift()).id()],C=h[c.id()],x=null==C?void 0:C.connectedNodes().not(c)[0];if(!0===(w=r?n.call(a,c,C,x,g++,b):n.call(c,g++,b,c,C,x))){s=c;break}if(!1===w)break;for(var E=c.connectedEdges(i?function(){return this.data("source")===c.id()}:void 0).intersect(m),y=0;y<E.length;y++){var _=E[y],S=_.connectedNodes(function(){return this.id()!==c.id()}).intersect(v);0===S.length||f[S.id()]||(S=S[0],d.push(S),f[S.id()]=!0,p[S.id()]=p[c.id()]+1,u.push(S),h[S.id()]=_)}}for(var k=[],y=0;y<u.length;y++){var T=u[y],D=h[T.id()];D&&k.push(D),k.push(T)}return{path:new e.Collection(l,k,{unique:!0}),found:new e.Collection(l,s,{unique:!0})}},stdDepthFirstSearch:function(t){return t=e.util.extend({},t,{std:!0}),this.depthFirstSearch(t)},depthFirstSearch:function(t,n,i){var o,r,a;e.is.plainObject(t)&&!e.is.elementOrCollection(t)&&(t=(o=t).roots,n=o.visit,i=o.directed,r=o.std,a=o.thisArg),i=2!==arguments.length||e.is.fn(n)?i:n,n=e.is.fn(n)?n:function(){};for(var s,l=this._private.cy,c=e.is.string(t)?this.filter(t):t,d=[],u=[],h={},p={},f={},g=0,v=this.edges(),m=this.nodes(),y=0;y<c.length;y++)c[y].isNode()&&(d.push(c[y]),u.push(c[y]),p[c[y].id()]=0);for(;0!==d.length;)if(!f[(c=d.pop()).id()]){f[c.id()]=!0;var w,b=p[c.id()],C=h[c.id()],x=null==C?void 0:C.connectedNodes().not(c)[0];if(!0===(w=r?n.call(a,c,C,x,g++,b):n.call(c,g++,b,c,C,x))){s=c;break}if(!1===w)break;for(var E=c.connectedEdges(i?function(){return this.data("source")===c.id()}:void 0).intersect(v),y=0;y<E.length;y++){var _=E[y],S=_.connectedNodes(function(){return this.id()!==c.id()}).intersect(m);0===S.length||f[S.id()]||(S=S[0],d.push(S),p[S.id()]=p[c.id()]+1,u.push(S),h[S.id()]=_)}}for(var k=[],y=0;y<u.length;y++){var T=u[y],D=h[T.id()];D&&k.push(D),k.push(T)}return{path:new e.Collection(l,k,{unique:!0}),found:new e.Collection(l,s,{unique:!0})}},kruskal:function(t){function n(e){for(var t=0;t<o.length;t++){var n=o[t];if(n.anySame(e))return{eles:n,index:t}}}t=e.is.fn(t)?t:function(){return 1};for(var i=new e.Collection(this._private.cy,[]),o=[],r=this.nodes(),a=0;a<r.length;a++)o.push(r[a].collection());for(var s=this.edges().toArray().sort(function(e,n){return t.call(e,e)-t.call(n,n)}),a=0;a<s.length;a++){var l=s[a],c=l.source()[0],d=l.target()[0],u=n(c),h=n(d);u.index!==h.index&&(i=i.add(l),o[u.index]=u.eles.add(h.eles),o.splice(h.index,1))}return r.add(i)},dijkstra:function(t,n,i){var o;e.is.plainObject(t)&&!e.is.elementOrCollection(t)&&(t=(o=t).root,n=o.weight,i=o.directed);var r=this._private.cy;i=e.is.fn(n)?i:n,n=e.is.fn(n)?n:function(){return 1};for(var a=e.is.string(t)?this.filter(t).eq(0):t.eq(0),s={},l={},c={},d=this.edges().filter(function(){return!this.isLoop()}),u=this.nodes(),h=[],p=0;p<u.length;p++)s[u[p].id()]=u[p].same(a)?0:1/0,h.push(u[p]);h=new e.Collection(r,h);for(var f=e.Minheap(r,h,function(e){return s[e.id()]});f.size()>0;){var g=f.pop(),v=g.value,m=g.id,y=r.getElementById(m);if(c[m]=v,v===Math.Infinite)break;for(var w=y.neighborhood().intersect(u),p=0;p<w.length;p++){var b=w[p],C=b.id(),x=function(e,t){for(var o,r=(i?e.edgesTo(t):e.edgesWith(t)).intersect(d),a=1/0,s=0;s<r.length;s++){var l=r[s],c=n.apply(l,[l]);(c<a||!o)&&(a=c,o=l)}return{edge:o,dist:a}}(y,b),E=v+x.dist;E<f.getValueById(C)&&(f.edit(C,E),l[C]={node:y,edge:x.edge})}}return{distanceTo:function(t){var n=e.is.string(t)?u.filter(t).eq(0):t.eq(0);return c[n.id()]},pathTo:function(t){var n=e.is.string(t)?u.filter(t).eq(0):t.eq(0),i=[],o=n;if(n.length>0)for(i.unshift(n);l[o.id()];){var a=l[o.id()];i.unshift(a.edge),i.unshift(a.node),o=a.node}return new e.Collection(r,i)}}}}),e.elesfn.bfs=e.elesfn.breadthFirstSearch,e.elesfn.dfs=e.elesfn.depthFirstSearch,e.elesfn.stdBfs=e.elesfn.stdBreadthFirstSearch,e.elesfn.stdDfs=e.elesfn.stdDepthFirstSearch}(cytoscape),function(e){"use strict";e.fn.eles({aStar:function(t){var n=function(){o&&console.log.apply(console,arguments)},i=function(e,t,n,o){if(e==t)return o.push(r.getElementById(t)),o;if(t in n){var a=n[t],s=f[t];return o.push(r.getElementById(t)),o.push(r.getElementById(s)),i(e,a,n,o)}};if(null!=(t=t||{}).debug)o=t.debug;else var o=!1;n("Starting aStar...");var r=this._private.cy;if(null!=t&&null!=t.root){var a=e.is.string(t.root)?this.filter(t.root)[0]:t.root[0];if(n("Source node: %s",a.id()),null!=t.goal){var s=e.is.string(t.goal)?this.filter(t.goal)[0]:t.goal[0];if(n("Target node: %s",s.id()),null!=t.heuristic&&e.is.fn(t.heuristic))l=t.heuristic;else var l=function(){return 0};if(null!=t.weight&&e.is.fn(t.weight))c=t.weight;else var c=function(e){return 1};if(null!=t.directed)d=t.directed;else var d=!1;var u=[],h=[a.id()],p={},f={},g={},v={};g[a.id()]=0,v[a.id()]=l(a);for(var m=this.edges().not(":loop"),y=this.nodes(),w=0;h.length>0;){var b=function(e,t){if(0!==e.length){for(var n=0,i=t[e[0]],o=1;o<e.length;o++){var r=t[e[o]];r<i&&(i=r,n=o)}return n}}(h,v),C=this.filter("#"+h[b])[0];if(w++,n("\nStep: %s",w),n("Processing node: %s, fScore = %s",C.id(),v[C.id()]),C.id()==s.id()){n("Found goal node!");var x=i(a.id(),s.id(),p,[]);return x.reverse(),n("Path: %s",x),{found:!0,distance:g[C.id()],path:new e.Collection(r,x),steps:w}}u.push(C.id()),h.splice(b,1),n("Added node to closedSet, removed from openSet."),n("Processing neighbors...");for(var E=C.connectedEdges(d?'[source = "'+C.id()+'"]':void 0).intersect(m),_=0;_<E.length;_++){var S=E[_],k=S.connectedNodes('[id != "'+C.id()+'"]').intersect(y);if(n("   processing neighbor: %s",k.id()),-1==u.indexOf(k.id())){var T=g[C.id()]+c.apply(S,[S]);n("   tentative gScore: %d",T),-1!=h.indexOf(k.id())?T<g[k.id()]&&(g[k.id()]=T,v[k.id()]=T+l(k),p[k.id()]=C.id(),n("   better score, replacing gScore. "),n("   fScore(%s) = %s",k.id(),T)):(g[k.id()]=T,v[k.id()]=T+l(k),h.push(k.id()),p[k.id()]=C.id(),f[k.id()]=S.id(),n("   not in openSet, adding it. "),n("   fScore(%s) = %s",k.id(),T))}else n("   already in closedSet, ignoring it.")}}return n("Reached end of computation without finding our goal"),{found:!1,distance:void 0,path:void 0,steps:w}}}},floydWarshall:function(t){if(null!=(t=t||{}).debug)n=t.debug;else var n=!1;!function(){n&&console.log.apply(console,arguments)}("Starting floydWarshall...");var i=this._private.cy;if(null!=t.weight&&e.is.fn(t.weight))o=t.weight;else var o=function(e){return 1};if(null!=t.directed)r=t.directed;else var r=!1;for(var a=this.edges().not(":loop"),s=this.nodes(),l=s.length,c={},d=0;d<l;d++)c[s[d].id()]=d;for(var u=[],d=0;d<l;d++){for(var h=new Array(l),p=0;p<l;p++)h[p]=d==p?0:1/0;u.push(h)}var f=[],g=[],v=function(e){for(var t=0;t<l;t++){for(var n=new Array(l),i=0;i<l;i++)n[i]=void 0;e.push(n)}};v(f),v(g);for(d=0;d<a.length;d++){var m=c[a[d].source().id()],y=c[a[d].target().id()],w=o.apply(a[d],[a[d]]);u[m][y]>w&&(u[m][y]=w,f[m][y]=y,g[m][y]=a[d])}if(!r)for(d=0;d<a.length;d++){var m=c[a[d].target().id()],y=c[a[d].source().id()],w=o.apply(a[d],[a[d]]);u[m][y]>w&&(u[m][y]=w,f[m][y]=y,g[m][y]=a[d])}for(var b=0;b<l;b++)for(d=0;d<l;d++)for(p=0;p<l;p++)u[d][b]+u[b][p]<u[d][p]&&(u[d][p]=u[d][b]+u[b][p],f[d][p]=f[d][b]);for(var C=[],d=0;d<l;d++)C.push(s[d].id());return{distance:function(t,n){if(e.is.string(t))o=i.filter(t)[0].id();else var o=t.id();if(e.is.string(n))r=i.filter(n)[0].id();else var r=n.id();return u[c[o]][c[r]]},path:function(t,n){if(e.is.string(t))o=i.filter(t)[0].id();else var o=t.id();if(e.is.string(n))r=i.filter(n)[0].id();else var r=n.id();var a=function(e,t,n,o,r){if(e===t)return i.getElementById(o[e]);if(void 0!==n[e][t]){for(var a=[i.getElementById(o[e])],s=e;e!==t;){s=e,e=n[e][t];var l=r[s][e];a.push(l),a.push(i.getElementById(o[e]))}return a}}(c[o],c[r],f,C,g);return new e.Collection(i,a)}}},bellmanFord:function(t){var n=function(){i&&console.log.apply(console,arguments)};if(null!=(t=t||{}).debug)i=t.debug;else var i=!1;if(n("Starting bellmanFord..."),null!=t.weight&&e.is.fn(t.weight))o=t.weight;else var o=function(e){return 1};if(null!=t.directed)r=t.directed;else var r=!1;if(null!=t.root){if(e.is.string(t.root))a=this.filter(t.root)[0];else var a=t.root[0];n("Source node: %s",a.id());for(var s=this._private.cy,l=this.edges().not(":loop"),c=this.nodes(),d=c.length,u={},h=0;h<d;h++)u[c[h].id()]=h;for(var p=[],f=[],g=[],h=0;h<d;h++)c[h].id()===a.id()?p[h]=0:p[h]=1/0,f[h]=void 0;for(var v=!1,h=1;h<d;h++){v=!1;for(C=0;C<l.length;C++){var m=u[l[C].source().id()],y=u[l[C].target().id()],w=o.apply(l[C],[l[C]]),b=p[m]+w;b<p[y]&&(p[y]=b,f[y]=m,g[y]=l[C],v=!0),r||(b=p[y]+w)<p[m]&&(p[m]=b,f[m]=y,g[m]=l[C],v=!0)}if(!v)break}if(v)for(var C=0;C<l.length;C++){var m=u[l[C].source().id()],y=u[l[C].target().id()],w=o.apply(l[C],[l[C]]);if(p[m]+w<p[y])return e.util.error("Error: graph contains a negative weigth cycle!"),{pathTo:void 0,distanceTo:void 0,hasNegativeWeightCycle:!0}}for(var x=[],h=0;h<d;h++)x.push(c[h].id());return{distanceTo:function(t){if(e.is.string(t))n=s.filter(t)[0].id();else var n=t.id();return p[u[n]]},pathTo:function(t){if(e.is.string(t))n=s.filter(t)[0].id();else var n=t.id();var i=[],o=function(e,t,n,i,o,r){for(;;){if(o.push(s.getElementById(i[n])),o.push(r[n]),t===n)return o;var a=e[n];if(void 0===a)return;n=a}}(f,u[a.id()],u[n],x,i,g);return null!=o&&o.reverse(),new e.Collection(s,o)},hasNegativeWeightCycle:!1}}e.util.error("options.root required")},kargerStein:function(t){var n=function(e,t,n){for(var i=n[e],o=i[1],r=i[2],a=t[o],s=t[r],l=n.filter(function(e){return(t[e[1]]!==a||t[e[2]]!==s)&&(t[e[1]]!==s||t[e[2]]!==a)}),c=0;c<l.length;c++){var d=l[c];d[1]===s?(l[c]=d.slice(0),l[c][1]=a):d[2]===s&&(l[c]=d.slice(0),l[c][2]=a)}for(c=0;c<t.length;c++)t[c]===s&&(t[c]=a);return l},i=function(e,t,o,r){if(o<=r)return t;var a=Math.floor(Math.random()*t.length),s=n(a,e,t);return i(e,s,o-1,r)};if(null!=(t=t||{})&&null!=t.debug)o=t.debug;else var o=!1;!function(){o&&console.log.apply(console,arguments)}("Starting kargerStein...");var r=this._private.cy,a=this.edges().not(":loop"),s=this.nodes(),l=s.length,c=a.length,d=Math.ceil(Math.pow(Math.log(l)/Math.LN2,2)),u=Math.floor(l/Math.sqrt(2));if(!(l<2)){for(var h={},p=0;p<l;p++)h[s[p].id()]=p;for(var f=[],p=0;p<c;p++){var g=a[p];f.push([p,h[g.source().id()],h[g.target().id()]])}for(var v,m=1/0,y=[],p=0;p<l;p++)y.push(p);for(var w=0;w<=d;w++){var b=y.slice(0),C=i(b,f,l,u),x=b.slice(0),E=i(b,C,u,2),_=i(x,C,u,2);E.length<=_.length&&E.length<m?(m=E.length,v=[E,b]):_.length<=E.length&&_.length<m&&(m=_.length,v=[_,x])}for(var S=v[0].map(function(e){return a[e[0]]}),k=[],T=[],D=v[1][0],p=0;p<v[1].length;p++)v[1][p]===D?k.push(s[p]):T.push(s[p]);return{cut:new e.Collection(r,S),partition1:new e.Collection(r,k),partition2:new e.Collection(r,T)}}e.util.error("At least 2 nodes are required for KargerSteing algorithm!")},pageRank:function(t){var n=function(){i&&console.log.apply(console,arguments)};if(null!=(t=t||{})&&null!=t.debug)i=t.debug;else var i=!1;if(n("Starting pageRank..."),null!=t&&null!=t.dampingfactor)o=t.dampingFactor;else var o=.8;if(null!=t&&null!=t.precision)r=t.precision;else var r=1e-6;if(null!=t&&null!=t.iterations)a=t.iterations;else var a=200;if(null!=t&&null!=t.weight&&e.is.fn(t.weight))s=t.weight;else var s=function(e){return 1};for(var l=this._private.cy,c=this.edges().not(":loop"),d=this.nodes(),u=d.length,h=c.length,p={},f=0;f<u;f++)p[d[f].id()]=f;for(var g=[],v=[],m=(1-o)/u,f=0;f<u;f++){for(var y=[],w=0;w<u;w++)y.push(0);g.push(y),v.push(0)}for(f=0;f<h;f++){var b=c[f],C=p[b.source().id()],x=p[b.target().id()],E=s.apply(b,[b]);g[x][C]+=E,v[C]+=E}for(var _=1/u+m,w=0;w<u;w++)if(0===v[w])for(f=0;f<u;f++)g[f][w]=_;else for(f=0;f<u;f++)g[f][w]=g[f][w]/v[w]+m;for(var S,k=[],T=[],f=0;f<u;f++)k.push(1),T.push(0);for(var D=0;D<a;D++){for(var R=T.slice(0),f=0;f<u;f++)for(w=0;w<u;w++)R[f]+=g[f][w]*k[w];!function(e){for(var t=e.length,n=0,i=0;i<t;i++)n+=e[i];for(i=0;i<t;i++)e[i]=e[i]/n}(R),S=k,k=R;for(var P=0,f=0;f<u;f++)P+=Math.pow(S[f]-k[f],2);if(P<r){n("Stoped at iteration %s",D);break}}return n("Result:\n"+k),{rank:function(t){if(e.is.string(t))n=l.filter(t)[0].id();else var n=t.id();return k[p[n]]}}}})}(cytoscape),function(e){"use strict";e.fn.eles({animated:e.define.animated(),clearQueue:e.define.clearQueue(),delay:e.define.delay(),animate:e.define.animate(),stop:e.define.stop()})}(cytoscape),function(e){"use strict";e.fn.eles({classes:function(t){var n,i=this,o=[];if(e.is.fn(t))n=t;else if(!e.is.plainObject(t))return this;for(var r=0;r<i.length;r++){var a=i[r],s=!1;if((t=n?n.apply(a,[r,a]):t).add)for(d=0;d<t.add.length;d++){var l=t.add[d],c=a._private.classes[l];a._private.classes[l]=!0,c||s||(o.push(a),s=!0)}if(t.remove)for(d=0;d<t.remove.length;d++){var l=t.remove[d],c=a._private.classes[l];a._private.classes[l]=!1,c&&!s&&(o.push(a),s=!0)}if(t.toggle)for(var d=0;d<t.toggle.length;d++){var l=t.toggle[d],c=a._private.classes[l];a._private.classes[l]=!c,s||(o.push(a),s=!0)}}return o.length>0&&new e.Collection(this.cy(),o).updateStyle().trigger("class"),this},addClass:function(t){t=t.split(/\s+/);for(var n=this,i=[],o=0;o<t.length;o++){var r=t[o];if(!e.is.emptyString(r))for(var a=0;a<n.length;a++){var s=n[a],l=s._private.classes[r];s._private.classes[r]=!0,l||i.push(s)}}return i.length>0&&new e.Collection(this._private.cy,i).updateStyle().trigger("class"),n},hasClass:function(e){var t=this[0];return!(null==t||!t._private.classes[e])},toggleClass:function(t,n){for(var i=t.split(/\s+/),o=this,r=[],a=0,s=o.length;a<s;a++)for(var l=o[a],c=0;c<i.length;c++){var d=i[c];if(!e.is.emptyString(d)){var u=l._private.classes[d];n||void 0===n&&!u?(l._private.classes[d]=!0,u||r.push(l)):(l._private.classes[d]=!1,u&&r.push(l))}}return r.length>0&&new e.Collection(this._private.cy,r).updateStyle().trigger("class"),o},removeClass:function(t){t=t.split(/\s+/);for(var n=this,i=[],o=0;o<n.length;o++)for(var r=n[o],a=0;a<t.length;a++){var s=t[a];if(s&&""!==s){var l=r._private.classes[s];r._private.classes[s]=void 0,l&&i.push(r)}}return i.length>0&&new e.Collection(n._private.cy,i).updateStyle(),n.trigger("class"),n},flashClass:function(e,t){var n=this;if(null==t)t=250;else if(0===t)return n;return n.addClass(e),setTimeout(function(){n.removeClass(e)},t),n}})}(cytoscape),function(e){"use strict";cytoscape.fn.eles({allAre:function(e){return this.filter(e).length===this.length},is:function(e){return this.filter(e).length>0},some:function(e,t){for(var n=0;n<this.length;n++)if(e.apply(t,[this[n],n,this]))return!0;return!1},every:function(e,t){for(var n=0;n<this.length;n++)if(!e.apply(t,[this[n],n,this]))return!1;return!0},same:function(e){return e=this.cy().collection(e),this.length===e.length&&this.intersect(e).length===this.length},anySame:function(e){return e=this.cy().collection(e),this.intersect(e).length>0},allAreNeighbors:function(e){return e=this.cy().collection(e),this.neighborhood().intersect(e).length===e.length}})}(),function(e){"use strict";e.fn.eles({parent:function(t){for(var n=[],i=this._private.cy,o=0;o<this.length;o++){var r=this[o],a=i.getElementById(r._private.data.parent);a.size()>0&&n.push(a)}return new e.Collection(i,n,{unique:!0}).filter(t)},parents:function(t){for(var n=[],i=this.parent();i.nonempty();){for(var o=0;o<i.length;o++){var r=i[o];n.push(r)}i=i.parent()}return new e.Collection(this.cy(),n,{unique:!0}).filter(t)},commonAncestors:function(e){for(var t,n=0;n<this.length;n++){var i=this[n].parents();t=(t=t||i).intersect(i)}return t.filter(e)},orphans:function(e){return this.stdFilter(function(e){return e.isNode()&&e.parent().empty()}).filter(e)},nonorphans:function(e){return this.stdFilter(function(e){return e.isNode()&&e.parent().nonempty()}).filter(e)},children:function(t){for(var n=[],i=0;i<this.length;i++){var o=this[i];n=n.concat(o._private.children)}return new e.Collection(this.cy(),n,{unique:!0}).filter(t)},siblings:function(e){return this.parent().children().not(this).filter(e)},isParent:function(){var e=this[0];if(e)return 0!==e._private.children.length},isChild:function(){var e=this[0];if(e)return void 0!==e._private.data.parent&&0!==e.parent().length},descendants:function(t){function n(e){for(var t=0;t<e.length;t++){var o=e[t];i.push(o),o.children().nonempty()&&n(o.children())}}var i=[];return n(this.children()),new e.Collection(this.cy(),i,{unique:!0}).filter(t)}}),e.elesfn.ancestors=e.elesfn.parents}(cytoscape),function(e){"use strict";e.fn.eles({data:e.define.data({field:"data",bindingEvent:"data",allowBinding:!0,allowSetting:!0,settingEvent:"data",settingTriggersEvent:!0,triggerFnName:"trigger",allowGetting:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),removeData:e.define.removeData({field:"data",event:"data",triggerFnName:"trigger",triggerEvent:!0,immutableKeys:{id:!0,source:!0,target:!0,parent:!0},updateStyle:!0}),scratch:e.define.data({field:"scratch",allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!0}),removeScratch:e.define.removeData({field:"scratch",triggerEvent:!1}),rscratch:e.define.data({field:"rscratch",allowBinding:!1,allowSetting:!0,settingTriggersEvent:!1,allowGetting:!0}),removeRscratch:e.define.removeData({field:"rscratch",triggerEvent:!1}),id:function(){var e=this[0];if(e)return e._private.data.id},position:e.define.data({field:"position",bindingEvent:"position",allowBinding:!0,allowSetting:!0,settingEvent:"position",settingTriggersEvent:!0,triggerFnName:"rtrigger",allowGetting:!0,validKeys:["x","y"],onSet:function(e){e.updateCompoundBounds().rtrigger("position")},canSet:function(e){return!e.locked()}}),silentPosition:e.define.data({field:"position",bindingEvent:"position",allowBinding:!1,allowSetting:!0,settingEvent:"position",settingTriggersEvent:!1,triggerFnName:"trigger",allowGetting:!0,validKeys:["x","y"],onSet:function(e){e.updateCompoundBounds()},canSet:function(e){return!e.locked()}}),positions:function(t,n){if(e.is.plainObject(t))this.position(t);else if(e.is.fn(t)){for(var i=t,o=0;o<this.length;o++){var r=this[o];if((t=i.apply(r,[o,r]))&&!r.locked()){var a=r._private.position;a.x=t.x,a.y=t.y}}var s=this.updateCompoundBounds(),l=s.length>0?this.add(s):this;n?l.trigger("position"):l.rtrigger("position")}return this},silentPositions:function(e){return this.positions(e,!0)},updateCompoundBounds:function(){var t=this.cy();if(!t.styleEnabled()||!t.hasCompoundNodes())return t.collection();for(var n=[],i=this.parent();i.nonempty();){for(var o=0;o<i.length;o++)!function(e){var t=e.children(),i=e._private.style,o=t.boundingBox({includeLabels:!1,includeEdges:!1}),r={top:i["padding-top"].pxValue,bottom:i["padding-bottom"].pxValue,left:i["padding-left"].pxValue,right:i["padding-right"].pxValue},a=e._private.position,s=!1;"auto"===i.width.value&&(e._private.autoWidth=o.w+r.left+r.right,a.x=(o.x1+o.x2-r.left+r.right)/2,s=!0),"auto"===i.height.value&&(e._private.autoHeight=o.h+r.top+r.bottom,a.y=(o.y1+o.y2-r.top+r.bottom)/2,s=!0),s&&n.push(e)}(i[o]);i=i.parent()}return new e.Collection(t,n)},renderedPosition:function(t,n){var i=this[0],o=this.cy(),r=o.zoom(),a=o.pan(),s=e.is.plainObject(t)?t:void 0,l=void 0!==s||void 0!==n&&e.is.string(t);if(i&&i.isNode()){if(!l){var c=i._private.position;return s={x:c.x*r+a.x,y:c.y*r+a.y},void 0===t?s:s[t]}for(var d=0;d<this.length;d++){i=this[d];void 0!==n?i._private.position[t]=(n-a[t])/r:void 0!==s&&(i._private.position={x:(s.x-a.x)/r,y:(s.y-a.y)/r})}this.rtrigger("position")}else if(!l)return;return this},parentPosition:function(t,n){var i=this[0],o=this.cy(),r=e.is.plainObject(t)?t:void 0,a=void 0!==r||void 0!==n&&e.is.string(t),s=o.hasCompoundNodes();if(i&&i.isNode()){if(!a){var l=i._private.position,c=s?i.parent():null,d=c&&c.length>0,u=d;d&&(c=c[0]);p=u?c._private.position:{x:0,y:0};return r={x:l.x-p.x,y:l.y-p.y},void 0===t?r:r[t]}for(var h=0;h<this.length;h++){var i=this[h],u=d=(c=s?i.parent():null)&&c.length>0;d&&(c=c[0]);var p=u?c._private.position:{x:0,y:0};void 0!==n?i._private.position[t]=n+p[t]:void 0!==r&&(i._private.position={x:r.x+p.x,y:r.y+p.y})}this.rtrigger("position")}else if(!a)return;return this},width:function(){var e=this[0],t=e._private.cy._private.styleEnabled;if(e){if(t){var n=e._private.style.width;return"auto"===n.strValue?e._private.autoWidth:n.pxValue}return 1}},outerWidth:function(){var e=this[0],t=e._private.cy._private.styleEnabled;if(e){if(t){var n=e._private.style;return("auto"===n.width.strValue?e._private.autoWidth:n.width.pxValue)+(n["border-width"]?1*n["border-width"].pxValue+0:0)}return 1}},renderedWidth:function(){var e=this[0];if(e)return e.width()*this.cy().zoom()},renderedOuterWidth:function(){var e=this[0];if(e)return e.outerWidth()*this.cy().zoom()},height:function(){var e=this[0],t=e._private.cy._private.styleEnabled;if(e&&"nodes"===e._private.group){if(t){var n=e._private.style.height;return"auto"===n.strValue?e._private.autoHeight:n.pxValue}return 1}},outerHeight:function(){var e=this[0],t=e._private.cy._private.styleEnabled;if(e&&"nodes"===e._private.group){if(!t)return 1;var n=e._private.style;return("auto"===n.height.strValue?e._private.autoHeight:n.height.pxValue)+(n["border-width"]?1*n["border-width"].pxValue+0:0)}},renderedHeight:function(){var e=this[0];if(e&&"nodes"===e._private.group)return e.height()*this.cy().zoom()},renderedOuterHeight:function(){var e=this[0];if(e&&"nodes"===e._private.group)return e.outerHeight()*this.cy().zoom()},renderedBoundingBox:function(e){var t=this.boundingBox(e),n=this.cy(),i=n.zoom(),o=n.pan(),r=t.x1*i+o.x,a=t.x2*i+o.x,s=t.y1*i+o.y,l=t.y2*i+o.y;return{x1:r,x2:a,y1:s,y2:l,w:a-r,h:l-s}},boundingBox:function(e){var t=this,n=t._private.cy._private,i=n.styleEnabled,o=void 0===(e=e||{}).includeNodes||e.includeNodes,r=void 0===e.includeEdges||e.includeEdges,a=void 0===e.includeLabels||e.includeLabels;i&&n.renderer.recalculateRenderedStyle(this);for(var s=1/0,l=-1/0,c=1/0,d=-1/0,u=0;u<t.length;u++){var h,p,f,g,v,m,y=t[u],w=y._private,b=i?w.style.display.value:"element",C="nodes"===w.group,x=!1;if("none"!==b){if(C&&o){x=!0;var E=w.position;v=E.x,m=E.y;var _=(A=y.outerWidth())/2,S=y.outerHeight()/2;p=v+_,f=m-S,g=m+S,s=(h=v-_)<s?h:s,l=p>l?p:l,c=f<c?f:c,d=g>d?g:d}else if(y.isEdge()&&r){x=!0;var k=y._private.source._private.position,T=y._private.target._private.position,D=y._private.rstyle||{};if(h=k.x,p=T.x,f=k.y,g=T.y,h>p){R=h;h=p,p=R}if(f>g){var R=f;f=g,g=R}if(s=h<s?h:s,l=p>l?p:l,c=f<c?f:c,d=g>d?g:d,i)for(var P=D.bezierPts||[],A=y._private.style.width.pxValue,N=A/2,M=0;M<P.length;M++){var O=P[M];h=O.x-N,p=O.x+N,f=O.y-N,g=O.y+N,s=h<s?h:s,l=p>l?p:l,c=f<c?f:c,d=g>d?g:d}}if(i){var I=y._private.style,D=y._private.rstyle,L=I.content.strValue,H=I["font-size"],B=I["text-halign"],F=I["text-valign"],z=D.labelWidth,V=D.labelHeight,W=D.labelX,j=D.labelY;if(x&&a&&L&&H&&null!=V&&null!=z&&null!=W&&null!=j&&B&&F){var U,G,$,X,Y=V,q=z;if(y.isEdge())U=W-q/2,G=W+q/2,$=j-Y/2,X=j+Y/2;else{switch(B.value){case"left":U=W-q,G=W;break;case"center":U=W-q/2,G=W+q/2;break;case"right":U=W,G=W+q}switch(F.value){case"top":$=j-Y,X=j;break;case"center":$=j-Y/2,X=j+Y/2;break;case"bottom":$=j,X=j+Y}}s=U<s?U:s,l=G>l?G:l,c=$<c?$:c,d=X>d?X:d}}}}return{x1:s,x2:l,y1:c,y2:d,w:l-s,h:d-c}}}),e.elesfn.modelPosition=e.elesfn.position,e.elesfn.modelPositions=e.elesfn.positions}(cytoscape),function(e){"use strict";function t(e){return function(t){var n=this;if(void 0===t&&(t=!0),0!==n.length&&n.isNode()&&!n.removed()){for(var i=0,o=n[0],r=o._private.edges,a=0;a<r.length;a++){var s=r[a];!t&&s.isLoop()||(i+=e(o,s))}return i}}}function n(e,t){return function(n){for(var i,o=this.nodes(),r=0;r<o.length;r++){var a=o[r][e](n);void 0===a||void 0!==i&&!t(a,i)||(i=a)}return i}}e.fn.eles({degree:t(function(e,t){return t.source().same(t.target())?2:1}),indegree:t(function(e,t){return t.target().same(e)?1:0}),outdegree:t(function(e,t){return t.source().same(e)?1:0})}),e.fn.eles({minDegree:n("degree",function(e,t){return e<t}),maxDegree:n("degree",function(e,t){return e>t}),minIndegree:n("indegree",function(e,t){return e<t}),maxIndegree:n("indegree",function(e,t){return e>t}),minOutdegree:n("outdegree",function(e,t){return e<t}),maxOutdegree:n("outdegree",function(e,t){return e>t})}),e.fn.eles({totalDegree:function(e){for(var t=0,n=this.nodes(),i=0;i<n.length;i++)t+=n[i].degree(e);return t}})}(cytoscape),function(e){"use strict";e.fn.eles({on:e.define.on(),one:e.define.on({unbindSelfOnTrigger:!0}),once:e.define.on({unbindAllBindersOnTrigger:!0}),off:e.define.off(),trigger:e.define.trigger(),rtrigger:function(e,t){if(0!==this.length)return this.cy().notify({type:e,collection:this}),this.trigger(e,t),this}}),e.elesfn.bind=e.elesfn.on,e.elesfn.unbind=e.elesfn.off}(cytoscape),function(e){"use strict";e.fn.eles({nodes:function(e){return this.filter(function(e,t){return t.isNode()}).filter(e)},edges:function(e){return this.filter(function(e,t){return t.isEdge()}).filter(e)},filter:function(t){var n=this._private.cy;if(e.is.fn(t)){for(var i=[],o=0;o<this.length;o++){var r=this[o];t.apply(r,[o,r])&&i.push(r)}return new e.Collection(n,i)}return e.is.string(t)||e.is.elementOrCollection(t)?new e.Selector(t).filter(this):void 0===t?this:new e.Collection(n)},not:function(t){var n=this._private.cy;if(t){e.is.string(t)&&(t=this.filter(t));for(var i=[],o=0;o<this.length;o++){var r=this[o];t._private.ids[r.id()]||i.push(r)}return new e.Collection(n,i)}return this},intersect:function(t){var n=this._private.cy;if(e.is.string(t)){var i=t;return this.filter(i)}for(var o=[],r=this,a=t,s=this.length<t.length,l=s?a._private.ids:r._private.ids,c=s?r:a,d=0;d<c.length;d++){var u=l[c[d]._private.data.id];u&&o.push(u)}return new e.Collection(n,o)},add:function(t){var n=this._private.cy;if(!t)return this;if(e.is.string(t)){var i=t;t=n.elements(i)}for(var o=[],r=0;r<this.length;r++)o.push(this[r]);for(r=0;r<t.length;r++)!this._private.ids[t[r].id()]&&o.push(t[r]);return new e.Collection(n,o)},merge:function(t){var n=this._private,i=n.cy;if(!t)return this;if(e.is.string(t)){var o=t;t=i.elements(o)}for(var r=0;r<t.length;r++){var a=t[r],s=a.id();if(!n.ids[s]){var l=this.length++;this[l]=a,n.ids[s]=a,n.indexes[s]=l}}return this},unmergeOne:function(e){e=e[0];var t=this._private,n=e.id(),i=t.indexes[n];if(null==i)return this;this[i]=void 0,t.ids[n]=void 0,t.indexes[n]=void 0;var o=i===this.length-1;if(this.length>1&&!o){var r=this.length-1,a=this[r];this[r]=void 0,this[i]=a,t.indexes[a.id()]=i}return this.length--,this},unmerge:function(t){var n=this._private.cy;if(!t)return this;if(e.is.string(t)){var i=t;t=n.elements(i)}for(var o=0;o<t.length;o++)this.unmergeOne(t[o]);return this},map:function(e,t){for(var n=[],i=this,o=0;o<i.length;o++){var r=i[o],a=e.apply(t,[r,o,i]);n.push(a)}return n},stdFilter:function(t,n){for(var i=[],o=this,r=this._private.cy,a=0;a<o.length;a++){var s=o[a];t.apply(n,[s,a,o])&&i.push(s)}return new e.Collection(r,i)},max:function(e,t){for(var n,i=-1/0,o=this,r=0;r<o.length;r++){var a=o[r],s=e.apply(t,[a,r,o]);s>i&&(i=s,n=a)}return{value:i,ele:n}},min:function(e,t){for(var n,i=1/0,o=this,r=0;r<o.length;r++){var a=o[r],s=e.apply(t,[a,r,o]);s<i&&(i=s,n=a)}return{value:i,ele:n}}})}(cytoscape),function(e){"use strict";cytoscape.fn.eles({isNode:function(){return"nodes"===this.group()},isEdge:function(){return"edges"===this.group()},isLoop:function(){return this.isEdge()&&this.source().id()===this.target().id()},isSimple:function(){return this.isEdge()&&this.source().id()!==this.target().id()},group:function(){var e=this[0];if(e)return e._private.group}})}(),function(e){"use strict";e.fn.eles({each:function(t){if(e.is.fn(t))for(var n=0;n<this.length;n++){var i=this[n];if(!1===t.apply(i,[n,i]))break}return this},forEach:function(t,n){if(e.is.fn(t))for(var i=0;i<this.length;i++){var o=this[i];if(!1===t.apply(n,[o,i,this]))break}return this},toArray:function(){for(var e=[],t=0;t<this.length;t++)e.push(this[t]);return e},slice:function(t,n){var i=[],o=this.length;null==n&&(n=o),null==t&&(t=0),t<0&&(t=o+t),n<0&&(n=o+n);for(var r=t;r>=0&&r<n&&r<o;r++)i.push(this[r]);return new e.Collection(this.cy(),i)},size:function(){return this.length},eq:function(t){return this[t]||new e.Collection(this.cy())},first:function(){return this[0]||new e.Collection(this.cy())},last:function(){return this[this.length-1]||new e.Collection(this.cy())},empty:function(){return 0===this.length},nonempty:function(){return!this.empty()},sort:function(t){if(!e.is.fn(t))return this;var n=this.cy(),i=this.toArray().sort(t);return new e.Collection(n,i)},sortByZIndex:function(){return this.sort(e.Collection.zIndexSort)},zDepth:function(){var e=this[0];if(e){var t=e._private;if("nodes"===t.group)return t.data.parent?e.parents().size():0;var n=t.source,i=t.target,o=n._private.data.parent?n.parents().size():0,r=i._private.data.parent?i.parents().size():0;return Math.max(o-1,r-1,0)+.5}}}),e.Collection.zIndexSort=function(e,t){var n=e.cy(),i=e._private,o=t._private,r=i.style["z-index"].value-o.style["z-index"].value,a=0,s=0,l=n.hasCompoundNodes(),c="nodes"===i.group,d="edges"===i.group,u="nodes"===o.group,h="edges"===o.group;l&&(a=e.zDepth(),s=t.zDepth());var p=a-s;return 0===p?c&&h?1:d&&u?-1:0===r?i.index-o.index:r:p}}(cytoscape),function(e){"use strict";e.fn.eles({layoutPositions:function(t,n,i){var o=this.nodes(),r=this.cy();if(t.trigger({type:"layoutstart",layout:t}),n.animate){for(var a=0;a<o.length;a++){var s=o[a],l=a===o.length-1,c=i.call(s,a,s),d=s.position();e.is.number(d.x)&&e.is.number(d.y)||s.silentPosition({x:0,y:0}),s.animate({position:c},{duration:n.animationDuration,step:l?function(){n.fit&&r.fit(n.padding)}:void 0,complete:l?function(){null!=n.zoom&&r.zoom(n.zoom),n.pan&&r.pan(n.pan),n.fit&&r.fit(n.padding),t.one("layoutstop",n.stop),t.trigger({type:"layoutstop",layout:t})}:void 0})}t.one("layoutready",n.ready),t.trigger({type:"layoutready",layout:t})}else o.positions(i),n.fit&&r.fit(n.padding),null!=n.zoom&&r.zoom(n.zoom),n.pan&&r.pan(n.pan),t.one("layoutready",n.ready),t.trigger({type:"layoutready",layout:t}),t.one("layoutstop",n.stop),t.trigger({type:"layoutstop",layout:t});return this},layout:function(t){return this.cy().layout(e.util.extend({},t,{eles:this})),this},makeLayout:function(t){return this.cy().makeLayout(e.util.extend({},t,{eles:this}))}})}(cytoscape),function(e){"use strict";e.fn.eles({updateStyle:function(e){var t=this._private.cy;if(!t.styleEnabled())return this;if(t._private.batchingStyle){for(var n=t._private.batchStyleEles,i=0;i<this.length;i++){var o=this[i];n.ids[o._private.id]||n.push(o)}return this}var r=t.style();e=!(!e&&void 0!==e),r.apply(this);var a=this.updateCompoundBounds(),s=a.length>0?this.add(a):this;return e?s.rtrigger("style"):s.trigger("style"),this},updateMappers:function(e){var t=this._private.cy,n=t.style();if(e=!(!e&&void 0!==e),!t.styleEnabled())return this;n.updateMappers(this);var i=this.updateCompoundBounds(),o=i.length>0?this.add(i):this;return e?o.rtrigger("style"):o.trigger("style"),this},renderedCss:function(e){if(!this.cy().styleEnabled())return this;var t=this[0];if(t){var n=t.cy().style().getRenderedStyle(t);return void 0===e?n:n[e]}},css:function(t,n){var i=this.cy();if(!i.styleEnabled())return this;var o=i.style();if(e.is.plainObject(t)){var r=t;o.applyBypass(this,r,!1),(s=(a=this.updateCompoundBounds()).length>0?this.add(a):this).rtrigger("style")}else if(e.is.string(t)){if(void 0===n)return(l=this[0])?l._private.style[t].strValue:void 0;o.applyBypass(this,t,n,!1);var a=this.updateCompoundBounds(),s=a.length>0?this.add(a):this;s.rtrigger("style")}else if(void 0===t){var l=this[0];return l?o.getRawStyle(l):void 0}return this},removeCss:function(e){var t=this.cy();if(!t.styleEnabled())return this;var n=t.style(),i=this;if(void 0===e)for(o=0;o<i.length;o++){r=i[o];n.removeAllBypasses(r,!1)}else{e=e.split(/\s+/);for(var o=0;o<i.length;o++){var r=i[o];n.removeBypasses(r,e,!1)}}var a=this.updateCompoundBounds();return(a.length>0?this.add(a):this).rtrigger("style"),this},show:function(){return this.css("display","element"),this},hide:function(){return this.css("display","none"),this},visible:function(){var e=this.cy();if(!e.styleEnabled())return!0;var t=this[0],n=e.hasCompoundNodes();if(t){var i=t._private.style;if("visible"!==i.visibility.value||"element"!==i.display.value)return!1;if("nodes"===t._private.group){if(!n)return!0;var o=t._private.data.parent?t.parents():null;if(o)for(var r=0;r<o.length;r++){var a=o[r]._private.style,s=a.visibility.value,l=a.display.value;if("visible"!==s||"element"!==l)return!1}return!0}var c=t._private.source,d=t._private.target;return c.visible()&&d.visible()}},hidden:function(){var e=this[0];if(e)return!e.visible()},effectiveOpacity:function(){var e=this.cy();if(!e.styleEnabled())return 1;var t=e.hasCompoundNodes(),n=this[0];if(n){var i=n._private,o=i.style.opacity.value;if(!t)return o;var r=i.data.parent?n.parents():null;if(r)for(var a=0;a<r.length;a++)o*=r[a]._private.style.opacity.value;return o}},transparent:function(){var e=this[0],t=e.cy().hasCompoundNodes();if(e)return t?0===e.effectiveOpacity():0===e._private.style.opacity.value},isFullAutoParent:function(){if(!this.cy().styleEnabled())return!1;var e=this[0];if(e){var t="auto"===e._private.style.width.value,n="auto"===e._private.style.height.value;return e.isParent()&&t&&n}}}),e.elesfn.style=e.elesfn.css,e.elesfn.renderedStyle=e.elesfn.renderedCss,e.elesfn.removeStyle=e.elesfn.removeCss}(cytoscape),function(e){"use strict";function t(e){return function(){var t=arguments;if(2===t.length){var n=t[0],i=t[1];this.bind(e.event,n,i)}else if(1===t.length){i=t[0];this.bind(e.event,i)}else if(0===t.length){for(var o=0;o<this.length;o++){var r=this[o],a=!e.ableField||r._private[e.ableField];if(e.overrideAble){var s=e.overrideAble(r);if(void 0!==s&&(a=s,!s))return this}a&&(r._private[e.field]=e.value)}this.updateStyle(),this.trigger(e.event)}return this}}function n(n){e.elesfn[n.field]=function(){var e=this[0];if(e){if(n.overrideField){var t=n.overrideField(e);if(void 0!==t)return t}return e._private[n.field]}},e.elesfn[n.on]=t({event:n.on,field:n.field,ableField:n.ableField,overrideAble:n.overrideAble,value:!0}),e.elesfn[n.off]=t({event:n.off,field:n.field,ableField:n.ableField,overrideAble:n.overrideAble,value:!1})}n({field:"locked",overrideField:function(e){return!!e.cy().autolock()||void 0},on:"lock",off:"unlock"}),n({field:"grabbable",overrideField:function(e){return!e.cy().autoungrabify()&&void 0},on:"grabify",off:"ungrabify"}),n({field:"selected",ableField:"selectable",overrideAble:function(e){return!e.cy().autounselectify()&&void 0},on:"select",off:"unselect"}),n({field:"selectable",overrideField:function(e){return!e.cy().autounselectify()&&void 0},on:"selectify",off:"unselectify"}),e.elesfn.grabbed=function(){var e=this[0];if(e)return e._private.grabbed},n({field:"active",on:"activate",off:"unactivate"}),e.elesfn.inactive=function(){var e=this[0];if(e)return!e._private.active}}(cytoscape),function(e){"use strict";function t(t){return function(n){for(var i=[],o=this._private.cy,r=0;r<this.length;r++){var a=this[r]._private[t.attr];a&&i.push(a)}return new e.Collection(o,i,{unique:!0}).filter(n)}}function n(t){return function(n){var i=[],o=this._private.cy,r=t||{};e.is.string(n)&&(n=o.$(n));for(var a=n.connectedEdges(),s=this._private.ids,l=0;l<a.length;l++){var c=a[l],d=c._private.data;(r.thisIs?s[d[r.thisIs]]:s[d.source]||s[d.target])&&i.push(c)}return new e.Collection(o,i,{unique:!0})}}function i(t){var n={codirected:!1};return t=e.util.extend({},n,t),function(n){for(var i=this._private.cy,o=[],r=this.edges(),a=t,s=0;s<r.length;s++)for(var l=r[s],c=l.source()[0],d=c.id(),u=l.target()[0].id(),h=c._private.edges,p=0;p<h.length;p++){var f=h[p],g=f._private.data,v=g.target,m=g.source,y=v===u&&m===d,w=d===v&&u===m;(a.codirected&&y||!a.codirected&&(y||w))&&o.push(f)}return new e.Collection(i,o,{unique:!0}).filter(n)}}e.fn.eles({roots:function(t){for(var n=this,i=[],o=0;o<n.length;o++){var r=n[o];r.isNode()&&(r.connectedEdges(function(){return this.data("target")===r.id()&&this.data("source")!==r.id()}).length>0||i.push(r))}return new e.Collection(this._private.cy,i,{unique:!0}).filter(t)},leaves:function(t){for(var n=this,i=[],o=0;o<n.length;o++){var r=n[o];r.isNode()&&(r.connectedEdges(function(){return this.data("source")===r.id()&&this.data("target")!==r.id()}).length>0||i.push(r))}return new e.Collection(this._private.cy,i,{unique:!0}).filter(t)},outgoers:function(t){for(var n=this,i=[],o=0;o<n.length;o++){var r=n[o],a=r.id();if(r.isNode())for(var s=r._private.edges,l=0;l<s.length;l++){var c=s[l],d=c._private.data.source,u=c._private.data.target;d===a&&u!==a&&(i.push(c),i.push(c.target()[0]))}}return new e.Collection(this._private.cy,i,{unique:!0}).filter(t)},successors:function(t){for(var n=this,i=[],o={};;){var r=n.outgoers();if(0===r.length)break;for(var a=!1,s=0;s<r.length;s++){var l=r[s],c=l.id();o[c]||(o[c]=!0,i.push(l),a=!0)}if(!a)break;n=r}return new e.Collection(this._private.cy,i,{unique:!0}).filter(t)},incomers:function(t){for(var n=this,i=[],o=0;o<n.length;o++){var r=n[o],a=r.id();if(r.isNode())for(var s=r._private.edges,l=0;l<s.length;l++){var c=s[l],d=c._private.data.source;c._private.data.target===a&&d!==a&&(i.push(c),i.push(c.source()[0]))}}return new e.Collection(this._private.cy,i,{unique:!0}).filter(t)},predecessors:function(t){for(var n=this,i=[],o={};;){var r=n.incomers();if(0===r.length)break;for(var a=!1,s=0;s<r.length;s++){var l=r[s],c=l.id();o[c]||(o[c]=!0,i.push(l),a=!0)}if(!a)break;n=r}return new e.Collection(this._private.cy,i,{unique:!0}).filter(t)}}),e.fn.eles({neighborhood:function(t){for(var n=[],i=this._private.cy,o=this.nodes(),r=0;r<o.length;r++)for(var a=o[r],s=a.connectedEdges(),l=0;l<s.length;l++){var c=s[l],d=c.connectedNodes().not(a);d.length>0&&n.push(d[0]),n.push(c[0])}return new e.Collection(i,n,{unique:!0}).filter(t)},closedNeighborhood:function(e){return this.neighborhood().add(this).filter(e)},openNeighborhood:function(e){return this.neighborhood(e)}}),e.fn.eles({source:function(e){var t,n=this[0];return n&&(t=n._private.source),t&&e?t.filter(e):t},target:function(e){var t,n=this[0];return n&&(t=n._private.target),t&&e?t.filter(e):t},sources:t({attr:"source"}),targets:t({attr:"target"})}),e.fn.eles({edgesWith:n(),edgesTo:n({thisIs:"source"})}),e.fn.eles({connectedEdges:function(t){for(var n=[],i=this._private.cy,o=this,r=0;r<o.length;r++){var a=o[r];if(a.isNode())for(var s=a._private.edges,l=0;l<s.length;l++){var c=s[l];n.push(c)}}return new e.Collection(i,n,{unique:!0}).filter(t)},connectedNodes:function(t){for(var n=[],i=this._private.cy,o=this,r=0;r<o.length;r++){var a=o[r];a.isEdge()&&(n.push(a.source()[0]),n.push(a.target()[0]))}return new e.Collection(i,n,{unique:!0}).filter(t)},parallelEdges:i(),codirectedEdges:i({codirected:!0})})}(cytoscape),function(e){"use strict";cytoscape.fn.eles({fit:function(){},center:function(){}})}(),function(e){"use strict";e.Minheap=function(t,n,i){return new e.Heap(t,n,e.Heap.minHeapComparator,i)},e.Maxheap=function(t,n,i){return new e.Heap(t,n,e.Heap.maxHeapComparator,i)},e.Heap=function(t,n,i,o){if(void 0!==i&&void 0!==n){void 0===o&&(o=e.Heap.idFn);var r,a,s,l=[],c={},d=[],u=0;for(s=(n=this.getArgumentAsCollection(n,t)).length,u=0;u<s;u+=1){if(l.push(o.call(t,n[u],u,n)),r=n[u].id(),c.hasOwnProperty(r))throw"ERROR: Multiple items with the same id found: "+r;c[r]=u,d.push(r)}for(this._private={cy:t,heap:l,pointers:c,elements:d,comparator:i,extractor:o,length:s},u=Math.floor(s/2);u>=0;u-=1)a=this.heapify(u);return a}},e.Heap.idFn=function(e){return e.id()},e.Heap.minHeapComparator=function(e,t){return e>=t},e.Heap.maxHeapComparator=function(e,t){return e<=t},e.fn.heap=function(t,n){for(var i in t){var o=t[i];e.Heap.prototype[i]=o}},e.heapfn=e.Heap.prototype,e.heapfn.size=function(){return this._private.length},e.heapfn.getArgumentAsCollection=function(t,n){var i;if(void 0===n&&(n=this._private.cy),e.is.elementOrCollection(t))i=t;else{for(var o=[],r=[].concat.apply([],[t]),a=0;a<r.length;a++){var s=r[a],l=n.getElementById(s);l.length>0&&o.push(l)}i=new e.Collection(n,o)}return i},e.heapfn.isHeap=function(){var e,t,n,i,o,r=this._private.heap,a=r.length,s=this._private.comparator;for(e=0;e<a;e+=1)if(t=2*e+1,n=t+1,i=!(t<a)||s(r[t],r[e]),o=!(n<a)||s(r[n],r[e]),!i||!o)return!1;return!0},e.heapfn.heapSwap=function(e,t){var n=this._private.heap,i=this._private.pointers,o=this._private.elements,r=n[e],a=o[e],s=o[e],l=o[t];n[e]=n[t],o[e]=o[t],i[s]=t,i[l]=e,n[t]=r,o[t]=a},e.heapfn.heapify=function(e,t){var n,i,o,r,a,s,l,c=0,d=!1;for(void 0===t&&(t=!0),c=(n=this._private.heap).length,s=this._private.comparator,i=e;!d;)t?(r=(o=2*i+1)+1,a=i,o<c&&!s(n[o],n[a])&&(a=o),r<c&&!s(n[r],n[a])&&(a=r),(d=a===i)||(this.heapSwap(a,i),i=a)):(a=i,(d=(l=Math.floor((i-1)/2))<0||s(n[a],n[l]))||(this.heapSwap(a,l),i=l))},e.heapfn.insert=function(e){var t,n,i,o,r,a=this.getArgumentAsCollection(e),s=a.length;for(r=0;r<s;r+=1){if(t=a[r],n=this._private.heap.length,i=this._private.extractor(t),o=t.id(),this._private.pointers.hasOwnProperty(o))throw"ERROR: Multiple items with the same id found: "+o;this._private.heap.push(i),this._private.elements.push(o),this._private.pointers[o]=n,this.heapify(n,!1)}this._private.length=this._private.heap.length},e.heapfn.getValueById=function(e){if(this._private.pointers.hasOwnProperty(e)){var t=this._private.pointers[e];return this._private.heap[t]}},e.heapfn.contains=function(e){for(var t=this.getArgumentAsCollection(e),n=0;n<t.length;n+=1){var i=t[n].id();if(!this._private.pointers.hasOwnProperty(i))return!1}return!0},e.heapfn.top=function(){if(this._private.length>0)return{value:this._private.heap[0],id:this._private.elements[0]}},e.heapfn.pop=function(){if(this._private.length>0){var e,t,n=this.top(),i=this._private.length-1;return this.heapSwap(0,i),e=this._private.elements[i],this._private.heap[i],t=e,this._private.heap.pop(),this._private.elements.pop(),this._private.length=this._private.heap.length,this._private.pointers[t]=void 0,this.heapify(0),n}},e.heapfn.findDirectionHeapify=function(e){var t=Math.floor((e-1)/2),n=this._private.heap,i=t<0||this._private.comparator(n[e],n[t]);this.heapify(e,i)},e.heapfn.edit=function(t,n){for(var i=this.getArgumentAsCollection(t),o=0;o<i.length;o+=1){var r=i[o].id(),a=this._private.pointers[r],s=this._private.heap[a];e.is.number(n)?this._private.heap[a]=n:e.is.fn(n)&&(this._private.heap[a]=n.call(this._private.cy,s,a)),this.findDirectionHeapify(a)}},e.heapfn.delete=function(e){for(var t=this.getArgumentAsCollection(e),n=0;n<t.length;n+=1){var i,o,r,a=t[n].id(),s=this._private.pointers[a],l=this._private.length-1;s!==l&&this.heapSwap(s,l),i=this._private.elements[l],o=this._private.heap[l],r=i,this._private.heap.pop(),this._private.elements.pop(),this._private.length=this._private.heap.length,this._private.pointers[r]=void 0,this.findDirectionHeapify(s)}return o}}(cytoscape),function(e){"use strict";function t(e){t.CANVAS_LAYERS=5,t.SELECT_BOX=0,t.DRAG=2,t.NODE=4,t.TEXTURE_BUFFER=0,t.BUFFER_COUNT=2,this.options=e,this.data={select:[void 0,void 0,void 0,void 0,0],renderer:this,cy:e.cy,container:e.cy.container(),canvases:new Array(t.CANVAS_LAYERS),contexts:new Array(t.CANVAS_LAYERS),canvasNeedsRedraw:new Array(t.CANVAS_LAYERS),bufferCanvases:new Array(t.BUFFER_COUNT),bufferContexts:new Array(t.CANVAS_LAYERS)},this.hoverData={down:null,last:null,downTime:null,triggerMode:null,dragging:!1,initialPan:[null,null],capture:!1},this.timeoutData={panTimeout:null},this.dragData={possibleDragElements:[]},this.touchData={start:null,capture:!1,startPosition:[null,null,null,null,null,null],singleTouchStartTime:null,singleTouchMoved:!0,now:[null,null,null,null,null,null],earlier:[null,null,null,null,null,null]},this.zoomData={freeToZoom:!1,lastPointerX:null},this.redraws=0,this.showFps=e.showFps,this.bindings=[],this.data.canvasContainer=document.createElement("div");var n=this.data.canvasContainer.style;n.position="absolute",n.zIndex="0",n.overflow="hidden",this.data.container.appendChild(this.data.canvasContainer);for(i=0;i<t.CANVAS_LAYERS;i++)this.data.canvases[i]=document.createElement("canvas"),this.data.contexts[i]=this.data.canvases[i].getContext("2d"),this.data.canvases[i].style.position="absolute",this.data.canvases[i].setAttribute("data-id","layer"+i),this.data.canvases[i].style.zIndex=String(t.CANVAS_LAYERS-i),this.data.canvasContainer.appendChild(this.data.canvases[i]),this.data.canvasNeedsRedraw[i]=!1;this.data.topCanvas=this.data.canvases[0],this.data.canvases[t.NODE].setAttribute("data-id","layer"+t.NODE+"-node"),this.data.canvases[t.SELECT_BOX].setAttribute("data-id","layer"+t.SELECT_BOX+"-selectbox"),this.data.canvases[t.DRAG].setAttribute("data-id","layer"+t.DRAG+"-drag");for(var i=0;i<t.BUFFER_COUNT;i++)this.data.bufferCanvases[i]=document.createElement("canvas"),this.data.bufferContexts[i]=this.data.bufferCanvases[i].getContext("2d"),this.data.bufferCanvases[i].style.position="absolute",this.data.bufferCanvases[i].setAttribute("data-id","buffer"+i),this.data.bufferCanvases[i].style.zIndex=String(-i-1),this.data.bufferCanvases[i].style.visibility="hidden";this.hideEdgesOnViewport=e.hideEdgesOnViewport,this.hideLabelsOnViewport=e.hideLabelsOnViewport,this.textureOnViewport=e.textureOnViewport,this.wheelSensitivity=e.wheelSensitivity,this.motionBlurEnabled=void 0===e.motionBlur||e.motionBlur,this.forcedPixelRatio=e.pixelRatio,this.motionBlur=!0,this.tapThreshold=e.tapThreshold,this.tapThreshold2=e.tapThreshold*e.tapThreshold,this.tapholdDuration=500,this.load()}t.panOrBoxSelectDelay=400,t.isTouch=e.is.touch();var n="undefined"!=typeof Path2D;t.usePaths=function(){return n},t.prototype.notify=function(n){var i;i=e.is.array(n.type)?n.type:[n.type];for(var o=0;o<i.length;o++){var r=i[o];switch(r){case"destroy":return void this.destroy();case"add":case"remove":case"load":this.updateNodesCache(),this.updateEdgesCache();break;case"viewport":this.data.canvasNeedsRedraw[t.SELECT_BOX]=!0;break;case"style":this.updateCachedZSortedEles()}"load"!==r&&"resize"!==r||(this.invalidateContainerClientCoordsCache(),this.matchCanvasSize(this.data.container))}this.data.canvasNeedsRedraw[t.NODE]=!0,this.data.canvasNeedsRedraw[t.DRAG]=!0,this.redraw()},t.prototype.destroy=function(){this.destroyed=!0;for(var e=0;e<this.bindings.length;e++){var t=this.bindings[e];t.target.removeEventListener(t.event,t.handler,t.useCapture)}this.removeObserver&&this.removeObserver.disconnect()};for(var i in e.math)t.prototype[i]=e.math[i];e("renderer","canvas",t)}(cytoscape),function(e){"use strict";var t=e("renderer","canvas"),n=t.prototype,i=t.arrowShapes={};t.arrowShapeHeight=.3;var o=function(e,t,n,i,o,r,a,s){var l=n+o/2,c=i-r/2,d=i+r/2;return n-o/2<=e&&e<=l&&c<=t&&t<=d},r=function(e,t,n,i,o){i=-i;var r=e*Math.cos(i)-t*Math.sin(i),a=(e*Math.sin(i)+t*Math.cos(i))*n;return{x:r*n+o.x,y:a+o.y}};i.arrow={_points:[-.15,-.3,0,0,.15,-.3],collide:function(t,n,o,r,a,s,l,c){var d=i.arrow._points;return e.math.pointInsidePolygon(t,n,d,o,r,a,s,l,c)},roughCollide:o,draw:function(e,t,n,o){for(var a=i.arrow._points,s=0;s<a.length/2;s++){var l=r(a[2*s],a[2*s+1],t,n,o);e.lineTo(l.x,l.y)}},spacing:function(e){return 0},gap:function(e){return 2*e._private.style.width.pxValue}},i.triangle=i.arrow,i["triangle-backcurve"]={_ctrlPt:[0,-.15],collide:function(t,n,o,r,a,s,l,c){var d=i.triangle._points;return e.math.pointInsidePolygon(t,n,d,o,r,a,s,l,c)},roughCollide:o,draw:function(e,t,n,o){for(var a,s=i.triangle._points,l=0;l<s.length/2;l++){var c=r(s[2*l],s[2*l+1],t,n,o);0===l&&(a=c),e.lineTo(c.x,c.y)}var d=this._ctrlPt,u=r(d[0],d[1],t,n,o);e.quadraticCurveTo(u.x,u.y,a.x,a.y)},spacing:function(e){return 0},gap:function(e){return 2*e._private.style.width.pxValue}},i["triangle-tee"]={_points:[-.15,-.3,0,0,.15,-.3,-.15,-.3],_pointsTee:[-.15,-.4,-.15,-.5,.15,-.5,.15,-.4],collide:function(t,n,o,r,a,s,l,c){var d=i["triangle-tee"]._points,u=i["triangle-tee"]._pointsTee;return e.math.pointInsidePolygon(t,n,u,o,r,a,s,l,c)||e.math.pointInsidePolygon(t,n,d,o,r,a,s,l,c)},roughCollide:o,draw:function(e,t,n,o){for(var a=i["triangle-tee"]._points,s=0;s<a.length/2;s++){d=r(a[2*s],a[2*s+1],t,n,o);e.lineTo(d.x,d.y)}var l=i["triangle-tee"]._pointsTee,c=r(l[0],l[1],t,n,o);e.moveTo(c.x,c.y);for(s=0;s<l.length/2;s++){var d=r(l[2*s],l[2*s+1],t,n,o);e.lineTo(d.x,d.y)}},spacing:function(e){return 0},gap:function(e){return 2*e._private.style.width.pxValue}},i["half-triangle-overshot"]={_points:[0,-.25,-.5,-.25,.5,.25],leavePathOpen:!0,matchEdgeWidth:!0,collide:function(t,n,i,o,r,a,s,l){var c=this._points;return e.math.pointInsidePolygon(t,n,c,i,o,r,a,s,l)},roughCollide:o,draw:function(e,t,n,i){for(var o=this._points,a=0;a<o.length/2;a++){var s=r(o[2*a],o[2*a+1],t,n,i);e.lineTo(s.x,s.y)}},spacing:function(e){return 0},gap:function(e){return 2*e._private.style.width.pxValue}},i.none={collide:function(e,t,n,i,o,r,a,s){return!1},roughCollide:function(e,t,n,i,o,r,a,s){return!1},draw:function(e){},spacing:function(e){return 0},gap:function(e){return 0}},i.circle={_baseRadius:.15,collide:function(e,t,n,o,r,a,s,l){if(r!=a){var c=(a+l)/(r+l);return t/=c,o/=c,Math.pow(n-e,2)+Math.pow(o-t,2)<=Math.pow((r+l)*i.circle._baseRadius,2)}return Math.pow(n-e,2)+Math.pow(o-t,2)<=Math.pow((r+l)*i.circle._baseRadius,2)},roughCollide:o,draw:function(e,t,n,o){e.arc(o.x,o.y,i.circle._baseRadius*t,0,2*Math.PI,!1)},spacing:function(e){return n.getArrowWidth(e._private.style.width.pxValue)*i.circle._baseRadius},gap:function(e){return 2*e._private.style.width.pxValue}},i.inhibitor={_points:[-.25,0,-.25,-.1,.25,-.1,.25,0],collide:function(t,n,o,r,a,s,l,c){var d=i.inhibitor._points;return e.math.pointInsidePolygon(t,n,d,o,r,a,s,l,c)},roughCollide:o,draw:function(e,t,n,o){for(var a=i.inhibitor._points,s=0;s<a.length/2;s++){var l=r(a[2*s],a[2*s+1],t,n,o);e.lineTo(l.x,l.y)}},spacing:function(e){return 1},gap:function(e){return 1}},i.tee=i.inhibitor,i.square={_points:[-.15,0,.15,0,.15,-.3,-.15,-.3],collide:function(t,n,o,r,a,s,l,c){var d=i.square._points;return e.math.pointInsidePolygon(t,n,d,o,r,a,s,l,c)},roughCollide:o,draw:function(e,t,n,o){for(var a=i.square._points,s=0;s<a.length/2;s++){var l=r(a[2*s],a[2*s+1],t,n,o);e.lineTo(l.x,l.y)}},spacing:function(e){return 0},gap:function(e){return 2*e._private.style.width.pxValue}},i.diamond={_points:[-.15,-.15,0,-.3,.15,-.15,0,0],collide:function(t,n,o,r,a,s,l,c){var d=i.diamond._points;return e.math.pointInsidePolygon(t,n,d,o,r,a,s,l,c)},roughCollide:o,draw:function(e,t,n,o){for(var a=i.diamond._points,s=0;s<a.length/2;s++){var l=r(a[2*s],a[2*s+1],t,n,o);e.lineTo(l.x,l.y)}},spacing:function(e){return 0},gap:function(e){return e._private.style.width.pxValue}}}(cytoscape),function(e){"use strict";var t=cytoscape("renderer","canvas");t.prototype.getCachedNodes=function(){var e=this.data,t=this.data.cy;return null==e.cache&&(e.cache={}),null==e.cache.cachedNodes&&(e.cache.cachedNodes=t.nodes()),e.cache.cachedNodes},t.prototype.updateNodesCache=function(){var e=this.data,t=this.data.cy;null==e.cache&&(e.cache={}),e.cache.cachedNodes=t.nodes()},t.prototype.getCachedEdges=function(){var e=this.data,t=this.data.cy;return null==e.cache&&(e.cache={}),null==e.cache.cachedEdges&&(e.cache.cachedEdges=t.edges()),e.cache.cachedEdges},t.prototype.updateEdgesCache=function(){var e=this.data,t=this.data.cy;null==e.cache&&(e.cache={}),e.cache.cachedEdges=t.edges()}}(),function(e){"use strict";var t=e("renderer","canvas");t.prototype.projectIntoViewport=function(e,t){var n=this.findContainerClientCoords(),i=e-n[0],o=t-n[1];return i-=this.data.cy.pan().x,o-=this.data.cy.pan().y,i/=this.data.cy.zoom(),o/=this.data.cy.zoom(),[i,o]},t.prototype.findContainerClientCoords=function(){var e=this.data.container,t=this.containerBB=this.containerBB||e.getBoundingClientRect();return[t.left,t.top,t.right-t.left,t.bottom-t.top]},t.prototype.invalidateContainerClientCoordsCache=function(){this.containerBB=null},t.prototype.findNearestElement=function(n,i,o){function r(e){var r=e.outerWidth(),s=e.outerHeight(),c=r/2,d=s/2,u=e._private.position;if(u.x-c<=n&&n<=u.x+c&&u.y-d<=i&&i<=u.y+d){var h=!o||e.visible()&&!e.transparent();if(o&&!h)return;var f=t.nodeShapes[a.getNodeShape(e)],g=e._private.style["border-width"].pxValue/2;f.checkPoint(n,i,g,r+p,s+p,u.x,u.y)&&l.push(e)}}for(var a=this,s=this.getCachedZSortedEles(),l=[],c=t.isTouch,d=this.data.cy.zoom(),u=this.data.cy.hasCompoundNodes(),h=(c?256:32)/d,p=(c?16:0)/d,f=s.length-1;f>=0;f--){var g=s[f];if(l.length>0)break;"nodes"===g._private.group?r(s[f]):function(s){var c,d=s._private.rscratch,p=s._private.style,f=p.width.pxValue,g=f*f,v=2*f,m=s._private.source,y=s._private.target,w=!1,b=function(){return void 0!==c?c:o?s.visible()&&!s.transparent()?(c=!0,!0):(c=!1,!1):(c=!0,!0)};if("self"===d.edgeType)((w=e.math.inBezierVicinity(n,i,d.startX,d.startY,d.cp2ax,d.cp2ay,d.selfEdgeMidX,d.selfEdgeMidY,g))&&b()&&g+h>e.math.sqDistanceToQuadraticBezier(n,i,d.startX,d.startY,d.cp2ax,d.cp2ay,d.selfEdgeMidX,d.selfEdgeMidY)||(w=e.math.inBezierVicinity(n,i,d.selfEdgeMidX,d.selfEdgeMidY,d.cp2cx,d.cp2cy,d.endX,d.endY,g))&&b()&&g+h>e.math.sqDistanceToQuadraticBezier(n,i,d.selfEdgeMidX,d.selfEdgeMidY,d.cp2cx,d.cp2cy,d.endX,d.endY))&&l.push(s);else if("haystack"===d.edgeType){var C=p["haystack-radius"].value/2,x=y._private.position,E=y.width(),_=y.height(),S=m._private.position,k=m.width(),T=m.height(),D=S.x+d.source.x*k*C,R=S.y+d.source.y*T*C,P=x.x+d.target.x*E*C,A=x.y+d.target.y*_*C;(w=e.math.inLineVicinity(n,i,D,R,P,A,v))&&b()&&g+h>e.math.sqDistanceToFiniteLine(n,i,D,R,P,A)&&l.push(s)}else"straight"===d.edgeType?(w=e.math.inLineVicinity(n,i,d.startX,d.startY,d.endX,d.endY,v))&&b()&&g+h>e.math.sqDistanceToFiniteLine(n,i,d.startX,d.startY,d.endX,d.endY)&&l.push(s):"bezier"===d.edgeType&&(w=e.math.inBezierVicinity(n,i,d.startX,d.startY,d.cp2x,d.cp2y,d.endX,d.endY,g))&&b()&&g+h>e.math.sqDistanceToQuadraticBezier(n,i,d.startX,d.startY,d.cp2x,d.cp2y,d.endX,d.endY)&&l.push(s);if(w&&b()&&0===l.length||l[l.length-1]!==s){var N=t.arrowShapes[p["source-arrow-shape"].value],M=t.arrowShapes[p["target-arrow-shape"].value],m=m||s._private.source,x=(y=y||s._private.target)._private.position,S=m._private.position,O=a.getArrowWidth(p.width.pxValue),I=a.getArrowHeight(p.width.pxValue),L=O,H=I;(N.roughCollide(n,i,d.arrowStartX,d.arrowStartY,O,I,[d.arrowStartX-S.x,d.arrowStartY-S.y],0)&&N.collide(n,i,d.arrowStartX,d.arrowStartY,O,I,[d.arrowStartX-S.x,d.arrowStartY-S.y],0)||M.roughCollide(n,i,d.arrowEndX,d.arrowEndY,L,H,[d.arrowEndX-x.x,d.arrowEndY-x.y],0)&&M.collide(n,i,d.arrowEndX,d.arrowEndY,L,H,[d.arrowEndX-x.x,d.arrowEndY-x.y],0))&&l.push(s)}u&&l.length>0&&l[l.length-1]===s&&(r(m),r(y))}(s[f])}return l.length>0?l[l.length-1]:null},t.prototype.getAllInBox=function(n,i,o,r){var a=this.getCachedNodes(),s=this.getCachedEdges(),l=[],c=Math.min(n,o),d=Math.max(n,o),u=Math.min(i,r),h=Math.max(i,r);n=c,o=d,i=u,r=h;for(var p,f=0;f<a.length;f++){var g=a[f]._private.position,v=this.getNodeShape(a[f]),m=this.getNodeWidth(a[f]),y=this.getNodeHeight(a[f]),w=a[f]._private.style["border-width"].pxValue/2;t.nodeShapes[v].intersectBox(n,i,o,r,m,y,g.x,g.y,w)&&l.push(a[f])}for(f=0;f<s.length;f++){var b=s[f]._private.rscratch;if("self"==s[f]._private.rscratch.edgeType&&((p=e.math.boxInBezierVicinity(n,i,o,r,b.startX,b.startY,b.cp2ax,b.cp2ay,b.endX,b.endY,s[f]._private.style.width.pxValue))&&(2==p||1==p&&e.math.checkBezierInBox(n,i,o,r,b.startX,b.startY,b.cp2ax,b.cp2ay,b.endX,b.endY,s[f]._private.style.width.pxValue))||(p=e.math.boxInBezierVicinity(n,i,o,r,b.startX,b.startY,b.cp2cx,b.cp2cy,b.endX,b.endY,s[f]._private.style.width.pxValue))&&(2==p||1==p&&e.math.checkBezierInBox(n,i,o,r,b.startX,b.startY,b.cp2cx,b.cp2cy,b.endX,b.endY,s[f]._private.style.width.pxValue)))&&l.push(s[f]),"bezier"==b.edgeType&&(p=e.math.boxInBezierVicinity(n,i,o,r,b.startX,b.startY,b.cp2x,b.cp2y,b.endX,b.endY,s[f]._private.style.width.pxValue))&&(2==p||1==p&&e.math.checkBezierInBox(n,i,o,r,b.startX,b.startY,b.cp2x,b.cp2y,b.endX,b.endY,s[f]._private.style.width.pxValue))&&l.push(s[f]),"straight"==b.edgeType&&(p=e.math.boxInBezierVicinity(n,i,o,r,b.startX,b.startY,.5*b.startX+.5*b.endX,.5*b.startY+.5*b.endY,b.endX,b.endY,s[f]._private.style.width.pxValue))&&(2==p||1==p&&e.math.checkStraightEdgeInBox(n,i,o,r,b.startX,b.startY,b.endX,b.endY,s[f]._private.style.width.pxValue))&&l.push(s[f]),"haystack"==b.edgeType){var C=s[f].target()[0].position(),x=s[f].source()[0].position(),E=x.x+b.source.x,_=x.y+b.source.y,S=C.x+b.target.x,k=C.y+b.target.y,T=n<=E&&E<=o&&i<=_&&_<=r,D=n<=S&&S<=o&&i<=k&&k<=r;T&&D&&l.push(s[f])}}return l},t.prototype.getNodeWidth=function(e){return e.width()},t.prototype.getNodeHeight=function(e){return e.height()},t.prototype.getNodeShape=function(e){var t=e._private.style.shape.value;return e.isParent()?"rectangle"===t||"roundrectangle"===t?t:"rectangle":t},t.prototype.getNodePadding=function(e){var t=e._private.style["padding-left"].pxValue,n=e._private.style["padding-right"].pxValue,i=e._private.style["padding-top"].pxValue,o=e._private.style["padding-bottom"].pxValue;return isNaN(t)&&(t=0),isNaN(n)&&(n=0),isNaN(i)&&(i=0),isNaN(o)&&(o=0),{left:t,right:n,top:i,bottom:o}},t.prototype.zOrderSort=e.Collection.zIndexSort,t.prototype.updateCachedZSortedEles=function(){this.getCachedZSortedEles(!0)},t.prototype.getCachedZSortedEles=function(e){var t=this.lastZOrderCachedNodes,n=this.lastZOrderCachedEdges,i=this.getCachedNodes(),o=this.getCachedEdges(),r=[];if(!e&&t&&n&&t===i&&n===o)r=this.cachedZSortedEles;else{for(a=0;a<i.length;a++)i[a].visible()&&!i[a].transparent()&&r.push(i[a]);for(var a=0;a<o.length;a++)o[a].visible()&&!o[a].transparent()&&r.push(o[a]);r.sort(this.zOrderSort),this.cachedZSortedEles=r}return this.lastZOrderCachedNodes=i,this.lastZOrderCachedEdges=o,r},t.prototype.projectBezier=function(t){function n(e){r.push({x:i(e[0],e[2],e[4],.05),y:i(e[1],e[3],e[5],.05)}),r.push({x:i(e[0],e[2],e[4],.25),y:i(e[1],e[3],e[5],.25)}),r.push({x:i(e[0],e[2],e[4],.4),y:i(e[1],e[3],e[5],.4)});var t={x:i(e[0],e[2],e[4],.5),y:i(e[1],e[3],e[5],.5)};r.push(t),"self"===o.edgeType?(o.midX=o.selfEdgeMidX,o.midY=o.selfEdgeMidY):(o.midX=t.x,o.midY=t.y),r.push({x:i(e[0],e[2],e[4],.6),y:i(e[1],e[3],e[5],.6)}),r.push({x:i(e[0],e[2],e[4],.75),y:i(e[1],e[3],e[5],.75)}),r.push({x:i(e[0],e[2],e[4],.95),y:i(e[1],e[3],e[5],.95)})}var i=e.math.qbezierAt,o=t._private.rscratch,r=t._private.rstyle.bezierPts=[];"self"===o.edgeType?(n([o.startX,o.startY,o.cp2ax,o.cp2ay,o.selfEdgeMidX,o.selfEdgeMidY]),n([o.selfEdgeMidX,o.selfEdgeMidY,o.cp2cx,o.cp2cy,o.endX,o.endY])):"bezier"===o.edgeType&&n([o.startX,o.startY,o.cp2x,o.cp2y,o.endX,o.endY])},t.prototype.recalculateNodeLabelProjection=function(e){var t=e._private.style.content.strValue;if(t&&!t.match(/^\s+$/)){var n,i,o=e.outerWidth(),r=e.outerHeight(),a=e._private.position,s=e._private.style["text-halign"].strValue,l=e._private.style["text-valign"].strValue,c=e._private.rscratch,d=e._private.rstyle;switch(s){case"left":n=a.x-o/2;break;case"right":n=a.x+o/2;break;default:n=a.x}switch(l){case"top":i=a.y-r/2;break;case"bottom":i=a.y+r/2;break;default:i=a.y}c.labelX=n,c.labelY=i,d.labelX=n,d.labelY=i,this.applyLabelDimensions(e)}},t.prototype.recalculateEdgeLabelProjection=function(t){var n=t._private.style.content.strValue;if(n&&!n.match(/^\s+$/)){var i,o,r,a,s=t._private.rscratch,l=t._private.rstyle;if("self"==s.edgeType)r=s.selfEdgeMidX,a=s.selfEdgeMidY;else if("straight"==s.edgeType)r=(s.startX+s.endX)/2,a=(s.startY+s.endY)/2;else if("bezier"==s.edgeType)r=e.math.qbezierAt(s.startX,s.cp2x,s.endX,.5),a=e.math.qbezierAt(s.startY,s.cp2y,s.endY,.5);else if("haystack"==s.edgeType){var c=t._private.source._private.position,d=t._private.target._private.position;r=(c.x+s.source.x+d.x+s.target.x)/2,a=(c.y+s.source.y+d.y+s.target.y)/2}i=r,o=a,s.labelX=i,s.labelY=o,l.labelX=i,l.labelY=o,this.applyLabelDimensions(t)}},t.prototype.applyLabelDimensions=function(e){var t=e._private.rscratch,n=e._private.rstyle,i=this.getLabelText(e),o=this.calculateLabelDimensions(e,i);n.labelWidth=o.width,t.labelWidth=o.width,n.labelHeight=o.height,t.labelHeight=o.height},t.prototype.getLabelText=function(e){var t=e._private.style,n=e._private.style.content.strValue,i=t["text-transform"].value;return"none"==i||("uppercase"==i?n=n.toUpperCase():"lowercase"==i&&(n=n.toLowerCase())),n},t.prototype.calculateLabelDimensions=function(e,t){var n=this,i=e._private.style,o=i["font-style"].strValue,r=i["font-size"].pxValue+"px",a=i["font-family"].strValue,s=i["font-weight"].strValue,l=e._private.labelKey,c=n.labelDimCache||(n.labelDimCache={});if(c[l])return c[l];var d=this.labelCalcDiv;d||(d=this.labelCalcDiv=document.createElement("div"),document.body.appendChild(d));var u=d.style;return u.fontFamily=a,u.fontStyle=o,u.fontSize=r,u.fontWeight=s,u.position="absolute",u.left="-9999px",u.top="-9999px",u.zIndex="-1",u.visibility="hidden",u.pointerEvents="none",u.padding="0",u.lineHeight="1",d.textContent=t,c[l]={width:d.clientWidth,height:d.clientHeight},c[l]},t.prototype.recalculateRenderedStyle=function(e){for(var t=[],n=[],i={},o=0;o<e.length;o++){var r=e[o],a=r._private,s=a.rscratch,l=a.rstyle,c=a.data.id,d=null!=s.boundingBoxKey&&a.boundingBoxKey===s.boundingBoxKey,u=null!=s.labelKey&&a.labelKey===s.labelKey,h=d&&u;if("nodes"===r._private.group){var p=a.position;null!=l.nodeX&&null!=l.nodeY&&p.x===l.nodeX&&p.y===l.nodeY&&h||n.push(r),l.nodeX=p.x,l.nodeY=p.y}else{var f=r._private.source._private.position,g=r._private.target._private.position,v=null!=l.srcX&&null!=l.srcY&&f.x===l.srcX&&f.y===l.srcY,m=null!=l.tgtX&&null!=l.tgtY&&g.x===l.tgtX&&g.y===l.tgtY;if(!(v&&m)||!h)if("bezier"===a.style["curve-style"].value){if(!i[c]){t.push(r),i[c]=!0;for(var y=r.parallelEdges(),o=0;o<y.length;o++){var w=y[o],b=w._private.data.id;i[b]||(t.push(w),i[b]=!0)}}}else t.push(r);l.srcX=f.x,l.srcY=f.y,l.tgtX=g.x,l.tgtY=g.y}s.boundingBoxKey=a.boundingBoxKey,s.labelKey=a.labelKey}this.recalculateEdgeProjections(t),this.recalculateLabelProjections(n,t)},t.prototype.recalculateLabelProjections=function(e,t){for(n=0;n<e.length;n++)this.recalculateNodeLabelProjection(e[n]);for(var n=0;n<t.length;n++)this.recalculateEdgeLabelProjection(t[n])},t.prototype.recalculateEdgeProjections=function(e){this.findEdgeControlPoints(e)},t.prototype.findEdgeControlPoints=function(n){if(n&&0!==n.length){for(var i,o={},r=[],a=[],s=0;s<n.length;s++){var l=(H=n[s])._private.style,c="unbundled-bezier"===l["curve-style"].value;if("none"!==l.display.value)if("haystack"!==l["curve-style"].value){var d=H._private.data.source,u=H._private.data.target;i=d>u?u+"-"+d:d+"-"+u,c&&(i="unbundled"+H._private.data.id),null==o[i]&&(o[i]=[],r.push(i)),o[i].push(H),c&&(o[i].hasUnbundled=!0)}else a.push(H)}for(var h,p,f,g,v,m,y,w,b,C,x,E,_,S,k=0;k<r.length;k++){var T=o[i=r[k]];if(T.sort(function(e,t){return e._private.index-t._private.index}),h=T[0]._private.source,p=T[0]._private.target,h._private.data.id>p._private.data.id){var D=h;h=p,p=D}if(f=h._private.position,g=p._private.position,v=this.getNodeWidth(h),m=this.getNodeHeight(h),y=this.getNodeWidth(p),w=this.getNodeHeight(p),b=t.nodeShapes[this.getNodeShape(h)],C=t.nodeShapes[this.getNodeShape(p)],x=h._private.style["border-width"].pxValue,E=p._private.style["border-width"].pxValue,S=!1,T.length>1&&h!==p||T.hasUnbundled){var R=b.intersectLine(f.x,f.y,v,m,g.x,g.y,x/2),P=C.intersectLine(g.x,g.y,y,w,f.x,f.y,E/2),A={x1:R[0],x2:P[0],y1:R[1],y2:P[1]},N=P[1]-R[1],M=P[0]-R[0],O=Math.sqrt(M*M+N*N),I={x:M,y:N},L={x:I.x/O,y:I.y/O};_={x:-L.y,y:L.x},(C.checkPoint(R[0],R[1],E/2,y,w,g.x,g.y)||b.checkPoint(P[0],P[1],x/2,v,m,f.x,f.y))&&(_={},S=!0)}for(var H,B,s=0;s<T.length;s++){var F=(B=(H=T[s])._private.rscratch).lastEdgeIndex,z=s,V=B.lastNumEdges,W=T.length,j=H._private.style,U=j["control-point-step-size"].pxValue,G=void 0!==j["control-point-distance"]?j["control-point-distance"].pxValue:void 0,$=j["control-point-weight"].value,c="unbundled-bezier"===j["curve-style"].value,X=B.lastSrcCtlPtX,Y=f.x,q=B.lastSrcCtlPtY,K=f.y,Z=B.lastSrcCtlPtW,Q=h.outerWidth(),J=B.lastSrcCtlPtH,ee=h.outerHeight(),te=B.lastTgtCtlPtX,ne=g.x,ie=B.lastTgtCtlPtY,oe=g.y,re=B.lastTgtCtlPtW,ae=p.outerWidth(),se=B.lastTgtCtlPtH,le=p.outerHeight();if(B.badBezier=!!S,X!==Y||q!==K||Z!==Q||J!==ee||te!==ne||ie!==oe||re!==ae||se!==le||!(F===z&&V===W||c)){if(B.lastSrcCtlPtX=Y,B.lastSrcCtlPtY=K,B.lastSrcCtlPtW=Q,B.lastSrcCtlPtH=ee,B.lastTgtCtlPtX=ne,B.lastTgtCtlPtY=oe,B.lastTgtCtlPtW=ae,B.lastTgtCtlPtH=le,B.lastEdgeIndex=z,B.lastNumEdges=W,h===p){B.edgeType="self";var ce=s,de=U;c&&(ce=0,de=G),B.cp2ax=f.x,B.cp2ay=f.y-(1+Math.pow(m,1.12)/100)*de*(ce/3+1),B.cp2cx=h._private.position.x-(1+Math.pow(v,1.12)/100)*de*(ce/3+1),B.cp2cy=f.y,B.selfEdgeMidX=(B.cp2ax+B.cp2cx)/2,B.selfEdgeMidY=(B.cp2ay+B.cp2cy)/2}else if(T.length%2!=1||s!==Math.floor(T.length/2)||c){var ue,he=(.5-T.length/2+s)*U,pe=e.math.signum(he),fe=void 0!==(ue=c?G:void 0!==G?pe*G:void 0)?ue:he,ge=1-$,ve=$;H._private.source!==h&&(ge=$,ve=1-$);var me={x:A.x1*ge+A.x2*ve,y:A.y1*ge+A.y2*ve};B.edgeType="bezier",B.cp2x=me.x+_.x*fe,B.cp2y=me.y+_.y*fe}else B.edgeType="straight";this.findEndpoints(H);var ye=!e.is.number(B.startX)||!e.is.number(B.startY),we=!e.is.number(B.arrowStartX)||!e.is.number(B.arrowStartY),be=!e.is.number(B.endX)||!e.is.number(B.endY),Ce=!e.is.number(B.arrowEndX)||!e.is.number(B.arrowEndY),xe=3*(this.getArrowWidth(H._private.style.width.pxValue)*t.arrowShapeHeight),Ee=e.math.distance({x:B.cp2x,y:B.cp2y},{x:B.startX,y:B.startY}),_e=Ee<xe,Se=e.math.distance({x:B.cp2x,y:B.cp2y},{x:B.endX,y:B.endY}),ke=Se<xe;if("bezier"===B.edgeType){var Te=!1;if(ye||we||_e){Te=!0;var De={x:B.cp2x-f.x,y:B.cp2y-f.y},Re=Math.sqrt(De.x*De.x+De.y*De.y),Pe={x:De.x/Re,y:De.y/Re},Ae=Math.max(v,m),Ne={x:B.cp2x+2*Pe.x*Ae,y:B.cp2y+2*Pe.y*Ae},Me=b.intersectLine(f.x,f.y,v,m,Ne.x,Ne.y,x/2);_e?(B.cp2x=B.cp2x+Pe.x*(xe-Ee),B.cp2y=B.cp2y+Pe.y*(xe-Ee)):(B.cp2x=Me[0]+Pe.x*xe,B.cp2y=Me[1]+Pe.y*xe)}if(be||Ce||ke){Te=!0;var De={x:B.cp2x-g.x,y:B.cp2y-g.y},Re=Math.sqrt(De.x*De.x+De.y*De.y),Pe={x:De.x/Re,y:De.y/Re},Ae=Math.max(v,m),Ne={x:B.cp2x+2*Pe.x*Ae,y:B.cp2y+2*Pe.y*Ae},Oe=C.intersectLine(g.x,g.y,y,w,Ne.x,Ne.y,E/2);ke?(B.cp2x=B.cp2x+Pe.x*(xe-Se),B.cp2y=B.cp2y+Pe.y*(xe-Se)):(B.cp2x=Oe[0]+Pe.x*xe,B.cp2y=Oe[1]+Pe.y*xe)}Te&&this.findEndpoints(H)}else"straight"===B.edgeType&&(B.midX=(Y+ne)/2,B.midY=(K+oe)/2);this.projectBezier(H)}}}for(s=0;s<a.length;s++){var Ie=(H=a[s])._private.rscratch;if(!Ie.haystack){Le=2*Math.random()*Math.PI;Ie.source={x:Math.cos(Le),y:Math.sin(Le)};var Le=2*Math.random()*Math.PI;Ie.target={x:Math.cos(Le),y:Math.sin(Le)},Ie.edgeType="haystack",Ie.haystack=!0}}return o}},t.prototype.findEndpoints=function(n){var i,o=n.source()[0],r=n.target()[0],a=n._private.style["target-arrow-shape"].value,s=n._private.style["source-arrow-shape"].value,l=r._private.style["border-width"].pxValue,c=o._private.style["border-width"].pxValue,d=n._private.rscratch;if("self"==n._private.rscratch.edgeType){g=[d.cp2cx,d.cp2cy];i=t.nodeShapes[this.getNodeShape(r)].intersectLine(r._private.position.x,r._private.position.y,this.getNodeWidth(r),this.getNodeHeight(r),g[0],g[1],l/2);var u=e.math.shortenIntersection(i,g,t.arrowShapes[a].spacing(n)),h=e.math.shortenIntersection(i,g,t.arrowShapes[a].gap(n));d.endX=h[0],d.endY=h[1],d.arrowEndX=u[0],d.arrowEndY=u[1];g=[d.cp2ax,d.cp2ay];i=t.nodeShapes[this.getNodeShape(o)].intersectLine(o._private.position.x,o._private.position.y,this.getNodeWidth(o),this.getNodeHeight(o),g[0],g[1],c/2);var p=e.math.shortenIntersection(i,g,t.arrowShapes[s].spacing(n)),f=e.math.shortenIntersection(i,g,t.arrowShapes[s].gap(n));d.startX=f[0],d.startY=f[1],d.arrowStartX=p[0],d.arrowStartY=p[1]}else if("straight"==d.edgeType){0===(i=t.nodeShapes[this.getNodeShape(r)].intersectLine(r._private.position.x,r._private.position.y,this.getNodeWidth(r),this.getNodeHeight(r),o.position().x,o.position().y,l/2)).length?d.noArrowPlacement=!0:d.noArrowPlacement=!1;var u=e.math.shortenIntersection(i,[o.position().x,o.position().y],t.arrowShapes[a].spacing(n)),h=e.math.shortenIntersection(i,[o.position().x,o.position().y],t.arrowShapes[a].gap(n));d.endX=h[0],d.endY=h[1],d.arrowEndX=u[0],d.arrowEndY=u[1],0===(i=t.nodeShapes[this.getNodeShape(o)].intersectLine(o._private.position.x,o._private.position.y,this.getNodeWidth(o),this.getNodeHeight(o),r.position().x,r.position().y,c/2)).length?d.noArrowPlacement=!0:d.noArrowPlacement=!1;var p=e.math.shortenIntersection(i,[r.position().x,r.position().y],t.arrowShapes[s].spacing(n)),f=e.math.shortenIntersection(i,[r.position().x,r.position().y],t.arrowShapes[s].gap(n));d.startX=f[0],d.startY=f[1],d.arrowStartX=p[0],d.arrowStartY=p[1]}else if("bezier"==d.edgeType){var g=[d.cp2x,d.cp2y];i=t.nodeShapes[this.getNodeShape(r)].intersectLine(r._private.position.x,r._private.position.y,this.getNodeWidth(r),this.getNodeHeight(r),g[0],g[1],l/2);var u=e.math.shortenIntersection(i,g,t.arrowShapes[a].spacing(n)),h=e.math.shortenIntersection(i,g,t.arrowShapes[a].gap(n));d.endX=h[0],d.endY=h[1],d.arrowEndX=u[0],d.arrowEndY=u[1],i=t.nodeShapes[this.getNodeShape(o)].intersectLine(o._private.position.x,o._private.position.y,this.getNodeWidth(o),this.getNodeHeight(o),g[0],g[1],c/2);var p=e.math.shortenIntersection(i,g,t.arrowShapes[s].spacing(n)),f=e.math.shortenIntersection(i,g,t.arrowShapes[s].gap(n));d.startX=f[0],d.startY=f[1],d.arrowStartX=p[0],d.arrowStartY=p[1]}else if(d.isArcEdge)return},t.prototype.findEdges=function(e){for(var t=this.getCachedEdges(),n={},i=[],o=0;o<e.length;o++)n[e[o]._private.data.id]=e[o];for(o=0;o<t.length;o++)(n[t[o]._private.data.source]||n[t[o]._private.data.target])&&i.push(t[o]);return i},t.prototype.getArrowWidth=t.prototype.getArrowHeight=function(e){var t=this.arrowWidthCache=this.arrowWidthCache||{},n=t[e];return n||(n=Math.max(Math.pow(13.37*e,.9),29),t[e]=n,n)}}(cytoscape),function(e){"use strict";var t=cytoscape("renderer","canvas");t.prototype.drawEdge=function(e,n,i){var o=n._private.rscratch,r=t.usePaths();if(!o.badBezier&&("bezier"!==o.edgeType&&"straight"!==o.edgeType||!isNaN(o.startX))){var a=n._private.style;if(!(a.width.pxValue<=0)){var s=a["overlay-padding"].pxValue,l=a["overlay-opacity"].value,c=a["overlay-color"].value;if(i){if(0===l)return;this.strokeStyle(e,c[0],c[1],c[2],l),e.lineCap="round","self"!=n._private.rscratch.edgeType||r||(e.lineCap="butt")}else{var d=a["line-color"].value;this.strokeStyle(e,d[0],d[1],d[2],a.opacity.value),e.lineCap="butt"}var u,h,p,f;p=u=n._private.source;var g=(f=h=n._private.target)._private.position,v=f.width(),m=f.height(),y=p._private.position,w=p.width(),b=p.height(),C=a.width.pxValue+(i?2*s:0),x=i?"solid":a["line-style"].value;if(e.lineWidth=C,o.edgeType,"haystack"===o.edgeType){var E=a["haystack-radius"].value/2;this.drawStyledEdge(n,e,o.haystackPts=[o.source.x*w*E+y.x,o.source.y*b*E+y.y,o.target.x*v*E+g.x,o.target.y*m*E+g.y],x,C)}else if("self"===o.edgeType){var _=[(S=n._private.rscratch).startX,S.startY,S.cp2ax,S.cp2ay,S.selfEdgeMidX,S.selfEdgeMidY,S.selfEdgeMidX,S.selfEdgeMidY,S.cp2cx,S.cp2cy,S.endX,S.endY],S=n._private.rscratch;this.drawStyledEdge(n,e,_,x,C)}else if("straight"===o.edgeType){var k=h._private.position.x-u._private.position.x,T=h._private.position.y-u._private.position.y;if(k*(o.endX-o.startX)+T*(o.endY-o.startY)<0)o.straightEdgeTooShort=!0;else{S=o;this.drawStyledEdge(n,e,[S.startX,S.startY,S.endX,S.endY],x,C),o.straightEdgeTooShort=!1}}else{S=o;this.drawStyledEdge(n,e,[S.startX,S.startY,S.cp2x,S.cp2y,S.endX,S.endY],x,C)}"haystack"===o.edgeType?this.drawArrowheads(e,n,i):!0!==o.noArrowPlacement&&void 0!==o.startX&&this.drawArrowheads(e,n,i)}}},t.prototype.drawStyledEdge=function(e,n,i,o,r){var a,s=e._private.rscratch,l=n,c=!1,d=t.usePaths();if(d){for(var u=i,h=s.pathCacheKey&&u.length===s.pathCacheKey.length,p=0;h&&p<u.length;p++)s.pathCacheKey[p]!==u[p]&&(h=!1);h?(a=n=s.pathCache,c=!0):(a=n=new Path2D,s.pathCacheKey=u,s.pathCache=a)}if(l.setLineDash)switch(o){case"dotted":l.setLineDash([1,1]);break;case"dashed":l.setLineDash([6,3]);break;case"solid":l.setLineDash([])}c||(n.beginPath&&n.beginPath(),n.moveTo(i[0],i[1]),6===i.length?n.quadraticCurveTo(i[2],i[3],i[4],i[5]):12===i.length?(n.quadraticCurveTo(i[2],i[3],i[4],i[5]),n.quadraticCurveTo(i[8],i[9],i[10],i[11])):(n.lineTo(i[2],i[3]),n.closePath())),n=l,d?(n.lineWidth=6,n.strokeStyle="#7c7c7c",n.stroke(a)):n.stroke(),d?(n.lineWidth=5,n.strokeStyle="lightgrey",n.stroke(a)):n.stroke(),n.beginPath(),n.arc(i[0],i[1],6,0,2*Math.PI,!1),n.closePath(),n.fillStyle="lightgrey",n.fill(),n.beginPath(),n.arc(i[0],i[1],3,0,2*Math.PI,!1),n.closePath(),n.fillStyle="darkgrey",n.fill(),n.beginPath(),n.arc(i[2],i[3],6,0,2*Math.PI,!1),n.closePath(),n.fillStyle="lightgrey",n.fill(),n.beginPath(),n.arc(i[2],i[3],3,0,2*Math.PI,!1),n.closePath(),n.fillStyle="white",n.fill(),n.setLineDash&&n.setLineDash([])},t.prototype.drawArrowheads=function(e,t,n){function i(n,i,o,r,a){var s=g[n+"-arrow-shape"].value;if("none"!==s){var l=e.globalCompositeOperation;e.globalCompositeOperation="destination-out",u.fillStyle(e,255,255,255,1);var c="hollow"===g[n+"-arrow-fill"].value?"both":"filled",d=g[n+"-arrow-fill"].value;"half-triangle-overshot"===s&&(d="hollow",c="hollow"),u.drawArrowShape(t,n,e,c,g.width.pxValue,g[n+"-arrow-shape"].value,i,o,r,a),e.globalCompositeOperation=l;var h=g[n+"-arrow-color"].value;u.fillStyle(e,h[0],h[1],h[2],g.opacity.value),u.drawArrowShape(t,n,e,d,g.width.pxValue,g[n+"-arrow-shape"].value,i,o,r,a)}}if(!n){var o,r,a,s,l,c,d=t._private.rscratch,u=this,h="haystack"===d.edgeType,p=t.source().position(),f=t.target().position();h?(a=d.haystackPts[0],s=d.haystackPts[1],l=d.haystackPts[2],c=d.haystackPts[3]):(a=d.arrowStartX,s=d.arrowStartY,l=d.arrowEndX,c=d.arrowEndY);var g=t._private.style;o=a-p.x,r=s-p.y,h||isNaN(a)||isNaN(s)||isNaN(o)||isNaN(r)||i("source",a,s,o,r);var v=d.midX,m=d.midY;h&&(v=(a+l)/2,m=(s+c)/2),o=a-l,r=s-c,"self"===d.edgeType&&(o=1,r=-1),isNaN(v)||isNaN(m)||i("mid-target",v,m,o,r),o*=-1,r*=-1,isNaN(v)||isNaN(m)||i("mid-source",v,m,o,r),o=l-f.x,r=c-f.y,h||isNaN(l)||isNaN(c)||isNaN(o)||isNaN(r)||i("target",l,c,o,r)}},t.prototype.drawArrowShape=function(e,n,i,o,r,a,s,l,c,d){var u,h=t.usePaths(),p=e._private.rscratch,f=!1,g=i,v={x:s,y:l},m=Math.asin(d/Math.sqrt(c*c+d*d));c<0?m+=Math.PI/2:m=-(Math.PI/2+m);var y=this.getArrowWidth(r),w=t.arrowShapes[a];if(h){var b=y+"$"+a+"$"+m+"$"+s+"$"+l;p.arrowPathCacheKey=p.arrowPathCacheKey||{},p.arrowPathCache=p.arrowPathCache||{},p.arrowPathCacheKey[n]===b?(u=i=p.arrowPathCache[n],f=!0):(u=i=new Path2D,p.arrowPathCacheKey[n]=b,p.arrowPathCache[n]=u)}i.beginPath&&i.beginPath(),f||w.draw(i,y,m,v),!w.leavePathOpen&&i.closePath&&i.closePath(),i=g,"filled"!==o&&"both"!==o||(h?i.fill(u):i.fill()),"hollow"!==o&&"both"!==o||(i.lineWidth=w.matchEdgeWidth?r:1,i.lineJoin="miter",h?i.stroke(u):i.stroke())}}(),function(e){"use strict";var t=cytoscape("renderer","canvas");t.prototype.getCachedImage=function(e,t){var n=this,i=n.imageCache=n.imageCache||{};if(i[e]&&i[e].image)return i[e].image;var o=(i[e]=i[e]||{}).image=new Image;return o.addEventListener("load",t),o.src=e,o},t.prototype.drawInscribedImage=function(e,n,i){var o=this,r=i._private.position.x,a=i._private.position.y,s=i._private.style,l=s["background-fit"].value,c=s["background-position-x"],d=s["background-position-y"],u=s["background-repeat"].value,h=i.width(),p=i.height(),f=i._private.rscratch,g="node"===s["background-clip"].value,v=s["background-image-opacity"].value,m=n.width,y=n.height;if(0!==m&&0!==y){if("contain"===l)m*=w=Math.min(h/m,p/y),y*=w;else if("cover"===l){var w=Math.max(h/m,p/y);m*=w,y*=w}var b=r-h/2;"%"===c.units?b+=(h-m)*c.value/100:b+=c.pxValue;var C=a-p/2;"%"===d.units?C+=(p-y)*d.value/100:C+=d.pxValue,f.pathCache&&(b-=r,C-=a,r=0,a=0);var x=e.globalAlpha;if(e.globalAlpha=v,"no-repeat"===u)g&&(e.save(),f.pathCache?e.clip(f.pathCache):(t.nodeShapes[o.getNodeShape(i)].drawPath(e,r,a,h,p),e.clip())),e.drawImage(n,0,0,n.width,n.height,b,C,m,y),g&&e.restore();else{var E=e.createPattern(n,u);e.fillStyle=E,t.nodeShapes[o.getNodeShape(i)].drawPath(e,r,a,h,p),e.translate(b,C),e.fill(),e.translate(-b,-C)}e.globalAlpha=x}}}(),function(e){"use strict";var t=cytoscape("renderer","canvas");t.prototype.drawEdgeText=function(e,t){var n=t._private.style.content.strValue;if(n&&!n.match(/^\s+$/)&&!(this.hideEdgesOnViewport&&(this.dragData.didDrag||this.pinching||this.hoverData.dragging||this.data.wheel||this.swipePanning)||t._private.style["font-size"].pxValue*t.cy().zoom()<t._private.style["min-zoomed-font-size"].pxValue)){e.textAlign="center",e.textBaseline="middle";var i=t._private.rscratch;this.drawText(e,t,i.labelX,i.labelY)}},t.prototype.drawNodeText=function(e,t){var n=t._private.style.content.strValue;if(n&&!n.match(/^\s+$/)&&!(t._private.style["font-size"].pxValue*t.cy().zoom()<t._private.style["min-zoomed-font-size"].pxValue)){var i=t._private.style["text-halign"].strValue,o=t._private.style["text-valign"].strValue,r=t._private.rscratch;switch(i){case"left":e.textAlign="right";break;case"right":e.textAlign="left";break;default:e.textAlign="center"}switch(o){case"top":e.textBaseline="bottom";break;case"bottom":e.textBaseline="top";break;default:e.textBaseline="middle"}this.drawText(e,t,r.labelX,r.labelY+5)}},t.prototype.getFontCache=function(e){var t;this.fontCaches=this.fontCaches||[];for(var n=0;n<this.fontCaches.length;n++)if((t=this.fontCaches[n]).context===e)return t;return t={context:e},this.fontCaches.push(t),t},t.prototype.setupTextStyle=function(e,t){var n=t.effectiveOpacity(),i=t._private.style,o=i["font-style"].strValue,r=i["font-size"].pxValue+"px",a=i["font-family"].strValue,s=i["font-weight"].strValue,l=i["text-opacity"].value*i.opacity.value*n,c=i["text-outline-opacity"].value*l,d=i.color.value,u=i["text-outline-color"].value,h=t._private.fontKey,p=this.getFontCache(e);p.key!==h&&(e.font=o+" "+s+" "+r+" "+a,p.key=h);var f=String(i.content.value),g=i["text-transform"].value;return"none"==g||("uppercase"==g?f=f.toUpperCase():"lowercase"==g&&(f=f.toLowerCase())),e.lineJoin="round",this.fillStyle(e,d[0],d[1],d[2],l),this.strokeStyle(e,u[0],u[1],u[2],c),f},t.prototype.drawText=function(e,t,n,i){var o=t._private.style;if(0!==t.effectiveOpacity()){var r=this.setupTextStyle(e,t);if(null!=r&&!isNaN(n)&&!isNaN(i)){var a=2*o["text-outline-width"].value;a>0&&(e.lineWidth=a,e.strokeText(r,n,i)),e.fillText(r,n,i)}}}}(),function(e){"use strict";var t=e("renderer","canvas");t.prototype.drawNode=function(e,n,i){var o,r,a,s=this,l=n._private.style,c=n._private.rscratch,d=t.usePaths(),u=e,h=!1,p=l["overlay-padding"].pxValue,f=l["overlay-opacity"].value,g=l["overlay-color"].value;if(!i||0!==f){var v=n.effectiveOpacity();if(0!==v)if(o=this.getNodeWidth(n),r=this.getNodeHeight(n),e.lineWidth=l["border-width"].pxValue,void 0!==i&&i)f>0&&(this.fillStyle(e,g[0],g[1],g[2],f),t.nodeShapes.roundrectangle.drawPath(e,n._private.position.x,n._private.position.y,o+2*p,r+2*p),e.fill());else{var m=l["background-color"].value,y=l["border-color"].value,w=l["border-style"].value;if(this.fillStyle(e,m[0],m[1],m[2],l["background-opacity"].value*l.opacity.value*v),this.strokeStyle(e,y[0],y[1],y[2],l["border-opacity"].value*l.opacity.value*v),e.lineJoin="miter",e.setLineDash)switch(w){case"dotted":e.setLineDash([1,1]);break;case"dashed":e.setLineDash([4,2]);break;case"solid":case"double":e.setLineDash([])}var b=l["background-image"].value[2]||l["background-image"].value[1],C=l.shape.strValue,x=n._private.position;if(d){var E=C+"$"+o+"$"+r;e.translate(x.x,x.y),c.pathCacheKey===E?(a=e=c.pathCache,h=!0):(a=e=new Path2D,c.pathCacheKey=E,c.pathCache=a)}if(!h){var _=x;d&&(_={x:0,y:0}),t.nodeShapes[this.getNodeShape(n)].drawPath(e,_.x,_.y,o,r)}if(e=u,d?e.fill(a):e.fill(),void 0!==b){var S=this.getCachedImage(b,function(){s.data.canvasNeedsRedraw[t.NODE]=!0,s.data.canvasNeedsRedraw[t.DRAG]=!0,s.redraw()});S.complete&&this.drawInscribedImage(e,S,n)}var k=l["background-blacken"].value,T=l["border-width"].pxValue;if(this.hasPie(n)&&(this.drawPie(e,n),0===k&&0===T||d||t.nodeShapes[this.getNodeShape(n)].drawPath(e,x.x,x.y,o,r)),k>0?(this.fillStyle(e,0,0,0,k),d?e.fill(a):e.fill()):k<0&&(this.fillStyle(e,255,255,255,-k),d?e.fill(a):e.fill()),"reset"==n._private.data.id){D=e.lineWidth;e.beginPath(),e.lineWidth=2.2,e.lineCap="square",e.strokeStyle="white",e.moveTo(-3,-3),e.lineTo(3,3),e.moveTo(-3,3),e.lineTo(3,-3),e.stroke(),e.beginPath(),e.lineWidth=1.2,e.strokeStyle="#333333",e.moveTo(-4,8),e.lineTo(-4.5,8),e.lineTo(-3,9.9),e.lineTo(-1.5,8),e.lineTo(-4,8),e.lineTo(-3,9),e.stroke(),e.closePath(),e.lineWidth=D}else if("info"==n._private.data.id){var D=e.lineWidth,R=e.font;e.beginPath(),e.lineWidth=3,e.strokeStyle="white",e.fillStyle="white",e.font="bold 12pt 'Courier New', Courier, monospace",e.fillText("i",0,-8),e.closePath(),e.lineWidth=D,e.font=R}else if("inputdirectory"==n._private.data.type){D=e.lineWidth;e.beginPath(),e.lineWidth=2,e.lineCap="round",e.strokeStyle="white",e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=8,e.shadowColor="#353535",e.arc(0,0,30,0,2*Math.PI,!1),e.stroke(),e.beginPath(),e.shadowOffsetX=2,e.shadowOffsetY=3,e.moveTo(11.5,-6),e.lineTo(11.5,9),e.lineTo(-11.5,9),e.lineTo(-11.5,-9),e.lineTo(-2,-9),e.lineTo(2,-6),e.lineTo(11.5,-6),e.stroke(),e.closePath(),e.lineWidth=.75,e.beginPath(),e.moveTo(-8.5,-6),e.lineTo(-3.5,-6),e.stroke(),e.closePath(),e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=0}else if("inputfile"==n._private.data.type){D=e.lineWidth;e.beginPath(),e.lineWidth=2,e.lineCap="round",e.strokeStyle="white",e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=8,e.shadowColor="#353535",e.arc(0,0,30,0,2*Math.PI,!1),e.stroke(),e.beginPath(),e.shadowOffsetX=2,e.shadowOffsetY=3,e.moveTo(8,10),e.lineTo(-8,10),e.moveTo(-8,10),e.lineTo(-8,-10),e.moveTo(-8,-10),e.lineTo(4,-10),e.moveTo(8,10),e.lineTo(8,-6),e.moveTo(8,-6),e.lineTo(4,-10),e.moveTo(8,-6),e.lineTo(4,-6),e.moveTo(4,-10),e.lineTo(4,-6),e.stroke(),e.closePath(),e.lineWidth=.75,e.beginPath(),e.moveTo(-5,-5.7),e.lineTo(1,-5.7),e.moveTo(-5,-2.7),e.lineTo(5,-2.7),e.moveTo(-5,.3),e.lineTo(5,.3),e.moveTo(-5,3.3),e.lineTo(5,3.3),e.moveTo(-5,6.3),e.lineTo(5,6.3),e.stroke(),e.closePath(),e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=0}else if("inputfiles"==n._private.data.type){D=e.lineWidth;e.beginPath(),e.lineWidth=2,e.lineCap="round",e.strokeStyle="white",e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=8,e.shadowColor="#353535",e.arc(0,0,30,0,2*Math.PI,!1),e.stroke(),e.beginPath(),e.shadowOffsetX=2,e.shadowOffsetY=3,e.moveTo(-6,6),e.lineTo(-11,6),e.moveTo(-11,6),e.lineTo(-11,-14),e.moveTo(-11,-14),e.lineTo(1,-14),e.moveTo(5,-7),e.lineTo(5,-10),e.moveTo(5,-10),e.lineTo(1,-14),e.moveTo(5,-10),e.lineTo(1,-10),e.moveTo(1,-14),e.lineTo(1,-10),e.stroke(),e.closePath(),e.lineWidth=.75,e.beginPath(),e.moveTo(-8,-9.7),e.lineTo(-2,-9.7),e.moveTo(-8,-6.7),e.lineTo(-5,-6.7),e.moveTo(-8,-3.7),e.lineTo(-6,-3.7),e.moveTo(-8,-.7),e.lineTo(-6,-.7),e.moveTo(-8,2.3),e.lineTo(-6,2.3),e.stroke(),e.closePath(),e.lineWidth=2,e.beginPath(),e.moveTo(11,14),e.lineTo(-5,14),e.moveTo(-5,14),e.lineTo(-5,-6),e.moveTo(-5,-6),e.lineTo(7,-6),e.moveTo(11,14),e.lineTo(11,-2),e.moveTo(11,-2),e.lineTo(7,-6),e.moveTo(11,-2),e.lineTo(7,-2),e.moveTo(7,-6),e.lineTo(7,-2),e.stroke(),e.closePath(),e.lineWidth=.75,e.beginPath(),e.moveTo(-2,-1.7),e.lineTo(4,-1.7),e.moveTo(-2,1.3),e.lineTo(8,1.3),e.moveTo(-2,4.3),e.lineTo(8,4.3),e.moveTo(-2,7.3),e.lineTo(8,7.3),e.moveTo(-2,10.3),e.lineTo(8,10.3),e.stroke(),e.closePath(),e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=0}else if("component"==n._private.data.type){var D=e.lineWidth,P=e.strokeStyle;e.beginPath(),e.lineWidth=2.5,e.lineCap="square",e.strokeStyle="white",e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=8,e.shadowColor="#353535",e.arc(0,0,39,0,2*Math.PI,!1),e.stroke(),e.beginPath(),e.shadowOffsetX=2,e.shadowOffsetY=3,e.arc(2,-9,8,0,2*Math.PI,!1),e.arc(2,-9,10.4,0,.03*Math.PI,!1),e.moveTo(8,-3),e.arc(2,-9,10.4,.25*Math.PI,.28*Math.PI,!1),e.moveTo(2,-1),e.arc(2,-9,10.4,.5*Math.PI,.53*Math.PI,!1),e.moveTo(-4,-3),e.arc(2,-9,10.4,.75*Math.PI,.78*Math.PI,!1),e.moveTo(-6,-9),e.arc(2,-9,10.4,1*Math.PI,1.03*Math.PI,!1),e.moveTo(-4,-15),e.arc(2,-9,10.4,1.25*Math.PI,1.28*Math.PI,!1),e.moveTo(2,-17),e.arc(2,-9,10.4,1.5*Math.PI,1.53*Math.PI,!1),e.moveTo(8,-15),e.arc(2,-9,10.4,1.75*Math.PI,1.78*Math.PI,!1),e.stroke(),e.beginPath(),e.arc(-7,9,6,.15*Math.PI,2.15*Math.PI,!1),e.moveTo(-1,12),e.arc(-7,9,8.4,.15*Math.PI,.18*Math.PI,!1),e.moveTo(-5,15),e.arc(-7,9,8.4,.4*Math.PI,.43*Math.PI,!1),e.moveTo(-10,15),e.arc(-7,9,8.4,.65*Math.PI,.68*Math.PI,!1),e.moveTo(-13,11),e.arc(-7,9,8.4,.9*Math.PI,.93*Math.PI,!1),e.moveTo(-13,6),e.arc(-7,9,8.4,1.15*Math.PI,1.18*Math.PI,!1),e.moveTo(-9,3),e.arc(-7,9,8.4,1.4*Math.PI,1.43*Math.PI,!1),e.moveTo(-4,3),e.arc(-7,9,8.4,1.65*Math.PI,1.68*Math.PI,!1),e.moveTo(-1,7),e.arc(-7,9,8.4,1.9*Math.PI,1.93*Math.PI,!1),e.stroke(),e.beginPath(),e.arc(8,10,3,0,2*Math.PI,!1),e.arc(8,10,5,0,0*Math.PI,!1),e.moveTo(10,13.5),e.arc(8,10,5,.33*Math.PI,.33*Math.PI,!1),e.moveTo(6.2,13.5),e.arc(8,10,5,.66*Math.PI,.66*Math.PI,!1),e.moveTo(5,10),e.arc(8,10,5,.99*Math.PI,.99*Math.PI,!1),e.moveTo(6.2,7),e.arc(8,10,5,1.33*Math.PI,1.33*Math.PI,!1),e.moveTo(9.8,7),e.arc(8,10,5,1.66*Math.PI,1.66*Math.PI,!1),e.stroke(),e.closePath(),e.lineWidth=D,e.strokeStyle=P,e.shadowOffsetX=0,e.shadowOffsetY=0,e.shadowBlur=0}if(T>0&&(d?e.stroke(a):e.stroke(),"double"===w)){e.lineWidth=l["border-width"].pxValue/3;var A=e.globalCompositeOperation;e.globalCompositeOperation="destination-out",d?e.stroke(a):e.stroke(),e.globalCompositeOperation=A}d&&e.translate(-x.x,-x.y),e.setLineDash&&e.setLineDash([])}}},t.prototype.hasPie=function(e){return(e=e[0])._private.hasPie},t.prototype.drawPie=function(n,i){var o=(i=i[0])._private.style["pie-size"],r=this.getNodeWidth(i),a=this.getNodeHeight(i),s=i._private.position.x,l=i._private.position.y,c=Math.min(r,a)/2,d=0;t.usePaths()&&(s=0,l=0),"%"===o.units?c=c*o.value/100:void 0!==o.pxValue&&(c=o.pxValue/2);for(var u=1;u<=e.style.pieBackgroundN;u++){var h=i._private.style["pie-"+u+"-background-size"].value,p=i._private.style["pie-"+u+"-background-color"].value,f=i._private.style["pie-"+u+"-background-opacity"].value,g=h/100,v=1.5*Math.PI+2*Math.PI*d,m=v+2*Math.PI*g;0===h||d>=1||d+g>1||(n.beginPath(),n.moveTo(s,l),n.arc(s,l,c,v,m),n.closePath(),this.fillStyle(n,p[0],p[1],p[2],f),n.fill(),d+=g)}n.globalAlpha=1,n.beginPath(),n.arc(s,l,30,0,2*Math.PI,!1);var y=n.createLinearGradient(0,0,0,40);"0.8px"==i[0].css("border-width")?(n.shadowColor="darkgrey",n.shadowBlur=3,y.addColorStop(0,"#8f8f8f"),y.addColorStop(1,"#b3b3b3")):(n.shadowColor="darkgrey",n.shadowBlur=0,y.addColorStop(0,"#7c7c7c"),y.addColorStop(1,"#a2a2a2")),n.fillStyle=y,n.fill(),n.closePath(),n.beginPath(),n.lineWidth=2,n.lineCap="square",n.moveTo(s,l-39),n.lineTo(s,l-31),n.strokeStyle="white",n.stroke(),n.closePath()}}(cytoscape),function(e){"use strict";var t=e("renderer","canvas");t.prototype.getPixelRatio=function(){var e=this.data.contexts[0];if(null!=this.forcedPixelRatio)return this.forcedPixelRatio;var t=e.backingStorePixelRatio||e.webkitBackingStorePixelRatio||e.mozBackingStorePixelRatio||e.msBackingStorePixelRatio||e.oBackingStorePixelRatio||e.backingStorePixelRatio||1;return(window.devicePixelRatio||1)/t},t.prototype.paintCache=function(e){for(var t,n=this.paintCaches=this.paintCaches||[],i=!0,o=0;o<n.length;o++)if((t=n[o]).context===e){i=!1;break}return i&&(t={context:e},n.push(t)),t},t.prototype.fillStyle=function(e,t,n,i,o){e.fillStyle="rgba("+t+","+n+","+i+","+o+")"},t.prototype.strokeStyle=function(e,t,n,i,o){e.strokeStyle="rgba("+t+","+n+","+i+","+o+")"},t.prototype.matchCanvasSize=function(e){var n,i=this.data,o=e.clientWidth,r=e.clientHeight,a=this.getPixelRatio(),s=o*a,l=r*a;if(s!==this.canvasWidth||l!==this.canvasHeight){this.fontCaches=null;var c=i.canvasContainer;c.style.width=o+"px",c.style.height=r+"px";for(d=0;d<t.CANVAS_LAYERS;d++)(n=i.canvases[d]).width===s&&n.height===l||(n.width=s,n.height=l,n.style.width=o+"px",n.style.height=r+"px");for(var d=0;d<t.BUFFER_COUNT;d++)(n=i.bufferCanvases[d]).width===s&&n.height===l||(n.width=s,n.height=l,n.style.width=o+"px",n.style.height=r+"px");this.textureMult=1,a<=1&&(n=i.bufferCanvases[t.TEXTURE_BUFFER],this.textureMult=2,n.width=s*this.textureMult,n.height=l*this.textureMult),this.canvasWidth=s,this.canvasHeight=l}},t.prototype.renderTo=function(e,t,n,i){this.redraw({forcedContext:e,forcedZoom:t,forcedPan:n,drawAllLayers:!0,forcedPxRatio:i})},t.prototype.timeToRender=function(){return this.redrawTotalTime/this.redrawCount},t.minRedrawLimit=1e3/60,t.maxRedrawLimit=1e3,t.motionBlurDelay=100,t.prototype.redraw=function(n){function i(){function n(e,t){if(e.setTransform(1,0,0,1,0,0),"motionBlur"===t){var n=e.globalCompositeOperation;e.globalCompositeOperation="destination-out",c.fillStyle(e,255,255,255,.666),e.fillRect(0,0,c.canvasWidth,c.canvasHeight),e.globalCompositeOperation=n}else o||void 0!==t&&!t||e.clearRect(0,0,c.canvasWidth,c.canvasHeight);r||(e.translate(C.x,C.y),e.scale(y,y)),l&&e.translate(l.x,l.y),s&&e.scale(s,s)}function i(e,t){for(var n=e.eles,i=0;i<n.length;i++){var o=n[i];o.isNode()?(c.drawNode(t,o),A||c.drawNodeText(t,o),c.drawNode(t,o,!0)):P||(c.drawEdge(t,o),A||c.drawEdgeText(t,o),c.drawEdge(t,o,!0))}}var g=c.getCachedEdges(),v=u.style()._private.coreStyle,m=u.zoom(),y=void 0!==s?s:m,w=u.pan(),C={x:w.x,y:w.y};l&&(C=l),y*=d,C.x*=d,C.y*=d;var x={drag:{nodes:[],edges:[],eles:[]},nondrag:{nodes:[],edges:[],eles:[]}};if(c.textureOnViewport&&!o&&(c.pinching||c.hoverData.dragging||c.swipePanning||c.data.wheelZooming)){if(!c.textureCache){c.textureCache={},L=c.textureCache.bb=u.elements().boundingBox(),c.textureCache.texture=c.data.bufferCanvases[t.TEXTURE_BUFFER];var E=c.data.bufferContexts[t.TEXTURE_BUFFER];E.setTransform(1,0,0,1,0,0),E.clearRect(0,0,c.canvasWidth*c.textureMult,c.canvasHeight*c.textureMult),c.redraw({forcedContext:E,drawOnlyNodeLayer:!0,forcedPxRatio:d*c.textureMult}),(k=c.textureCache.viewport={zoom:u.zoom(),pan:u.pan(),width:c.canvasWidth,height:c.canvasHeight}).mpan={x:(0-k.pan.x)/k.zoom,y:(0-k.pan.y)/k.zoom}}p[t.DRAG]=!1,p[t.NODE]=!1;var _=h.contexts[t.NODE],S=c.textureCache.texture,k=c.textureCache.viewport;L=c.textureCache.bb,_.setTransform(1,0,0,1,0,0),_.clearRect(0,0,k.width,k.height);var T=v["outside-texture-bg-color"].value,D=v["outside-texture-bg-opacity"].value;c.fillStyle(_,T[0],T[1],T[2],D),_.fillRect(0,0,k.width,k.height);m=u.zoom();n(_,!1),_.clearRect(k.mpan.x,k.mpan.y,k.width/k.zoom/d,k.height/k.zoom/d),_.drawImage(S,k.mpan.x,k.mpan.y,k.width/k.zoom/d,k.height/k.zoom/d)}else c.textureOnViewport&&!o&&(c.textureCache=null);var R=c.pinching||c.hoverData.dragging||c.swipePanning||c.data.wheelZooming||c.hoverData.draggingEles,P=c.hideEdgesOnViewport&&R,A=c.hideLabelsOnViewport&&R;if(p[t.DRAG]||p[t.NODE]||r||a){P||c.findEdgeControlPoints(g);for(var N=c.getCachedZSortedEles(),M=u.extent(),O=0;O<N.length;O++){var I=N[O],L=o?null:I.boundingBox();(!!o||e.math.boundingBoxesIntersect(M,L))&&(I._private.rscratch.inDragLayer?x.drag:x.nondrag).eles.push(I)}}var H=p[t.DRAG]&&!p[t.NODE]&&f&&!c.clearedNodeLayerForMotionBlur;if(H&&(c.clearedNodeLayerForMotionBlur=!0),(p[t.NODE]||r||a||H)&&(n(_=o||h.contexts[t.NODE],f&&!H?"motionBlur":void 0),i(x.nondrag,_),r||(p[t.NODE]=!1)),a||!p[t.DRAG]&&!r||(n(_=o||h.contexts[t.DRAG],f?"motionBlur":void 0),i(x.drag,_),r||(p[t.DRAG]=!1)),c.showFps||!a&&p[t.SELECT_BOX]&&!r){if(n(_=o||h.contexts[t.SELECT_BOX]),1==h.select[4]){var m=h.cy.zoom(),B=v["selection-box-border-width"].value/m;_.lineWidth=B,_.fillStyle="rgba("+v["selection-box-color"].value[0]+","+v["selection-box-color"].value[1]+","+v["selection-box-color"].value[2]+","+v["selection-box-opacity"].value+")",_.fillRect(h.select[0],h.select[1],h.select[2]-h.select[0],h.select[3]-h.select[1]),B>0&&(_.strokeStyle="rgba("+v["selection-box-border-color"].value[0]+","+v["selection-box-border-color"].value[1]+","+v["selection-box-border-color"].value[2]+","+v["selection-box-opacity"].value+")",_.strokeRect(h.select[0],h.select[1],h.select[2]-h.select[0],h.select[3]-h.select[1]))}if(h.bgActivePosistion){m=h.cy.zoom(),h.bgActivePosistion;_.fillStyle="rgba("+v["active-bg-color"].value[0]+","+v["active-bg-color"].value[1]+","+v["active-bg-color"].value[2]+","+v["active-bg-opacity"].value+")"}var F=c.averageRedrawTime;if(c.showFps&&F){F=Math.round(F);var z=Math.round(1e3/F);_.setTransform(1,0,0,1,0,0),_.fillStyle="rgba(255, 0, 0, 0.75)",_.strokeStyle="rgba(255, 0, 0, 0.75)",_.lineWidth=1,_.fillText("1 frame = "+F+" ms = "+z+" fps",0,20);_.strokeRect(0,30,250,20),_.fillRect(0,30,250*Math.min(z/60,1),20)}r||(p[t.SELECT_BOX]=!1)}var V=+new Date;void 0===c.averageRedrawTime&&(c.averageRedrawTime=V-b),void 0===c.redrawCount&&(c.redrawCount=0),c.redrawCount++,void 0===c.redrawTotalTime&&(c.redrawTotalTime=0),c.redrawTotalTime+=V-b,c.lastRedrawTime=V-b,c.averageRedrawTime=c.averageRedrawTime/2+(V-b)/2,c.currentlyDrawing=!1,c.clearingMotionBlur&&(c.clearingMotionBlur=!1,c.motionBlurCleared=!0,c.motionBlur=!0),f&&(c.motionBlurTimeout=setTimeout(function(){c.motionBlurTimeout=null,c.clearedNodeLayerForMotionBlur=!1,c.motionBlur=!1,c.clearingMotionBlur=!0,p[t.NODE]=!0,p[t.DRAG]=!0,c.redraw()},t.motionBlurDelay))}var o=(n=n||{}).forcedContext,r=n.drawAllLayers,a=n.drawOnlyNodeLayer,s=n.forcedZoom,l=n.forcedPan,c=this,d=void 0===n.forcedPxRatio?this.getPixelRatio():n.forcedPxRatio,u=c.data.cy,h=c.data,p=h.canvasNeedsRedraw,f=void 0!==n.motionBlur?n.motionBlur:c.motionBlur;f=f&&!o&&c.motionBlurEnabled,c.motionBlurTimeout&&clearTimeout(c.motionBlurTimeout),this.redrawTimeout&&clearTimeout(this.redrawTimeout),this.redrawTimeout=null,void 0===this.averageRedrawTime&&(this.averageRedrawTime=0);var g=t.minRedrawLimit,v=t.maxRedrawLimit,m=this.averageRedrawTime;m=(m=g>m?g:m)<v?m:v,void 0===this.lastDrawTime&&(this.lastDrawTime=0);var y=+new Date,w=y-this.lastDrawTime>=m;if(!o){if(!w||this.currentlyDrawing)return void(this.redrawTimeout=setTimeout(function(){c.redraw()},m));this.lastDrawTime=y,this.currentlyDrawing=!0}var b=+new Date;o?i():e.util.requestAnimationFrame(i),o||c.initrender||(c.initrender=!0,u.trigger("initrender"))}}(cytoscape),function(e){"use strict";var t=e("renderer","canvas");t.prototype.drawPolygonPath=function(e,t,n,i,o,r){var a=i/2,s=o/2;e.beginPath&&e.beginPath(),e.moveTo(t+a*r[0],n+s*r[1]);for(var l=1;l<r.length/2;l++)e.lineTo(t+a*r[2*l],n+s*r[2*l+1]);e.closePath()},t.prototype.drawPolygon=function(e,t,n,i,o,r){this.drawPolygonPath(e,t,n,i,o,r),e.fill()},t.prototype.drawRoundRectanglePath=function(t,n,i,o,r,a){var s=o/2,l=r/2,c=e.math.getRoundRectangleRadius(o,r);t.beginPath&&t.beginPath(),t.moveTo(n,i-l),t.arcTo(n+s,i-l,n+s,i,c),t.arcTo(n+s,i+l,n,i+l,c),t.arcTo(n-s,i+l,n-s,i,c),t.arcTo(n-s,i-l,n,i-l,c),t.lineTo(n,i-l),t.closePath()},t.prototype.drawRoundRectangle=function(e,t,n,i,o,r){this.drawRoundRectanglePath(e,t,n,i,o,r),e.fill()}}(cytoscape),function(e){"use strict";var t=cytoscape("renderer","canvas");t.prototype.createBuffer=function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,[n,n.getContext("2d")]},t.prototype.bufferCanvasImage=function(e){var t=this.data.cy,n=t.elements().boundingBox(),i=e.full?Math.ceil(n.w):this.data.container.clientWidth,o=e.full?Math.ceil(n.h):this.data.container.clientHeight,r=1;void 0!==e.scale&&(i*=e.scale,o*=e.scale,r=e.scale);var a=document.createElement("canvas");a.width=i,a.height=o,a.style.width=i+"px",a.style.height=o+"px";var s=a.getContext("2d");if(i>0&&o>0)if(s.clearRect(0,0,i,o),e.bg&&(s.fillStyle=e.bg,s.rect(0,0,i,o),s.fill()),s.globalCompositeOperation="source-over",e.full)this.redraw({forcedContext:s,drawAllLayers:!0,forcedZoom:r,forcedPan:{x:-n.x1*r,y:-n.y1*r},forcedPxRatio:1});else{var l=t.pan(),c={x:l.x*r,y:l.y*r},d=t.zoom()*r;this.redraw({forcedContext:s,drawAllLayers:!0,forcedZoom:d,forcedPan:c,forcedPxRatio:1})}return a},t.prototype.png=function(e){return this.bufferCanvasImage(e).toDataURL("image/png")}}(),function(e){"use strict";var t=e("renderer","canvas");t.prototype.registerBinding=function(e,t,n,i){this.bindings.push({target:e,event:t,handler:n,useCapture:i}),e.addEventListener(t,n,i)},t.prototype.nodeIsDraggable=function(e){return!(0===e._private.style.opacity.value||"visible"!=e._private.style.visibility.value||"element"!=e._private.style.display.value||e.locked()||!e.grabbable())},t.prototype.load=function(){var n=this,i=function(e){var t;if(e.addToList&&n.data.cy.hasCompoundNodes()){if(!e.addToList.hasId){e.addToList.hasId={};for(var i=0;i<e.addToList.length;i++){var o=e.addToList[i];e.addToList.hasId[o.id()]=!0}}t=e.addToList.hasId}return t||{}},o=function(e,t){if(e._private.cy.hasCompoundNodes())for(var n=i(t),o=e.descendants(),r=0;r<o.size();r++){var a=o[r],s=a._private;t.inDragLayer&&(s.rscratch.inDragLayer=!0),t.addToList&&!n[a.id()]&&(t.addToList.push(a),n[a.id()]=!0,s.grabbed=!0);for(var l=s.edges,c=0;t.inDragLayer&&c<l.length;c++)l[c]._private.rscratch.inDragLayer=!0}},r=function(e,t){var n=e._private,r=i(t);t.inDragLayer&&(n.rscratch.inDragLayer=!0),t.addToList&&!r[e.id()]&&(t.addToList.push(e),r[e.id()]=!0,n.grabbed=!0);for(var s=n.edges,l=0;t.inDragLayer&&l<s.length;l++)s[l]._private.rscratch.inDragLayer=!0;o(e,t),a(e,{inDragLayer:!0})},a=function(e,t){var n=e;if(e._private.cy.hasCompoundNodes()){for(;n.parent().nonempty();)n=n.parent()[0];if(n!=e){for(var o=n.descendants().add(n).not(e).not(e.descendants()),r=o.connectedEdges(),a=i(t),s=0;s<o.size();s++)void 0!==t.inDragLayer&&(o[s]._private.rscratch.inDragLayer=t.inDragLayer),t.addToList&&!a[o[s].id()]&&(t.addToList.push(o[s]),a[o[s].id()]=!0,o[s]._private.grabbed=!0);for(var l=0;void 0!==t.inDragLayer&&l<r.length;l++)r[l]._private.rscratch.inDragLayer=t.inDragLayer}}};"undefined"!=typeof MutationObserver?(n.removeObserver=new MutationObserver(function(e){for(var t=0;t<e.length;t++){var i=e[t].removedNodes;if(i)for(var o=0;o<i.length;o++)if(i[o]===n.data.container){n.destroy();break}}}),n.removeObserver.observe(n.data.container.parentNode,{childList:!0})):n.registerBinding(n.data.container,"DOMNodeRemoved",function(e){n.destroy()}),n.registerBinding(window,"resize",e.util.debounce(function(e){n.invalidateContainerClientCoordsCache(),n.matchCanvasSize(n.data.container),n.data.canvasNeedsRedraw[t.NODE]=!0,n.redraw()},100));for(var s=n.data.cy.container();function(e){n.registerBinding(e,"scroll",function(e){n.invalidateContainerClientCoordsCache()})}(s),s.parentNode;)s=s.parentNode;n.registerBinding(n.data.container,"contextmenu",function(e){e.preventDefault()});var l=function(){return 0!==n.data.select[4]};n.registerBinding(n.data.container,"mousedown",function(i){i.preventDefault(),n.hoverData.capture=!0,n.hoverData.which=i.which;var o=n.data.cy,a=n.projectIntoViewport(i.clientX,i.clientY),s=n.data.select,l=n.findNearestElement(a[0],a[1],!0),c=n.dragData.possibleDragElements;n.hoverData.mdownPos=a;var d=function(){n.hoverData.tapholdCancelled=!1,clearTimeout(n.hoverData.tapholdTimeout),n.hoverData.tapholdTimeout=setTimeout(function(){if(!n.hoverData.tapholdCancelled){var t=n.hoverData.down;t?t.trigger(new e.Event(i,{type:"taphold",cyPosition:{x:a[0],y:a[1]}})):o.trigger(new e.Event(i,{type:"taphold",cyPosition:{x:a[0],y:a[1]}}))}},n.tapholdDuration)};if(3==i.which){n.hoverData.cxtStarted=!0;var u=new e.Event(i,{type:"cxttapstart",cyPosition:{x:a[0],y:a[1]}});l?(l.activate(),l.trigger(u),n.hoverData.down=l):o.trigger(u),n.hoverData.downTime=(new Date).getTime(),n.hoverData.cxtDragged=!1}else if(1==i.which){if(null!=l){if(n.nodeIsDraggable(l)){var h=new e.Event(i,{type:"grab",cyPosition:{x:a[0],y:a[1]}});if(l.isNode()&&!l.selected())c=n.dragData.possibleDragElements=[],r(l,{addToList:c}),l.trigger(h);else if(l.isNode()&&l.selected()){c=n.dragData.possibleDragElements=[];for(var p=o.$(function(){return this.isNode()&&this.selected()}),f=0;f<p.length;f++)n.nodeIsDraggable(p[f])&&r(p[f],{addToList:c});l.trigger(h)}n.data.canvasNeedsRedraw[t.NODE]=!0,n.data.canvasNeedsRedraw[t.DRAG]=!0}l.trigger(new e.Event(i,{type:"mousedown",cyPosition:{x:a[0],y:a[1]}})).trigger(new e.Event(i,{type:"tapstart",cyPosition:{x:a[0],y:a[1]}})).trigger(new e.Event(i,{type:"vmousedown",cyPosition:{x:a[0],y:a[1]}}))}else null==l&&o.trigger(new e.Event(i,{type:"mousedown",cyPosition:{x:a[0],y:a[1]}})).trigger(new e.Event(i,{type:"tapstart",cyPosition:{x:a[0],y:a[1]}})).trigger(new e.Event(i,{type:"vmousedown",cyPosition:{x:a[0],y:a[1]}}));if(n.hoverData.down=l,n.hoverData.downTime=(new Date).getTime(),null==l||l.isEdge()){s[4]=1;var g=Math.max(0,t.panOrBoxSelectDelay-(+new Date-n.hoverData.downTime));clearTimeout(n.bgActiveTimeout),o.boxSelectionEnabled()||l&&l.isEdge()?n.bgActiveTimeout=setTimeout(function(){l&&l.unactivate(),n.data.bgActivePosistion={x:a[0],y:a[1]},d(),n.data.canvasNeedsRedraw[t.SELECT_BOX]=!0,n.redraw()},g):(n.data.bgActivePosistion={x:a[0],y:a[1]},d(),n.data.canvasNeedsRedraw[t.SELECT_BOX]=!0,n.redraw())}}s[0]=s[2]=a[0],s[1]=s[3]=a[1]},!1),n.registerBinding(window,"mousemove",e.util.throttle(function(i){var o=!1;if(!n.hoverData.capture){var a=n.findContainerClientCoords();if(!(i.clientX>a[0]&&i.clientX<a[0]+n.canvasWidth&&i.clientY>a[1]&&i.clientY<a[1]+n.canvasHeight))return;for(var s=n.data.container,l=i.target.parentNode,c=!1;l;){if(l===s){c=!0;break}l=l.parentNode}if(!c)return}var d=n.data.cy,u=d.zoom(),h=(d.pan(),n.projectIntoViewport(i.clientX,i.clientY)),p=n.data.select,f=null;n.hoverData.draggingEles||(f=n.findNearestElement(h[0],h[1],!0));var g=n.hoverData.last,v=n.hoverData.down,m=[h[0]-p[2],h[1]-p[3]],y=n.dragData.possibleDragElements,w=p[2]-p[0],b=w*w,C=p[3]-p[1],x=(b+C*C)*u*u;n.hoverData.tapholdCancelled=!0;if(o=!0,null!=f?f.trigger(new e.Event(i,{type:"mousemove",cyPosition:{x:h[0],y:h[1]}})).trigger(new e.Event(i,{type:"vmousemove",cyPosition:{x:h[0],y:h[1]}})).trigger(new e.Event(i,{type:"tapdrag",cyPosition:{x:h[0],y:h[1]}})):null==f&&d.trigger(new e.Event(i,{type:"mousemove",cyPosition:{x:h[0],y:h[1]}})).trigger(new e.Event(i,{type:"vmousemove",cyPosition:{x:h[0],y:h[1]}})).trigger(new e.Event(i,{type:"tapdrag",cyPosition:{x:h[0],y:h[1]}})),3===n.hoverData.which){var E=new e.Event(i,{type:"cxtdrag",cyPosition:{x:h[0],y:h[1]}});v?v.trigger(E):d.trigger(E),n.hoverData.cxtDragged=!0,n.hoverData.cxtOver&&f===n.hoverData.cxtOver||(n.hoverData.cxtOver&&n.hoverData.cxtOver.trigger(new e.Event(i,{type:"cxtdragout",cyPosition:{x:h[0],y:h[1]}})),n.hoverData.cxtOver=f,f&&f.trigger(new e.Event(i,{type:"cxtdragover",cyPosition:{x:h[0],y:h[1]}})))}else if(n.hoverData.dragging){if(o=!0,d.panningEnabled()&&d.userPanningEnabled()){var _;if(n.hoverData.justStartedPan){var S=n.hoverData.mdownPos;_={x:(h[0]-S[0])*u,y:(h[1]-S[1])*u},n.hoverData.justStartedPan=!1}else _={x:m[0]*u,y:m[1]*u};d.panBy(_)}h=n.projectIntoViewport(i.clientX,i.clientY)}else if(1==p[4]&&(null==v||v.isEdge())&&(!d.boxSelectionEnabled()||+new Date-n.hoverData.downTime>=t.panOrBoxSelectDelay)&&x>=n.tapThreshold2&&d.panningEnabled()&&d.userPanningEnabled())n.hoverData.dragging=!0,n.hoverData.justStartedPan=!0,p[4]=0;else{if(d.boxSelectionEnabled()&&Math.pow(p[2]-p[0],2)+Math.pow(p[3]-p[1],2)>7&&p[4]&&(clearTimeout(n.bgActiveTimeout),n.data.bgActivePosistion=void 0,n.data.canvasNeedsRedraw[t.SELECT_BOX]=!0,n.redraw()),v&&v.isEdge()&&v.active()&&v.unactivate(),f!=g&&(g&&(g.trigger(new e.Event(i,{type:"mouseout",cyPosition:{x:h[0],y:h[1]}})),g.trigger(new e.Event(i,{type:"tapdragout",cyPosition:{x:h[0],y:h[1]}}))),f&&(f.trigger(new e.Event(i,{type:"mouseover",cyPosition:{x:h[0],y:h[1]}})),f.trigger(new e.Event(i,{type:"tapdragover",cyPosition:{x:h[0],y:h[1]}}))),n.hoverData.last=f),v&&v.isNode()&&n.nodeIsDraggable(v))if(x>=n.tapThreshold2){var k=!n.dragData.didDrag;k&&(n.data.canvasNeedsRedraw[t.NODE]=!0),n.dragData.didDrag=!0;for(var T=[],D=0;D<y.length;D++){var R=y[D];if(n.hoverData.draggingEles||r(R,{inDragLayer:!0}),R.isNode()&&n.nodeIsDraggable(R)&&R.grabbed()){var P=R._private.position;if(T.push(R),e.is.number(m[0])&&e.is.number(m[1])&&(P.x+=m[0],P.y+=m[1],k)){var A=n.hoverData.dragDelta;e.is.number(A[0])&&e.is.number(A[1])&&(P.x+=A[0],P.y+=A[1])}}}n.hoverData.draggingEles=!0;var N=new e.Collection(d,T);N.updateCompoundBounds(),N.trigger("position drag"),n.data.canvasNeedsRedraw[t.DRAG]=!0,n.redraw()}else!function(){var e=n.hoverData.dragDelta=n.hoverData.dragDelta||[];0===e.length?(e.push(0),e.push(0)):(e[0]+=m[0],e[1]+=m[1])}();o=!0}if(p[2]=h[0],p[3]=h[1],o)return i.stopPropagation&&i.stopPropagation(),i.preventDefault&&i.preventDefault(),!1},1e3/30,{trailing:!0}),!1),n.registerBinding(window,"mouseup",function(i){if(n.hoverData.capture){n.hoverData.capture=!1;var o=n.data.cy,r=n.projectIntoViewport(i.clientX,i.clientY),s=n.data.select,l=n.findNearestElement(r[0],r[1],!0),c=n.dragData.possibleDragElements,d=n.hoverData.down,u=i.shiftKey;if(n.data.bgActivePosistion&&(n.data.canvasNeedsRedraw[t.SELECT_BOX]=!0,n.redraw()),n.data.bgActivePosistion=void 0,clearTimeout(n.bgActiveTimeout),n.hoverData.cxtStarted=!1,n.hoverData.draggingEles=!1,d&&d.unactivate(),3===n.hoverData.which){var h=new e.Event(i,{type:"cxttapend",cyPosition:{x:r[0],y:r[1]}});if(d?d.trigger(h):o.trigger(h),!n.hoverData.cxtDragged){var p=new e.Event(i,{type:"cxttap",cyPosition:{x:r[0],y:r[1]}});d?d.trigger(p):o.trigger(p)}n.hoverData.cxtDragged=!1,n.hoverData.which=null}else{if(null!=d||n.dragData.didDrag||Math.pow(s[2]-s[0],2)+Math.pow(s[3]-s[1],2)>7&&s[4]||n.hoverData.dragging||(o.$(function(){return this.selected()}).unselect(),c.length>0&&(n.data.canvasNeedsRedraw[t.NODE]=!0),n.dragData.possibleDragElements=c=[]),null!=l?l.trigger(new e.Event(i,{type:"mouseup",cyPosition:{x:r[0],y:r[1]}})).trigger(new e.Event(i,{type:"tapend",cyPosition:{x:r[0],y:r[1]}})).trigger(new e.Event(i,{type:"vmouseup",cyPosition:{x:r[0],y:r[1]}})):null==l&&o.trigger(new e.Event(i,{type:"mouseup",cyPosition:{x:r[0],y:r[1]}})).trigger(new e.Event(i,{type:"tapend",cyPosition:{x:r[0],y:r[1]}})).trigger(new e.Event(i,{type:"vmouseup",cyPosition:{x:r[0],y:r[1]}})),Math.pow(s[2]-s[0],2)+Math.pow(s[3]-s[1],2)===0&&(null!=l?l.trigger(new e.Event(i,{type:"click",cyPosition:{x:r[0],y:r[1]}})).trigger(new e.Event(i,{type:"tap",cyPosition:{x:r[0],y:r[1]}})).trigger(new e.Event(i,{type:"vclick",cyPosition:{x:r[0],y:r[1]}})):null==l&&o.trigger(new e.Event(i,{type:"click",cyPosition:{x:r[0],y:r[1]}})).trigger(new e.Event(i,{type:"tap",cyPosition:{x:r[0],y:r[1]}})).trigger(new e.Event(i,{type:"vclick",cyPosition:{x:r[0],y:r[1]}}))),l!=d||n.dragData.didDrag||null!=l&&l._private.selectable&&(n.hoverData.dragging||("additive"===o.selectionType()||u?l.selected()?l.unselect():l.select():u||(o.$(":selected").not(l).unselect(),l.select())),n.data.canvasNeedsRedraw[t.NODE]=!0),o.boxSelectionEnabled()&&Math.pow(s[2]-s[0],2)+Math.pow(s[3]-s[1],2)>7&&s[4]){var f=[],g=n.getAllInBox(s[0],s[1],s[2],s[3]);n.data.canvasNeedsRedraw[t.SELECT_BOX]=!0,g.length>0&&(n.data.canvasNeedsRedraw[t.NODE]=!0);for(m=0;m<g.length;m++)g[m]._private.selectable&&f.push(g[m]);var v=new e.Collection(o,f);"additive"===o.selectionType()?v.select():(u||o.$(":selected").not(v).unselect(),v.select()),n.redraw()}if(n.hoverData.dragging&&(n.data.canvasNeedsRedraw[t.SELECT_BOX]=!0,n.redraw()),n.hoverData.dragging=!1,!s[4]){n.data.canvasNeedsRedraw[t.DRAG]=!0,n.data.canvasNeedsRedraw[t.NODE]=!0;for(var m=0;m<c.length;m++)if("nodes"===c[m]._private.group){c[m]._private.rscratch.inDragLayer=!1,c[m]._private.grabbed=!1;for(var y=c[m]._private.edges,w=0;w<y.length;w++)y[w]._private.rscratch.inDragLayer=!1;a(c[m],{inDragLayer:!1})}else"edges"===c[m]._private.group&&(c[m]._private.rscratch.inDragLayer=!1);d&&d.trigger("free")}}s[4]=0,n.hoverData.down=null,n.dragData.didDrag=!1,n.hoverData.dragDelta=[]}},!1);n.registerBinding(n.data.container,"wheel",function(e){if(!n.scrollingPage){var i=n.data.cy,o=n.projectIntoViewport(e.clientX,e.clientY),r=[o[0]*i.zoom()+i.pan().x,o[1]*i.zoom()+i.pan().y];if(n.hoverData.draggingEles||n.hoverData.dragging||n.hoverData.cxtStarted||l())e.preventDefault();else if(i.panningEnabled()&&i.userPanningEnabled()&&i.zoomingEnabled()&&i.userZoomingEnabled()){e.preventDefault(),n.data.wheelZooming=!0,clearTimeout(n.data.wheelTimeout),n.data.wheelTimeout=setTimeout(function(){n.data.wheelZooming=!1,n.data.canvasNeedsRedraw[t.NODE]=!0,n.redraw()},150);var a=e.deltaY/-250||e.wheelDeltaY/1e3||e.wheelDelta/1e3;a*=n.wheelSensitivity,1===e.deltaMode&&(a*=33),i.zoom({level:i.zoom()*Math.pow(10,a),renderedPosition:{x:r[0],y:r[1]}})}}},!0),n.registerBinding(window,"scroll",function(e){n.scrollingPage=!0,clearTimeout(n.scrollingPageTimeout),n.scrollingPageTimeout=setTimeout(function(){n.scrollingPage=!1},250)},!0),n.registerBinding(n.data.container,"mouseout",function(t){var i=n.projectIntoViewport(t.clientX,t.clientY);n.data.cy.trigger(new e.Event(t,{type:"mouseout",cyPosition:{x:i[0],y:i[1]}}))},!1),n.registerBinding(n.data.container,"mouseover",function(t){var i=n.projectIntoViewport(t.clientX,t.clientY);n.data.cy.trigger(new e.Event(t,{type:"mouseover",cyPosition:{x:i[0],y:i[1]}}))},!1);var c,d,u,h,p,f,g,v,m,y,w,b,C,x=function(e,t,n,i){return Math.sqrt((n-e)*(n-e)+(i-t)*(i-t))},E=function(e,t,n,i){return(n-e)*(n-e)+(i-t)*(i-t)};n.registerBinding(n.data.container,"touchstart",function(i){clearTimeout(this.threeFingerSelectTimeout),i.target!==n.data.link&&i.preventDefault(),n.touchData.capture=!0,n.data.bgActivePosistion=void 0;var o=n.data.cy,a=n.getCachedNodes(),s=n.getCachedEdges(),l=n.touchData.now,_=n.touchData.earlier;if(i.touches[0]){S=n.projectIntoViewport(i.touches[0].clientX,i.touches[0].clientY);l[0]=S[0],l[1]=S[1]}if(i.touches[1]){S=n.projectIntoViewport(i.touches[1].clientX,i.touches[1].clientY);l[2]=S[0],l[3]=S[1]}if(i.touches[2]){var S=n.projectIntoViewport(i.touches[2].clientX,i.touches[2].clientY);l[4]=S[0],l[5]=S[1]}if(i.touches[1]){var k=function(e){for(var t=0;t<e.length;t++)e[t]._private.grabbed=!1,e[t]._private.rscratch.inDragLayer=!1,e[t].active()&&e[t].unactivate()};k(a),k(s);var T=n.findContainerClientCoords();m=T[0],y=T[1],w=T[2],b=T[3],c=i.touches[0].clientX-m,d=i.touches[0].clientY-y,u=i.touches[1].clientX-m,h=i.touches[1].clientY-y,C=0<=c&&c<=w&&0<=u&&u<=w&&0<=d&&d<=b&&0<=h&&h<=b;var D=o.pan(),R=o.zoom();p=x(c,d,u,h),f=E(c,d,u,h),v=[((g=[(c+u)/2,(d+h)/2])[0]-D.x)/R,(g[1]-D.y)/R];if(f<4e4&&!i.touches[2]){var P=n.findNearestElement(l[0],l[1],!0),A=n.findNearestElement(l[2],l[3],!0);return P&&P.isNode()?(P.activate().trigger(new e.Event(i,{type:"cxttapstart",cyPosition:{x:l[0],y:l[1]}})),n.touchData.start=P):A&&A.isNode()?(A.activate().trigger(new e.Event(i,{type:"cxttapstart",cyPosition:{x:l[0],y:l[1]}})),n.touchData.start=A):(o.trigger(new e.Event(i,{type:"cxttapstart",cyPosition:{x:l[0],y:l[1]}})),n.touchData.start=null),n.touchData.start&&(n.touchData.start._private.grabbed=!1),n.touchData.cxt=!0,n.touchData.cxtDragged=!1,n.data.bgActivePosistion=void 0,void n.redraw()}}if(i.touches[2]);else if(i.touches[1]);else if(i.touches[0]){var N=n.findNearestElement(l[0],l[1],!0);if(null!=N){if(N.activate(),n.touchData.start=N,N.isNode()&&n.nodeIsDraggable(N)){var M=n.dragData.touchDragEles=[];if(n.data.canvasNeedsRedraw[t.NODE]=!0,n.data.canvasNeedsRedraw[t.DRAG]=!0,N.selected())for(var O=o.$(function(){return this.isNode()&&this.selected()}),I=0;I<O.length;I++){var L=O[I];n.nodeIsDraggable(L)&&r(L,{addToList:M})}else r(N,{addToList:M});N.trigger(new e.Event(i,{type:"grab",cyPosition:{x:l[0],y:l[1]}}))}N.trigger(new e.Event(i,{type:"touchstart",cyPosition:{x:l[0],y:l[1]}})).trigger(new e.Event(i,{type:"tapstart",cyPosition:{x:l[0],y:l[1]}})).trigger(new e.Event(i,{type:"vmousdown",cyPosition:{x:l[0],y:l[1]}}))}null==N&&(o.trigger(new e.Event(i,{type:"touchstart",cyPosition:{x:l[0],y:l[1]}})).trigger(new e.Event(i,{type:"tapstart",cyPosition:{x:l[0],y:l[1]}})).trigger(new e.Event(i,{type:"vmousedown",cyPosition:{x:l[0],y:l[1]}})),n.data.bgActivePosistion={x:S[0],y:S[1]},n.data.canvasNeedsRedraw[t.SELECT_BOX]=!0,n.redraw());for(var H=0;H<l.length;H++)_[H]=l[H],n.touchData.startPosition[H]=l[H];n.touchData.singleTouchMoved=!1,n.touchData.singleTouchStartTime=+new Date,clearTimeout(n.touchData.tapholdTimeout),n.touchData.tapholdTimeout=setTimeout(function(){!1!==n.touchData.singleTouchMoved||n.pinching||(n.touchData.start?n.touchData.start.trigger(new e.Event(i,{type:"taphold",cyPosition:{x:l[0],y:l[1]}})):(n.data.cy.trigger(new e.Event(i,{type:"taphold",cyPosition:{x:l[0],y:l[1]}})),o.$(":selected").unselect()))},n.tapholdDuration)}},!1),n.registerBinding(window,"touchmove",e.util.throttle(function(i){var o=n.data.select,a=n.touchData.capture;a&&i.preventDefault();var s=n.data.cy,l=n.touchData.now,g=n.touchData.earlier,w=s.zoom();if(i.touches[0]){ie=n.projectIntoViewport(i.touches[0].clientX,i.touches[0].clientY);l[0]=ie[0],l[1]=ie[1]}if(i.touches[1]){ie=n.projectIntoViewport(i.touches[1].clientX,i.touches[1].clientY);l[2]=ie[0],l[3]=ie[1]}if(i.touches[2]){ie=n.projectIntoViewport(i.touches[2].clientX,i.touches[2].clientY);l[4]=ie[0],l[5]=ie[1]}for(var b=[],_=0;_<l.length;_++)b[_]=l[_]-g[_];var S=n.touchData.startPosition,k=l[0]-S[0],T=k*k,D=l[1]-S[1],R=(T+D*D)*w*w;if(a&&n.touchData.cxt){var P=i.touches[0].clientX-m,A=i.touches[0].clientY-y,N=i.touches[1].clientX-m,M=i.touches[1].clientY-y,O=E(P,A,N,M);if(O/f>=2.25||O>=22500){n.touchData.cxt=!1,n.touchData.start&&(n.touchData.start.unactivate(),n.touchData.start=null),n.data.bgActivePosistion=void 0,n.data.canvasNeedsRedraw[t.SELECT_BOX]=!0;I=new e.Event(i,{type:"cxttapend",cyPosition:{x:l[0],y:l[1]}});n.touchData.start?n.touchData.start.trigger(I):s.trigger(I)}}if(a&&n.touchData.cxt){var I=new e.Event(i,{type:"cxtdrag",cyPosition:{x:l[0],y:l[1]}});n.data.bgActivePosistion=void 0,n.data.canvasNeedsRedraw[t.SELECT_BOX]=!0,n.touchData.start?n.touchData.start.trigger(I):s.trigger(I),n.touchData.start&&(n.touchData.start._private.grabbed=!1),n.touchData.cxtDragged=!0;Y=n.findNearestElement(l[0],l[1],!0);n.touchData.cxtOver&&Y===n.touchData.cxtOver||(n.touchData.cxtOver&&n.touchData.cxtOver.trigger(new e.Event(i,{type:"cxtdragout",cyPosition:{x:l[0],y:l[1]}})),n.touchData.cxtOver=Y,Y&&Y.trigger(new e.Event(i,{type:"cxtdragover",cyPosition:{x:l[0],y:l[1]}})))}else if(a&&i.touches[2]&&s.boxSelectionEnabled())n.data.bgActivePosistion=void 0,clearTimeout(this.threeFingerSelectTimeout),this.lastThreeTouch=+new Date,n.data.canvasNeedsRedraw[t.SELECT_BOX]=!0,o&&0!==o.length&&void 0!==o[0]?(o[2]=(l[0]+l[2]+l[4])/3,o[3]=(l[1]+l[3]+l[5])/3):(o[0]=(l[0]+l[2]+l[4])/3,o[1]=(l[1]+l[3]+l[5])/3,o[2]=(l[0]+l[2]+l[4])/3+1,o[3]=(l[1]+l[3]+l[5])/3+1),o[4]=1,n.redraw();else if(a&&i.touches[1]&&s.zoomingEnabled()&&s.panningEnabled()&&s.userZoomingEnabled()&&s.userPanningEnabled()){if(n.data.bgActivePosistion=void 0,n.data.canvasNeedsRedraw[t.SELECT_BOX]=!0,q=n.dragData.touchDragEles){n.data.canvasNeedsRedraw[t.DRAG]=!0;for(ne=0;ne<q.length;ne++)q[ne]._private.grabbed=!1,q[ne]._private.rscratch.inDragLayer=!1}var P=i.touches[0].clientX-m,A=i.touches[0].clientY-y,N=i.touches[1].clientX-m,M=i.touches[1].clientY-y,L=x(P,A,N,M),H=L/p;if(1!=H&&C){var B=(P-c+(N-u))/2,F=(A-d+(M-h))/2,z=s.zoom(),V=z*H,W=s.pan(),j=v[0]*z+W.x,U=v[1]*z+W.y,G={x:-V/z*(j-W.x-B)+j,y:-V/z*(U-W.y-F)+U};if(n.touchData.start){if(q=n.dragData.touchDragEles)for(ne=0;ne<q.length;ne++)q[ne]._private.grabbed=!1,q[ne]._private.rscratch.inDragLayer=!1;n.touchData.start._private.active=!1,n.touchData.start._private.grabbed=!1,n.touchData.start._private.rscratch.inDragLayer=!1,n.data.canvasNeedsRedraw[t.DRAG]=!0,n.touchData.start.trigger("free").trigger("unactivate")}s.viewport({zoom:V,pan:G,cancelOnFailedZoom:!0}),p=L,c=P,d=A,u=N,h=M,n.pinching=!0}if(i.touches[0]){ie=n.projectIntoViewport(i.touches[0].clientX,i.touches[0].clientY);l[0]=ie[0],l[1]=ie[1]}if(i.touches[1]){ie=n.projectIntoViewport(i.touches[1].clientX,i.touches[1].clientY);l[2]=ie[0],l[3]=ie[1]}if(i.touches[2]){ie=n.projectIntoViewport(i.touches[2].clientX,i.touches[2].clientY);l[4]=ie[0],l[5]=ie[1]}}else if(i.touches[0]){var $=n.touchData.start,X=n.touchData.last,Y=Y||n.findNearestElement(l[0],l[1],!0);if(null!=$&&"nodes"==$._private.group&&n.nodeIsDraggable($))if(R>=n.tapThreshold2){for(var q=n.dragData.touchDragEles,K=0;K<q.length;K++){var Z=q[K];if(n.nodeIsDraggable(Z)&&Z.isNode()&&Z.grabbed()){n.dragData.didDrag=!0;var Q=Z._private.position,J=!n.hoverData.draggingEles;if(e.is.number(b[0])&&e.is.number(b[1])&&(Q.x+=b[0],Q.y+=b[1]),J){r(Z,{inDragLayer:!0});var ee=n.touchData.dragDelta;e.is.number(ee[0])&&e.is.number(ee[1])&&(Q.x+=ee[0],Q.y+=ee[1])}}}var te=new e.Collection(s,Z);te.updateCompoundBounds(),te.trigger("position drag"),n.hoverData.draggingEles=!0,n.data.canvasNeedsRedraw[t.DRAG]=!0,n.touchData.startPosition[0]==g[0]&&n.touchData.startPosition[1]==g[1]&&(n.data.canvasNeedsRedraw[t.NODE]=!0),n.redraw()}else 0===(ee=n.touchData.dragDelta=n.touchData.dragDelta||[]).length?(ee.push(0),ee.push(0)):(ee[0]+=b[0],ee[1]+=b[1]);null!=$&&($.trigger(new e.Event(i,{type:"touchmove",cyPosition:{x:l[0],y:l[1]}})),$.trigger(new e.Event(i,{type:"tapdrag",cyPosition:{x:l[0],y:l[1]}})),$.trigger(new e.Event(i,{type:"vmousemove",cyPosition:{x:l[0],y:l[1]}}))),null==$&&(null!=Y&&(Y.trigger(new e.Event(i,{type:"touchmove",cyPosition:{x:l[0],y:l[1]}})),Y.trigger(new e.Event(i,{type:"tapdrag",cyPosition:{x:l[0],y:l[1]}})),Y.trigger(new e.Event(i,{type:"vmousemove",cyPosition:{x:l[0],y:l[1]}}))),null==Y&&(s.trigger(new e.Event(i,{type:"touchmove",cyPosition:{x:l[0],y:l[1]}})),s.trigger(new e.Event(i,{type:"tapdrag",cyPosition:{x:l[0],y:l[1]}})),s.trigger(new e.Event(i,{type:"vmousemove",cyPosition:{x:l[0],y:l[1]}})))),Y!=X&&(X&&X.trigger(new e.Event(i,{type:"tapdragout",cyPosition:{x:l[0],y:l[1]}})),Y&&Y.trigger(new e.Event(i,{type:"tapdragover",cyPosition:{x:l[0],y:l[1]}}))),n.touchData.last=Y;for(var ne=0;ne<l.length;ne++)l[ne]&&n.touchData.startPosition[ne]&&Math.abs(l[ne]-n.touchData.startPosition[ne])>4&&(n.touchData.singleTouchMoved=!0);if(a&&(null==$||$.isEdge())&&s.panningEnabled()&&s.userPanningEnabled()){n.swipePanning?s.panBy({x:b[0]*w,y:b[1]*w}):R>=n.tapThreshold2&&(n.swipePanning=!0,s.panBy({x:k*w,y:D*w})),$&&($.unactivate(),n.data.bgActivePosistion||(n.data.bgActivePosistion={x:l[0],y:l[1]}),n.data.canvasNeedsRedraw[t.SELECT_BOX]=!0,n.touchData.start=null);var ie=n.projectIntoViewport(i.touches[0].clientX,i.touches[0].clientY);l[0]=ie[0],l[1]=ie[1]}}for(_=0;_<l.length;_++)g[_]=l[_]},1e3/30,{trailing:!0}),!1),n.registerBinding(window,"touchcancel",function(e){var t=n.touchData.start;n.touchData.capture=!1,t&&t.unactivate()}),n.registerBinding(window,"touchend",function(i){var o=n.touchData.start;if(n.touchData.capture){n.touchData.capture=!1,i.preventDefault();var r=n.data.select;n.swipePanning=!1,n.hoverData.draggingEles=!1;var s=n.data.cy,l=s.zoom(),c=n.touchData.now,d=n.touchData.earlier;if(i.touches[0]){u=n.projectIntoViewport(i.touches[0].clientX,i.touches[0].clientY);c[0]=u[0],c[1]=u[1]}if(i.touches[1]){u=n.projectIntoViewport(i.touches[1].clientX,i.touches[1].clientY);c[2]=u[0],c[3]=u[1]}if(i.touches[2]){var u=n.projectIntoViewport(i.touches[2].clientX,i.touches[2].clientY);c[4]=u[0],c[5]=u[1]}o&&o.unactivate();var h;if(n.touchData.cxt){if(h=new e.Event(i,{type:"cxttapend",cyPosition:{x:c[0],y:c[1]}}),o?o.trigger(h):s.trigger(h),!n.touchData.cxtDragged){var p=new e.Event(i,{type:"cxttap",cyPosition:{x:c[0],y:c[1]}});o?o.trigger(p):s.trigger(p)}return n.touchData.start&&(n.touchData.start._private.grabbed=!1),n.touchData.cxt=!1,n.touchData.start=null,void n.redraw()}if(!i.touches[2]&&s.boxSelectionEnabled()){clearTimeout(this.threeFingerSelectTimeout);var f=[],g=n.getAllInBox(r[0],r[1],r[2],r[3]);r[0]=void 0,r[1]=void 0,r[2]=void 0,r[3]=void 0,r[4]=0,n.data.canvasNeedsRedraw[t.SELECT_BOX]=!0;for(var v=0;v<g.length;v++)g[v]._private.selectable&&f.push(g[v]);var m=new e.Collection(s,f);"single"===s.selectionType()&&s.$(":selected").not(m).unselect(),m.select(),m.length>0?n.data.canvasNeedsRedraw[t.NODE]=!0:n.redraw()}var y=!1;if(null!=o&&(o._private.active=!1,y=!0,o.unactivate()),i.touches[2])n.data.bgActivePosistion=void 0,n.data.canvasNeedsRedraw[t.SELECT_BOX]=!0;else if(i.touches[1]);else if(i.touches[0]);else if(!i.touches[0]){if(n.data.bgActivePosistion=void 0,n.data.canvasNeedsRedraw[t.SELECT_BOX]=!0,null!=o){o._private.grabbed&&(o._private.grabbed=!1,o.trigger("free"),o._private.rscratch.inDragLayer=!1);for(var w=o._private.edges,b=0;b<w.length;b++)w[b]._private.rscratch.inDragLayer=!1;if(a(o,!1),o.selected())for(var C=s.$("node:selected"),x=0;x<C.length;x++){var E=C[x];E._private.rscratch.inDragLayer=!1,E._private.grabbed=!1;for(var w=E._private.edges,b=0;b<w.length;b++)w[b]._private.rscratch.inDragLayer=!1;a(E,!1)}n.data.canvasNeedsRedraw[t.DRAG]=!0,n.data.canvasNeedsRedraw[t.NODE]=!0,o.trigger(new e.Event(i,{type:"touchend",cyPosition:{x:c[0],y:c[1]}})).trigger(new e.Event(i,{type:"tapend",cyPosition:{x:c[0],y:c[1]}})).trigger(new e.Event(i,{type:"vmouseup",cyPosition:{x:c[0],y:c[1]}})),o.unactivate(),n.touchData.start=null}else{var _=n.findNearestElement(c[0],c[1],!0);null!=_&&_.trigger(new e.Event(i,{type:"touchend",cyPosition:{x:c[0],y:c[1]}})).trigger(new e.Event(i,{type:"tapend",cyPosition:{x:c[0],y:c[1]}})).trigger(new e.Event(i,{type:"vmouseup",cyPosition:{x:c[0],y:c[1]}})),null==_&&s.trigger(new e.Event(i,{type:"touchend",cyPosition:{x:c[0],y:c[1]}})).trigger(new e.Event(i,{type:"tapend",cyPosition:{x:c[0],y:c[1]}})).trigger(new e.Event(i,{type:"vmouseup",cyPosition:{x:c[0],y:c[1]}}))}var S=n.touchData.startPosition[0]-c[0],k=S*S,T=n.touchData.startPosition[1]-c[1],D=(k+T*T)*l*l;null!=o&&!n.dragData.didDrag&&o._private.selectable&&D<n.tapThreshold2&&!n.pinching&&("single"===s.selectionType()?(s.$(":selected").not(o).unselect(),o.select()):o.selected()?o.unselect():o.select(),y=!0,n.data.canvasNeedsRedraw[t.NODE]=!0),!1===n.touchData.singleTouchMoved&&(o?o.trigger(new e.Event(i,{type:"tap",cyPosition:{x:c[0],y:c[1]}})).trigger(new e.Event(i,{type:"vclick",cyPosition:{x:c[0],y:c[1]}})):s.trigger(new e.Event(i,{type:"tap",cyPosition:{x:c[0],y:c[1]}})).trigger(new e.Event(i,{type:"vclick",cyPosition:{x:c[0],y:c[1]}}))),n.touchData.singleTouchMoved=!0}for(b=0;b<c.length;b++)d[b]=c[b];n.dragData.didDrag=!1,i.touches[0]&&(n.touchData.dragDelta=[]),y&&o&&o.updateStyle(!1),i.touches.length<2&&(n.pinching=!1,n.data.canvasNeedsRedraw[t.NODE]=!0,n.redraw())}},!1)}}(cytoscape),function(e){"use strict";for(var t=e("renderer","canvas"),n=t.prototype,i=t.usePaths(),o=t.nodeShapes={},r=Math.sin(0),a=Math.cos(0),s={},l={},c=0*Math.PI;c<2*Math.PI;c+=.1)s[c]=Math.sin(c),l[c]=Math.cos(c);o.ellipse={draw:function(e,t,n,i,r){o.ellipse.drawPath(e,t,n,i,r),e.fill()},drawPath:function(e,t,n,o,c){if(i){e.beginPath&&e.beginPath();for(var d,u,h=o/2,p=c/2,f=0*Math.PI;f<2*Math.PI;f+=.1)d=t-h*s[f]*r+h*l[f]*a,u=n+p*l[f]*r+p*s[f]*a,0===f?e.moveTo(d,u):e.lineTo(d,u);e.closePath()}else e.beginPath&&e.beginPath(),e.translate(t,n),e.scale(o/2,c/2),e.arc(0,0,1,0,2*Math.PI*.999,!1),e.closePath(),e.scale(2/o,2/c),e.translate(-t,-n)},intersectLine:function(t,n,i,o,r,a,s){return e.math.intersectLineEllipse(r,a,t,n,i/2+s,o/2+s)},intersectBox:function(t,n,i,o,r,a,s,l,c){return e.math.boxIntersectEllipse(t,n,i,o,c,r,a,s,l)},checkPoint:function(e,t,n,i,o,r,a){return e-=r,t-=a,e/=i/2+n,t/=o/2+n,Math.pow(e,2)+Math.pow(t,2)<=1}},o.triangle={points:e.math.generateUnitNgonPointsFitToSquare(3,0),draw:function(e,t,i,r,a){n.drawPolygon(e,t,i,r,a,o.triangle.points)},drawPath:function(e,t,i,r,a){n.drawPolygonPath(e,t,i,r,a,o.triangle.points)},intersectLine:function(t,n,i,r,a,s,l){return e.math.polygonIntersectLine(a,s,o.triangle.points,t,n,i/2,r/2,l)},intersectBox:function(t,n,i,r,a,s,l,c,d){var u=o.triangle.points;return e.math.boxIntersectPolygon(t,n,i,r,u,a,s,l,c,[0,-1],d)},checkPoint:function(t,n,i,r,a,s,l){return e.math.pointInsidePolygon(t,n,o.triangle.points,s,l,r,a,[0,-1],i)}},o.square={points:e.math.generateUnitNgonPointsFitToSquare(4,0),draw:function(e,t,i,r,a){n.drawPolygon(e,t,i,r,a,o.square.points)},drawPath:function(e,t,i,r,a){n.drawPolygonPath(e,t,i,r,a,o.square.points)},intersectLine:function(t,n,i,r,a,s,l){return e.math.polygonIntersectLine(a,s,o.square.points,t,n,i/2,r/2,l)},intersectBox:function(t,n,i,r,a,s,l,c,d){var u=o.square.points;return e.math.boxIntersectPolygon(t,n,i,r,u,a,s,l,c,[0,-1],d)},checkPoint:function(t,n,i,r,a,s,l){return e.math.pointInsidePolygon(t,n,o.square.points,s,l,r,a,[0,-1],i)}},o.rectangle=o.square,o.octogon={},o.roundrectangle={points:e.math.generateUnitNgonPointsFitToSquare(4,0),draw:function(e,t,i,o,r){n.drawRoundRectangle(e,t,i,o,r,10)},drawPath:function(e,t,i,o,r){n.drawRoundRectanglePath(e,t,i,o,r,10)},intersectLine:function(t,n,i,o,r,a,s){return e.math.roundRectangleIntersectLine(r,a,t,n,i,o,s)},intersectBox:function(t,n,i,o,r,a,s,l,c){return e.math.roundRectangleIntersectBox(t,n,i,o,r,a,s,l,c)},checkPoint:function(t,n,i,r,a,s,l){var c=e.math.getRoundRectangleRadius(r,a);if(e.math.pointInsidePolygon(t,n,o.roundrectangle.points,s,l,r,a-2*c,[0,-1],i))return!0;if(e.math.pointInsidePolygon(t,n,o.roundrectangle.points,s,l,r-2*c,a,[0,-1],i))return!0;var d=function(e,t,n,i,o,r,a){return e-=n,t-=i,e/=o/2+a,t/=r/2+a,Math.pow(e,2)+Math.pow(t,2)<=1};return!!d(t,n,s-r/2+c,l-a/2+c,2*c,2*c,i)||(!!d(t,n,s+r/2-c,l-a/2+c,2*c,2*c,i)||(!!d(t,n,s+r/2-c,l+a/2-c,2*c,2*c,i)||!!d(t,n,s-r/2+c,l+a/2-c,2*c,2*c,i)))}},o.pentagon={points:e.math.generateUnitNgonPointsFitToSquare(5,0),draw:function(e,t,i,r,a){n.drawPolygon(e,t,i,r,a,o.pentagon.points)},drawPath:function(e,t,i,r,a){n.drawPolygonPath(e,t,i,r,a,o.pentagon.points)},intersectLine:function(e,t,i,r,a,s,l){return n.polygonIntersectLine(a,s,o.pentagon.points,e,t,i/2,r/2,l)},intersectBox:function(t,n,i,r,a,s,l,c,d){var u=o.pentagon.points;return e.math.boxIntersectPolygon(t,n,i,r,u,a,s,l,c,[0,-1],d)},checkPoint:function(t,n,i,r,a,s,l){return e.math.pointInsidePolygon(t,n,o.pentagon.points,s,l,r,a,[0,-1],i)}},o.hexagon={points:e.math.generateUnitNgonPointsFitToSquare(6,0),draw:function(e,t,i,r,a){n.drawPolygon(e,t,i,r,a,o.hexagon.points)},drawPath:function(e,t,i,r,a){n.drawPolygonPath(e,t,i,r,a,o.hexagon.points)},intersectLine:function(t,n,i,r,a,s,l){return e.math.polygonIntersectLine(a,s,o.hexagon.points,t,n,i/2,r/2,l)},intersectBox:function(t,n,i,r,a,s,l,c,d){var u=o.hexagon.points;return e.math.boxIntersectPolygon(t,n,i,r,u,a,s,l,c,[0,-1],d)},checkPoint:function(t,n,i,r,a,s,l){return e.math.pointInsidePolygon(t,n,o.hexagon.points,s,l,r,a,[0,-1],i)}},o.heptagon={points:e.math.generateUnitNgonPointsFitToSquare(7,0),draw:function(e,t,i,r,a){n.drawPolygon(e,t,i,r,a,o.heptagon.points)},drawPath:function(e,t,i,r,a){n.drawPolygonPath(e,t,i,r,a,o.heptagon.points)},intersectLine:function(e,t,i,r,a,s,l){return n.polygonIntersectLine(a,s,o.heptagon.points,e,t,i/2,r/2,l)},intersectBox:function(e,t,i,r,a,s,l,c,d){var u=o.heptagon.points;return n.boxIntersectPolygon(e,t,i,r,u,a,s,l,c,[0,-1],d)},checkPoint:function(t,n,i,r,a,s,l){return e.math.pointInsidePolygon(t,n,o.heptagon.points,s,l,r,a,[0,-1],i)}},o.octagon={points:e.math.generateUnitNgonPointsFitToSquare(8,0),draw:function(e,t,i,r,a){n.drawPolygon(e,t,i,r,a,o.octagon.points)},drawPath:function(e,t,i,r,a){n.drawPolygonPath(e,t,i,r,a,o.octagon.points)},intersectLine:function(e,t,i,r,a,s,l){return n.polygonIntersectLine(a,s,o.octagon.points,e,t,i/2,r/2,l)},intersectBox:function(e,t,i,r,a,s,l,c,d){var u=o.octagon.points;return n.boxIntersectPolygon(e,t,i,r,u,a,s,l,c,[0,-1],d)},checkPoint:function(t,n,i,r,a,s,l){return e.math.pointInsidePolygon(t,n,o.octagon.points,s,l,r,a,[0,-1],i)}};var d=new Array(20),u=e.math.generateUnitNgonPoints(5,0),h=e.math.generateUnitNgonPoints(5,Math.PI/5),p=.5*(3-Math.sqrt(5));p*=1.57;for(c=0;c<h.length/2;c++)h[2*c]*=p,h[2*c+1]*=p;for(c=0;c<5;c++)d[4*c]=u[2*c],d[4*c+1]=u[2*c+1],d[4*c+2]=h[2*c],d[4*c+3]=h[2*c+1];d=e.math.fitPolygonToSquare(d),o.star5=o.star={points:d,draw:function(e,t,i,r,a){n.drawPolygon(e,t,i,r,a,o.star5.points)},drawPath:function(e,t,i,r,a){n.drawPolygonPath(e,t,i,r,a,o.star5.points)},intersectLine:function(e,t,i,r,a,s,l){return n.polygonIntersectLine(a,s,o.star5.points,e,t,i/2,r/2,l)},intersectBox:function(e,t,i,r,a,s,l,c,d){var u=o.star5.points;return n.boxIntersectPolygon(e,t,i,r,u,a,s,l,c,[0,-1],d)},checkPoint:function(t,n,i,r,a,s,l){return e.math.pointInsidePolygon(t,n,o.star5.points,s,l,r,a,[0,-1],i)}}}(cytoscape),function(e){"use strict";function t(t){this._private={},this._private.options=e.util.extend({},n,t)}var n={animate:!0,maxSimulationTime:4e3,fit:!0,padding:30,boundingBox:void 0,ungrabifyWhileSimulating:!1,ready:void 0,stop:void 0,repulsion:void 0,stiffness:void 0,friction:void 0,gravity:!0,fps:void 0,precision:void 0,nodeMass:void 0,edgeLength:void 0,stepSize:.1,stableEnergy:function(e){var t=e;return t.max<=.5||t.mean<=.3},infinite:!1};t.prototype.run=function(){var t=this,n=this._private.options;return e.util.require("arbor",function(i){function o(e,t){return null==t?void 0:"function"==typeof t?t.apply(e,[e._private.data,{nodes:c.length,edges:d.length,element:e}]):t}function r(e){if(!e.isFullAutoParent()){var t=e._private.data.id,i=o(e,n.nodeMass),r=e._private.locked,a=e.position(),s=p.fromScreen({x:a.x,y:a.y});e.scratch().arbor=p.addNode(t,{element:e,mass:i,fixed:r,x:r?s.x:void 0,y:r?s.y:void 0})}}function a(e){var t=e.source().id(),i=e.target().id(),r=o(e,n.edgeLength);e.scratch().arbor=p.addEdge(t,i,{length:r})}var s=n.cy,l=n.eles,c=l.nodes().not(":parent"),d=l.edges(),u=e.util.makeBoundingBox(n.boundingBox?n.boundingBox:{x1:0,y1:0,w:s.width(),h:s.height()}),h=!1;if(t.trigger({type:"layoutstart",layout:t}),void 0!==n.liveUpdate&&(n.animate=n.liveUpdate),s.nodes().size()<=1)return n.fit&&s.reset(),s.nodes().position({x:Math.round((u.x1+u.x2)/2),y:Math.round((u.y1+u.y2)/2)}),t.one("layoutready",n.ready),t.trigger({type:"layoutready",layout:t}),t.one("layoutstop",n.stop),void t.trigger({type:"layoutstop",layout:t});var p=t._private.system=i.ParticleSystem();p.parameters({repulsion:n.repulsion,stiffness:n.stiffness,friction:n.friction,gravity:n.gravity,fps:n.fps,dt:n.dt,precision:n.precision}),n.animate&&n.fit&&s.fit(u,n.padding);var f,g=!1,v=+new Date,m={init:function(e){},redraw:function(){var e=p.energy();if(!n.infinite&&null!=n.stableEnergy&&null!=e&&e.n>0&&n.stableEnergy(e))t.stop();else{n.infinite||(clearTimeout(f),f=setTimeout(_,250));var i=s.collection();p.eachNode(function(e,t){var n=e.data.element;null!=n&&(n.locked()||n.grabbed()||(n.silentPosition({x:u.x1+t.x,y:u.y1+t.y}),i.merge(n)))}),n.animate&&i.length>0&&(h=!0,i.rtrigger("position"),n.fit&&s.fit(n.padding),v=+new Date,h=!1),g||(g=!0,t.one("layoutready",n.ready),t.trigger({type:"layoutready",layout:t}))}}};p.renderer=m,p.screenSize(u.w,u.h),p.screenPadding(n.padding,n.padding,n.padding,n.padding),p.screenStep(n.stepSize);var y;c.on("grab free position",y=function(e){if(!h){var t=this.position(),o=p.fromScreen(t);if(o){var r=i.Point(o.x,o.y),a=n.padding;switch(u.x1+a<=t.x&&t.x<=u.x2-a&&u.y1+a<=t.y&&t.y<=u.y2-a&&(this.scratch().arbor.p=r),e.type){case"grab":this.scratch().arbor.fixed=!0;break;case"free":this.scratch().arbor.fixed=!1}}}});var w;c.on("lock unlock",w=function(e){node.scratch().arbor.fixed=node.locked()});var b;l.on("remove",b=function(e){});var C;s.on("add","*",C=function(){});var x;s.on("resize",x=function(){if(null==n.boundingBox&&null!=t._private.system){var e=s.width(),i=s.height();p.screenSize(e,i)}}),c.each(function(e,t){r(t)}),d.each(function(e,t){a(t)});var E=c.filter(":grabbable");n.ungrabifyWhileSimulating&&E.ungrabify();var _=t._private.doneHandler=function(){t._private.doneHandler=null,n.animate||(n.fit&&s.reset(),c.rtrigger("position")),c.off("grab free position",y),c.off("lock unlock",w),l.off("remove",b),s.off("add","*",C),s.off("resize",x),n.ungrabifyWhileSimulating&&E.grabify(),t.one("layoutstop",n.stop),t.trigger({type:"layoutstop",layout:t})};p.start(),!n.infinite&&null!=n.maxSimulationTime&&n.maxSimulationTime>0&&n.maxSimulationTime!==1/0&&setTimeout(function(){t.stop()},n.maxSimulationTime)}),this},t.prototype.stop=function(){return null!=this._private.system&&this._private.system.stop(),this._private.doneHandler&&this._private.doneHandler(),this},e("layout","arbor",t)}(cytoscape),function(e){"use strict";function t(t){this.options=e.util.extend({},n,t)}var n={fit:!0,directed:!1,padding:30,circle:!1,boundingBox:void 0,avoidOverlap:!0,roots:void 0,maximalAdjustments:0,animate:!1,animationDuration:500,ready:void 0,stop:void 0};t.prototype.run=function(){var t,n=this.options,i=n,o=n.cy,r=i.eles,a=r.nodes().not(":parent"),s=r,l=e.util.makeBoundingBox(i.boundingBox?i.boundingBox:{x1:0,y1:0,w:o.width(),h:o.height()});if(e.is.elementOrCollection(i.roots))t=i.roots;else if(e.is.array(i.roots)){for(var c=[],d=0;d<i.roots.length;d++){var u=i.roots[d],h=o.getElementById(u);c.push(h)}t=new e.Collection(o,c)}else if(e.is.string(i.roots))t=o.$(i.roots);else if(i.directed)t=a.roots();else{for(var p=[],f=a;f.length>0;){var g=o.collection();r.bfs({roots:f[0],visit:function(e,t,n,i,o){g=g.add(n)},directed:!1}),f=f.not(g),p.push(g)}t=o.collection();for(d=0;d<p.length;d++){var v=p[d],m=v.maxDegree(!1),y=v.filter(function(){return this.degree(!1)===m});t=t.add(y)}}var w=[],b={},C={},x={},E={},_={};s.bfs({roots:t,directed:i.directed,visit:function(e,t,n,i,o){var r=this[0],a=r.id();if(w[t]||(w[t]=[]),w[t].push(r),b[a]=!0,C[a]=t,x[a]=o,E[a]=i,o){var s=o.id();(_[s]=_[s]||[]).push(n)}}});for(var S=[],d=0;d<a.length;d++){h=a[d];b[h.id()]||S.push(h)}for(var k=3*S.length,T=0;0!==S.length&&T<k;){for(var D=(K=S.shift()).neighborhood().nodes(),R=!1,d=0;d<D.length;d++)if(void 0!==(q=C[D[d].id()])){w[q].push(K),R=!0;break}R||S.push(K),T++}for(;0!==S.length;){K=S.shift();(R=!1)||(0===w.length&&w.push([]),w[0].push(K))}var P=function(){for(var e=0;e<w.length;e++)for(var t=w[e],n=0;n<t.length;n++)t[n]._private.scratch.breadthfirst={depth:e,index:n}};P();for(var A=0;A<i.maximalAdjustments;A++){for(var N=w.length,M=[],d=0;d<N;d++)for(var O=(q=w[d]).length,I=0;I<O;I++){var L=(h=q[I])._private.scratch.breadthfirst;(H=function(e){for(var t,n=e.connectedEdges(function(){return this.data("target")===e.id()}),i=e._private.scratch.breadthfirst,o=0,r=0;r<n.length;r++){var a=n[r].source()[0],s=a._private.scratch.breadthfirst;i.depth<=s.depth&&o<s.depth&&(o=s.depth,t=a)}return t}(h))&&(L.intEle=H,M.push(h))}for(d=0;d<M.length;d++){var H=(L=(h=M[d])._private.scratch.breadthfirst).intEle,B=H._private.scratch.breadthfirst;w[L.depth].splice(L.index,1);for(var F=B.depth+1;F>w.length-1;)w.push([]);w[F].push(h),L.depth=F,L.index=w[F].length-1}P()}var z=0;if(i.avoidOverlap){for(d=0;d<a.length;d++){var V=a[d].outerWidth(),W=a[d].outerHeight();z=Math.max(z,V,W)}z*=1.75}for(var j={},U=function(e){if(j[e.id()])return j[e.id()];for(var t=e._private.scratch.breadthfirst.depth,n=e.neighborhood().nodes(),i=0,o=0,r=0;r<n.length;r++){var a=n[r],s=a._private.scratch.breadthfirst.index,l=a._private.scratch.breadthfirst.depth,c=w[l].length;(t>l||0===t)&&(i+=s/c,o++)}return o=Math.max(1,o),i/=o,0===o&&(i=void 0),j[e.id()]=i,i},G=0;G<3;G++){for(d=0;d<w.length;d++)w[d]=w[d].sort(function(e,t){return U(e)-U(t)});P()}for(var $=0,d=0;d<w.length;d++)$=Math.max(w[d].length,$);for(var X={x:l.x1+l.w/2,y:l.x1+l.h/2},Y={},d=w.length-1;d>=0;d--)for(var q=w[d],I=0;I<q.length;I++){var K=q[I];Y[K.id()]=function(e,t){var n=e._private.scratch.breadthfirst,o=n.depth,r=n.index,a=w[o].length;i.strictHierarchy&&(a=$);var s=Math.max(l.w/(a+1),z),c=Math.max(l.h/(w.length+1),z),d=Math.min(l.w/2/w.length,l.h/2/w.length);if(d=Math.max(d,z),i.strictHierarchy&&!i.circle){var u={x:X.x+(r+1-(a+1)/2)*s,y:(o+1)*c};if(t)return u;var h=_[e.id()];if(h){u.x=0;for(var p=0;p<h.length;p++){var f=Y[h[p].id()];u.x+=f.x}u.x/=h.length}return u}if(i.circle){var g=d*o+d-(w.length>0&&w[0].length<=3?d/2:0),v=2*Math.PI/w[o].length*r;return 0===o&&1===w[0].length&&(g=1),{x:X.x+g*Math.cos(v),y:X.y+g*Math.sin(v)}}return{x:X.x+(r+1-(a+1)/2)*s,y:(o+1)*c}}(K,d===w.length-1)}return a.layoutPositions(this,i,function(){return Y[this.id()]}),this},e("layout","breadthfirst",t)}(cytoscape),function(e){"use strict";function t(t){this.options=e.util.extend({},n,t)}var n={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,radius:void 0,startAngle:1.5*Math.PI,counterclockwise:!1,animate:!1,animationDuration:500,ready:void 0,stop:void 0};t.prototype.run=function(){for(var t,n=this.options,i=n,o=n.cy,r=i.eles.nodes().not(":parent"),a=e.util.makeBoundingBox(i.boundingBox?i.boundingBox:{x1:0,y1:0,w:o.width(),h:o.height()}),s={x:a.x1+a.w/2,y:a.y1+a.h/2},l=i.startAngle,c=2*Math.PI/r.length,d=0,u=0;u<r.length;u++){var h=r[u].outerWidth(),p=r[u].outerHeight();d=Math.max(d,h,p)}if(t=e.is.number(i.radius)?i.radius:r.length<=1?0:Math.min(a.h,a.w)/2-d,r.length>1&&i.avoidOverlap){d*=1.75;var c=2*Math.PI/r.length,f=Math.cos(c)-Math.cos(0),g=Math.sin(c)-Math.sin(0),v=Math.sqrt(d*d/(f*f+g*g));t=Math.max(v,t)}return r.layoutPositions(this,i,function(e,n){var o=t*Math.cos(l),r=t*Math.sin(l),a={x:s.x+o,y:s.y+r};return l=i.counterclockwise?l-c:l+c,a}),this},e("layout","circle",t)}(cytoscape),function(e){"use strict";function t(t){this.options=e.util.extend(!0,{},n,t)}var n={animate:!0,refresh:1,maxSimulationTime:4e3,ungrabifyWhileSimulating:!1,fit:!0,padding:30,boundingBox:void 0,ready:function(){},stop:function(){},randomize:!1,avoidOverlap:!0,handleDisconnected:!0,nodeSpacing:function(e){return 10},flow:void 0,alignment:void 0,edgeLength:void 0,edgeSymDiffLength:void 0,edgeJaccardLength:void 0,unconstrIter:void 0,userConstIter:void 0,allConstIter:void 0,infinite:!1};t.prototype.run=function(){var t=this,n=this.options;return e.util.require("cola",function(i){var o=n.cy,r=n.eles,a=r.nodes(),s=r.edges(),l=!1,c=e.util.makeBoundingBox(n.boundingBox?n.boundingBox:{x1:0,y1:0,w:o.width(),h:o.height()}),d=function(t,n){return e.is.fn(t)?t.apply(n,[n]):t},u=function(){for(var e={min:1/0,max:-1/0},t={min:1/0,max:-1/0},i=0;i<a.length;i++){var r=a[i]._private.scratch.cola;e.min=Math.min(e.min,r.x),e.max=Math.max(e.max,r.x),t.min=Math.min(t.min,r.y),t.max=Math.max(t.max,r.y)}a.positions(function(n,i){var o=i._private.position,r=i._private.scratch.cola;i.grabbed()||(o.x=c.x1+r.x-e.min,o.y=c.y1+r.y-t.min)}),l||(p(),l=!0),n.fit&&o.fit(n.padding)},h=function(){t.manuallyStopped=!1,n.ungrabifyWhileSimulating&&m.grabify(),a.off("grab free position",y),a.off("lock unlock",w),t.one("layoutstop",n.stop),t.trigger({type:"layoutstop",layout:t})},p=function(){t.one("layoutready",n.ready),t.trigger({type:"layoutready",layout:t})},f=n.refresh,g=1;n.refresh<0?(g=Math.abs(n.refresh),f=1):f=Math.max(1,f);var v=i.adaptor({trigger:function(e){switch(e.type){case"tick":n.animate&&u();break;case"end":u(),n.infinite&&!t.manuallyStopped||h()}},kick:function(t){var i=0,o=function(){var e=t();return e&&n.infinite&&v.resume(),e},r=function(){var e,t=i;if(i=(i+1)%g,0!==t)return!1;for(var n=0;n<f&&!e;n++)e=e||o();return e};if(n.animate){var a=function(){r()||e.util.requestAnimationFrame(a)};e.util.requestAnimationFrame(a)}else for(;!o(););},on:function(e,t){},drag:function(){}});t.adaptor=v;var m=a.filter(":grabbable");n.ungrabifyWhileSimulating&&m.ungrabify();var y;a.on("grab free position",y=function(t){var n=this,i=n._private.scratch.cola,o=n._private.position;switch(n.grabbed()?(i.x=o.x-c.x1,i.y=o.y-c.y1,v.dragstart(i)):e.is.number(i.x)&&e.is.number(i.y)&&(o.x=i.x+c.x1,o.y=i.y+c.y1),t.type){case"grab":v.dragstart(i),v.resume();break;case"free":v.dragend(i)}});var w;a.on("lock unlock",w=function(e){var t=this,n=t._private.scratch.cola;t.locked()?v.dragstart(n):v.dragend(n)});var b=a.stdFilter(function(e){return!e.isParent()});if(v.nodes(b.map(function(e,t){var i=d(n.nodeSpacing,e),o=e.position();return e._private.scratch.cola={x:n.randomize?Math.round(Math.random()*c.w):o.x,y:n.randomize?Math.round(Math.random()*c.h):o.y,width:e.outerWidth()+2*i,height:e.outerHeight()+2*i,index:t}})),n.alignment){var C=[],x=[];b.forEach(function(e){var t=d(n.alignment,e),i=e._private.scratch.cola.index;t&&(null!=t.x&&C.push({node:i,offset:t.x}),null!=t.y&&x.push({node:i,offset:t.y}))});var E=[];C.length>0&&E.push({type:"alignment",axis:"x",offsets:C}),x.length>0&&E.push({type:"alignment",axis:"y",offsets:x}),v.constraints(E)}v.groups(a.stdFilter(function(e){return e.isParent()}).map(function(e,t){return e._private.scratch.cola={index:t,leaves:e.children().stdFilter(function(e){return!e.isParent()}).map(function(e){return e[0]._private.scratch.cola.index})},e}).map(function(e){return e._private.scratch.cola.groups=e.children().stdFilter(function(e){return e.isParent()}).map(function(e){return e._private.scratch.cola.index}),e._private.scratch.cola}));var _,S;null!=n.edgeLength?(_=n.edgeLength,S="linkDistance"):null!=n.edgeSymDiffLength?(_=n.edgeSymDiffLength,S="symmetricDiffLinkLengths"):null!=n.edgeJaccardLength?(_=n.edgeJaccardLength,S="jaccardLinkLengths"):(_=100,S="linkDistance");if(v.links(s.stdFilter(function(e){return!e.source().isParent()&&!e.target().isParent()}).map(function(e,t){var n=e._private.scratch.cola={source:e.source()[0]._private.scratch.cola.index,target:e.target()[0]._private.scratch.cola.index};return null!=_&&(n.calcLength=d(_,e)),n})),v.size([c.w,c.h]),null!=_&&v[S](function(e){return e.calcLength}),n.flow){var k;e.is.string(n.flow)?k={axis:n.flow,minSeparation:50}:e.is.number(n.flow)?k={axis:"y",minSeparation:n.flow}:e.is.plainObject(n.flow)?((k=n.flow).axis=k.axis||"y",k.minSeparation=null!=k.minSeparation?k.minSeparation:50):k={axis:"y",minSeparation:50},v.flowLayout(k.axis,k.minSeparation)}v.avoidOverlaps(n.avoidOverlap).handleDisconnected(n.handleDisconnected).start(n.unconstrIter,n.userConstIter,n.allConstIter),t.trigger({type:"layoutstart",layout:t}),n.infinite||setTimeout(function(){v.stop()},n.maxSimulationTime)}),this},t.prototype.stop=function(){return this.adaptor&&(this.manuallyStopped=!0,this.adaptor.stop()),this},e("layout","cola",t)}(cytoscape),function(e){"use strict";function t(t){this.options=e.util.extend({},n,t)}var n={fit:!0,padding:30,startAngle:1.5*Math.PI,counterclockwise:!1,minNodeSpacing:10,boundingBox:void 0,avoidOverlap:!0,height:void 0,width:void 0,concentric:function(){return this.degree()},levelWidth:function(e){return e.maxDegree()/4},animate:!1,animationDuration:500,ready:void 0,stop:void 0};t.prototype.run=function(){for(var t=this.options,n=t,i=t.cy,o=n.eles.nodes().not(":parent"),r=e.util.makeBoundingBox(n.boundingBox?n.boundingBox:{x1:0,y1:0,w:i.width(),h:i.height()}),a={x:r.x1+r.w/2,y:r.y1+r.h/2},s=[],l=n.startAngle,c=0,d=0;d<o.length;d++){var u,h=o[d];u=n.concentric.call(h),s.push({value:u,node:h}),h._private.layoutData.concentric=u}o.updateStyle();for(d=0;d<o.length;d++){h=o[d];c=Math.max(c,h.outerWidth(),h.outerHeight())}s.sort(function(e,t){return t.value-e.value});for(var p=n.levelWidth(o),f=[[]],g=f[0],d=0;d<s.length;d++){T=s[d];g.length>0&&Math.abs(g[0].value-T.value)>=p&&(g=[],f.push(g)),g.push(T)}var v={},m=0,y=c+n.minNodeSpacing;if(!n.avoidOverlap){var w=f.length>0&&f[0].length>1,b=(Math.min(r.w,r.h)/2-y)/(f.length+w?1:0);y=Math.min(y,b)}for(d=0;d<f.length;d++){var C=f[d],x=2*Math.PI/C.length;if(C.length>1&&n.avoidOverlap){var E=Math.cos(x)-Math.cos(0),_=Math.sin(x)-Math.sin(0),S=Math.sqrt(y*y/(E*E+_*_));m=Math.max(S,m)}for(var k=0;k<C.length;k++){var T=C[k],l=n.startAngle+(n.counterclockwise?1:-1)*x*k,D={x:a.x+m*Math.cos(l),y:a.y+m*Math.sin(l)};v[T.node.id()]=D}m+=y}return o.layoutPositions(this,n,function(){var e=this.id();return v[e]}),this},e("layout","concentric",t)}(cytoscape),function(e){"use strict";function t(t){this.options=e.util.extend({},i,t)}var n,i={ready:function(){},stop:function(){},animate:!0,refresh:4,fit:!0,padding:30,boundingBox:void 0,randomize:!0,debug:!1,nodeRepulsion:4e5,nodeOverlap:10,idealEdgeLength:10,edgeElasticity:100,nestingFactor:5,gravity:250,numIter:100,initialTemp:200,coolingFactor:.95,minTemp:1};t.prototype.run=function(){var t=this.options,i=t.cy,r=this;r.stopped=!1,r.trigger({type:"layoutstart",layout:r}),n=!0===t.debug;var a=new Date,u=o(i,r,t);n&&s(u),!0===t.randomize&&l(u,i),y(u,i,t);var h=function(e){return r.stopped?(C("Layout manually stopped. Stopping computation in step "+e),!1):(d(u,i,t,e),u.temperature=u.temperature*t.coolingFactor,C("New temperature: "+u.temperature),!(u.temperature<t.minTemp)||(C("Temperature drop below minimum threshold. Stopping computation in step "+e),!1))},p=function(){c(u,i,t),!0===t.fit&&i.fit(t.padding);var e=new Date;console.info("Layout took "+(e-a)+" ms"),r.one("layoutstop",t.stop),r.trigger({type:"layoutstop",layout:r})};if(t.animate){var f=0,g=function(){for(var n,o=0;o<t.refresh&&f<t.numIter&&!1!==(n=h(f));)o++,f++;c(u,i,t),t.fit&&i.fit(t.padding),!1!==n&&f+1<t.numIter?e.util.requestAnimationFrame(g):p()};e.util.requestAnimationFrame(g)}else{for(f=0;f<t.numIter&&!1!==h(f);f++);p()}return this},t.prototype.stop=function(){return this.stopped=!0,this};var o=function(t,n,i){for(var o=i.eles.edges(),a=i.eles.nodes(),s={layout:n,layoutNodes:[],idToIndex:{},nodeSize:a.size(),graphSet:[],indexToGraph:[],layoutEdges:[],edgeSize:o.size(),temperature:i.initialTemp,clientWidth:t.width(),clientHeight:t.width(),boundingBox:e.util.makeBoundingBox(i.boundingBox?i.boundingBox:{x1:0,y1:0,w:t.width(),h:t.height()})},l=0;l<s.nodeSize;l++)(P={}).id=a[l].data("id"),P.parentId=a[l].data("parent"),P.children=[],P.positionX=a[l].position("x"),P.positionY=a[l].position("y"),P.offsetX=0,P.offsetY=0,P.height=a[l].height(),P.width=a[l].width(),P.maxX=P.positionX+P.width/2,P.minX=P.positionX-P.width/2,P.maxY=P.positionY+P.height/2,P.minY=P.positionY-P.height/2,P.padLeft=a[l]._private.style["padding-left"].pxValue,P.padRight=a[l]._private.style["padding-right"].pxValue,P.padTop=a[l]._private.style["padding-top"].pxValue,P.padBottom=a[l]._private.style["padding-bottom"].pxValue,s.layoutNodes.push(P),s.idToIndex[P.id]=l;for(var c=[],d=0,u=-1,h=[],l=0;l<s.nodeSize;l++){var p=s.layoutNodes[l],f=p.parentId;null!=f?s.layoutNodes[s.idToIndex[f]].children.push(p.id):(c[++u]=p.id,h.push(p.id))}for(s.graphSet.push(h);d<=u;){var g=c[d++],v=s.idToIndex[g],m=s.layoutNodes[v].children;if(m.length>0){s.graphSet.push(m);for(l=0;l<m.length;l++)c[++u]=m[l]}}for(l=0;l<s.graphSet.length;l++)for(var y=s.graphSet[l],w=0;w<y.length;w++){var b=s.idToIndex[y[w]];s.indexToGraph[b]=l}for(l=0;l<s.edgeSize;l++){var x=o[l],E={};E.id=x.data("id"),E.sourceId=x.data("source"),E.targetId=x.data("target");var _=i.idealEdgeLength,S=s.idToIndex[E.sourceId],k=s.idToIndex[E.targetId];if(s.indexToGraph[S]!=s.indexToGraph[k]){for(var T=r(E.sourceId,E.targetId,s),D=s.graphSet[T],R=0,P=s.layoutNodes[S];-1===$.inArray(P.id,D);)P=s.layoutNodes[s.idToIndex[P.parentId]],R++;for(P=s.layoutNodes[k];-1===$.inArray(P.id,D);)P=s.layoutNodes[s.idToIndex[P.parentId]],R++;C("LCA of nodes "+E.sourceId+" and "+E.targetId+". Index: "+T+" Contents: "+D.toString()+". Depth: "+R),_*=R*i.nestingFactor}E.idealLength=_,s.layoutEdges.push(E)}return s},r=function(e,t,n){var i=a(e,t,0,n);return 2>i.count?0:i.graph},a=function(e,t,n,i){var o=i.graphSet[n];if(-1<$.inArray(e,o)&&-1<$.inArray(t,o))return{count:2,graph:n};for(var r=0,s=0;s<o.length;s++){var l=o[s],c=i.idToIndex[l],d=i.layoutNodes[c].children;if(0!==d.length){var u=i.indexToGraph[i.idToIndex[d[0]]],h=a(e,t,u,i);if(0!==h.count){if(1!==h.count)return h;if(2==++r)break}}}return{count:r,graph:n}},s=function(e){if(n){console.debug("layoutNodes:");for(o=0;o<e.nodeSize;o++){var t=e.layoutNodes[o],i="\nindex: "+o+"\nId: "+t.id+"\nChildren: "+t.children.toString()+"\nparentId: "+t.parentId+"\npositionX: "+t.positionX+"\npositionY: "+t.positionY+"\nOffsetX: "+t.offsetX+"\nOffsetY: "+t.offsetY+"\npadLeft: "+t.padLeft+"\npadRight: "+t.padRight+"\npadTop: "+t.padTop+"\npadBottom: "+t.padBottom;console.debug(i)}console.debug("idToIndex");for(var o in e.idToIndex)console.debug("Id: "+o+"\nIndex: "+e.idToIndex[o]);console.debug("Graph Set");for(var r=e.graphSet,o=0;o<r.length;o++)console.debug("Set : "+o+": "+r[o].toString());for(var i="IndexToGraph",o=0;o<e.indexToGraph.length;o++)i+="\nIndex : "+o+" Graph: "+e.indexToGraph[o];console.debug(i),i="Layout Edges";for(o=0;o<e.layoutEdges.length;o++){var a=e.layoutEdges[o];i+="\nEdge Index: "+o+" ID: "+a.id+" SouceID: "+a.sourceId+" TargetId: "+a.targetId+" Ideal Length: "+a.idealLength}console.debug(i),i="nodeSize: "+e.nodeSize,i+="\nedgeSize: "+e.edgeSize,i+="\ntemperature: "+e.temperature,console.debug(i)}},l=function(e,t){for(var n=e.clientWidth,i=e.clientHeight,o=0;o<e.nodeSize;o++){var r=e.layoutNodes[o];r.positionX=Math.random()*n,r.positionY=Math.random()*i}},c=function(e,t,n){var i="Refreshing positions";C(i);var o=e.layout,r=n.eles.nodes(),a=e.boundingBox,s={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0};n.boundingBox&&(r.forEach(function(t){var n=e.layoutNodes[e.idToIndex[t.data("id")]];s.x1=Math.min(s.x1,n.positionX),s.x2=Math.max(s.x2,n.positionX),s.y1=Math.min(s.y1,n.positionY),s.y2=Math.max(s.y2,n.positionY)}),s.w=s.x2-s.x1,s.h=s.y2-s.y1),r.positions(function(t,o){var r=e.layoutNodes[e.idToIndex[o.data("id")]];if(i="Node: "+r.id+". Refreshed position: ("+r.positionX+", "+r.positionY+").",C(i),n.boundingBox){var l=(r.positionX-s.x1)/s.w,c=(r.positionY-s.y1)/s.h;return{x:a.x1+l*a.w,y:a.y1+c*a.h}}return{x:r.positionX,y:r.positionY}}),!0!==e.ready&&(C(i="Triggering layoutready"),e.ready=!0,o.one("layoutready",n.ready),o.trigger({type:"layoutready",layout:this}))},d=function(e,t,n,i){var o="\n\n###############################";o+="\nSTEP: "+i,C(o+="\n###############################\n"),u(e,t,n),g(e,t,n),v(e,t,n),m(e,t,n),y(e,t,n)},u=function(e,t,n){var i="calculateNodeForces";C(i);for(var o=0;o<e.graphSet.length;o++){var r=e.graphSet[o],a=r.length;i="Set: "+r.toString(),C(i);for(var s=0;s<a;s++)for(var l=e.layoutNodes[e.idToIndex[r[s]]],c=s+1;c<a;c++){var d=e.layoutNodes[e.idToIndex[r[c]]];h(l,d,e,t,n)}}},h=function(e,t,n,i,o){var r="Node repulsion. Node1: "+e.id+" Node2: "+t.id,a=t.positionX-e.positionX,s=t.positionY-e.positionY;if(r+="\ndirectionX: "+a+", directionY: "+s,0!==a||0!==s){var l=f(e,t,a,s);if(l>0){r+="\nNodes DO overlap.",r+="\nOverlap: "+l;var c=o.nodeOverlap*l;r+="\nDistance: "+(w=Math.sqrt(a*a+s*s));var d=c*a/w,u=c*s/w}else{r+="\nNodes do NOT overlap.";var h=p(e,a,s),g=p(t,-1*a,-1*s),v=g.x-h.x,m=g.y-h.y,y=v*v+m*m,w=Math.sqrt(y);r+="\nDistance: "+w;var d=(c=o.nodeRepulsion/y)*v/w,u=c*m/w}e.offsetX-=d,e.offsetY-=u,t.offsetX+=d,t.offsetY+=u,C(r+="\nForceX: "+d+" ForceY: "+u)}else r+="\nNodes have the same position."},p=function(e,t,n){var i=e.positionX,o=e.positionY,r=e.height,a=e.width,s=n/t,l=r/a,c="Computing clipping point of node "+e.id+" . Height:  "+r+", Width: "+a+"\nDirection "+t+", "+n,d={};do{if(0===t&&0<n){d.x=i,c+="\nUp direction",d.y=o+r/2;break}if(0===t&&0>n){d.x=i,d.y=o+r/2,c+="\nDown direction";break}if(0<t&&-1*l<=s&&s<=l){d.x=i+a/2,d.y=o+a*n/2/t,c+="\nRightborder";break}if(0>t&&-1*l<=s&&s<=l){d.x=i-a/2,d.y=o-a*n/2/t,c+="\nLeftborder";break}if(0<n&&(s<=-1*l||s>=l)){d.x=i+r*t/2/n,d.y=o+r/2,c+="\nTop border";break}if(0>n&&(s<=-1*l||s>=l)){d.x=i-r*t/2/n,d.y=o-r/2,c+="\nBottom border";break}}while(!1);return c+="\nClipping point found at "+d.x+", "+d.y,C(c),d},f=function(e,t,n,i){if(n>0)o=e.maxX-t.minX;else var o=t.maxX-e.minX;if(i>0)r=e.maxY-t.minY;else var r=t.maxY-e.minY;return o>=0&&r>=0?Math.sqrt(o*o+r*r):0},g=function(e,t,n){for(var i=0;i<e.edgeSize;i++){var o=e.layoutEdges[i],r=e.idToIndex[o.sourceId],a=e.layoutNodes[r],s=e.idToIndex[o.targetId],l=e.layoutNodes[s],c=l.positionX-a.positionX,d=l.positionY-a.positionY;if(0===c&&0===d)return;var u=p(a,c,d),h=p(l,-1*c,-1*d),f=h.x-u.x,g=h.y-u.y,v=Math.sqrt(f*f+g*g),m=Math.pow(o.idealLength-v,2)/n.edgeElasticity;if(0!==v)var y=m*f/v,w=m*g/v;else var y=0,w=0;a.offsetX+=y,a.offsetY+=w,l.offsetX-=y,l.offsetY-=w;var b="Edge force between nodes "+a.id+" and "+l.id;C(b+="\nDistance: "+v+" Force: ("+y+", "+w+")")}},v=function(e,t,n){var i="calculateGravityForces";C(i);for(var o=0;o<e.graphSet.length;o++){var r=e.graphSet[o],a=r.length;if(i="Set: "+r.toString(),C(i),0===o)var s=e.clientHeight/2,l=e.clientWidth/2;else var c=e.layoutNodes[e.idToIndex[r[0]]],d=e.layoutNodes[e.idToIndex[c.parentId]],s=d.positionX,l=d.positionY;C(i="Center found at: "+s+", "+l);for(var u=0;u<a;u++){var h=e.layoutNodes[e.idToIndex[r[u]]];i="Node: "+h.id;var p=s-h.positionX,f=l-h.positionY,g=Math.sqrt(p*p+f*f);if(g>1){var v=n.gravity*p/g,m=n.gravity*f/g;h.offsetX+=v,h.offsetY+=m,i+=": Applied force: "+v+", "+m}else i+=": skypped since it's too close to center";C(i)}}},m=function(e,t,n){var i=[],o=0,r=-1;for(C("propagateForces"),i.push.apply(i,e.graphSet[0]),r+=e.graphSet[0].length;o<=r;){var a=i[o++],s=e.idToIndex[a],l=e.layoutNodes[s],c=l.children;if(0<c.length){var d=l.offsetX,u=l.offsetY,h="Propagating offset from parent node : "+l.id+". OffsetX: "+d+". OffsetY: "+u;h+="\n Children: "+c.toString(),C(h);for(var p=0;p<c.length;p++){var f=e.layoutNodes[e.idToIndex[c[p]]];f.offsetX+=d,f.offsetY+=u,i[++r]=c[p]}l.offsetX=0,l.offsetY=0}}},y=function(e,t,n){var i="Updating positions";C(i);for(r=0;r<e.nodeSize;r++)0<(a=e.layoutNodes[r]).children.length&&(C("Resetting boundaries of compound node: "+a.id),a.maxX=void 0,a.minX=void 0,a.maxY=void 0,a.minY=void 0);for(r=0;r<e.nodeSize;r++)if(0<(a=e.layoutNodes[r]).children.length)C("Skipping position update of node: "+a.id);else{i="Node: "+a.id+" Previous position: ("+a.positionX+", "+a.positionY+").";var o=w(a.offsetX,a.offsetY,e.temperature);a.positionX+=o.x,a.positionY+=o.y,a.offsetX=0,a.offsetY=0,a.minX=a.positionX-a.width,a.maxX=a.positionX+a.width,a.minY=a.positionY-a.height,a.maxY=a.positionY+a.height,i+=" New Position: ("+a.positionX+", "+a.positionY+").",C(i),b(a,e)}for(var r=0;r<e.nodeSize;r++){var a=e.layoutNodes[r];0<a.children.length&&(a.positionX=(a.maxX+a.minX)/2,a.positionY=(a.maxY+a.minY)/2,a.width=a.maxX-a.minX,a.height=a.maxY-a.minY,i="Updating position, size of compound node "+a.id,i+="\nPositionX: "+a.positionX+", PositionY: "+a.positionY,i+="\nWidth: "+a.width+", Height: "+a.height,C(i))}},w=function(e,t,n){var i="Limiting force: ("+e+", "+t+"). Max: "+n,o=Math.sqrt(e*e+t*t);if(o>n)r={x:n*e/o,y:n*t/o};else var r={x:e,y:t};return i+=".\nResult: ("+r.x+", "+r.y+")",C(i),r},b=function(e,t){var n="Propagating new position/size of node "+e.id,i=e.parentId;if(null==i)return n+=". No parent node.",void C(n);var o=t.layoutNodes[t.idToIndex[i]],r=!1;if((null==o.maxX||e.maxX+o.padRight>o.maxX)&&(o.maxX=e.maxX+o.padRight,r=!0,n+="\nNew maxX for parent node "+o.id+": "+o.maxX),(null==o.minX||e.minX-o.padLeft<o.minX)&&(o.minX=e.minX-o.padLeft,r=!0,n+="\nNew minX for parent node "+o.id+": "+o.minX),(null==o.maxY||e.maxY+o.padBottom>o.maxY)&&(o.maxY=e.maxY+o.padBottom,r=!0,n+="\nNew maxY for parent node "+o.id+": "+o.maxY),(null==o.minY||e.minY-o.padTop<o.minY)&&(o.minY=e.minY-o.padTop,r=!0,n+="\nNew minY for parent node "+o.id+": "+o.minY),r)return C(n),b(o,t);n+=". No changes in boundaries/position of parent node "+o.id,C(n)},C=function(e){n&&console.debug(e)};e("layout","cose",t)}(cytoscape),function(e){"use strict";function t(t){this.options=e.util.extend(!0,{},n,t)}var n={nodeSep:void 0,edgeSep:void 0,rankSep:void 0,rankDir:void 0,minLen:function(e){return 1},fit:!0,padding:30,animate:!1,animationDuration:500,boundingBox:void 0,ready:function(){},stop:function(){}};t.prototype.run=function(){var t=this.options,n=this;return e.util.require("dagre",function(i){for(var o=t.cy,r=t.eles,a=e.util.makeBoundingBox(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:o.width(),h:o.height()}),s=new i.Digraph,l=r.nodes().not(":parent"),c=0;c<l.length;c++){var d=l[c];s.addNode(d.id(),{width:d.width(),height:d.height()})}for(var u=r.edges(),c=0;c<u.length;c++){var h=u[c];s.addEdge(h.id(),h.source().id(),h.target().id(),{minLen:e.is.fn(t.minLen)?t.minLen.apply(h,[h]):t.minLen})}var p=i.layout();t.nodeSep&&p.nodeSep(t.nodeSep),t.edgeSep&&p.edgeSep(t.edgeSep),t.rankSep&&p.rankSep(t.rankSep),t.rankDir&&p.rankDir(t.rankDir),(p=p.run(s)).eachNode(function(e,t){o.getElementById(e).scratch().dagre=t});var f;t.boundingBox?(f={x1:1/0,x2:-1/0,y1:1/0,y2:-1/0},l.forEach(function(e){var t=e.scratch().dagre;f.x1=Math.min(f.x1,t.x),f.x2=Math.max(f.x2,t.x),f.y1=Math.min(f.y1,t.y),f.y2=Math.max(f.y2,t.y)}),f.w=f.x2-f.x1,f.h=f.y2-f.y1):f=a;var g=function(e){if(t.boundingBox){var n=(e.x-f.x1)/f.w,i=(e.y-f.y1)/f.h;return{x:a.x1+n*a.w,y:a.y1+i*a.h}}return e};l.layoutPositions(n,t,function(){var e=this.scratch().dagre;return g({x:e.x,y:e.y})})}),this},e("layout","dagre",t)}(cytoscape),function(e){"use strict";function t(t){this.options=e.util.extend({},n,t)}var n={fit:!0,padding:30,boundingBox:void 0,avoidOverlap:!0,rows:void 0,columns:void 0,position:function(e){},animate:!1,animationDuration:500,ready:void 0,stop:void 0};t.prototype.run=function(){var t=this.options,n=t,i=t.cy,o=n.eles.nodes().not(":parent"),r=e.util.makeBoundingBox(n.boundingBox?n.boundingBox:{x1:0,y1:0,w:i.width(),h:i.height()});if(0===r.h||0===r.w)o.layoutPositions(this,n,function(){return{x:r.x1,y:r.y1}});else{var a=o.size(),s=Math.sqrt(a*r.h/r.w),l=Math.round(s),c=Math.round(r.w/r.h*s),d=function(e){if(null==e)return Math.min(l,c);Math.min(l,c)==l?l=e:c=e},u=function(e){if(null==e)return Math.max(l,c);Math.max(l,c)==l?l=e:c=e};if(null!=n.rows&&null!=n.columns)l=n.rows,c=n.columns;else if(null!=n.rows&&null==n.columns)l=n.rows,c=Math.ceil(a/l);else if(null==n.rows&&null!=n.columns)c=n.columns,l=Math.ceil(a/c);else if(c*l>a)((h=d())-1)*(p=u())>=a?d(h-1):(p-1)*h>=a&&u(p-1);else for(;c*l<a;){var h=d(),p=u();(p+1)*h>=a?u(p+1):d(h+1)}var f=r.w/c,g=r.h/l;if(n.avoidOverlap)for(S=0;S<o.length;S++){var v=(k=o[S]).outerWidth(),m=k.outerHeight();f=Math.max(f,v),g=Math.max(g,m)}for(var y={},w=function(e,t){return!!y["c-"+e+"-"+t]},b=function(e,t){y["c-"+e+"-"+t]=!0},C=0,x=0,E=function(){++x>=c&&(x=0,C++)},_={},S=0;S<o.length;S++){var k=o[S],T=n.position(k);if(T&&(void 0!==T.row||void 0!==T.col)){var D={row:T.row,col:T.col};if(void 0===D.col)for(D.col=0;w(D.row,D.col);)D.col++;else if(void 0===D.row)for(D.row=0;w(D.row,D.col);)D.row++;_[k.id()]=D,b(D.row,D.col)}}o.layoutPositions(this,n,function(e,t){var n,i;if(t.locked()||t.isFullAutoParent())return!1;var o=_[t.id()];if(o)n=o.col*f+f/2+r.x1,i=o.row*g+g/2+r.y1;else{for(;w(C,x);)E();n=x*f+f/2+r.x1,i=C*g+g/2+r.y1,b(C,x),E()}return{x:n,y:i}})}return this},e("layout","grid",t)}(cytoscape),function(e){"use strict";function t(t){this.options=e.util.extend(!0,{},n,t)}var n={ready:function(){},stop:function(){}};t.prototype.run=function(){var e=this.options,t=e.eles,n=this;e.cy;return n.trigger("layoutstart"),t.nodes().positions(function(){return{x:0,y:0}}),n.one("layoutready",e.ready),n.trigger("layoutready"),n.one("layoutstop",e.stop),n.trigger("layoutstop"),this},t.prototype.stop=function(){return this},e("layout","null",t)}(cytoscape),function(e){"use strict";function t(t){this.options=e.util.extend(!0,{},n,t)}var n={positions:void 0,zoom:void 0,pan:void 0,fit:!0,padding:30,animate:!1,animationDuration:500,ready:void 0,stop:void 0};t.prototype.run=function(){function t(e){if(null==n.positions)return null;if(o)return n.positions.apply(e,[e]);var t=n.positions[e._private.data.id];return null==t?null:t}var n=this.options,i=n.eles.nodes(),o=e.is.fn(n.positions);return i.layoutPositions(this,n,function(e,n){var i=t(n);return!n.locked()&&null!=i&&i}),this},e("layout","preset",t)}(cytoscape),function(e){"use strict";function t(t){this.options=e.util.extend(!0,{},n,t)}var n={fit:!0,padding:30,boundingBox:void 0,animate:!1,animationDuration:500,ready:void 0,stop:void 0};t.prototype.run=function(){var t=this.options,n=t.cy,i=t.eles.nodes().not(":parent"),o=e.util.makeBoundingBox(t.boundingBox?t.boundingBox:{x1:0,y1:0,w:n.width(),h:n.height()});return i.layoutPositions(this,t,function(e,t){return{x:o.x1+Math.round(Math.random()*o.w),y:o.y1+Math.round(Math.random()*o.h)}}),this},e("layout","random",t)}(cytoscape),function(e){"use strict";function t(t){this.options=e.util.extend(!0,{},n,t)}var n={animate:!0,maxSimulationTime:4e3,ungrabifyWhileSimulating:!1,fit:!0,padding:30,boundingBox:void 0,random:!1,infinite:!1,ready:void 0,stop:void 0,stiffness:400,repulsion:400,damping:.5};t.prototype.run=function(){var t=this,n=this,i=this.options;return e.util.require("Springy",function(o){function r(e){var t=e.scratch("springy").model.id,n=b.layout.nodePoints[t].p,i=e.position(),o=null!=i.x&&null!=i.y?v(e.position()):{x:4*Math.random()-2,y:4*Math.random()-2};n.x=o.x,n.y=o.y}var a=!1,s=i.cy;t.trigger({type:"layoutstart",layout:t});var l=i.eles,c=l.nodes().not(":parent"),d=l.edges(),u=e.util.makeBoundingBox(i.boundingBox?i.boundingBox:{x1:0,y1:0,w:s.width(),h:s.height()}),h=new o.Graph;c.each(function(e,t){t.scratch("springy",{model:h.newNode({element:t})})}),d.each(function(e,t){var n=t.source().scratch("springy").model,i=t.target().scratch("springy").model;t.scratch("springy",{model:h.newEdge(n,i,{element:t})})});var p=window.sim=new o.Layout.ForceDirected(h,i.stiffness,i.repulsion,i.damping);i.infinite&&(p.minEnergyThreshold=-1/0);var f=p.getBoundingBox(),g=function(e){var t=(f=p.getBoundingBox()).topright.subtract(f.bottomleft),n=e.subtract(f.bottomleft).divide(t.x).x*u.w+u.x1,i=e.subtract(f.bottomleft).divide(t.y).y*u.h+u.x1;return new o.Vector(n,i)},v=function(e){var t=(f=p.getBoundingBox()).topright.subtract(f.bottomleft),n=(e.x-u.x1)/u.w*t.x+f.bottomleft.x,i=(e.y-u.y1)/u.h*t.y+f.bottomleft.y;return new o.Vector(n,i)},m=s.collection(),y=s.nodes().size(),w=1,b=new o.Renderer(p,function(){m.length>0&&i.animate&&(a=!0,m.rtrigger("position"),i.fit&&s.fit(i.padding),m=s.collection(),a=!1)},function(e,t,n){},function(e,n){var o=g(n),r=e.data.element;r.locked()||r.grabbed()||(r._private.position={x:o.x,y:o.y},m.merge(r)),w==y&&(t.one("layoutready",i.ready),t.trigger({type:"layoutready",layout:t})),w++});c.each(function(e,t){i.random||r(t)});var C;c.on("position",C=function(){a||r(this)});var x=c.filter(":grabbable");n.stopSystem=function(){h.filterNodes(function(){return!1}),i.ungrabifyWhileSimulating&&x.grabify(),i.fit&&s.fit(i.padding),c.off("drag position",C),t.one("layoutstop",i.stop),t.trigger({type:"layoutstop",layout:t}),n.stopSystem=null},i.ungrabifyWhileSimulating&&x.ungrabify(),b.start(),i.infinite||setTimeout(function(){n.stop()},i.maxSimulationTime)}),this},t.prototype.stop=function(){return null!=this.stopSystem&&this.stopSystem(),this},e("layout","springy",t)}(cytoscape),function(e){"use strict";function t(e){this.options=e}t.prototype.recalculateRenderedStyle=function(){},t.prototype.notify=function(){},e("renderer","null",t)}(cytoscape),function(e,t){var n={zoomFactor:.05,zoomDelay:45,minZoom:.1,maxZoom:10,fitPadding:50,panSpeed:10,panDistance:10,panDragAreaSize:75,panMinPercentSpeed:.25,panInactiveArea:8,panIndicatorMinOpacity:.5,autodisableForMobile:!0,sliderHandleIcon:"fa fa-minus",zoomInIcon:"fa fa-plus",zoomOutIcon:"fa fa-minus",resetIcon:"fa fa-expand"};e.fn.cytoscapePanzoom=function(t){var i=e.extend(!0,{},n,t),o=t,r={destroy:function(){e(this).find(".ui-cytoscape-panzoom").remove()},init:function(){return"ontouchstart"in window&&i.autodisableForMobile?e(this):e(this).each(function(){function t(e){var t={x:e.originalEvent.pageX-b.offset().left-b.width()/2,y:e.originalEvent.pageY-b.offset().top-b.height()/2},n=i.panDragAreaSize,o=Math.sqrt(t.x*t.x+t.y*t.y),r=Math.min(o/n,1);return o<i.panInactiveArea?{x:NaN,y:NaN}:(t={x:t.x/o,y:t.y/o},r=Math.max(i.panMinPercentSpeed,r),{x:-1*t.x*(r*i.panDistance),y:-1*t.y*(r*i.panDistance)})}function n(){clearInterval(R),e(window).unbind("mousemove",A),k.hide()}function o(e){var t=e,n=Math.sqrt(t.x*t.x+t.y*t.y),o={x:-1*t.x/n,y:-1*t.y/n},r=b.width(),a=b.height(),s=n/i.panDistance,l=Math.max(i.panIndicatorMinOpacity,s),c=255-Math.round(255*l);k.show().css({left:r/2*o.x+r/2,top:a/2*o.y+a/2,background:"rgb("+c+", "+c+", "+c+")"})}function r(){var e=h.cytoscape("get");e.pan(),e.zoom();T=h.width()/2,D=h.height()/2}function a(){P=!0,r()}function s(){P=!1}function l(e){var t=h.cytoscape("get");P||r(),t.zoom({level:e,renderedPosition:{x:T,y:D}})}function c(e,t){void 0===t&&(t=0);var n=I,o=0+n,r=m.height()-y.height()-2*n,a=e.pageY-m.offset().top-t;a<o&&(a=o),a>r&&(a=r);var s=1-(a-o)/(r-o);y.css("top",a);var c=i.minZoom,d=i.maxZoom,u=Math.log(c)/Math.log(d),h=(1-u)*s+u,p=Math.pow(d,h);p<c?p=c:p>d&&(p=d),l(p)}function d(){var e=h.cytoscape("get").zoom(),t=i.minZoom,n=i.maxZoom,o=Math.log(t)/Math.log(n),r=1-(Math.log(e)/Math.log(n)-o)/(1-o),a=I,s=m.height()-y.height()-2*I,l=r*(s-a);l<a&&(l=a),l>s&&(l=s),y.css("top",l)}function u(t,n){var o;t.bind("mousedown",function(e){if(e.preventDefault(),e.stopPropagation(),0==e.button){var t=h.cytoscape("get");return a(),o=setInterval(function(){var e=t.zoom(),o=t.zoom()*n;o<i.minZoom&&(o=i.minZoom),o>i.maxZoom&&(o=i.maxZoom),o==i.maxZoom&&e==i.maxZoom||o==i.minZoom&&e==i.minZoom||l(o)},i.zoomDelay),!1}}),e(window).bind("mouseup blur",function(){clearInterval(o),s()})}var h=e(this),p=e('<div class="ui-cytoscape-panzoom"></div>');h.append(p),i.staticPosition&&p.addClass("ui-cytoscape-panzoom-static");var f=e('<div class="ui-cytoscape-panzoom-zoom-in ui-cytoscape-panzoom-zoom-button"><span class="icon '+i.zoomInIcon+'"></span></div>');p.append(f);var g=e('<div class="ui-cytoscape-panzoom-zoom-out ui-cytoscape-panzoom-zoom-button"><span class="icon '+i.zoomOutIcon+'"></span></div>');p.append(g);var v=e('<div class="ui-cytoscape-panzoom-reset ui-cytoscape-panzoom-zoom-button"><span class="icon '+i.resetIcon+'"></span></div>');p.append(v);var m=e('<div class="ui-cytoscape-panzoom-slider"></div>');p.append(m),m.append('<div class="ui-cytoscape-panzoom-slider-background"></div>');var y=e('<div class="ui-cytoscape-panzoom-slider-handle"><span class="icon '+i.sliderHandleIcon+'"></span></div>');m.append(y);var w=e('<div class="ui-cytoscape-panzoom-no-zoom-tick"></div>');m.append(w);var b=e('<div class="ui-cytoscape-panzoom-panner"></div>');p.append(b);var C=e('<div class="ui-cytoscape-panzoom-panner-handle"></div>');b.append(C);var x=e('<div class="ui-cytoscape-panzoom-pan-up ui-cytoscape-panzoom-pan-button"></div>'),E=e('<div class="ui-cytoscape-panzoom-pan-down ui-cytoscape-panzoom-pan-button"></div>'),_=e('<div class="ui-cytoscape-panzoom-pan-left ui-cytoscape-panzoom-pan-button"></div>'),S=e('<div class="ui-cytoscape-panzoom-pan-right ui-cytoscape-panzoom-pan-button"></div>');b.append(x).append(E).append(_).append(S);var k=e('<div class="ui-cytoscape-panzoom-pan-indicator"></div>');b.append(k);var T,D,R,P=!1,A=function(e){e.stopPropagation(),e.preventDefault(),clearInterval(R);var n=t(e);isNaN(n.x)||isNaN(n.y)?k.hide():(o(n),R=setInterval(function(){h.cytoscape("get").panBy(n)},i.panSpeed))};C.bind("mousedown",function(t){A(t),e(window).bind("mousemove",A)}),C.bind("mouseup",function(){n()}),e(window).bind("mouseup blur",function(){n()}),m.bind("mousedown",function(){return!1});var N,M,O=!1,I=2;y.bind("mousedown",N=function(t){var n=t.target===y[0]?t.offsetY:0;O=!0,a(),y.addClass("active");var i=0;return e(window).bind("mousemove",M=function(e){var t=+new Date;return t>i+10&&(i=t,c(e,n),!1)}),e(window).bind("mouseup",function(){e(window).unbind("mousemove",M),O=!1,y.removeClass("active"),s()}),!1}),m.bind("mousedown",function(e){e.target!==y[0]&&(N(e),c(e))}),d(),h.cytoscape("get").on("zoom",function(){O||d()}),function(){var e=i.minZoom,t=i.maxZoom,n=Math.log(e)/Math.log(t),o=1-(Math.log(1)/Math.log(t)-n)/(1-n);if(o>1||o<0)w.hide();else{var r=I,a=m.height()-y.height()-2*I,s=o*(a-r);s<r&&(s=r),s>a&&(s=a),w.css("top",s)}}(),u(f,1+i.zoomFactor),u(g,1-i.zoomFactor),v.bind("mousedown",function(e){if(0==e.button){var t=h.cytoscape("get");return 0===t.elements().size()?t.reset():t.fit(i.fitPadding),!1}})})}};return r[o]?r[o].apply(this,Array.prototype.slice.call(arguments,1)):"object"!=typeof o&&o?(e.error("No such function `"+o+"` for jquery.cytoscapePanzoom"),e(this)):r.init.apply(this,arguments)},e.fn.cyPanzoom=e.fn.cytoscapePanzoom,t("core","panzoom",function(t){e(this.container()).cytoscapePanzoom(t)})}(jQuery,cytoscape),function e(t,n,i){function o(a,s){if(!n[a]){if(!t[a]){var l="function"==typeof require&&require;if(!s&&l)return l(a,!0);if(r)return r(a,!0);throw new Error("Cannot find module '"+a+"'")}var c=n[a]={exports:{}};t[a][0].call(c.exports,function(e){var n=t[a][1][e];return o(n||e)},c,c.exports,e,t,n,i)}return n[a].exports}for(var r="function"==typeof require&&require,a=0;a<i.length;a++)o(i[a]);return o}({1:[function(e,t,n){("undefined"!=typeof self?self:"undefined"!=typeof window?window:{}).dagre=e("./index")},{"./index":2}],2:[function(e,t,n){n.Digraph=e("graphlib").Digraph,n.Graph=e("graphlib").Graph,n.layout=e("./lib/layout"),n.version=e("./lib/version")},{"./lib/layout":3,"./lib/version":18,graphlib:24}],3:[function(e,t,n){var i=e("./util"),o=e("./rank"),r=e("./order"),a=e("graphlib").CGraph,s=e("graphlib").CDigraph;t.exports=function(){function t(e){var t=new s;e.eachNode(function(e,n){void 0===n&&(n={}),t.addNode(e,{width:n.width,height:n.height}),n.hasOwnProperty("rank")&&(t.node(e).prefRank=n.rank)}),e.parent&&e.nodes().forEach(function(n){t.parent(n,e.parent(n))}),e.eachEdge(function(e,n,i,o){void 0===o&&(o={});var r={e:e,minLen:o.minLen||1,width:o.width||0,height:o.height||0,points:[]};t.addEdge(null,n,i,r)});var n=e.graph()||{};return t.graph({rankDir:n.rankDir||h.rankDir,orderRestarts:n.orderRestarts}),t}function n(e){var t=0;e.eachEdge(function(n,i,o,r){var a=e.node(i).rank,s=e.node(o).rank;if(a+1<s){for(var l=i,c=a+1,d=0;c<s;++c,++d){var u="_D"+ ++t,h={width:r.width,height:r.height,edge:{id:n,source:i,target:o,attrs:r},rank:c,dummy:!0};0===d?h.index=0:c+1===s&&(h.index=1),e.addNode(u,h),e.addEdge(null,l,u,{}),l=u}e.addEdge(null,l,o,{}),e.delEdge(n)}})}function l(e){e.eachNode(function(t,n){if(n.dummy){if("index"in n){var i=n.edge;e.hasEdge(i.id)||e.addEdge(i.id,i.source,i.target,i.attrs),e.edge(i.id).points[n.index]={x:n.x,y:n.y,ul:n.ul,ur:n.ur,dl:n.dl,dr:n.dr}}e.delNode(t)}})}function c(e){e.eachEdge(function(e,t,n,i){i.reversed&&i.points.reverse()})}function d(e,t){var n=t?new s:new a;n.graph(e.graph()),e.eachNode(function(e,t){n.addNode(e,t)}),e.eachNode(function(t){n.parent(t,e.parent(t))}),e.eachEdge(function(e,t,i,o){n.addEdge(o.e,t,i,o)});var i=0,o=0;return e.eachNode(function(t,n){e.children(t).length||(i=Math.max(i,n.x+n.width/2),o=Math.max(o,n.y+n.height/2))}),e.eachEdge(function(e,t,n,r){var a=Math.max.apply(Math,r.points.map(function(e){return e.x})),s=Math.max.apply(Math,r.points.map(function(e){return e.y}));i=Math.max(i,a+r.width/2),o=Math.max(o,s+r.height/2)}),n.graph().width=i,n.graph().height=o,n}function u(e){return function(){return arguments.length?(e.apply(null,arguments),f):e()}}var h={debugLevel:0,orderMaxSweeps:r.DEFAULT_MAX_SWEEPS,rankSimplex:!1,rankDir:"TB"},p=e("./position")(),f={};return f.orderIters=i.propertyAccessor(f,h,"orderMaxSweeps"),f.rankSimplex=i.propertyAccessor(f,h,"rankSimplex"),f.nodeSep=u(p.nodeSep),f.edgeSep=u(p.edgeSep),f.universalSep=u(p.universalSep),f.rankSep=u(p.rankSep),f.rankDir=i.propertyAccessor(f,h,"rankDir"),f.debugAlignment=u(p.debugAlignment),f.debugLevel=i.propertyAccessor(f,h,"debugLevel",function(e){i.log.level=e,p.debugLevel(e)}),f.run=i.time("Total layout",function(e){var a,s=f.rankSep();try{return 0===(a=i.time("initLayoutGraph",t)(e)).order()?a:(a.eachEdge(function(e,t,n,i){i.minLen*=2}),f.rankSep(s/2),i.time("rank.run",o.run)(a,h.rankSimplex),i.time("normalize",n)(a),i.time("order",r)(a,h.orderMaxSweeps),i.time("position",p.run)(a),i.time("undoNormalize",l)(a),i.time("fixupEdgePoints",c)(a),i.time("rank.restoreEdges",o.restoreEdges)(a),i.time("createFinalGraph",d)(a,e.isDirected()))}finally{f.rankSep(s)}}),f._normalize=n,f}},{"./order":4,"./position":9,"./rank":10,"./util":17,graphlib:24}],4:[function(e,t,n){function o(e,t){arguments.length<2&&(t=g);var n=e.graph().orderRestarts||0,i=h(e);i.forEach(function(t){t=t.filterNodes(function(t){return!e.children(t).length})});for(var o,r=0,a=Number.MAX_VALUE,l={},c=0;c<Number(n)+1&&0!==a;++c){o=Number.MAX_VALUE,p(e,n>0),d.log(2,"Order phase start cross count: "+e.graph().orderInitCC);var f,v,m;for(f=0,v=0;v<4&&f<t&&o>0;++f,++v,++r)s(e,i,f),(m=u(e))<o&&(v=0,o=m,m<a&&(e.eachNode(function(e,t){l[e]=t.order}),a=m)),d.log(3,"Order phase start "+c+" iter "+f+" cross count: "+m)}Object.keys(l).forEach(function(t){e.children&&e.children(t).length||(e.node(t).order=l[t])}),e.graph().orderCC=a,d.log(2,"Order iterations: "+r),d.log(2,"Order phase best cross count: "+e.graph().orderCC)}function r(e,t){var n={};return t.forEach(function(t){n[t]=e.inEdges(t).map(function(t){return e.node(e.source(t)).order})}),n}function a(e,t){var n={};return t.forEach(function(t){n[t]=e.outEdges(t).map(function(t){return e.node(e.target(t)).order})}),n}function s(e,t,n){n%2==0?l(e,t):c(e,t)}function l(e,t){var n;for(i=1;i<t.length;++i)n=f(t[i],n,r(e,t[i].nodes()))}function c(e,t){for(i=t.length-2;i>=0;--i)f(t[i],void 0,a(e,t[i].nodes()))}var d=e("./util"),u=e("./order/crossCount"),h=e("./order/initLayerGraphs"),p=e("./order/initOrder"),f=e("./order/sortLayer");t.exports=o;var g=24;o.DEFAULT_MAX_SWEEPS=g},{"./order/crossCount":5,"./order/initLayerGraphs":6,"./order/initOrder":7,"./order/sortLayer":8,"./util":17}],5:[function(e,t,n){function i(e,t,n){var i=[];t.forEach(function(t){var n=[];e.outEdges(t).forEach(function(t){n.push(e.node(e.target(t)).order)}),n.sort(function(e,t){return e-t}),i=i.concat(n)});for(var o=1;o<n.length;)o<<=1;var r=2*o-1;o-=1;for(var a=[],s=0;s<r;++s)a[s]=0;var l=0;return i.forEach(function(e){var t=e+o;for(++a[t];t>0;)t%2&&(l+=a[t+1]),++a[t=t-1>>1]}),l}var o=e("../util");t.exports=function(e){for(var t=0,n=o.ordering(e),r=1;r<n.length;++r)t+=i(e,n[r-1],n[r]);return t}},{"../util":17}],6:[function(e,t,n){var i=e("graphlib").filter.nodesFromList,o=e("cp-data").Set;t.exports=function(e){function t(i){if(null!==i){var r=e.node(i);r.minRank="rank"in r?r.rank:Number.MAX_VALUE,r.maxRank="rank"in r?r.rank:Number.MIN_VALUE;var a=new o;return e.children(i).forEach(function(n){var i=t(n);a=o.union([a,i]),r.minRank=Math.min(r.minRank,e.node(n).minRank),r.maxRank=Math.max(r.maxRank,e.node(n).maxRank)}),"rank"in r&&a.add(r.rank),a.keys().forEach(function(e){e in n||(n[e]=[]),n[e].push(i)}),a}e.children(i).forEach(function(e){t(e)})}var n=[];t(null);var r=[];return n.forEach(function(t,n){r[n]=e.filterNodes(i(t))}),r}},{"cp-data":19,graphlib:24}],7:[function(e,t,n){var i=e("./crossCount"),o=e("../util");t.exports=function(e,t){var n=[];e.eachNode(function(t,i){var o=n[i.rank];e.children&&e.children(t).length>0||(o||(o=n[i.rank]=[]),o.push(t))}),n.forEach(function(n){t&&o.shuffle(n),n.forEach(function(t,n){e.node(t).order=n})});var r=i(e);e.graph().orderInitCC=r,e.graph().orderCC=Number.MAX_VALUE}},{"../util":17,"./crossCount":5}],8:[function(e,t,n){var i=e("../util");t.exports=function(e,t,n){var o=[],r={};e.eachNode(function(e,t){o[t.order]=e;var a=n[e];a.length&&(r[e]=i.sum(a)/a.length)});var a=e.nodes().filter(function(e){return void 0!==r[e]});a.sort(function(t,n){return r[t]-r[n]||e.node(t).order-e.node(n).order});for(var s=0,l=0,c=a.length;l<c;++s)void 0!==r[o[s]]&&(e.node(a[l++]).order=s)}},{"../util":17}],9:[function(e,t,n){var i=e("./util");t.exports=function(){function e(e,t){return e<t?e.toString().length+":"+e+"-"+t:t.toString().length+":"+t+"-"+e}function t(t,n){var i,o,r,a,s,l={},c={};if(n.length<=2)return l;n[1].forEach(function(e,t){c[e]=t});for(var d=1;d<n.length-1;++d){i=n[d],o=n[d+1],r=0,a=0;for(var u=0;u<o.length;++u){var h=o[u];if(c[h]=u,s=void 0,t.node(h).dummy){var p=t.predecessors(h)[0];void 0!==p&&t.node(p).dummy&&(s=c[p])}if(void 0===s&&u===o.length-1&&(s=i.length-1),void 0!==s){for(;a<=u;++a)t.predecessors(o[a]).forEach(function(t){var n=c[t];(n<r||n>s)&&(l[e(o[a],t)]=!0)});r=s}}}return l}function n(t,n,i,o){var r={},a={},s={};return n.forEach(function(e){e.forEach(function(e,t){a[e]=e,s[e]=e,r[e]=t})}),n.forEach(function(n){var l=-1;n.forEach(function(n){var c,d=t[o](n);d.length>0&&(d.sort(function(e,t){return r[e]-r[t]}),c=(d.length-1)/2,d.slice(Math.floor(c),Math.ceil(c)+1).forEach(function(t){s[n]===n&&!i[e(t,n)]&&l<r[t]&&(s[t]=n,s[n]=a[n]=a[t],l=r[t])}))})}),{pos:r,root:a,align:s}}function o(e,t,n,o,r){function a(e,t,n){t in c[e]?c[e][t]=Math.min(c[e][t],n):c[e][t]=n}function s(t){if(!(t in p)){p[t]=0;var i=t;do{if(n[i]>0){var c=o[u[i]];s(c),l[t]===t&&(l[t]=l[c]);var d=h(e,u[i])+h(e,i);l[t]!==l[c]?a(l[c],l[t],p[t]-p[c]-d):p[t]=Math.max(p[t],p[c]+d)}i=r[i]}while(i!==t)}}var l={},c={},d={},u={},p={};return t.forEach(function(e){e.forEach(function(t,n){l[t]=t,c[t]={},n>0&&(u[t]=e[n-1])})}),i.values(o).forEach(function(e){s(e)}),t.forEach(function(e){e.forEach(function(e){if(p[e]=p[o[e]],e===o[e]&&e===l[e]){var t=0;e in c&&Object.keys(c[e]).length>0&&(t=i.min(Object.keys(c[e]).map(function(t){return c[e][t]+(t in d?d[t]:0)}))),d[e]=t}})}),t.forEach(function(e){e.forEach(function(e){p[e]+=d[l[o[e]]]||0})}),p}function r(e,t,n){return i.min(t.map(function(e){var t=e[0];return n[t]}))}function a(e,t,n){return i.max(t.map(function(e){var t=e[e.length-1];return n[t]}))}function s(e,t,n){var i,o={},s={},l={},c=Number.POSITIVE_INFINITY;for(var d in n){var u=n[d];o[d]=r(e,t,u),s[d]=a(e,t,u);var h=s[d]-o[d];h<c&&(c=h,i=d)}["u","d"].forEach(function(e){["l","r"].forEach(function(t){var n=e+t;l[n]="l"===t?o[i]-o[n]:s[i]-s[n]})});for(d in n)e.eachNode(function(e){n[d][e]+=l[d]})}function l(e){for(var t in e)e[t]=-e[t]}function c(e){e.forEach(function(e){e.reverse()})}function d(e,t){switch(e.graph().rankDir){case"LR":case"RL":return e.node(t).height;default:return e.node(t).width}}function u(e,t){switch(e.graph().rankDir){case"LR":case"RL":return e.node(t).width;default:return e.node(t).height}}function h(e,t){return null!==m.universalSep?m.universalSep:(d(e,t)+(e.node(t).dummy?m.edgeSep:m.nodeSep))/2}function p(e,t,n){if("LR"===e.graph().rankDir||"RL"===e.graph().rankDir){if(arguments.length<3)return e.node(t).y;e.node(t).y=n}else{if(arguments.length<3)return e.node(t).x;e.node(t).x=n}}function f(e,t,n,i){if("LR"===t.graph().rankDir||"RL"===t.graph().rankDir){if(arguments.length<3)return t.node(n)[e];t.node(n)[e]=i}else{if(arguments.length<3)return t.node(n)[e];t.node(n)[e]=i}}function g(e,t,n){if("LR"===e.graph().rankDir||"RL"===e.graph().rankDir){if(arguments.length<3)return e.node(t).x;e.node(t).x=n}else{if(arguments.length<3)return e.node(t).y;e.node(t).y=n}}function v(e,t,n,i){n.forEach(function(n,o){var r,a;n.forEach(function(n){var s=i[n];if(r){var l=h(t,r)+h(t,n);s-a<l&&console.log("Position phase: sep violation. Align: "+e+". Layer: "+o+". U: "+r+" V: "+n+". Actual sep: "+(s-a)+" Expected sep: "+l)}r=n,a=s})})}var m={nodeSep:50,edgeSep:10,universalSep:null,rankSep:30},y={};return y.nodeSep=i.propertyAccessor(y,m,"nodeSep"),y.edgeSep=i.propertyAccessor(y,m,"edgeSep"),y.universalSep=i.propertyAccessor(y,m,"universalSep"),y.rankSep=i.propertyAccessor(y,m,"rankSep"),y.debugLevel=i.propertyAccessor(y,m,"debugLevel"),y.run=function(e){e=e.filterNodes(i.filterNonSubgraphs(e));var r=i.ordering(e),a=t(e,r),h={};["u","d"].forEach(function(t){"d"===t&&r.reverse(),["l","r"].forEach(function(i){"r"===i&&c(r);var s=t+i,d=n(e,r,a,"u"===t?"predecessors":"successors");h[s]=o(e,r,d.pos,d.root,d.align),m.debugLevel>=3&&v(t+i,e,r,h[s]),"r"===i&&l(h[s]),"r"===i&&c(r)}),"d"===t&&r.reverse()}),s(e,r,h),e.eachNode(function(t){var n=[];for(var i in h){var o=h[i][t];f(i,e,t,o),n.push(o)}n.sort(function(e,t){return e-t}),p(e,t,(n[1]+n[2])/2)});var y=0,w="BT"===e.graph().rankDir||"RL"===e.graph().rankDir;r.forEach(function(t){var n=i.max(t.map(function(t){return u(e,t)}));y+=n/2,t.forEach(function(t){g(e,t,w?-y:y)}),y+=n/2+m.rankSep});var b=i.min(e.nodes().map(function(t){return p(e,t)-d(e,t)/2})),C=i.min(e.nodes().map(function(t){return g(e,t)-u(e,t)/2}));e.eachNode(function(t){p(e,t,p(e,t)-b),g(e,t,g(e,t)-C)})},y}},{"./util":17}],10:[function(e,t,n){function i(e){e.eachEdge(function(t,n,i,o){if(n===i){var a=r(e,t,n,i,o,0,!1),s=r(e,t,n,i,o,1,!0),l=r(e,t,n,i,o,2,!1);e.addEdge(null,a,n,{minLen:1,selfLoop:!0}),e.addEdge(null,a,s,{minLen:1,selfLoop:!0}),e.addEdge(null,n,l,{minLen:1,selfLoop:!0}),e.addEdge(null,s,l,{minLen:1,selfLoop:!0}),e.delEdge(t)}})}function o(e){e.eachEdge(function(t,n,i,o){if(n===i){var a=o.originalEdge,s=r(e,a.e,a.u,a.v,a.value,0,!0);e.addEdge(null,n,s,{minLen:1}),e.addEdge(null,s,i,{minLen:1}),e.delEdge(t)}})}function r(e,t,n,i,o,r,a){return e.addNode(null,{width:a?o.width:0,height:a?o.height:0,edge:{id:t,source:n,target:i,attrs:o},dummy:!0,index:r})}function a(e){e.eachEdge(function(t,n,i,o){e.node(n).rank>e.node(i).rank&&(e.delEdge(t),o.reversed=!0,e.addEdge(t,i,n,o))})}function s(e,t){var n=h(e);t&&(c.log(1,"Using network simplex for ranking"),f(e,n)),l(e)}function l(e){var t=c.min(e.nodes().map(function(t){return e.node(t).rank}));e.eachNode(function(e,n){n.rank-=t})}var c=e("./util"),d=e("./rank/acyclic"),u=e("./rank/initRank"),h=e("./rank/feasibleTree"),p=e("./rank/constraints"),f=e("./rank/simplex"),g=e("graphlib").alg.components,v=e("graphlib").filter;n.run=function(e,t){i(e),c.time("constraints.apply",p.apply)(e),o(e),c.time("acyclic",d)(e);var n=e.filterNodes(c.filterNonSubgraphs(e));u(n),g(n).forEach(function(e){s(n.filterNodes(v.nodesFromList(e)),t)}),c.time("constraints.relax",p.relax(e)),c.time("reorientEdges",a)(e)},n.restoreEdges=function(e){d.undo(e)}},{"./rank/acyclic":11,"./rank/constraints":12,"./rank/feasibleTree":13,"./rank/initRank":14,"./rank/simplex":16,"./util":17,graphlib:24}],11:[function(e,t,n){var i=e("../util");t.exports=function(e){function t(i){i in o||(o[i]=n[i]=!0,e.outEdges(i).forEach(function(o){var a,s=e.target(o);i===s?console.error('Warning: found self loop "'+o+'" for node "'+i+'"'):s in n?(a=e.edge(o),e.delEdge(o),a.reversed=!0,++r,e.addEdge(o,s,i,a)):t(s)}),delete n[i])}var n={},o={},r=0;return e.eachNode(function(e){t(e)}),i.log(2,"Acyclic Phase: reversed "+r+" edge(s)"),r},t.exports.undo=function(e){e.eachEdge(function(t,n,i,o){o.reversed&&(delete o.reversed,e.delEdge(t),e.addEdge(t,i,n,o))})}},{"../util":17}],12:[function(e,t,n){function i(e){return"min"===e||"max"===e||0===e.indexOf("same_")||(console.error("Unsupported rank type: "+e),!1)}function o(e,t,n,i){e.inEdges(t).forEach(function(t){var o,r=e.edge(t);o=r.originalEdge?r:{originalEdge:{e:t,u:e.source(t),v:e.target(t),value:r},minLen:e.edge(t).minLen},r.selfLoop&&(i=!1),i?(e.addEdge(null,n,e.source(t),o),o.reversed=!0):e.addEdge(null,e.source(t),n,o)})}function r(e,t,n,i){e.outEdges(t).forEach(function(t){var o,r=e.edge(t);o=r.originalEdge?r:{originalEdge:{e:t,u:e.source(t),v:e.target(t),value:r},minLen:e.edge(t).minLen},r.selfLoop&&(i=!1),i?(e.addEdge(null,e.target(t),n,o),o.reversed=!0):e.addEdge(null,n,e.target(t),o)})}function a(e,t,n){void 0!==n&&e.children(t).forEach(function(t){t===n||e.outEdges(n,t).length||e.node(t).dummy||e.addEdge(null,n,t,{minLen:0})})}function s(e,t,n){void 0!==n&&e.children(t).forEach(function(t){t===n||e.outEdges(t,n).length||e.node(t).dummy||e.addEdge(null,t,n,{minLen:0})})}n.apply=function(e){function t(n){var l={};e.children(n).forEach(function(a){if(e.children(a).length)t(a);else{var s=e.node(a),c=s.prefRank;if(void 0!==c){if(!i(c))return;c in l?l.prefRank.push(a):l.prefRank=[a];var d=l[c];void 0===d&&(d=l[c]=e.addNode(null,{originalNodes:[]}),e.parent(d,n)),o(e,a,d,"min"===c),r(e,a,d,"max"===c),e.node(d).originalNodes.push({u:a,value:s,parent:n}),e.delNode(a)}}}),a(e,n,l.min),s(e,n,l.max)}t(null)},n.relax=function(e){var t=[];e.eachEdge(function(e,n,i,o){var r=o.originalEdge;r&&t.push(r)}),e.eachNode(function(t,n){var i=n.originalNodes;i&&(i.forEach(function(t){t.value.rank=n.rank,e.addNode(t.u,t.value),e.parent(t.u,t.parent)}),e.delNode(t))}),t.forEach(function(t){e.addEdge(t.e,t.u,t.v,t.value)})}},{}],13:[function(e,t,n){function i(e,t,n){return e.node(n).rank-e.node(t).rank-a.max(e.outEdges(t,n).map(function(t){return e.edge(t).minLen}))}var o=e("cp-data").Set,r=e("graphlib").Digraph,a=e("../util");t.exports=function(e){function t(o){var r=!0;return e.predecessors(o).forEach(function(s){n.has(s)&&!i(e,s,o)&&(n.has(o)&&(a.addNode(o,{}),n.remove(o),a.graph({root:o})),a.addNode(s,{}),a.addEdge(null,s,o,{reversed:!0}),n.remove(s),t(s),r=!1)}),e.successors(o).forEach(function(s){n.has(s)&&!i(e,o,s)&&(n.has(o)&&(a.addNode(o,{}),n.remove(o),a.graph({root:o})),a.addNode(s,{}),a.addEdge(null,o,s,{}),n.remove(s),t(s),r=!1)}),r}var n=new o(e.nodes()),a=new r;if(1===n.size()){var s=e.nodes()[0];return a.addNode(s,{}),a.graph({root:s}),a}for(;n.size();){for(var l=a.order()?a.nodes():n.keys(),c=0,d=l.length;c<d&&t(l[c]);++c);n.size()&&function(){var t=Number.MAX_VALUE;n.keys().forEach(function(o){e.predecessors(o).forEach(function(r){if(!n.has(r)){var a=i(e,r,o);Math.abs(a)<Math.abs(t)&&(t=-a)}}),e.successors(o).forEach(function(r){if(!n.has(r)){var a=i(e,o,r);Math.abs(a)<Math.abs(t)&&(t=a)}})}),a.eachNode(function(n){e.node(n).rank-=t})}()}return a}},{"../util":17,"cp-data":19,graphlib:24}],14:[function(e,t,n){var i=e("../util"),o=e("graphlib").alg.topsort;t.exports=function(e){o(e).forEach(function(t){var n=e.inEdges(t);if(0!==n.length){var o=n.map(function(t){return e.node(e.source(t)).rank+e.edge(t).minLen});e.node(t).rank=i.max(o)}else e.node(t).rank=0})}},{"../util":17,graphlib:24}],15:[function(e,t,n){t.exports={slack:function(e,t,n,i){return Math.abs(e.node(t).rank-e.node(n).rank)-i}}},{}],16:[function(e,t,n){function i(e,t){function n(i){var o=t.successors(i);for(var a in o)n(o[a]);i!==t.graph().root&&r(e,t,i)}o(t),t.eachEdge(function(e,t,n,i){i.cutValue=0}),n(t.graph().root)}function o(e){function t(i){var o=e.successors(i),r=n;for(var a in o){var s=o[a];t(s),r=Math.min(r,e.node(s).low)}e.node(i).low=r,e.node(i).lim=n++}var n=0;t(e.graph().root)}function r(e,t,n){var i=t.inEdges(n)[0],o=[],r=t.outEdges(n);for(var s in r)o.push(t.target(r[s]));var l,c=0,d=0,u=0,h=0,p=0,f=e.outEdges(n);for(var g in f){var v=e.target(f[g]);for(l in o)a(t,v,o[l])&&d++;a(t,v,n)||h++}var m=e.inEdges(n);for(var y in m){var w=e.source(m[y]);for(l in o)a(t,w,o[l])&&u++;a(t,w,n)||p++}var b=0;for(l in o){var C=t.edge(r[l]).cutValue;t.edge(r[l]).reversed?b-=C:b+=C}t.edge(i).reversed?c-=b-d+u-h+p:c+=b-d+u-h+p,t.edge(i).cutValue=c}function a(e,t,n){return e.node(n).low<=e.node(t).lim&&e.node(t).lim<=e.node(n).lim}function s(e){var t=e.edges();for(var n in t){var i=t[n];if(e.edge(i).cutValue<0)return i}return null}function l(e,t,n){var i,o=t.source(n),r=t.target(n),s=t.node(r).lim<t.node(o).lim?r:o,l=!t.edge(n).reversed,c=Number.POSITIVE_INFINITY;if(l?e.eachEdge(function(o,r,l,d){if(o!==n&&a(t,r,s)&&!a(t,l,s)){var u=p.slack(e,r,l,d.minLen);u<c&&(c=u,i=o)}}):e.eachEdge(function(o,r,l,d){if(o!==n&&!a(t,r,s)&&a(t,l,s)){var u=p.slack(e,r,l,d.minLen);u<c&&(c=u,i=o)}}),void 0===i){var d=[],u=[];throw e.eachNode(function(e){a(t,e,s)?u.push(e):d.push(e)}),new Error("No edge found from outside of tree to inside")}return i}function c(e,t,n,o){function r(e){var n=t.inEdges(e);for(var i in n){var o=n[i],a=t.source(o),s=t.edge(o);r(a),t.delEdge(o),s.reversed=!s.reversed,t.addEdge(o,e,a,s)}}t.delEdge(n);var a=e.source(o),s=e.target(o);r(s);for(var l=a,c=t.inEdges(l);c.length>0;)l=t.source(c[0]),c=t.inEdges(l);t.graph().root=l,t.addEdge(null,a,s,{cutValue:0}),i(e,t),d(e,t)}function d(e,t){function n(i){t.successors(i).forEach(function(t){var o=u(e,i,t);e.node(t).rank=e.node(i).rank+o,n(t)})}n(t.graph().root)}function u(e,t,n){var i=e.outEdges(t,n);if(i.length>0)return h.max(i.map(function(t){return e.edge(t).minLen}));var o=e.inEdges(t,n);return o.length>0?-h.max(o.map(function(t){return e.edge(t).minLen})):void 0}var h=e("../util"),p=e("./rankUtil");t.exports=function(e,t){for(i(e,t);;){var n=s(t);if(null===n)break;c(e,t,n,l(e,t,n))}}},{"../util":17,"./rankUtil":15}],17:[function(e,t,n){function o(e,t){return function(){var n=(new Date).getTime();try{return t.apply(null,arguments)}finally{r(1,e+" time: "+((new Date).getTime()-n)+"ms")}}}function r(e){r.level>=e&&console.log.apply(console,Array.prototype.slice.call(arguments,1))}n.min=function(e){return Math.min.apply(Math,e)},n.max=function(e){return Math.max.apply(Math,e)},n.all=function(e,t){for(var n=0;n<e.length;++n)if(!t(e[n]))return!1;return!0},n.sum=function(e){return e.reduce(function(e,t){return e+t},0)},n.values=function(e){return Object.keys(e).map(function(t){return e[t]})},n.shuffle=function(e){for(i=e.length-1;i>0;--i){var t=Math.floor(Math.random()*(i+1)),n=e[t];e[t]=e[i],e[i]=n}},n.propertyAccessor=function(e,t,n,i){return function(o){return arguments.length?(t[n]=o,i&&i(o),e):t[n]}},n.ordering=function(e){var t=[];return e.eachNode(function(e,n){(t[n.rank]||(t[n.rank]=[]))[n.order]=e}),t},n.filterNonSubgraphs=function(e){return function(t){return 0===e.children(t).length}},o.enabled=!1,n.time=o,r.level=0,n.log=r},{}],18:[function(e,t,n){t.exports="0.4.5"},{}],19:[function(e,t,n){n.Set=e("./lib/Set"),n.PriorityQueue=e("./lib/PriorityQueue"),n.version=e("./lib/version")},{"./lib/PriorityQueue":20,"./lib/Set":21,"./lib/version":23}],20:[function(e,t,n){function i(){this._arr=[],this._keyIndices={}}t.exports=i,i.prototype.size=function(){return this._arr.length},i.prototype.keys=function(){return this._arr.map(function(e){return e.key})},i.prototype.has=function(e){return e in this._keyIndices},i.prototype.priority=function(e){var t=this._keyIndices[e];if(void 0!==t)return this._arr[t].priority},i.prototype.min=function(){if(0===this.size())throw new Error("Queue underflow");return this._arr[0].key},i.prototype.add=function(e,t){var n=this._keyIndices;if(!(e in n)){var i=this._arr,o=i.length;return n[e]=o,i.push({key:e,priority:t}),this._decrease(o),!0}return!1},i.prototype.removeMin=function(){this._swap(0,this._arr.length-1);var e=this._arr.pop();return delete this._keyIndices[e.key],this._heapify(0),e.key},i.prototype.decrease=function(e,t){var n=this._keyIndices[e];if(t>this._arr[n].priority)throw new Error("New priority is greater than current priority. Key: "+e+" Old: "+this._arr[n].priority+" New: "+t);this._arr[n].priority=t,this._decrease(n)},i.prototype._heapify=function(e){var t=this._arr,n=2*e,i=n+1,o=e;n<t.length&&(o=t[n].priority<t[o].priority?n:o,i<t.length&&(o=t[i].priority<t[o].priority?i:o),o!==e&&(this._swap(e,o),this._heapify(o)))},i.prototype._decrease=function(e){for(var t,n=this._arr,i=n[e].priority;0!==e&&(t=e>>1,!(n[t].priority<i));)this._swap(e,t),e=t},i.prototype._swap=function(e,t){var n=this._arr,i=this._keyIndices,o=n[e],r=n[t];n[e]=r,n[t]=o,i[r.key]=e,i[o.key]=t}},{}],21:[function(e,t,n){function i(e){if(this._size=0,this._keys={},e)for(var t=0,n=e.length;t<n;++t)this.add(e[t])}function o(e){var t,n=Object.keys(e),i=n.length,o=new Array(i);for(t=0;t<i;++t)o[t]=e[n[t]];return o}var r=e("./util");t.exports=i,i.intersect=function(e){if(0===e.length)return new i;for(var t=new i(r.isArray(e[0])?e[0]:e[0].keys()),n=1,o=e.length;n<o;++n)for(var a=t.keys(),s=r.isArray(e[n])?new i(e[n]):e[n],l=0,c=a.length;l<c;++l){var d=a[l];s.has(d)||t.remove(d)}return t},i.union=function(e){for(var t=r.reduce(e,function(e,t){return e+(t.size?t.size():t.length)},0),n=new Array(t),o=0,a=0,s=e.length;a<s;++a)for(var l=e[a],c=r.isArray(l)?l:l.keys(),d=0,u=c.length;d<u;++d)n[o++]=c[d];return new i(n)},i.prototype.size=function(){return this._size},i.prototype.keys=function(){return o(this._keys)},i.prototype.has=function(e){return e in this._keys},i.prototype.add=function(e){return!(e in this._keys)&&(this._keys[e]=e,++this._size,!0)},i.prototype.remove=function(e){return e in this._keys&&(delete this._keys[e],--this._size,!0)}},{"./util":22}],22:[function(e,t,n){Array.isArray?n.isArray=Array.isArray:n.isArray=function(e){return"[object Array]"===Object.prototype.toString.call(e)},"function"!=typeof Array.prototype.reduce?n.reduce=function(e,t,n){"use strict";if(null===e||void 0===e)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof t)throw new TypeError(t+" is not a function");var i,o,r=e.length>>>0,a=!1;for(1<arguments.length&&(o=n,a=!0),i=0;r>i;++i)e.hasOwnProperty(i)&&(a?o=t(o,e[i],i,e):(o=e[i],a=!0));if(!a)throw new TypeError("Reduce of empty array with no initial value");return o}:n.reduce=function(e,t,n){return e.reduce(t,n)}},{}],23:[function(e,t,n){t.exports="1.1.3"},{}],24:[function(e,t,n){n.Graph=e("./lib/Graph"),n.Digraph=e("./lib/Digraph"),n.CGraph=e("./lib/CGraph"),n.CDigraph=e("./lib/CDigraph"),e("./lib/graph-converters"),n.alg={isAcyclic:e("./lib/alg/isAcyclic"),components:e("./lib/alg/components"),dijkstra:e("./lib/alg/dijkstra"),dijkstraAll:e("./lib/alg/dijkstraAll"),findCycles:e("./lib/alg/findCycles"),floydWarshall:e("./lib/alg/floydWarshall"),postorder:e("./lib/alg/postorder"),preorder:e("./lib/alg/preorder"),prim:e("./lib/alg/prim"),tarjan:e("./lib/alg/tarjan"),topsort:e("./lib/alg/topsort")},n.converter={json:e("./lib/converter/json.js")};var i=e("./lib/filter");n.filter={all:i.all,nodesFromList:i.nodesFromList},n.version=e("./lib/version")},{"./lib/CDigraph":26,"./lib/CGraph":27,"./lib/Digraph":28,"./lib/Graph":29,"./lib/alg/components":30,"./lib/alg/dijkstra":31,"./lib/alg/dijkstraAll":32,"./lib/alg/findCycles":33,"./lib/alg/floydWarshall":34,"./lib/alg/isAcyclic":35,"./lib/alg/postorder":36,"./lib/alg/preorder":37,"./lib/alg/prim":38,"./lib/alg/tarjan":39,"./lib/alg/topsort":40,"./lib/converter/json.js":42,"./lib/filter":43,"./lib/graph-converters":44,"./lib/version":46}],25:[function(e,t,n){function i(){this._value=void 0,this._nodes={},this._edges={},this._nextId=0}function o(e,t,n){(e[t]||(e[t]=new a)).add(n)}function r(e,t,n){var i=e[t];i.remove(n),0===i.size()&&delete e[t]}var a=e("cp-data").Set;t.exports=i,i.prototype.order=function(){return Object.keys(this._nodes).length},i.prototype.size=function(){return Object.keys(this._edges).length},i.prototype.graph=function(e){if(0===arguments.length)return this._value;this._value=e},i.prototype.hasNode=function(e){return e in this._nodes},i.prototype.node=function(e,t){var n=this._strictGetNode(e);if(1===arguments.length)return n.value;n.value=t},i.prototype.nodes=function(){var e=[];return this.eachNode(function(t){e.push(t)}),e},i.prototype.eachNode=function(e){for(var t in this._nodes){var n=this._nodes[t];e(n.id,n.value)}},i.prototype.hasEdge=function(e){return e in this._edges},i.prototype.edge=function(e,t){var n=this._strictGetEdge(e);if(1===arguments.length)return n.value;n.value=t},i.prototype.edges=function(){var e=[];return this.eachEdge(function(t){e.push(t)}),e},i.prototype.eachEdge=function(e){for(var t in this._edges){var n=this._edges[t];e(n.id,n.u,n.v,n.value)}},i.prototype.incidentNodes=function(e){var t=this._strictGetEdge(e);return[t.u,t.v]},i.prototype.addNode=function(e,t){if(void 0===e||null===e)do{e="_"+ ++this._nextId}while(this.hasNode(e));else if(this.hasNode(e))throw new Error("Graph already has node '"+e+"'");return this._nodes[e]={id:e,value:t},e},i.prototype.delNode=function(e){this._strictGetNode(e),this.incidentEdges(e).forEach(function(e){this.delEdge(e)},this),delete this._nodes[e]},i.prototype._addEdge=function(e,t,n,i,r,a){if(this._strictGetNode(t),this._strictGetNode(n),void 0===e||null===e)do{e="_"+ ++this._nextId}while(this.hasEdge(e));else if(this.hasEdge(e))throw new Error("Graph already has edge '"+e+"'");return this._edges[e]={id:e,u:t,v:n,value:i},o(r[n],t,e),o(a[t],n,e),e},i.prototype._delEdge=function(e,t,n){var i=this._strictGetEdge(e);r(t[i.v],i.u,e),r(n[i.u],i.v,e),delete this._edges[e]},i.prototype.copy=function(){var e=new this.constructor;return e.graph(this.graph()),this.eachNode(function(t,n){e.addNode(t,n)}),this.eachEdge(function(t,n,i,o){e.addEdge(t,n,i,o)}),e._nextId=this._nextId,e},i.prototype.filterNodes=function(e){var t=new this.constructor;return t.graph(this.graph()),this.eachNode(function(n,i){e(n)&&t.addNode(n,i)}),this.eachEdge(function(e,n,i,o){t.hasNode(n)&&t.hasNode(i)&&t.addEdge(e,n,i,o)}),t},i.prototype._strictGetNode=function(e){var t=this._nodes[e];if(void 0===t)throw new Error("Node '"+e+"' is not in graph");return t},i.prototype._strictGetEdge=function(e){var t=this._edges[e];if(void 0===t)throw new Error("Edge '"+e+"' is not in graph");return t}},{"cp-data":19}],26:[function(e,t,n){var i=e("./Digraph"),o=e("./compoundify")(i);t.exports=o,o.fromDigraph=function(e){var t=new o,n=e.graph();return void 0!==n&&t.graph(n),e.eachNode(function(e,n){void 0===n?t.addNode(e):t.addNode(e,n)}),e.eachEdge(function(e,n,i,o){void 0===o?t.addEdge(null,n,i):t.addEdge(null,n,i,o)}),t},o.prototype.toString=function(){return"CDigraph "+JSON.stringify(this,null,2)}},{"./Digraph":28,"./compoundify":41}],27:[function(e,t,n){var i=e("./Graph"),o=e("./compoundify")(i);t.exports=o,o.fromGraph=function(e){var t=new o,n=e.graph();return void 0!==n&&t.graph(n),e.eachNode(function(e,n){void 0===n?t.addNode(e):t.addNode(e,n)}),e.eachEdge(function(e,n,i,o){void 0===o?t.addEdge(null,n,i):t.addEdge(null,n,i,o)}),t},o.prototype.toString=function(){return"CGraph "+JSON.stringify(this,null,2)}},{"./Graph":29,"./compoundify":41}],28:[function(e,t,n){function i(){r.call(this),this._inEdges={},this._outEdges={}}var o=e("./util"),r=e("./BaseGraph"),a=e("cp-data").Set;t.exports=i,(i.prototype=new r).constructor=i,i.prototype.isDirected=function(){return!0},i.prototype.successors=function(e){return this._strictGetNode(e),Object.keys(this._outEdges[e]).map(function(e){return this._nodes[e].id},this)},i.prototype.predecessors=function(e){return this._strictGetNode(e),Object.keys(this._inEdges[e]).map(function(e){return this._nodes[e].id},this)},i.prototype.neighbors=function(e){return a.union([this.successors(e),this.predecessors(e)]).keys()},i.prototype.sources=function(){var e=this;return this._filterNodes(function(t){return 0===e.inEdges(t).length})},i.prototype.sinks=function(){var e=this;return this._filterNodes(function(t){return 0===e.outEdges(t).length})},i.prototype.source=function(e){return this._strictGetEdge(e).u},i.prototype.target=function(e){return this._strictGetEdge(e).v},i.prototype.inEdges=function(e,t){this._strictGetNode(e);var n=a.union(o.values(this._inEdges[e])).keys();return arguments.length>1&&(this._strictGetNode(t),n=n.filter(function(e){return this.source(e)===t},this)),n},i.prototype.outEdges=function(e,t){this._strictGetNode(e);var n=a.union(o.values(this._outEdges[e])).keys();return arguments.length>1&&(this._strictGetNode(t),n=n.filter(function(e){return this.target(e)===t},this)),n},i.prototype.incidentEdges=function(e,t){return arguments.length>1?a.union([this.outEdges(e,t),this.outEdges(t,e)]).keys():a.union([this.inEdges(e),this.outEdges(e)]).keys()},i.prototype.toString=function(){return"Digraph "+JSON.stringify(this,null,2)},i.prototype.addNode=function(e,t){return e=r.prototype.addNode.call(this,e,t),this._inEdges[e]={},this._outEdges[e]={},e},i.prototype.delNode=function(e){r.prototype.delNode.call(this,e),delete this._inEdges[e],delete this._outEdges[e]},i.prototype.addEdge=function(e,t,n,i){return r.prototype._addEdge.call(this,e,t,n,i,this._inEdges,this._outEdges)},i.prototype.delEdge=function(e){r.prototype._delEdge.call(this,e,this._inEdges,this._outEdges)},i.prototype._filterNodes=function(e){var t=[];return this.eachNode(function(n){e(n)&&t.push(n)}),t}},{"./BaseGraph":25,"./util":45,"cp-data":19}],29:[function(e,t,n){function i(){r.call(this),this._incidentEdges={}}var o=e("./util"),r=e("./BaseGraph"),a=e("cp-data").Set;t.exports=i,(i.prototype=new r).constructor=i,i.prototype.isDirected=function(){return!1},i.prototype.neighbors=function(e){return this._strictGetNode(e),Object.keys(this._incidentEdges[e]).map(function(e){return this._nodes[e].id},this)},i.prototype.incidentEdges=function(e,t){return this._strictGetNode(e),arguments.length>1?(this._strictGetNode(t),t in this._incidentEdges[e]?this._incidentEdges[e][t].keys():[]):a.union(o.values(this._incidentEdges[e])).keys()},i.prototype.toString=function(){return"Graph "+JSON.stringify(this,null,2)},i.prototype.addNode=function(e,t){return e=r.prototype.addNode.call(this,e,t),this._incidentEdges[e]={},e},i.prototype.delNode=function(e){r.prototype.delNode.call(this,e),delete this._incidentEdges[e]},i.prototype.addEdge=function(e,t,n,i){return r.prototype._addEdge.call(this,e,t,n,i,this._incidentEdges,this._incidentEdges)},i.prototype.delEdge=function(e){r.prototype._delEdge.call(this,e,this._incidentEdges,this._incidentEdges)}},{"./BaseGraph":25,"./util":45,"cp-data":19}],30:[function(e,t,n){var i=e("cp-data").Set;t.exports=function(e){function t(n,i){o.has(n)||(o.add(n),i.push(n),e.neighbors(n).forEach(function(e){t(e,i)}))}var n=[],o=new i;return e.nodes().forEach(function(e){var i=[];t(e,i),i.length>0&&n.push(i)}),n}},{"cp-data":19}],31:[function(e,t,n){var i=e("cp-data").PriorityQueue;t.exports=function(e,t,n,o){var r={},a=new i;n=n||function(){return 1},o=o||(e.isDirected()?function(t){return e.outEdges(t)}:function(t){return e.incidentEdges(t)}),e.eachNode(function(e){var n=e===t?0:Number.POSITIVE_INFINITY;r[e]={distance:n},a.add(e,n)});for(var s,l;a.size()>0&&(s=a.removeMin(),(l=r[s]).distance!==Number.POSITIVE_INFINITY);)o(s).forEach(function(t){var i=e.incidentNodes(t),o=i[0]!==s?i[0]:i[1],c=r[o],d=n(t),u=l.distance+d;if(d<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+t+" Weight: "+d);u<c.distance&&(c.distance=u,c.predecessor=s,a.decrease(o,u))});return r}},{"cp-data":19}],32:[function(e,t,n){var i=e("./dijkstra");t.exports=function(e,t,n){var o={};return e.eachNode(function(r){o[r]=i(e,r,t,n)}),o}},{"./dijkstra":31}],33:[function(e,t,n){var i=e("./tarjan");t.exports=function(e){return i(e).filter(function(e){return e.length>1})}},{"./tarjan":39}],34:[function(e,t,n){t.exports=function(e,t,n){var i={},o=e.nodes();return t=t||function(){return 1},n=n||(e.isDirected()?function(t){return e.outEdges(t)}:function(t){return e.incidentEdges(t)}),o.forEach(function(r){i[r]={},i[r][r]={distance:0},o.forEach(function(e){r!==e&&(i[r][e]={distance:Number.POSITIVE_INFINITY})}),n(r).forEach(function(n){var o=e.incidentNodes(n),a=o[0]!==r?o[0]:o[1],s=t(n);s<i[r][a].distance&&(i[r][a]={distance:s,predecessor:r})})}),o.forEach(function(e){var t=i[e];o.forEach(function(n){var r=i[n];o.forEach(function(n){var i=r[e],o=t[n],a=r[n],s=i.distance+o.distance;s<a.distance&&(a.distance=s,a.predecessor=o.predecessor)})})}),i}},{}],35:[function(e,t,n){var i=e("./topsort");t.exports=function(e){try{i(e)}catch(e){if(e instanceof i.CycleException)return!1;throw e}return!0}},{"./topsort":40}],36:[function(e,t,n){var i=e("cp-data").Set;t.exports=function(e,t,n){function o(t,i){if(r.has(t))throw new Error("The input graph is not a tree: "+e);r.add(t),e.neighbors(t).forEach(function(e){e!==i&&o(e,t)}),n(t)}var r=new i;if(e.isDirected())throw new Error("This function only works for undirected graphs");o(t)}},{"cp-data":19}],37:[function(e,t,n){var i=e("cp-data").Set;t.exports=function(e,t,n){function o(t,i){if(r.has(t))throw new Error("The input graph is not a tree: "+e);r.add(t),n(t),e.neighbors(t).forEach(function(e){e!==i&&o(e,t)})}var r=new i;if(e.isDirected())throw new Error("This function only works for undirected graphs");o(t)}},{"cp-data":19}],38:[function(e,t,n){var i=e("../Graph"),o=e("cp-data").PriorityQueue;t.exports=function(e,t){var n,r=new i,a={},s=new o;if(0===e.order())return r;e.eachNode(function(e){s.add(e,Number.POSITIVE_INFINITY),r.addNode(e)}),s.decrease(e.nodes()[0],0);for(var l=!1;s.size()>0;){if((n=s.removeMin())in a)r.addEdge(null,n,a[n]);else{if(l)throw new Error("Input graph is not connected: "+e);l=!0}e.incidentEdges(n).forEach(function(i){var o=e.incidentNodes(i),r=o[0]!==n?o[0]:o[1],l=s.priority(r);if(void 0!==l){var c=t(i);c<l&&(a[r]=n,s.decrease(r,c))}})}return r}},{"../Graph":29,"cp-data":19}],39:[function(e,t,n){t.exports=function(e){function t(a){var s=o[a]={onStack:!0,lowlink:n,index:n++};if(i.push(a),e.successors(a).forEach(function(e){e in o?o[e].onStack&&(s.lowlink=Math.min(s.lowlink,o[e].index)):(t(e),s.lowlink=Math.min(s.lowlink,o[e].lowlink))}),s.lowlink===s.index){var l,c=[];do{l=i.pop(),o[l].onStack=!1,c.push(l)}while(a!==l);r.push(c)}}if(!e.isDirected())throw new Error("tarjan can only be applied to a directed graph. Bad input: "+e);var n=0,i=[],o={},r=[];return e.nodes().forEach(function(e){e in o||t(e)}),r}},{}],40:[function(e,t,n){function i(e){function t(a){if(a in i)throw new o;a in n||(i[a]=!0,n[a]=!0,e.predecessors(a).forEach(function(e){t(e)}),delete i[a],r.push(a))}if(!e.isDirected())throw new Error("topsort can only be applied to a directed graph. Bad input: "+e);var n={},i={},r=[],a=e.sinks();if(0!==e.order()&&0===a.length)throw new o;return e.sinks().forEach(function(e){t(e)}),r}function o(){}t.exports=i,i.CycleException=o,o.prototype.toString=function(){return"Graph has at least one cycle"}},{}],41:[function(e,t,n){var i=e("cp-data").Set;t.exports=function(e){function t(){e.call(this),this._parents={},this._children={},this._children[null]=new i}return t.prototype=new e,t.prototype.constructor=t,t.prototype.parent=function(e,t){if(this._strictGetNode(e),arguments.length<2)return this._parents[e];if(e===t)throw new Error("Cannot make "+e+" a parent of itself");null!==t&&this._strictGetNode(t),this._children[this._parents[e]].remove(e),this._parents[e]=t,this._children[t].add(e)},t.prototype.children=function(e){return null!==e&&this._strictGetNode(e),this._children[e].keys()},t.prototype.addNode=function(t,n){return t=e.prototype.addNode.call(this,t,n),this._parents[t]=null,this._children[t]=new i,this._children[null].add(t),t},t.prototype.delNode=function(t){var n=this.parent(t);return this._children[t].keys().forEach(function(e){this.parent(e,n)},this),this._children[n].remove(t),delete this._parents[t],delete this._children[t],e.prototype.delNode.call(this,t)},t.prototype.copy=function(){var t=e.prototype.copy.call(this);return this.nodes().forEach(function(e){t.parent(e,this.parent(e))},this),t},t.prototype.filterNodes=function(t){function n(e){var t=i.parent(e);return null===t||o.hasNode(t)?(r[e]=t,t):t in r?r[t]:n(t)}var i=this,o=e.prototype.filterNodes.call(this,t),r={};return o.eachNode(function(e){o.parent(e,n(e))}),o},t}},{"cp-data":19}],42:[function(e,t,n){function i(e){return Object.prototype.toString.call(e).slice(8,-1)}var o=e("../Graph"),r=e("../Digraph"),a=e("../CGraph"),s=e("../CDigraph");n.decode=function(e,t,n){if(n=n||r,"Array"!==i(e))throw new Error("nodes is not an Array");if("Array"!==i(t))throw new Error("edges is not an Array");if("string"==typeof n)switch(n){case"graph":n=o;break;case"digraph":n=r;break;case"cgraph":n=a;break;case"cdigraph":n=s;break;default:throw new Error("Unrecognized graph type: "+n)}var l=new n;return e.forEach(function(e){l.addNode(e.id,e.value)}),l.parent&&e.forEach(function(e){e.children&&e.children.forEach(function(t){l.parent(t,e.id)})}),t.forEach(function(e){l.addEdge(e.id,e.u,e.v,e.value)}),l},n.encode=function(e){var t=[],n=[];e.eachNode(function(n,i){var o={id:n,value:i};if(e.children){var r=e.children(n);r.length&&(o.children=r)}t.push(o)}),e.eachEdge(function(e,t,i,o){n.push({id:e,u:t,v:i,value:o})});var i;if(e instanceof s)i="cdigraph";else if(e instanceof a)i="cgraph";else if(e instanceof r)i="digraph";else{if(!(e instanceof o))throw new Error("Couldn't determine type of graph: "+e);i="graph"}return{nodes:t,edges:n,type:i}}},{"../CDigraph":26,"../CGraph":27,"../Digraph":28,"../Graph":29}],43:[function(e,t,n){var i=e("cp-data").Set;n.all=function(){return function(){return!0}},n.nodesFromList=function(e){var t=new i(e);return function(e){return t.has(e)}}},{"cp-data":19}],44:[function(e,t,n){var i=e("./Graph"),o=e("./Digraph");i.prototype.toDigraph=i.prototype.asDirected=function(){var e=new o;return this.eachNode(function(t,n){e.addNode(t,n)}),this.eachEdge(function(t,n,i,o){e.addEdge(null,n,i,o),e.addEdge(null,i,n,o)}),e},o.prototype.toGraph=o.prototype.asUndirected=function(){var e=new i;return this.eachNode(function(t,n){e.addNode(t,n)}),this.eachEdge(function(t,n,i,o){e.addEdge(t,n,i,o)}),e}},{"./Digraph":28,"./Graph":29}],45:[function(e,t,n){n.values=function(e){var t,n=Object.keys(e),i=n.length,o=new Array(i);for(t=0;t<i;++t)o[t]=e[n[t]];return o}},{}],46:[function(e,t,n){t.exports="0.7.4"},{}]},{},[1]);var Handsontable=function(e,t){t=t||{};var n=new Handsontable.Core(e,t);return n.init(),n};Handsontable.plugins={},function(e,t){"use strict";function n(){this.refCounter=0,this.init()}function i(e){var n=t.eventManager(e),i=function(e,t,n,i){i.setCellMeta(e,t,"comment",n),i.render()},o=function(e,t,n){i(e.from.row,e.from.col,t,n)},r=function(){var e=d();e.style.display="none",e.value=""},a=function(i){n.addEventListener(document,"mousedown",t.helper.proxy(function(t){if(n.removeEventListener(document,"mouseover"),"htCommentTextArea"!=t.target.className&&-1==t.target.innerHTML.indexOf("Comment")){var a=document.querySelector(".htCommentTextArea").value;a.trim().length>1&&o(i,a,e),s(),r()}}))},s=function(){n.removeEventListener(document,"mousedown"),n.addEventListener(document,"mousedown",t.helper.proxy(u))},l=function(n,i){var o=e.view.wt.wtTable.getCell(n.from),r=t.Dom.offset(o),s=e.getColWidth(n.from.col);i.style.position="absolute",i.style.left=r.left+s+"px",i.style.top=r.top+"px",i.style.zIndex=2,a(n)},d=function(e){var n=document.querySelector(".htComments");if(!n){n=document.createElement("DIV");var i=document.createElement("TEXTAREA");t.Dom.addClass(i,"htCommentTextArea"),n.appendChild(i),t.Dom.addClass(n,"htComments"),document.getElementsByTagName("body")[0].appendChild(n)}return e=e||"",document.querySelector(".htCommentTextArea").value=e,n},u=function(n){if(-1!=n.target.className.indexOf("htCommentCell")){s();var i=e.view.wt.wtTable.getCoords(n.target),o={from:new c(i.row,i.col)};t.Comments.showComment(o)}else"htCommentTextArea"!=n.target.className&&r()};return{init:function(){n.addEventListener(document,"mouseover",t.helper.proxy(u))},showComment:function(t){var n=e.getCellMeta(t.from.row,t.from.col),i="";n.comment&&(i=n.comment);var o=d(i);o.style.display="block",l(t,o)},removeComment:function(t,n){e.removeCellMeta(t,n,"comment"),e.render()},checkSelectionCommentsConsistency:function(){var t=!1,n=e.getSelectedRange().from;return e.getCellMeta(n.row,n.col).comment&&(t=!0),t}}}function o(){this.boundaries=null,this.callback=null}function r(){var e=[];return e.getInfo=function(e,t){for(var n=0,i=this.length;i>n;n++)if(this[n].row<=e&&this[n].row+this[n].rowspan-1>=e&&this[n].col<=t&&this[n].col+this[n].colspan-1>=t)return this[n]},e.setInfo=function(e){for(var t=0,n=this.length;n>t;t++)if(this[t].row===e.row&&this[t].col===e.col)return void(this[t]=e);this.push(e)},e.removeInfo=function(e,t){for(var n=0,i=this.length;i>n;n++)if(this[n].row===e&&this[n].col===t){this.splice(n,1);break}},e}function a(e){if(this.mergedCellInfoCollection=new r,Array.isArray(e))for(var t=0,n=e.length;n>t;t++)this.mergedCellInfoCollection.setInfo(e[t])}function s(){}function l(e,n){var i;if(n){var o=t.eventManager(e);this.instance=e,this.settings=n,this.main=document.createElement("div"),(i=this.main.style).position="absolute",i.top=0,i.left=0;for(var r=["top","left","bottom","right","corner"],a=0;5>a;a++){var s=r[a],l=document.createElement("DIV");l.className="wtBorder "+(this.settings.className||""),this.settings[s]&&this.settings[s].hide&&(l.className+=" hidden"),(i=l.style).backgroundColor=this.settings[s]&&this.settings[s].color?this.settings[s].color:n.border.color,i.height=this.settings[s]&&this.settings[s].width?this.settings[s].width+"px":n.border.width+"px",i.width=this.settings[s]&&this.settings[s].width?this.settings[s].width+"px":n.border.width+"px",this.main.appendChild(l)}this.top=this.main.childNodes[0],this.left=this.main.childNodes[1],this.bottom=this.main.childNodes[2],this.right=this.main.childNodes[3],this.topStyle=this.top.style,this.leftStyle=this.left.style,this.bottomStyle=this.bottom.style,this.rightStyle=this.right.style,this.cornerDefaultStyle={width:"5px",height:"5px",borderWidth:"2px",borderStyle:"solid",borderColor:"#FFF"},this.corner=this.main.childNodes[4],this.corner.className+=" corner",this.cornerStyle=this.corner.style,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.height=this.cornerDefaultStyle.height,this.cornerStyle.border=[this.cornerDefaultStyle.borderWidth,this.cornerDefaultStyle.borderStyle,this.cornerDefaultStyle.borderColor].join(" "),t.mobileBrowser&&function(){this.selectionHandles={topLeft:document.createElement("DIV"),topLeftHitArea:document.createElement("DIV"),bottomRight:document.createElement("DIV"),bottomRightHitArea:document.createElement("DIV")};this.selectionHandles.topLeft.className="topLeftSelectionHandle",this.selectionHandles.topLeftHitArea.className="topLeftSelectionHandle-HitArea",this.selectionHandles.bottomRight.className="bottomRightSelectionHandle",this.selectionHandles.bottomRightHitArea.className="bottomRightSelectionHandle-HitArea",this.selectionHandles.styles={topLeft:this.selectionHandles.topLeft.style,topLeftHitArea:this.selectionHandles.topLeftHitArea.style,bottomRight:this.selectionHandles.bottomRight.style,bottomRightHitArea:this.selectionHandles.bottomRightHitArea.style};var e={position:"absolute",height:"40px",width:"40px","border-radius":parseInt(40/1.5,10)+"px"};for(var t in e)e.hasOwnProperty(t)&&(this.selectionHandles.styles.bottomRightHitArea[t]=e[t],this.selectionHandles.styles.topLeftHitArea[t]=e[t]);var n={position:"absolute",height:"10px",width:"10px","border-radius":parseInt(10/1.5,10)+"px",background:"#F5F5FF",border:"1px solid #4285c8"};for(var t in n)n.hasOwnProperty(t)&&(this.selectionHandles.styles.bottomRight[t]=n[t],this.selectionHandles.styles.topLeft[t]=n[t]);this.main.appendChild(this.selectionHandles.topLeft),this.main.appendChild(this.selectionHandles.bottomRight),this.main.appendChild(this.selectionHandles.topLeftHitArea),this.main.appendChild(this.selectionHandles.bottomRightHitArea)}.call(this),this.disappear(),e.wtTable.bordersHolder||(e.wtTable.bordersHolder=document.createElement("div"),e.wtTable.bordersHolder.className="htBorders",e.wtTable.hider.appendChild(e.wtTable.bordersHolder)),e.wtTable.bordersHolder.insertBefore(this.main,e.wtTable.bordersHolder.firstChild);var c=!1;o.addEventListener(document.body,"mousedown",function(){c=!0}),o.addEventListener(document.body,"mouseup",function(){c=!1});for(var d=0,u=this.main.childNodes.length;u>d;d++)o.addEventListener(this.main.childNodes[d],"mouseenter",function(t){if(c&&e.getSetting("hideBorderOnMouseDownOver")){t.preventDefault(),t.stopImmediatePropagation();var n=this.getBoundingClientRect();this.style.display="none";var i=function(e){return e.clientY<Math.floor(n.top)||(e.clientY>Math.ceil(n.top+n.height)||(e.clientX<Math.floor(n.left)||(e.clientX>Math.ceil(n.left+n.width)||void 0)))},r=function(e){i(e)&&(o.removeEventListener(document.body,"mousemove",r),this.style.display="block")};o.addEventListener(document.body,"mousemove",r)}})}}function c(e,t){void 0!==e&&void 0!==t?(this.row=e,this.col=t):(this.row=null,this.col=null)}function d(e,t,n){this.highlight=e,this.from=t,this.to=n}function u(e,t,n){this.offset=e,this.total=t,this.countTH=n}function h(e,t,n,i){var o,r=0;for(this.instance=e,this.containerSizeFn=t,this.cellSizesSum=0,this.cellSizes=[],this.cellStretch=[],this.cellCount=0,this.visibleCellCount=0,this.remainingSize=0,this.strategy=i;void 0!==(o=n(r));)this.cellSizesSum<this.getContainerSize()&&this.visibleCellCount++,this.cellSizes.push(o),this.cellSizesSum+=o,this.cellCount++,r++;var a=this.getContainerSize();this.remainingSize=this.cellSizesSum-a}function p(e){var n=[];if(this.guid="wt_"+v(),e.cloneSource?(this.cloneSource=e.cloneSource,this.cloneOverlay=e.cloneOverlay,this.wtSettings=e.cloneSource.wtSettings,this.wtTable=new S(this,e.table),this.wtScroll=new y(this),this.wtViewport=e.cloneSource.wtViewport,this.wtEvent=new g(this),this.selections=this.cloneSource.selections):(this.wtSettings=new _(this,e),this.wtTable=new S(this,e.table),this.wtScroll=new y(this),this.wtViewport=new T(this),this.wtEvent=new g(this),this.selections=this.getSetting("selections"),this.wtScrollbars=new x(this)),this.wtTable.THEAD.childNodes.length&&this.wtTable.THEAD.childNodes[0].childNodes.length){for(var i=0,o=this.wtTable.THEAD.childNodes[0].childNodes.length;o>i;i++)n.push(this.wtTable.THEAD.childNodes[0].childNodes[i].innerHTML);this.getSetting("columnHeaders").length||this.update("columnHeaders",[function(e,i){t.Dom.fastInnerText(i,n[e])}])}this.drawn=!1,this.drawInterrupted=!1}function f(e){this.instance=e,this.init(),this.clone=this.makeClone("debug"),this.clone.wtTable.holder.style.opacity=.4,this.clone.wtTable.holder.style.textShadow="0 0 2px #ff0000",this.lastTimeout=null,t.Dom.addClass(this.clone.wtTable.holder.parentNode,"wtDebugVisible")}function g(n){var i=this,o=t.eventManager(n);this.instance=n;var r=[null,null];this.dblClickTimeout=[null,null];var a,s=function(e){var n=i.parentCell(e.target);t.Dom.hasClass(e.target,"corner")?i.instance.getSetting("onCellCornerMouseDown",e,e.target):n.TD&&i.instance.hasSetting("onCellMouseDown")&&i.instance.getSetting("onCellMouseDown",e,n.coords,n.TD,i.instance),2!==e.button&&n.TD&&(r[0]=n.TD,clearTimeout(i.dblClickTimeout[0]),i.dblClickTimeout[0]=setTimeout(function(){r[0]=null},1e3))},l=function(){i.instance.touchMoving=!0},c=function(e){o.addEventListener(this,"touchmove",l),i.checkIfTouchMove=setTimeout(function(){return!0===i.instance.touchMoving?(i.instance.touchMoving=void 0,void o.removeEventListener("touchmove",l,!1)):void s(e)},30)},d=function(e){if(2!==e.button){var n=i.parentCell(e.target);n.TD===r[0]&&n.TD===r[1]?(t.Dom.hasClass(e.target,"corner")?i.instance.getSetting("onCellCornerDblClick",e,n.coords,n.TD,i.instance):i.instance.getSetting("onCellDblClick",e,n.coords,n.TD,i.instance),r[0]=null,r[1]=null):n.TD===r[0]&&(r[1]=n.TD,clearTimeout(i.dblClickTimeout[1]),i.dblClickTimeout[1]=setTimeout(function(){r[1]=null},500))}},u=function(e){clearTimeout(void 0),e.preventDefault(),d(e)};if(o.addEventListener(this.instance.wtTable.holder,"mousedown",s),o.addEventListener(this.instance.wtTable.TABLE,"mouseover",function(e){if(i.instance.hasSetting("onCellMouseOver")){var n=i.instance.wtTable.TABLE,o=t.Dom.closest(e.target,["TD","TH"],n);o&&o!==a&&t.Dom.isChildOf(o,n)&&(a=o,i.instance.getSetting("onCellMouseOver",e,i.instance.wtTable.getCoords(o),o,i.instance))}}),o.addEventListener(this.instance.wtTable.holder,"mouseup",d),this.instance.wtTable.holder.parentNode.parentNode&&t.mobileBrowser){var h="."+this.instance.wtTable.holder.parentNode.className.split(" ").join(".");o.addEventListener(this.instance.wtTable.holder.parentNode.parentNode,"touchstart",function(e){i.instance.touchApplied=!0,t.Dom.isChildOf(e.target,h)&&c.call(e.target,e)}),o.addEventListener(this.instance.wtTable.holder.parentNode.parentNode,"touchend",function(e){i.instance.touchApplied=!1,t.Dom.isChildOf(e.target,h)&&u.call(e.target,e)}),i.instance.momentumScrolling||(i.instance.momentumScrolling={}),o.addEventListener(this.instance.wtTable.holder.parentNode.parentNode,"scroll",function(){clearTimeout(i.instance.momentumScrolling._timeout),i.instance.momentumScrolling.ongoing||i.instance.getSetting("onBeforeTouchScroll"),i.instance.momentumScrolling.ongoing=!0,i.instance.momentumScrolling._timeout=setTimeout(function(){i.instance.touchApplied||(i.instance.momentumScrolling.ongoing=!1,i.instance.getSetting("onAfterMomentumScroll"))},200)})}o.addEventListener(e,"resize",function(){i.instance.draw()}),this.destroy=function(){clearTimeout(this.dblClickTimeout[0]),clearTimeout(this.dblClickTimeout[1]),o.clear()}}function v(){function e(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return e()+e()+e()+e()}function m(e,t,n){this.offset=e,this.total=t,this.countTH=n}function y(e){this.instance=e}function w(e){this.instance=e,this.type="corner",this.init(),this.clone=this.makeClone("corner")}function b(e){this.instance=e,this.type="horizontal",this.offset=0,this.init(),this.clone=this.makeClone("left")}function C(e){this.instance=e,this.type="vertical",this.init(),this.clone=this.makeClone("top")}function x(e){this.instance=e,e.update("scrollbarWidth",t.Dom.getScrollbarWidth()),e.update("scrollbarHeight",t.Dom.getScrollbarWidth()),this.vertical=new C(e),this.horizontal=new b(e),this.corner=new w(e),e.getSetting("debug")&&(this.debug=new f(e)),this.registerListeners()}function E(e,t){this.settings=e,this.cellRange=t||null,this.instanceBorders={}}function _(e,n){var i=this;this.instance=e,this.defaults={table:void 0,debug:!1,stretchH:"none",currentRowClassName:null,currentColumnClassName:null,data:void 0,fixedColumnsLeft:0,fixedRowsTop:0,rowHeaders:function(){return[]},columnHeaders:function(){return[]},totalRows:void 0,totalColumns:void 0,cellRenderer:function(e,n,o){var r=i.getSetting("data",e,n);t.Dom.fastInnerText(o,void 0===r||null===r?"":r)},columnWidth:function(){},rowHeight:function(){},defaultRowHeight:23,defaultColumnWidth:50,selections:null,hideBorderOnMouseDownOver:!1,viewportRowCalculatorOverride:null,viewportColumnCalculatorOverride:null,onCellMouseDown:null,onCellMouseOver:null,onCellDblClick:null,onCellCornerMouseDown:null,onCellCornerDblClick:null,beforeDraw:null,onDraw:null,onBeforeDrawBorders:null,onScrollVertically:null,onScrollHorizontally:null,onBeforeTouchScroll:null,onAfterMomentumScroll:null,scrollbarWidth:10,scrollbarHeight:10,renderAllRows:!1,groups:!1},this.settings={};for(var o in this.defaults)if(this.defaults.hasOwnProperty(o))if(void 0!==n[o])this.settings[o]=n[o];else{if(void 0===this.defaults[o])throw new Error('A required setting "'+o+'" was not provided');this.settings[o]=this.defaults[o]}}function S(e,n){this.instance=e,this.TABLE=n,t.Dom.removeTextNodes(this.TABLE);var i=this.TABLE.parentNode;if(!i||1!==i.nodeType||!t.Dom.hasClass(i,"wtHolder")){var o=document.createElement("DIV");o.className="wtSpreader",i&&i.insertBefore(o,this.TABLE),o.appendChild(this.TABLE)}if(this.spreader=this.TABLE.parentNode,!(i=this.spreader.parentNode)||1!==i.nodeType||!t.Dom.hasClass(i,"wtHolder")){var r=document.createElement("DIV");r.className="wtHider",i&&i.insertBefore(r,this.spreader),r.appendChild(this.spreader)}if(this.hider=this.spreader.parentNode,this.hiderStyle=this.hider.style,this.hiderStyle.position="relative",!(i=this.hider.parentNode)||1!==i.nodeType||!t.Dom.hasClass(i,"wtHolder")){var a=document.createElement("DIV");a.style.position="relative",a.className="wtHolder",e.cloneSource||(a.className+=" ht_master"),i&&i.insertBefore(a,this.hider),a.appendChild(this.hider)}if(this.holder=this.hider.parentNode,this.isWorkingOnClone()||(this.holder.parentNode.style.position="relative"),this.TBODY=this.TABLE.getElementsByTagName("TBODY")[0],this.TBODY||(this.TBODY=document.createElement("TBODY"),this.TABLE.appendChild(this.TBODY)),this.THEAD=this.TABLE.getElementsByTagName("THEAD")[0],this.THEAD||(this.THEAD=document.createElement("THEAD"),this.TABLE.insertBefore(this.THEAD,this.TBODY)),this.COLGROUP=this.TABLE.getElementsByTagName("COLGROUP")[0],this.COLGROUP||(this.COLGROUP=document.createElement("COLGROUP"),this.TABLE.insertBefore(this.COLGROUP,this.THEAD)),this.instance.getSetting("columnHeaders").length&&!this.THEAD.childNodes.length){var s=document.createElement("TR");this.THEAD.appendChild(s)}this.colgroupChildrenLength=this.COLGROUP.childNodes.length,this.theadChildrenLength=this.THEAD.firstChild?this.THEAD.firstChild.childNodes.length:0,this.tbodyChildrenLength=this.TBODY.childNodes.length,this.rowFilter=null,this.columnFilter=null}function k(e){this.wtTable=e,this.instance=e.instance,this.rowFilter=e.rowFilter,this.columnFilter=e.columnFilter,this.TABLE=e.TABLE,this.THEAD=e.THEAD,this.TBODY=e.TBODY,this.COLGROUP=e.COLGROUP,this.utils=k.utils}function T(n){this.instance=n,this.oversizedRows=[],this.oversizedCols=[],this.oversizedColumnHeaders=[];var i=this;t.eventManager(n).addEventListener(e,"resize",function(){i.clientHeight=i.getWorkspaceHeight()})}function D(e,t,n,i,o,r,a){function s(e,t){var i=0;if(h.stretchAllColumnsWidth[e]||(h.stretchAllColumnsWidth[e]=Math.round(t*h.stretchAllRatio)),h.stretchAllColumnsWidth.length===n&&h.needVerifyLastColumnWidth){h.needVerifyLastColumnWidth=!1;for(var o=0;o<h.stretchAllColumnsWidth.length;o++)i+=h.stretchAllColumnsWidth[o];i!=h.totalTargetWidth&&(h.stretchAllColumnsWidth[h.stretchAllColumnsWidth.length-1]+=h.totalTargetWidth-i)}return h.stretchAllColumnsWidth[e]}function l(e){return e===n-1?h.stretchLastWidth:null}var c,d,u,h=this,p=1,f=0,g=!0,v=[];for(this.scrollOffset=t,this.startColumn=null,this.endColumn=null,this.startPosition=null,this.count=0,this.stretchAllRatio=0,this.stretchLastWidth=0,this.stretch=a,this.totalTargetWidth=0,this.needVerifyLastColumnWidth=!0,this.stretchAllColumnsWidth=[],c=function(e){var t=i(e);return p=p||1,void 0===t&&(t=50),t},this.refreshStretching=function(e){for(var t,i,o=0,r=0;n>r;r++)t=c(r),o+=t;this.totalTargetWidth=e,i=o-e,"all"===this.stretch&&0>i?(this.stretchAllRatio=e/o,this.stretchAllColumnsWidth=[],this.needVerifyLastColumnWidth=!0):"last"===this.stretch&&1/0!==e&&(this.stretchLastWidth=-i+c(n-1))},this.getStretchedColumnWidth=function(e,t){var n=null;return"all"===this.stretch&&0!==this.stretchAllRatio?n=s(e,t):"last"===this.stretch&&0!==this.stretchLastWidth&&(n=l(e)),n},u=0;n>u;u++)if(d=c(u),t>=f&&!r&&(this.startColumn=u),f>=t&&t+e>=f+d&&(null==this.startColumn&&(this.startColumn=u),this.endColumn=u),v.push(f),f+=d,r||(this.endColumn=u),f>=t+e){g=!1;break}if(this.endColumn==n-1&&g)for(this.startColumn=this.endColumn;this.startColumn>0;){var m=v[this.endColumn]+d-v[this.startColumn-1];if((e>=m||!r)&&this.startColumn--,m>e)break}null!==this.startColumn&&o&&o(this),this.startPosition=v[this.startColumn],void 0==this.startPosition&&(this.startPosition=null),null!=this.startColumn&&(this.count=this.endColumn-this.startColumn+1)}function R(e,t,n,i,o,r){this.scrollOffset=t,this.startRow=null,this.startPosition=null,this.endRow=null,this.count=0;for(var a,s=0,l=!0,c=[],d=0;n>d;d++)if(void 0===(a=i(d))&&(a=23),t>=s&&!r&&(this.startRow=d),s>=t&&t+e>=s+a&&(null==this.startRow&&(this.startRow=d),this.endRow=d),c.push(s),s+=a,r||(this.endRow=d),s>=t+e){l=!1;break}if(this.endRow==n-1&&l)for(this.startRow=this.endRow;this.startRow>0;){var u=c[this.endRow]+a-c[this.startRow-1];if((e>=u||!r)&&this.startRow--,u>=e)break}null!==this.startRow&&o&&o(this),this.startPosition=c[this.startRow],void 0==this.startPosition&&(this.startPosition=null),null!=this.startRow&&(this.count=this.endRow-this.startRow+1)}Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length>>>0,n=Number(arguments[1])||0;for(0>(n=0>n?Math.ceil(n):Math.floor(n))&&(n+=t);t>n;n++)if(n in this&&this[n]===e)return n;return-1}),Array.prototype.filter||(Array.prototype.filter=function(e,t){if(void 0===this||null===this)throw new TypeError;if("function"!=typeof e)throw new TypeError;(function(e){return/NodeList/i.test(e.item)})(t=t||this)&&(t=function(e){for(var t=[],n=0,i=e.length;i>n;n++)t[n]=e[n];return t}(t));var n,i,o=t.length,r=[];for(n=0;o>n;n+=1)t.hasOwnProperty(n)&&(i=t[n],e.call(t,i,n,t)&&r.push(i));return r}),Array.isArray||(Array.isArray=function(e){return"[object Array]"==toString.call(e)}),Object.keys||(Object.keys=function(){var e=Object.prototype.hasOwnProperty,t=!{toString:null}.propertyIsEnumerable("toString"),n=["toString","toLocaleString","valueOf","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","constructor"],i=n.length;return function(o){if("object"!=typeof o&&("function"!=typeof o||null===o))throw new TypeError("Object.keys called on non-object");var r,a,s=[];for(r in o)e.call(o,r)&&s.push(r);if(t)for(a=0;i>a;a++)e.call(o,n[a])&&s.push(n[a]);return s}}()),"undefined"==typeof WeakMap&&function(){var t=Object.defineProperty;try{var n=!0;t(function(){},"foo",{})}catch(e){n=!1}var i=+new Date%1e9,o=function(){this.name="__st"+(1e9*Math.random()>>>0)+i+++"__",n||(this._wmCache=[])};o.prototype=n?{set:function(e,n){var i=e[this.name];i&&i[0]===e?i[1]=n:t(e,this.name,{value:[e,n],writable:!0})},get:function(e){var t;return(t=e[this.name])&&t[0]===e?t[1]:void 0},delete:function(e){this.set(e,void 0)}}:{set:function(e,t){if(void 0!==e&&void 0!==t){for(var n=0,i=this._wmCache.length;i>n;n++)if(this._wmCache[n].key==e)return void(this._wmCache[n].value=t);this._wmCache.push({key:e,value:t})}},get:function(e){if(void 0!==e)for(var t=0,n=this._wmCache.length;n>t;t++)if(this._wmCache[t].key==e)return this._wmCache[t].value},delete:function(e){if(void 0!==e)for(var t=0,n=this._wmCache.length;n>t;t++)this._wmCache[t].key==e&&Array.prototype.slice.call(this._wmCache,t,1)}},e.WeakMap=o}(),t.activeGuid=null,t.Core=function(e,n){function i(){var e=!1;return{validatorsInQueue:0,addValidatorToQueue:function(){this.validatorsInQueue++,e=!1},removeValidatorFormQueue:function(){this.validatorsInQueue=this.validatorsInQueue-1<0?0:this.validatorsInQueue-1,this.checkIfQueueIsEmpty()},onQueueEmpty:function(){},checkIfQueueIsEmpty:function(){0==this.validatorsInQueue&&0==e&&(e=!0,this.onQueueEmpty())}}}function o(e,n,o){var r=new i;r.onQueueEmpty=function(){var i;e.length&&("function"==typeof(i=t.hooks.run(y,"beforeChange",e,n))?console.warn("Your beforeChange callback returns a function. It's not supported since Handsontable 0.12.1 (and the returned function will not be executed)."):!1===i&&e.splice(0,e.length)),o()};for(var a=e.length-1;a>=0;a--)if(null===e[a])e.splice(a,1);else{var s=e[a][0],l=f.propToCol(e[a][1]),c=y.runHooks("modifyCol",l),d=y.getCellMeta(s,c);if("numeric"===d.type&&"string"==typeof e[a][3]&&e[a][3].length>0&&(/^-?[\d\s]*(\.|\,)?\d*$/.test(e[a][3])||d.format)){var u=e[a][3].length;numeral.language(void 0===d.language?"en":e[a][3].indexOf(".")===u-3&&-1===e[a][3].indexOf(",")?"en":d.language),numeral.validate(e[a][3])&&(e[a][3]=numeral().unformat(e[a][3]))}y.getCellValidator(d)&&(r.addValidatorToQueue(),y.validateCell(e[a][3],d,function(t,n){return function(i){if("boolean"!=typeof i)throw new Error("Validation error: result is not boolean");!1===i&&!1===n.allowInvalid&&(e.splice(t,1),n.valid=!0,--t),r.removeValidatorFormQueue()}}(a,d),n))}r.checkIfQueueIsEmpty()}function r(e,n){var i=e.length-1;if(!(0>i)){for(;i>=0;i--)if(null!==e[i]){if(null!=e[i][2]||null!=e[i][3]){if(p.settings.allowInsertRow)for(;e[i][0]>y.countRows()-1;)f.createRow();if("array"===y.dataType&&p.settings.allowInsertColumn)for(;f.propToCol(e[i][1])>y.countCols()-1;)f.createCol();f.set(e[i][0],e[i][1],e[i][3])}}else e.splice(i,1);y.forceFullRender=!0,g.adjustRowsAndCols(),t.hooks.run(y,"beforeChangeRender",e,n),v.refreshBorders(null,!0),t.hooks.run(y,"afterChange",e,n||"edit")}}function a(e,t,n){return"object"==typeof e?e:[[e,t,n]]}function s(e){if(e.hasOwnProperty("type")){var n,i={};if("object"==typeof e.type)n=e.type;else if("string"==typeof e.type&&void 0===(n=t.cellTypes[e.type]))throw new Error('You declared cell type "'+e.type+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');for(var o in n)n.hasOwnProperty(o)&&!e.hasOwnProperty(o)&&(i[o]=n[o]);return i}}function l(e){return t.hooks.run(y,"modifyRow",e)}function u(e){return t.hooks.run(y,"modifyCol",e)}function h(){throw new Error("This method cannot be called because this Handsontable instance has been destroyed")}var p,f,g,v,m,y=this,w=function(){},b=t.eventManager(y);t.helper.extend(w.prototype,P.prototype),t.helper.extend(w.prototype,n),t.helper.extend(w.prototype,s(n)),this.rootElement=e,this.isHotTableEnv=t.Dom.isChildOfWebComponentTable(this.rootElement),t.eventManager.isHotTableEnv=this.isHotTableEnv,this.container=document.createElement("DIV"),this.container.className="htContainer",e.insertBefore(this.container,e.firstChild),this.guid="ht_"+t.helper.randomString(),this.rootElement.id&&"ht_"!==this.rootElement.id.substring(0,3)||(this.rootElement.id=this.guid),p={cellSettings:[],columnSettings:[],columnsSettingConflicts:["data","width"],settings:new w,selRange:null,isPopulated:null,scrollable:null,firstRun:!0},g={alter:function(e,t,n,i,o){var r;switch(n=n||1,e){case"insert_row":(r=f.createRow(t,n))&&(v.isSelected()&&p.selRange.from.row>=t?(p.selRange.from.row=p.selRange.from.row+r,v.transformEnd(r,0)):v.refreshBorders());break;case"insert_col":if(r=f.createCol(t,n)){if(Array.isArray(y.getSettings().colHeaders)){var a=[t,0];a.length+=r,Array.prototype.splice.apply(y.getSettings().colHeaders,a)}v.isSelected()&&p.selRange.from.col>=t?(p.selRange.from.col=p.selRange.from.col+r,v.transformEnd(0,r)):v.refreshBorders()}break;case"remove_row":t=y.runHooks("modifyCol",t),f.removeRow(t,n),p.cellSettings.splice(t,n);var s=y.getSettings().fixedRowsTop;s>=t+1&&(y.getSettings().fixedRowsTop-=Math.min(n,s-t)),g.adjustRowsAndCols(),v.refreshBorders();break;case"remove_col":f.removeCol(t,n);for(var l=0,c=f.getAll().length;c>l;l++)l in p.cellSettings&&p.cellSettings[l].splice(t,n);var d=y.getSettings().fixedColumnsLeft;d>=t+1&&(y.getSettings().fixedColumnsLeft-=Math.min(n,d-t)),Array.isArray(y.getSettings().colHeaders)&&(void 0===t&&(t=-1),y.getSettings().colHeaders.splice(t,n)),g.adjustRowsAndCols(),v.refreshBorders();break;default:throw new Error('There is no such action "'+e+'"')}o||g.adjustRowsAndCols()},adjustRowsAndCols:function(){var e,t,n,i;if((t=y.countRows())<p.settings.minRows)for(e=0;e<p.settings.minRows-t;e++)f.createRow(y.countRows(),1,!0);if((n=y.countEmptyRows(!0))<p.settings.minSpareRows)for(;n<p.settings.minSpareRows&&y.countRows()<p.settings.maxRows;n++)f.createRow(y.countRows(),1,!0);if(i=y.countEmptyCols(!0),!p.settings.columns&&y.countCols()<p.settings.minCols)for(;y.countCols()<p.settings.minCols;i++)f.createCol(y.countCols(),1,!0);if(!p.settings.columns&&"array"===y.dataType&&i<p.settings.minSpareCols)for(;i<p.settings.minSpareCols&&y.countCols()<p.settings.maxCols;i++)f.createCol(y.countCols(),1,!0);var o=y.countRows(),r=y.countCols();if((0===o||0===r)&&v.deselect(),v.isSelected()){var a,s=p.selRange.from.row,l=p.selRange.from.col,c=p.selRange.to.row,d=p.selRange.to.col;s>o-1?(s=o-1,a=!0,c>s&&(c=s)):c>o-1&&(c=o-1,a=!0,s>c&&(s=c)),l>r-1?(l=r-1,a=!0,d>l&&(d=l)):d>r-1&&(d=r-1,a=!0,l>d&&(l=d)),a&&y.selectCell(s,l,c,d)}},populateFromArray:function(e,n,i,o,r,a,s){var l,c,d,u,h=[],f={};if(0===(c=n.length))return!1;var g,v,m,w;switch(r){case"shift_down":for(g=i?i.col-e.col+1:0,v=i?i.row-e.row+1:0,d=0,u=(n=t.helper.translateRowsToColumns(n)).length,m=Math.max(u,g);m>d;d++)if(u>d){for(l=0,c=n[d].length;v-c>l;l++)n[d].push(n[d][l%c]);n[d].unshift(e.col+d,e.row,0),y.spliceCol.apply(y,n[d])}else n[d%u][0]=e.col+d,y.spliceCol.apply(y,n[d%u]);break;case"shift_right":for(g=i?i.col-e.col+1:0,v=i?i.row-e.row+1:0,l=0,c=n.length,w=Math.max(c,v);w>l;l++)if(c>l){for(d=0,u=n[l].length;g-u>d;d++)n[l].push(n[l][d%u]);n[l].unshift(e.row+l,e.col,0),y.spliceRow.apply(y,n[l])}else n[l%c][0]=e.row+l,y.spliceRow.apply(y,n[l%c]);break;case"overwrite":default:f.row=e.row,f.col=e.col;var b={row:0,col:0},C={row:i&&e?i.row-e.row+1:1,col:i&&e?i.col-e.col+1:1};for(-1!==["up","left"].indexOf(a)?b={row:Math.ceil(C.row/c)||1,col:Math.ceil(C.col/n[0].length)||1}:-1!==["down","right"].indexOf(a)&&(b={row:1,col:1}),l=0;c>l&&!(i&&f.row>i.row||!p.settings.allowInsertRow&&f.row>y.countRows()-1||f.row>=p.settings.maxRows);l++){for(f.col=e.col,u=n[l]?n[l].length:0,d=0;u>d&&!(i&&f.col>i.col||!p.settings.allowInsertColumn&&f.col>y.countCols()-1||f.col>=p.settings.maxCols);d++){if(!y.getCellMeta(f.row,f.col).readOnly){var x,E=n[l][d],_={row:l,col:d};"autofill"===o&&(x=y.runHooks("beforeAutofillInsidePopulate",_,a,n,s,b,C))&&(b=void 0!==x.iterators?x.iterators:b,E=void 0!==x.value?x.value:E),h.push([f.row,f.col,E])}f.col++,i&&d===u-1&&(d=-1,-1!==["down","right"].indexOf(a)?b.col++:-1!==["up","left"].indexOf(a)&&b.col>1&&b.col--)}f.row++,b.col=1,i&&l===c-1&&(l=-1,-1!==["down","right"].indexOf(a)?b.row++:-1!==["up","left"].indexOf(a)&&b.row>1&&b.row--)}y.setDataAtCell(h,null,null,o||"populateFromArray")}}},this.selection=v={inProgress:!1,selectedHeader:{cols:!1,rows:!1},setSelectedHeaders:function(e,t){y.selection.selectedHeader.rows=e,y.selection.selectedHeader.cols=t},begin:function(){y.selection.inProgress=!0},finish:function(){var e=y.getSelected();t.hooks.run(y,"afterSelectionEnd",e[0],e[1],e[2],e[3]),t.hooks.run(y,"afterSelectionEndByProp",e[0],y.colToProp(e[1]),e[2],y.colToProp(e[3])),y.selection.inProgress=!1},isInProgress:function(){return y.selection.inProgress},setRangeStart:function(e,n){t.hooks.run(y,"beforeSetRangeStart",e),p.selRange=new d(e,e,e),v.setRangeEnd(e,null,n)},setRangeEnd:function(e,n,i){t.hooks.run(y,"beforeSetRangeEnd",e),y.selection.begin(),p.selRange.to=new c(e.row,e.col),p.settings.multiSelect||(p.selRange.from=e),y.view.wt.selections.current.clear(),y.view.wt.selections.current.add(p.selRange.highlight),y.view.wt.selections.area.clear(),v.isMultiple()&&(y.view.wt.selections.area.add(p.selRange.from),y.view.wt.selections.area.add(p.selRange.to)),(p.settings.currentRowClassName||p.settings.currentColClassName)&&(y.view.wt.selections.highlight.clear(),y.view.wt.selections.highlight.add(p.selRange.from),y.view.wt.selections.highlight.add(p.selRange.to)),t.hooks.run(y,"afterSelection",p.selRange.from.row,p.selRange.from.col,p.selRange.to.row,p.selRange.to.col),t.hooks.run(y,"afterSelectionByProp",p.selRange.from.row,f.colToProp(p.selRange.from.col),p.selRange.to.row,f.colToProp(p.selRange.to.col)),!1!==n&&y.view.mainViewIsActive()&&y.view.scrollViewport(p.selRange.from&&!v.isMultiple()?p.selRange.from:e),v.refreshBorders(null,i)},refreshBorders:function(e,t){t||m.destroyEditor(e),y.view.render(),v.isSelected()&&!t&&m.prepareEditor()},isMultiple:function(){var e=!(p.selRange.to.col===p.selRange.from.col&&p.selRange.to.row===p.selRange.from.row),n=t.hooks.run(y,"afterIsMultipleSelection",e);return e?n:void 0},transformStart:function(e,t,n,i){var o=new c(e,t);y.runHooks("modifyTransformStart",o),p.selRange.highlight.row+e>y.countRows()-1?n&&p.settings.minSpareRows>0?y.alter("insert_row",y.countRows()):p.settings.autoWrapCol&&(o.row=1-y.countRows(),o.col=p.selRange.highlight.col+o.col==y.countCols()-1?1-y.countCols():1):p.settings.autoWrapCol&&p.selRange.highlight.row+o.row<0&&p.selRange.highlight.col+o.col>=0&&(o.row=y.countRows()-1,o.col=p.selRange.highlight.col+o.col==0?y.countCols()-1:-1),p.selRange.highlight.col+o.col>y.countCols()-1?n&&p.settings.minSpareCols>0?y.alter("insert_col",y.countCols()):p.settings.autoWrapRow&&(o.row=p.selRange.highlight.row+o.row==y.countRows()-1?1-y.countRows():1,o.col=1-y.countCols()):p.settings.autoWrapRow&&p.selRange.highlight.col+o.col<0&&p.selRange.highlight.row+o.row>=0&&(o.row=p.selRange.highlight.row+o.row==0?y.countRows()-1:-1,o.col=y.countCols()-1);var r=y.countRows(),a=y.countCols(),s=new c(p.selRange.highlight.row+o.row,p.selRange.highlight.col+o.col);s.row<0?s.row=0:s.row>0&&s.row>=r&&(s.row=r-1),s.col<0?s.col=0:s.col>0&&s.col>=a&&(s.col=a-1),v.setRangeStart(s,i)},transformEnd:function(e,t){var n=new c(e,t);y.runHooks("modifyTransformEnd",n);var i=y.countRows(),o=y.countCols(),r=new c(p.selRange.to.row+n.row,p.selRange.to.col+n.col);r.row<0?r.row=0:r.row>0&&r.row>=i&&(r.row=i-1),r.col<0?r.col=0:r.col>0&&r.col>=o&&(r.col=o-1),v.setRangeEnd(r,!0)},isSelected:function(){return null!==p.selRange},inInSelection:function(e){return!!v.isSelected()&&p.selRange.includes(e)},deselect:function(){v.isSelected()&&(y.selection.inProgress=!1,p.selRange=null,y.view.wt.selections.current.clear(),y.view.wt.selections.area.clear(),(p.settings.currentRowClassName||p.settings.currentColClassName)&&y.view.wt.selections.highlight.clear(),m.destroyEditor(),v.refreshBorders(),t.hooks.run(y,"afterDeselect"))},selectAll:function(){p.settings.multiSelect&&(v.setRangeStart(new c(0,0)),v.setRangeEnd(new c(y.countRows()-1,y.countCols()-1),!1))},empty:function(){if(v.isSelected()){var e,t,n=p.selRange.getTopLeftCorner(),i=p.selRange.getBottomRightCorner(),o=[];for(e=n.row;e<=i.row;e++)for(t=n.col;t<=i.col;t++)y.getCellMeta(e,t).readOnly||o.push([e,t,""]);y.setDataAtCell(o)}}},this.init=function(){t.hooks.run(y,"beforeInit"),t.mobileBrowser&&t.Dom.addClass(y.rootElement,"mobile"),this.updateSettings(p.settings,!0),this.view=new t.TableView(this),m=new t.EditorManager(y,p,v,f),this.forceFullRender=!0,this.view.render(),"object"==typeof p.firstRun&&(t.hooks.run(y,"afterChange",p.firstRun[0],p.firstRun[1]),p.firstRun=!1),t.hooks.run(y,"afterInit")},this.validateCell=function(e,n,i,o){function r(e){var t=n.col,o=n.row,r=y.getCell(o,t,!0);r&&y.view.wt.wtSettings.settings.cellRenderer(o,t,r),i(e)}var a=y.getCellValidator(n);"[object RegExp]"===Object.prototype.toString.call(a)&&(a=function(e){return function(t,n){n(e.test(t))}}(a)),"function"==typeof a?(e=t.hooks.run(y,"beforeValidate",e,n.row,n.prop,o),y._registerTimeout(setTimeout(function(){a.call(n,e,function(i){i=t.hooks.run(y,"afterValidate",i,e,n.row,n.prop,o),n.valid=i,r(i),t.hooks.run(y,"postAfterValidate",i,e,n.row,n.prop,o)})},0))):(n.valid=!0,r(n.valid))},this.setDataAtCell=function(e,t,n,i){var s,l,c,d=a(e,t,n),u=[];for(s=0,l=d.length;l>s;s++){if("object"!=typeof d[s])throw new Error("Method `setDataAtCell` accepts row number or changes array of arrays as its first parameter");if("number"!=typeof d[s][1])throw new Error("Method `setDataAtCell` accepts row and column number as its parameters. If you want to use object property name, use method `setDataAtRowProp`");c=f.colToProp(d[s][1]),u.push([d[s][0],c,f.get(d[s][0],c),d[s][2]])}i||"object"!=typeof e||(i=t),o(u,i,function(){r(u,i)})},this.setDataAtRowProp=function(e,t,n,i){var s,l,c=a(e,t,n),d=[];for(s=0,l=c.length;l>s;s++)d.push([c[s][0],c[s][1],f.get(c[s][0],c[s][1]),c[s][2]]);i||"object"!=typeof e||(i=t),o(d,i,function(){r(d,i)})},this.listen=function(){t.activeGuid=y.guid,document.activeElement&&document.activeElement!==document.body?document.activeElement.blur():document.activeElement||document.body.focus()},this.unlisten=function(){t.activeGuid=null},this.isListening=function(){return t.activeGuid===y.guid},this.destroyEditor=function(e){v.refreshBorders(e)},this.populateFromArray=function(e,t,n,i,o,r,a,s,l){var d;if("object"!=typeof n||"object"!=typeof n[0])throw new Error("populateFromArray parameter `input` must be an array of arrays");return d="number"==typeof i?new c(i,o):null,g.populateFromArray(new c(e,t),n,d,r,a,s,l)},this.spliceCol=function(){return f.spliceCol.apply(f,arguments)},this.spliceRow=function(){return f.spliceRow.apply(f,arguments)},this.getSelected=function(){return v.isSelected()?[p.selRange.from.row,p.selRange.from.col,p.selRange.to.row,p.selRange.to.col]:void 0},this.getSelectedRange=function(){return v.isSelected()?p.selRange:void 0},this.render=function(){y.view&&(y.forceFullRender=!0,v.refreshBorders(null,!0))},this.loadData=function(e){if("object"==typeof e&&null!==e)e.push&&e.splice||(e=[e]);else{if(null!==e)throw new Error("loadData only accepts array of objects or array of arrays ("+typeof e+" given)");e=[];for(var n,i=0,o=p.settings.startRows;o>i;i++){n=[];for(var r=0,a=p.settings.startCols;a>r;r++)n.push(null);e.push(n)}}p.isPopulated=!1,w.prototype.data=e,y.dataType=Array.isArray(p.settings.dataSchema)||Array.isArray(e[0])?"array":"function"==typeof p.settings.dataSchema?"function":"object",f=new t.DataMap(y,p,w),p.cellSettings.length=0,g.adjustRowsAndCols(),t.hooks.run(y,"afterLoadData"),p.firstRun?p.firstRun=[null,"loadData"]:(t.hooks.run(y,"afterChange",null,"loadData"),y.render()),p.isPopulated=!0},this.getData=function(e,t,n,i){return void 0===e?f.getAll():f.getRange(new c(e,t),new c(n,i),f.DESTINATION_RENDERER)},this.getCopyableData=function(e,t,n,i){return f.getCopyableText(new c(e,t),new c(n,i))},this.updateSettings=function(e,n){var i,o;if(void 0!==e.rows)throw new Error("'rows' setting is no longer supported. do you mean startRows, minRows or maxRows?");if(void 0!==e.cols)throw new Error("'cols' setting is no longer supported. do you mean startCols, minCols or maxCols?");for(i in e)"data"!==i&&(void 0!==t.hooks.hooks[i]||void 0!==t.hooks.legacy[i]?("function"==typeof e[i]||Array.isArray(e[i]))&&y.addHook(i,e[i]):!n&&e.hasOwnProperty(i)&&(w.prototype[i]=e[i]));if(void 0===e.data&&void 0===p.settings.data?y.loadData(null):void 0!==e.data?y.loadData(e.data):void 0!==e.columns&&f.createMap(),o=y.countCols(),p.cellSettings.length=0,o>0){var r,a;for(i=0;o>i;i++)p.columnSettings[i]=t.helper.columnFactory(w,p.columnsSettingConflicts),r=p.columnSettings[i].prototype,w.prototype.columns&&(a=w.prototype.columns[i],t.helper.extend(r,a),t.helper.extend(r,s(a)))}if(void 0!==e.cell)for(i in e.cell){var l=e.cell[i];y.setCellMetaObject(l.row,l.col,l)}if(t.hooks.run(y,"afterCellMetaReset"),void 0!==e.className&&(w.prototype.className&&t.Dom.removeClass(y.rootElement,w.prototype.className),e.className&&t.Dom.addClass(y.rootElement,e.className)),void 0!==e.height){var c=e.height;"function"==typeof c&&(c=c()),y.rootElement.style.height=c+"px"}if(void 0!==e.width){var d=e.width;"function"==typeof d&&(d=d()),y.rootElement.style.width=d+"px"}c&&(y.rootElement.style.overflow="auto"),n||t.hooks.run(y,"afterUpdateSettings"),g.adjustRowsAndCols(),y.view&&!p.firstRun&&(y.forceFullRender=!0,v.refreshBorders(null,!0))},this.getValue=function(){var e=y.getSelected();if(w.prototype.getValue){if("function"==typeof w.prototype.getValue)return w.prototype.getValue.call(y);if(e)return y.getData()[e[0]][w.prototype.getValue]}else if(e)return y.getDataAtCell(e[0],e[1])},this.getSettings=function(){return p.settings},this.clear=function(){v.selectAll(),v.empty()},this.alter=function(e,t,n,i,o){g.alter(e,t,n,i,o)},this.getCell=function(e,t,n){return y.view.getCellAtCoords(new c(e,t),n)},this.getCoords=function(e){return this.view.wt.wtTable.getCoords.call(this.view.wt.wtTable,e)},this.colToProp=function(e){return f.colToProp(e)},this.propToCol=function(e){return f.propToCol(e)},this.getDataAtCell=function(e,t){return f.get(e,f.colToProp(t))},this.getDataAtRowProp=function(e,t){return f.get(e,t)},this.getDataAtCol=function(e){var t=[];return t.concat.apply(t,f.getRange(new c(0,e),new c(p.settings.data.length-1,e),f.DESTINATION_RENDERER))},this.getDataAtProp=function(e){var t,n=[];return t=f.getRange(new c(0,f.propToCol(e)),new c(p.settings.data.length-1,f.propToCol(e)),f.DESTINATION_RENDERER),n.concat.apply(n,t)},this.getSourceDataAtCol=function(e){for(var t=[],n=p.settings.data,i=0;i<n.length;i++)t.push(n[i][e]);return t},this.getSourceDataAtRow=function(e){return p.settings.data[e]},this.getDataAtRow=function(e){return f.getRange(new c(e,0),new c(e,this.countCols()-1),f.DESTINATION_RENDERER)[0]},this.removeCellMeta=function(e,t,n){void 0!=y.getCellMeta(e,t)[n]&&delete p.cellSettings[e][t][n]},this.setCellMetaObject=function(e,t,n){if("object"==typeof n)for(var i in n){var o=n[i];this.setCellMeta(e,t,i,o)}},this.setCellMeta=function(e,n,i,o){p.cellSettings[e]||(p.cellSettings[e]=[]),p.cellSettings[e][n]||(p.cellSettings[e][n]=new p.columnSettings[n]),p.cellSettings[e][n][i]=o,t.hooks.run(y,"afterSetCellMeta",e,n,i,o)},this.getCellMeta=function(e,n){var i,o=f.colToProp(n);if(e=l(e),n=u(n),p.columnSettings[n]||(p.columnSettings[n]=t.helper.columnFactory(w,p.columnsSettingConflicts)),p.cellSettings[e]||(p.cellSettings[e]=[]),p.cellSettings[e][n]||(p.cellSettings[e][n]=new p.columnSettings[n]),i=p.cellSettings[e][n],i.row=e,i.col=n,i.prop=o,i.instance=y,t.hooks.run(y,"beforeGetCellMeta",e,n,i),t.helper.extend(i,s(i)),i.cells){var r=i.cells.call(i,e,n,o);r&&(t.helper.extend(i,r),t.helper.extend(i,s(r)))}return t.hooks.run(y,"afterGetCellMeta",e,n,i),i};var C=t.helper.cellMethodLookupFactory("renderer");this.getCellRenderer=function(e,n){var i=C.call(this,e,n);return t.renderers.getRenderer(i)},this.getCellEditor=t.helper.cellMethodLookupFactory("editor"),this.getCellValidator=t.helper.cellMethodLookupFactory("validator"),this.validateCells=function(e){var t=new i;t.onQueueEmpty=e;for(var n=y.countRows()-1;n>=0;){for(var o=y.countCols()-1;o>=0;)t.addValidatorToQueue(),y.validateCell(y.getDataAtCell(n,o),y.getCellMeta(n,o),function(){t.removeValidatorFormQueue()},"validateCells"),o--;n--}t.checkIfQueueIsEmpty()},this.getRowHeader=function(e){if(void 0===e){for(var t=[],n=0,i=y.countRows();i>n;n++)t.push(y.getRowHeader(n));return t}return Array.isArray(p.settings.rowHeaders)&&void 0!==p.settings.rowHeaders[e]?p.settings.rowHeaders[e]:"function"==typeof p.settings.rowHeaders?p.settings.rowHeaders(e):p.settings.rowHeaders&&"string"!=typeof p.settings.rowHeaders&&"number"!=typeof p.settings.rowHeaders?e+1:p.settings.rowHeaders},this.hasRowHeaders=function(){return!!p.settings.rowHeaders},this.hasColHeaders=function(){if(void 0!==p.settings.colHeaders&&null!==p.settings.colHeaders)return!!p.settings.colHeaders;for(var e=0,t=y.countCols();t>e;e++)if(y.getColHeader(e))return!0;return!1},this.getColHeader=function(e){if(void 0===e){for(var n=[],i=0,o=y.countCols();o>i;i++)n.push(y.getColHeader(i));return n}var r=e;return e=t.hooks.run(y,"modifyCol",e),p.settings.columns&&p.settings.columns[e]&&p.settings.columns[e].title?p.settings.columns[e].title:Array.isArray(p.settings.colHeaders)&&void 0!==p.settings.colHeaders[e]?p.settings.colHeaders[e]:"function"==typeof p.settings.colHeaders?p.settings.colHeaders(e):p.settings.colHeaders&&"string"!=typeof p.settings.colHeaders&&"number"!=typeof p.settings.colHeaders?t.helper.spreadsheetColumnLabel(r):p.settings.colHeaders},this._getColWidthFromSettings=function(e){var t=y.getCellMeta(0,e),n=t.width;if((void 0===n||n===p.settings.width)&&(n=t.colWidths),void 0!==n&&null!==n){switch(typeof n){case"object":n=n[e];break;case"function":n=n(e)}"string"==typeof n&&(n=parseInt(n,10))}return n},this.getColWidth=function(e){var n=y._getColWidthFromSettings(e);return n||(n=50),n=t.hooks.run(y,"modifyColWidth",n,e)},this._getRowHeightFromSettings=function(e){var t=p.settings.rowHeights;if(void 0!==t&&null!==t){switch(typeof t){case"object":t=t[e];break;case"function":t=t(e)}"string"==typeof t&&(t=parseInt(t,10))}return t},this.getRowHeight=function(e){var n=y._getRowHeightFromSettings(e);return n=t.hooks.run(y,"modifyRowHeight",n,e)},this.countRows=function(){return p.settings.data.length},this.countCols=function(){return"object"===y.dataType||"function"===y.dataType?p.settings.columns&&p.settings.columns.length?p.settings.columns.length:f.colToPropCache.length:"array"===y.dataType?p.settings.columns&&p.settings.columns.length?p.settings.columns.length:p.settings.data&&p.settings.data[0]&&p.settings.data[0].length?p.settings.data[0].length:0:void 0},this.rowOffset=function(){return y.view.wt.wtTable.getFirstRenderedRow()},this.colOffset=function(){return y.view.wt.wtTable.getFirstRenderedColumn()},this.countRenderedRows=function(){return y.view.wt.drawn?y.view.wt.wtTable.getRenderedRowsCount():-1},this.countVisibleRows=function(){return y.view.wt.drawn?y.view.wt.wtTable.getVisibleRowsCount():-1},this.countRenderedCols=function(){return y.view.wt.drawn?y.view.wt.wtTable.getRenderedColumnsCount():-1},this.countVisibleCols=function(){return y.view.wt.drawn?y.view.wt.wtTable.getVisibleColumnsCount():-1},this.countEmptyRows=function(e){for(var n,i=y.countRows()-1,o=0;i>=0;){if(n=t.hooks.run(this,"modifyRow",i),y.isEmptyRow(n))o++;else if(e)break;i--}return o},this.countEmptyCols=function(e){if(y.countRows()<1)return 0;for(var t=y.countCols()-1,n=0;t>=0;){if(y.isEmptyCol(t))n++;else if(e)break;t--}return n},this.isEmptyRow=function(e){return p.settings.isEmptyRow.call(y,e)},this.isEmptyCol=function(e){return p.settings.isEmptyCol.call(y,e)},this.selectCell=function(e,t,n,i,o){if("number"!=typeof e||0>e||e>=y.countRows())return!1;if("number"!=typeof t||0>t||t>=y.countCols())return!1;if(void 0!==n){if("number"!=typeof n||0>n||n>=y.countRows())return!1;if("number"!=typeof i||0>i||i>=y.countCols())return!1}var r=new c(e,t);return p.selRange=new d(r,r,r),document.activeElement&&document.activeElement!==document.documentElement&&document.activeElement!==document.body&&document.activeElement.blur(),y.listen(),void 0===n?v.setRangeEnd(p.selRange.from,o):v.setRangeEnd(new c(n,i),o),y.selection.finish(),!0},this.selectCellByProp=function(){return arguments[1]=f.propToCol(arguments[1]),void 0!==arguments[3]&&(arguments[3]=f.propToCol(arguments[3])),y.selectCell.apply(y,arguments)},this.deselectCell=function(){v.deselect()},this.destroy=function(){y._clearTimeouts(),y.view&&y.view.destroy(),t.Dom.empty(y.rootElement),b.clear(),t.hooks.run(y,"afterDestroy"),t.hooks.destroy(y);for(var e in y)y.hasOwnProperty(e)&&("function"==typeof y[e]?"runHooks"!==e&&(y[e]=h):"guid"!==e&&(y[e]=null));p=null,f=null,g=null,v=null,m=null,y=null,w=null},this.getActiveEditor=function(){return m.getActiveEditor()},this.getInstance=function(){return y},this.addHook=function(e,n){t.hooks.add(e,n,y)},this.addHookOnce=function(e,n){t.hooks.once(e,n,y)},this.removeHook=function(e,n){t.hooks.remove(e,n,y)},this.runHooks=function(e,n,i,o,r,a,s){return t.hooks.run(y,e,n,i,o,r,a,s)},this.timeouts=[],this._registerTimeout=function(e){this.timeouts.push(e)},this._clearTimeouts=function(){for(var e=0,t=this.timeouts.length;t>e;e++)clearTimeout(this.timeouts[e])},this.version="0.13.1"};var P=function(){};if(P.prototype={data:void 0,dataSchema:void 0,width:void 0,height:void 0,startRows:5,startCols:5,rowHeaders:null,colHeaders:null,colWidths:void 0,columns:void 0,cells:void 0,cell:[],comments:!1,customBorders:!1,minRows:0,minCols:0,maxRows:1/0,maxCols:1/0,minSpareRows:0,minSpareCols:0,allowInsertRow:!0,allowInsertColumn:!0,allowRemoveRow:!0,allowRemoveColumn:!0,multiSelect:!0,fillHandle:!0,fixedRowsTop:0,fixedColumnsLeft:0,outsideClickDeselects:!0,enterBeginsEditing:!0,enterMoves:{row:1,col:0},tabMoves:{row:0,col:1},autoWrapRow:!1,autoWrapCol:!1,copyRowsLimit:1e3,copyColsLimit:1e3,pasteMode:"overwrite",persistentState:!1,currentRowClassName:void 0,currentColClassName:void 0,stretchH:"none",isEmptyRow:function(e){for(var t,n=0,i=this.countCols();i>n;n++)if(""!==(t=this.getDataAtCell(e,n))&&null!==t&&void 0!==t)return!1;return!0},isEmptyCol:function(e){for(var t,n=0,i=this.countRows();i>n;n++)if(""!==(t=this.getDataAtCell(n,e))&&null!==t&&void 0!==t)return!1;return!0},observeDOMVisibility:!0,allowInvalid:!0,invalidCellClassName:"htInvalid",placeholder:!1,placeholderCellClassName:"htPlaceholder",readOnlyCellClassName:"htDimmed",renderer:void 0,commentedCellClassName:"htCommentCell",fragmentSelection:!1,readOnly:!1,search:!1,type:"text",copyable:!0,editor:"text",autoComplete:void 0,debug:!1,wordWrap:!0,noWordWrapClassName:"htNoWrap",contextMenu:void 0,undo:void 0,columnSorting:void 0,manualColumnMove:void 0,manualColumnResize:void 0,manualRowMove:void 0,manualRowResize:void 0,mergeCells:!1,viewportRowRenderingOffset:10,viewportColumnRenderingOffset:10,groups:void 0,validator:void 0,manualColumnFreeze:void 0,trimWhitespace:!0,settings:void 0,source:void 0,title:void 0,checkedTemplate:void 0,uncheckedTemplate:void 0,format:void 0,className:void 0},t.DefaultSettings=P,function(e){e.MultiMap||(e.MultiMap=function(){function e(e){return null!==e&&!n(e)&&("string"==typeof e||"number"==typeof e)}function t(e){return null!==e&&("object"==typeof e||"function"==typeof e)}function n(e){return e!==e}var i={arrayMap:[],weakMap:new WeakMap};return{get:function(n){return e(n)?i.arrayMap[n]:t(n)?i.weakMap.get(n):void 0},set:function(n,o){if(e(n))i.arrayMap[n]=o;else{if(!t(n))throw new Error("Invalid key type");i.weakMap.set(n,o)}},delete:function(n){e(n)?delete i.arrayMap[n]:t(n)&&i.weakMap.delete(n)}}})}(e),!e.Handsontable)t={};if(t.Dom={},t.Dom.enableImmediatePropagation=function(e){null!=e&&null==e.isImmediatePropagationEnabled&&(e.stopImmediatePropagation=function(){this.isImmediatePropagationEnabled=!1,this.cancelBubble=!0},e.isImmediatePropagationEnabled=!0,e.isImmediatePropagationStopped=function(){return!this.isImmediatePropagationEnabled})},t.Dom.closest=function(e,t,n){for(;null!=e&&e!==n;){if(1===e.nodeType&&t.indexOf(e.nodeName)>-1)return e;e=e.parentNode}return null},t.Dom.isChildOf=function(e,t){var n=e.parentNode,i=[];for("string"==typeof t?i=Array.prototype.slice.call(document.querySelectorAll(t),0):i.push(t);null!=n;){if(i.indexOf(n)>-1)return!0;n=n.parentNode}return!1},t.Dom.isChildOfWebComponentTable=function(e){function t(e){return e.nodeType===Node.ELEMENT_NODE&&e.nodeName===i.toUpperCase()}var n,i="hot-table",o=!1;for(n="undefined"==typeof wrap?e:wrap(e);null!=n;){if(t(n)){o=!0;break}if(n.host&&n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(o=t(n.host))break;n=n.host}n=n.parentNode}return o},t.Dom.index=function(e){var t=0;if(e.previousSibling)for(;e=e.previousSibling;)++t;return t},document.documentElement.classList?(t.Dom.hasClass=function(e,t){return e.classList.contains(t)},t.Dom.addClass=function(e,t){t&&e.classList.add(t)},t.Dom.removeClass=function(e,t){e.classList.remove(t)}):(t.Dom.hasClass=function(e,t){return e.className.match(new RegExp("(\\s|^)"+t+"(\\s|$)"))},t.Dom.addClass=function(e,t){""===e.className?e.className=t:this.hasClass(e,t)||(e.className+=" "+t)},t.Dom.removeClass=function(e,t){if(this.hasClass(e,t)){var n=new RegExp("(\\s|^)"+t+"(\\s|$)");e.className=e.className.replace(n," ").trim()}}),t.Dom.removeTextNodes=function(e,t){if(3===e.nodeType)t.removeChild(e);else if(["TABLE","THEAD","TBODY","TFOOT","TR"].indexOf(e.nodeName)>-1)for(var n=e.childNodes,i=n.length-1;i>=0;i--)this.removeTextNodes(n[i],e)},t.Dom.empty=function(e){for(var t;t=e.lastChild;)e.removeChild(t)},t.Dom.HTML_CHARACTERS=/(<(.*)>|&(.*);)/,t.Dom.fastInnerHTML=function(e,t){this.HTML_CHARACTERS.test(t)?e.innerHTML=t:this.fastInnerText(e,t)},t.Dom.fastInnerText=document.createTextNode("test").textContent?function(e,t){var n=e.firstChild;n&&3===n.nodeType&&null===n.nextSibling?n.textContent=t:(this.empty(e),e.appendChild(document.createTextNode(t)))}:function(e,t){var n=e.firstChild;n&&3===n.nodeType&&null===n.nextSibling?n.data=t:(this.empty(e),e.appendChild(document.createTextNode(t)))},t.Dom.isVisible=function(e){for(var n=e;function(e){return"undefined"==typeof unwrap?e:unwrap(e)}(n)!==document.documentElement;){if(null===n)return!1;if(n.nodeType===Node.DOCUMENT_FRAGMENT_NODE){if(n.host){if(n.host.impl)return t.Dom.isVisible(n.host.impl);if(n.host)return t.Dom.isVisible(n.host);throw new Error("Lost in Web Components world")}return!1}if("none"===n.style.display)return!1;n=n.parentNode}return!0},t.Dom.offset=function(t){var n,i,o,r,a;if(r=document.documentElement,this.hasCaptionProblem()&&t.firstChild&&"CAPTION"===t.firstChild.nodeName)return a=t.getBoundingClientRect(),{top:a.top+(e.pageYOffset||r.scrollTop)-(r.clientTop||0),left:a.left+(e.pageXOffset||r.scrollLeft)-(r.clientLeft||0)};for(n=t.offsetLeft,i=t.offsetTop,o=t;(t=t.offsetParent)&&t!==document.body;)n+=t.offsetLeft,i+=t.offsetTop,o=t;return o&&"fixed"===o.style.position&&(n+=e.pageXOffset||r.scrollLeft,i+=e.pageYOffset||r.scrollTop),{left:n,top:i}},t.Dom.getWindowScrollTop=function(){var t=e.scrollY;return void 0==t&&(t=document.documentElement.scrollTop),t},t.Dom.getWindowScrollLeft=function(){var t=e.scrollX;return void 0==t&&(t=document.documentElement.scrollLeft),t},t.Dom.getScrollTop=function(n){return n===e?t.Dom.getWindowScrollTop(n):n.scrollTop},t.Dom.getScrollLeft=function(n){return n===e?t.Dom.getWindowScrollLeft(n):n.scrollLeft},t.Dom.getScrollableElement=function(t){for(var n,i,o,r=t.parentNode,a=["auto","scroll"];r&&r.style;){if(n=r.style.overflow,i=r.style.overflowX,o=r.style.overflowY,"scroll"==n||"scroll"==i||"scroll"==o)return r;if(r.clientHeight<r.scrollHeight&&(-1!==a.indexOf(o)||-1!==a.indexOf(n)))return r;if(r.clientWidth<r.scrollWidth&&(-1!==a.indexOf(i)||-1!==a.indexOf(n)))return r;r=r.parentNode}return e},t.Dom.getComputedStyle=function(e){return e.currentStyle||document.defaultView.getComputedStyle(e)},t.Dom.outerWidth=function(e){return e.offsetWidth},t.Dom.outerHeight=function(e){return this.hasCaptionProblem()&&e.firstChild&&"CAPTION"===e.firstChild.nodeName?e.offsetHeight+e.firstChild.offsetHeight:e.offsetHeight},t.Dom.innerHeight=function(e){return e.clientHeight||e.innerHeight},t.Dom.innerWidth=function(e){return e.clientWidth||e.innerWidth},t.Dom.addEvent=function(t,n,i){e.addEventListener?t.addEventListener(n,i,!1):t.attachEvent("on"+n,i)},t.Dom.removeEvent=function(t,n,i){e.removeEventListener?t.removeEventListener(n,i,!1):t.detachEvent("on"+n,i)},function(){function e(){var e=document.createElement("TABLE");e.style.borderSpacing=0,e.style.borderWidth=0,e.style.padding=0;var t=document.createElement("TBODY");e.appendChild(t),t.appendChild(document.createElement("TR")),t.firstChild.appendChild(document.createElement("TD")),t.firstChild.firstChild.innerHTML="<tr><td>t<br>t</td></tr>";var n=document.createElement("CAPTION");n.innerHTML="c<br>c<br>c<br>c",n.style.padding=0,n.style.margin=0,e.insertBefore(n,t),document.body.appendChild(e),i=e.offsetHeight<2*e.lastChild.offsetHeight,document.body.removeChild(e)}function n(){var e=document.createElement("p");e.style.width="100%",e.style.height="200px";var t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.style.visibility="hidden",t.style.width="200px",t.style.height="150px",t.style.overflow="hidden",t.appendChild(e),(document.body||document.documentElement).appendChild(t);var n=e.offsetWidth;t.style.overflow="scroll";var i=e.offsetWidth;return n==i&&(i=t.clientWidth),(document.body||document.documentElement).removeChild(t),n-i}var i;t.Dom.hasCaptionProblem=function(){return void 0===i&&e(),i},t.Dom.getCaretPosition=function(e){if(e.selectionStart)return e.selectionStart;if(document.selection){e.focus();var t=document.selection.createRange();if(null==t)return 0;var n=e.createTextRange(),i=n.duplicate();return n.moveToBookmark(t.getBookmark()),i.setEndPoint("EndToStart",n),i.text.length}return 0},t.Dom.getSelectionEndPosition=function(e){if(e.selectionEnd)return e.selectionEnd;if(document.selection){var t=document.selection.createRange();return null==t?0:e.createTextRange().text.indexOf(t.text)+t.text.length}},t.Dom.setCaretPosition=function(e,t,n){if(void 0===n&&(n=t),e.setSelectionRange)e.focus(),e.setSelectionRange(t,n);else if(e.createTextRange){var i=e.createTextRange();i.collapse(!0),i.moveEnd("character",n),i.moveStart("character",t),i.select()}};var o;t.Dom.getScrollbarWidth=function(){return void 0===o&&(o=n()),o};var r=!document.createTextNode("test").textContent;t.Dom.isIE8=function(){return r};var a=!!document.documentMode;t.Dom.isIE9=function(){return a};var s=/Safari/.test(navigator.userAgent)&&/Apple Computer/.test(navigator.vendor);t.Dom.isSafari=function(){return s},t.Dom.setOverlayPosition=function(e,t,n){r||a?(e.style.top=n,e.style.left=t):s?e.style["-webkit-transform"]="translate3d("+t+","+n+",0)":e.style.transform="translate3d("+t+","+n+",0)"},t.Dom.getCssTransform=function(e){var t;return e.style.transform&&""!=(t=e.style.transform)?["transform",t]:e.style["-webkit-transform"]&&""!=(t=e.style["-webkit-transform"])?["-webkit-transform",t]:-1},t.Dom.resetCssTransform=function(e){e.transform&&""!=e.transform?e.transform="":e["-webkit-transform"]&&""!=e["-webkit-transform"]&&(e["-webkit-transform"]="")}}(),!e.Handsontable)var t={};t.countEventManagerListeners=0,t.eventManager=function(n){var i,o,r,a;if(!n)throw new Error("instance not defined");return n.eventListeners||(n.eventListeners=[]),i=function(i,r,a){var s;return s=function(e){var n,i,o=!1;if(void 0==e.target&&void 0!=e.srcElement&&(e.definePoperty?e.definePoperty("target",{value:e.srcElement}):e.target=e.srcElement),void 0==e.preventDefault&&(e.definePoperty?e.definePoperty("preventDefault",{value:function(){this.returnValue=!1}}):e.preventDefault=function(){this.returnValue=!1}),e.isTargetWebComponent=!1,t.eventManager.isHotTableEnv){for(i=(e="undefined"==typeof wrap?e:wrap(e)).path?e.path.length:0;i--;)"HOT-TABLE"===e.path[i].nodeName?o=!0:o&&e.path[i].shadowRoot&&(n=e.path[i]),0!==i||n||(n=e.path[i]);n||(n=e.target),e.isTargetWebComponent=!0,Object.defineProperty(e,"target",{get:function(){return"undefined"==typeof wrap?n:wrap(n)},enumerable:!0,configurable:!0})}a.call(this,e)},n.eventListeners.push({element:i,event:r,callback:a,callbackProxy:s}),e.addEventListener?i.addEventListener(r,s,!1):i.attachEvent("on"+r,s),t.countEventManagerListeners++,function(){o(i,r,a)}},o=function(e,i,o){for(var r,a=n.eventListeners.length;a--;)if((r=n.eventListeners[a]).event==i&&r.element==e){if(o&&o!=r.callback)continue;n.eventListeners.splice(a,1),r.element.removeEventListener?r.element.removeEventListener(r.event,r.callbackProxy,!1):r.element.detachEvent("on"+r.event,r.callbackProxy),t.countEventManagerListeners--}},r=function(){for(var e,t=n.eventListeners.length;t--;)(e=n.eventListeners[t])&&o(e.element,e.event,e.callback)},a=function(t,n){var i,o;i={bubbles:!0,cancelable:"mousemove"!==n,view:e,detail:0,screenX:0,screenY:0,clientX:1,clientY:1,ctrlKey:!1,altKey:!1,shiftKey:!1,metaKey:!1,button:0,relatedTarget:void 0},document.createEvent?(o=document.createEvent("MouseEvents")).initMouseEvent(n,i.bubbles,i.cancelable,i.view,i.detail,i.screenX,i.screenY,i.clientX,i.clientY,i.ctrlKey,i.altKey,i.shiftKey,i.metaKey,i.button,i.relatedTarget||document.body.parentNode):o=document.createEventObject(),t.dispatchEvent?t.dispatchEvent(o):t.fireEvent("on"+n,o)},{addEventListener:i,removeEventListener:o,clear:r,fireEvent:a}},t.TableView=function(n){var i=this;this.eventManager=t.eventManager(n),this.instance=n,this.settings=n.getSettings();var o=n.rootElement.getAttribute("style");o&&n.rootElement.setAttribute("data-originalstyle",o),t.Dom.addClass(n.rootElement,"handsontable");var r=document.createElement("TABLE");r.className="htCore",this.THEAD=document.createElement("THEAD"),r.appendChild(this.THEAD),this.TBODY=document.createElement("TBODY"),r.appendChild(this.TBODY),n.table=r,n.container.insertBefore(r,n.container.firstChild),this.eventManager.addEventListener(n.rootElement,"mousedown",function(t){i.isTextSelectionAllowed(t.target)||(s(),t.preventDefault(),e.focus())}),this.eventManager.addEventListener(document.documentElement,"keyup",function(e){n.selection.isInProgress()&&!e.shiftKey&&n.selection.finish()});var a;this.isMouseDown=function(){return a},this.eventManager.addEventListener(document.documentElement,"mouseup",function(e){n.selection.isInProgress()&&1===e.which&&n.selection.finish(),a=!1,t.helper.isOutsideInput(document.activeElement)&&n.unlisten()}),this.eventManager.addEventListener(document.documentElement,"mousedown",function(e){var t=e.target;if(!a){if(t!==i.instance.container)for(;t!==document.documentElement;){if(null===t){if(e.isTargetWebComponent)break;return}if(t===n.rootElement)return;t=t.parentNode}i.settings.outsideClickDeselects?n.deselectCell():n.destroyEditor()}}),this.eventManager.addEventListener(r,"selectstart",function(e){i.settings.fragmentSelection||e.preventDefault()});var s=function(){e.getSelection?e.getSelection().empty?e.getSelection().empty():e.getSelection().removeAllRanges&&e.getSelection().removeAllRanges():document.selection&&document.selection.empty()},l=[new E({className:"current",border:{width:2,color:"#5292F7",cornerVisible:function(){return i.settings.fillHandle&&!i.isCellEdited()&&!n.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return!i.isCellEdited()&&!n.selection.isMultiple()}}}),new E({className:"area",border:{width:1,color:"#89AFF9",cornerVisible:function(){return i.settings.fillHandle&&!i.isCellEdited()&&n.selection.isMultiple()},multipleSelectionHandlesVisible:function(){return!i.isCellEdited()&&n.selection.isMultiple()}}}),new E({className:"highlight",highlightRowClassName:i.settings.currentRowClassName,highlightColumnClassName:i.settings.currentColClassName}),new E({className:"fill",border:{width:1,color:"red"}})];l.current=l[0],l.area=l[1],l.highlight=l[2],l.fill=l[3];var d={debug:function(){return i.settings.debug},table:r,stretchH:this.settings.stretchH,data:n.getDataAtCell,totalRows:n.countRows,totalColumns:n.countCols,fixedColumnsLeft:function(){return i.settings.fixedColumnsLeft},fixedRowsTop:function(){return i.settings.fixedRowsTop},renderAllRows:i.settings.renderAllRows,rowHeaders:function(){var e=[];return n.hasRowHeaders()&&e.push(function(e,t){i.appendRowHeader(e,t)}),t.hooks.run(n,"afterGetRowHeaderRenderers",e),e},columnHeaders:function(){var e=[];return n.hasColHeaders()&&e.push(function(e,t){i.appendColHeader(e,t)}),t.hooks.run(n,"afterGetColumnHeaderRenderers",e),e},columnWidth:n.getColWidth,rowHeight:n.getRowHeight,cellRenderer:function(e,n,o){var r=i.instance.colToProp(n),a=i.instance.getCellMeta(e,n),s=i.instance.getCellRenderer(a),l=i.instance.getDataAtRowProp(e,r);s(i.instance,o,e,n,r,l,a),t.hooks.run(i.instance,"afterRenderer",o,e,n,r,l,a)},selections:l,hideBorderOnMouseDownOver:function(){return i.settings.fragmentSelection},onCellMouseDown:function(e,o,r,s){n.listen(),i.activeWt=s,a=!0,t.Dom.enableImmediatePropagation(e),t.hooks.run(n,"beforeOnCellMouseDown",e,o,r),e.isImmediatePropagationStopped()||(2===e.button&&n.selection.inInSelection(o)||(e.shiftKey?o.row>=0&&o.col>=0&&n.selection.setRangeEnd(o):(o.row<0||o.col<0)&&(o.row>=0||o.col>=0)?(o.row<0&&(n.selectCell(0,o.col,n.countRows()-1,o.col),n.selection.setSelectedHeaders(!1,!0)),o.col<0&&(n.selectCell(o.row,0,o.row,n.countCols()-1),n.selection.setSelectedHeaders(!0,!1))):(o.row=o.row<0?0:o.row,o.col=o.col<0?0:o.col,n.selection.setRangeStart(o))),t.hooks.run(n,"afterOnCellMouseDown",e,o,r),i.activeWt=i.wt)},onCellMouseOver:function(e,o,r,s){i.activeWt=s,o.row>=0&&o.col>=0?a&&n.selection.setRangeEnd(o):a&&(o.row<0&&(n.selection.setRangeEnd(new c(n.countRows()-1,o.col)),n.selection.setSelectedHeaders(!1,!0)),o.col<0&&(n.selection.setRangeEnd(new c(o.row,n.countCols()-1)),n.selection.setSelectedHeaders(!0,!1))),t.hooks.run(n,"afterOnCellMouseOver",e,o,r),i.activeWt=i.wt},onCellCornerMouseDown:function(e){e.preventDefault(),t.hooks.run(n,"afterOnCellCornerMouseDown",e)},beforeDraw:function(e){i.beforeRender(e)},onDraw:function(e){i.onDraw(e)},onScrollVertically:function(){n.runHooks("afterScrollVertically")},onScrollHorizontally:function(){n.runHooks("afterScrollHorizontally")},onBeforeDrawBorders:function(e,t){n.runHooks("beforeDrawBorders",e,t)},onBeforeTouchScroll:function(){n.runHooks("beforeTouchScroll")},onAfterMomentumScroll:function(){n.runHooks("afterMomentumScroll")},viewportRowCalculatorOverride:function(e){i.settings.viewportRowRenderingOffset&&(e.startRow=Math.max(e.startRow-i.settings.viewportRowRenderingOffset,0),e.endRow=Math.min(e.endRow+i.settings.viewportRowRenderingOffset,n.countRows()-1)),n.runHooks("afterViewportRowCalculatorOverride",e)},viewportColumnCalculatorOverride:function(e){i.settings.viewportColumnRenderingOffset&&(e.startColumn=Math.max(e.startColumn-i.settings.viewportColumnRenderingOffset,0),e.endColumn=Math.min(e.endColumn+i.settings.viewportColumnRenderingOffset,n.countCols()-1)),n.runHooks("afterViewportColumnCalculatorOverride",e)}};t.hooks.run(n,"beforeInitWalkontable",d),this.wt=new p(d),this.activeWt=this.wt,this.eventManager.addEventListener(i.wt.wtTable.spreader,"mousedown",function(e){e.target===i.wt.wtTable.spreader&&3===e.which&&t.helper.stopPropagation(e)}),this.eventManager.addEventListener(i.wt.wtTable.spreader,"contextmenu",function(e){e.target===i.wt.wtTable.spreader&&3===e.which&&t.helper.stopPropagation(e)}),this.eventManager.addEventListener(document.documentElement,"click",function(){i.settings.observeDOMVisibility&&i.wt.drawInterrupted&&(i.instance.forceFullRender=!0,i.render())})},t.TableView.prototype.isTextSelectionAllowed=function(e){return!!t.helper.isInput(e)||!(!this.settings.fragmentSelection||!t.Dom.isChildOf(e,this.TBODY))},t.TableView.prototype.isCellEdited=function(){var e=this.instance.getActiveEditor();return e&&e.isOpened()},t.TableView.prototype.beforeRender=function(e){e&&t.hooks.run(this.instance,"beforeRender",this.instance.forceFullRender)},t.TableView.prototype.onDraw=function(e){e&&t.hooks.run(this.instance,"afterRender",this.instance.forceFullRender)},t.TableView.prototype.render=function(){this.wt.draw(!this.instance.forceFullRender),this.instance.forceFullRender=!1},t.TableView.prototype.getCellAtCoords=function(e,t){var n=this.wt.getCell(e,t);return 0>n?null:n},t.TableView.prototype.scrollViewport=function(e){this.wt.scrollViewport(e)},t.TableView.prototype.appendRowHeader=function(e,n){var i=document.createElement("DIV"),o=document.createElement("SPAN");i.className="relative",o.className="rowHeader",e>-1?t.Dom.fastInnerHTML(o,this.instance.getRowHeader(e)):t.Dom.fastInnerText(o,String.fromCharCode(160)),i.appendChild(o),t.Dom.empty(n),n.appendChild(i),t.hooks.run(this.instance,"afterGetRowHeader",e,n)},t.TableView.prototype.appendColHeader=function(e,n){var i=document.createElement("DIV"),o=document.createElement("SPAN");i.className="relative",o.className="colHeader",e>-1?t.Dom.fastInnerHTML(o,this.instance.getColHeader(e)):(t.Dom.fastInnerText(o,String.fromCharCode(160)),t.Dom.addClass(o,"cornerHeader")),i.appendChild(o),t.Dom.empty(n),n.appendChild(i),t.hooks.run(this.instance,"afterGetColHeader",e,n)},t.TableView.prototype.maximumVisibleElementWidth=function(e){var t=this.wt.wtViewport.getWorkspaceWidth()-e;return t>0?t:0},t.TableView.prototype.maximumVisibleElementHeight=function(e){var t=this.wt.wtViewport.getWorkspaceHeight()-e;return t>0?t:0},t.TableView.prototype.mainViewIsActive=function(){return this.wt===this.activeWt},t.TableView.prototype.destroy=function(){this.wt.destroy(),this.eventManager.clear()},function(e){function t(e){var t,n;n={},t=e,this.getInstance=function(e){return e.guid in n||(n[e.guid]=new t(e)),n[e.guid]}}var n={},i=new WeakMap;e.editors={registerEditor:function(e,o){var r=new t(o);"string"==typeof e&&(n[e]=r),i.set(o,r)},getEditor:function(e,t){var o;if("function"==typeof e)i.get(e)||this.registerEditor(null,e),o=i.get(e);else{if("string"!=typeof e)throw Error('Only strings and functions can be passed as "editor" parameter ');o=n[e]}if(!o)throw Error('No editor registered under name "'+e+'"');return o.getInstance(t)}}}(t),function(e){e.EditorManager=function(t,n,i){function o(e){var t="function"==typeof n.settings.enterMoves?n.settings.enterMoves(event):n.settings.enterMoves;e?i.transformStart(-t.row,-t.col):i.transformStart(t.row,t.col,!0)}function r(e){e?i.transformEnd(-1,0):i.transformStart(-1,0)}function a(e){e?i.transformEnd(1,0):i.transformStart(1,0)}function s(e){e?i.transformEnd(0,1):i.transformStart(0,1)}function l(e){e?i.transformEnd(0,-1):i.transformStart(0,-1)}function d(d){var u,v;if(t.isListening()&&(e.hooks.run(t,"beforeKeyDown",d),!g&&(e.Dom.enableImmediatePropagation(d),!d.isImmediatePropagationStopped()&&(n.lastKeyCode=d.keyCode,i.isSelected())))){if(u=(d.ctrlKey||d.metaKey)&&!d.altKey,h&&!h.isWaiting()&&!e.helper.isMetaKey(d.keyCode)&&!u&&!p.isEditorOpened())return void p.openEditor("",d);switch(v=d.shiftKey?i.setRangeEnd:i.setRangeStart,d.keyCode){case f.A:u&&(i.selectAll(),d.preventDefault(),e.helper.stopPropagation(d));break;case f.ARROW_UP:p.isEditorOpened()&&h&&!h.isWaiting()&&p.closeEditorAndSaveChanges(u),r(d.shiftKey),d.preventDefault(),e.helper.stopPropagation(d);break;case f.ARROW_DOWN:p.isEditorOpened()&&h&&!h.isWaiting()&&p.closeEditorAndSaveChanges(u),a(d.shiftKey),d.preventDefault(),e.helper.stopPropagation(d);break;case f.ARROW_RIGHT:p.isEditorOpened()&&h&&!h.isWaiting()&&p.closeEditorAndSaveChanges(u),s(d.shiftKey),d.preventDefault(),e.helper.stopPropagation(d);break;case f.ARROW_LEFT:p.isEditorOpened()&&h&&!h.isWaiting()&&p.closeEditorAndSaveChanges(u),l(d.shiftKey),d.preventDefault(),e.helper.stopPropagation(d);break;case f.TAB:var m="function"==typeof n.settings.tabMoves?n.settings.tabMoves(d):n.settings.tabMoves;d.shiftKey?i.transformStart(-m.row,-m.col):i.transformStart(m.row,m.col,!0),d.preventDefault(),e.helper.stopPropagation(d);break;case f.BACKSPACE:case f.DELETE:i.empty(d),p.prepareEditor(),d.preventDefault();break;case f.F2:p.openEditor(null,d),d.preventDefault();break;case f.ENTER:p.isEditorOpened()?(h&&h.state!==e.EditorState.WAITING&&p.closeEditorAndSaveChanges(u),o(d.shiftKey)):t.getSettings().enterBeginsEditing?p.openEditor(null,d):o(d.shiftKey),d.preventDefault(),d.stopImmediatePropagation();break;case f.ESCAPE:p.isEditorOpened()&&p.closeEditorAndRestoreOriginalValue(u),d.preventDefault();break;case f.HOME:v(d.ctrlKey||d.metaKey?new c(0,n.selRange.from.col):new c(n.selRange.from.row,0)),d.preventDefault(),e.helper.stopPropagation(d);break;case f.END:v(d.ctrlKey||d.metaKey?new c(t.countRows()-1,n.selRange.from.col):new c(n.selRange.from.row,t.countCols()-1)),d.preventDefault(),e.helper.stopPropagation(d);break;case f.PAGE_UP:i.transformStart(-t.countVisibleRows(),0),d.preventDefault(),e.helper.stopPropagation(d);break;case f.PAGE_DOWN:i.transformStart(t.countVisibleRows(),0),d.preventDefault(),e.helper.stopPropagation(d)}}}var u,h,p=this,f=e.helper.keyCode,g=!1;u=e.eventManager(t),this.destroyEditor=function(e){this.closeEditor(e)},this.getActiveEditor=function(){return h},this.prepareEditor=function(){var i,o,r,a,s,l,c;return h&&h.isWaiting()?void this.closeEditor(!1,!1,function(e){e&&p.prepareEditor()}):(i=n.selRange.highlight.row,o=n.selRange.highlight.col,r=t.colToProp(o),a=t.getCell(i,o),s=t.getDataAtCell(i,o),l=t.getCellMeta(i,o),void((c=t.getCellEditor(l))?(h=e.editors.getEditor(c,t)).prepare(i,o,r,a,s,l):h=void 0))},this.isEditorOpened=function(){return h&&h.isOpened()},this.openEditor=function(e,t){h&&!h.cellProperties.readOnly&&h.beginEditing(e,t)},this.closeEditor=function(e,t,n){h?h.finishEditing(e,t,n):n&&n(!1)},this.closeEditorAndSaveChanges=function(e){return this.closeEditor(!1,e)},this.closeEditorAndRestoreOriginalValue=function(e){return this.closeEditor(!0,e)},function(){t.addHook("afterDocumentKeyDown",d),u.addEventListener(document.documentElement,"keydown",function(e){t.runHooks("afterDocumentKeyDown",e)}),t.view.wt.update("onCellDblClick",function(e,t,n){"TD"==n.nodeName&&p.openEditor()}),t.addHook("afterDestroy",function(){g=!0})}()}}(t),function(e){var t={};e.renderers={registerRenderer:function(e,n){t[e]=n},getRenderer:function(e){if("function"==typeof e)return e;if("string"!=typeof e)throw Error('Only strings and functions can be passed as "renderer" parameter ');if(!(e in t))throw Error('No editor registered under name "'+e+'"');return t[e]}}}(t),t.helper={},t.helper.isPrintableChar=function(e){return 32==e||e>=48&&57>=e||e>=96&&111>=e||e>=186&&192>=e||e>=219&&222>=e||e>=226||e>=65&&90>=e},t.helper.isMetaKey=function(e){var n=t.helper.keyCode;return-1!=[n.ARROW_DOWN,n.ARROW_UP,n.ARROW_LEFT,n.ARROW_RIGHT,n.HOME,n.END,n.DELETE,n.BACKSPACE,n.F1,n.F2,n.F3,n.F4,n.F5,n.F6,n.F7,n.F8,n.F9,n.F10,n.F11,n.F12,n.TAB,n.PAGE_DOWN,n.PAGE_UP,n.ENTER,n.ESCAPE,n.SHIFT,n.CAPS_LOCK,n.ALT].indexOf(e)},t.helper.isCtrlKey=function(e){var n=t.helper.keyCode;return-1!=[n.CONTROL_LEFT,224,n.COMMAND_LEFT,n.COMMAND_RIGHT].indexOf(e)},t.helper.stringify=function(e){switch(typeof e){case"string":case"number":return e+"";case"object":return null===e?"":e.toString();case"undefined":return"";default:return e.toString()}},t.helper.spreadsheetColumnLabel=function(e){for(var t,n=e+1,i="";n>0;)t=(n-1)%26,i=String.fromCharCode(65+t)+i,n=parseInt((n-t)/26,10);return i},t.helper.createSpreadsheetData=function(e,n){e="number"==typeof e?e:100,n="number"==typeof n?n:4;var i,o,r=[];for(i=0;e>i;i++){var a=[];for(o=0;n>o;o++)a.push(t.helper.spreadsheetColumnLabel(o)+(i+1));r.push(a)}return r},t.helper.createSpreadsheetObjectData=function(e,n){e="number"==typeof e?e:100,n="number"==typeof n?n:4;var i,o,r=[];for(i=0;e>i;i++){var a={};for(o=0;n>o;o++)a["prop"+o]=t.helper.spreadsheetColumnLabel(o)+(i+1);r.push(a)}return r},t.helper.isNumeric=function(e){var t=typeof e;return"number"==t?!isNaN(e)&&isFinite(e):"string"==t?!!e.length&&(1==e.length?/\d/.test(e):/^\s*[+-]?\s*(?:(?:\d+(?:\.\d+)?(?:e[+-]?\d+)?)|(?:0x[a-f\d]+))\s*$/i.test(e)):"object"==t&&!(!e||"number"!=typeof e.valueOf()||e instanceof Date)},t.helper.randomString=function(){return v()},t.helper.inherit=function(e,t){return t.prototype.constructor=t,e.prototype=new t,e.prototype.constructor=e,e},t.helper.extend=function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])},t.helper.deepExtend=function(e,n){for(var i in n)n.hasOwnProperty(i)&&(n[i]&&"object"==typeof n[i]?(e[i]||(e[i]=Array.isArray(n[i])?[]:{}),t.helper.deepExtend(e[i],n[i])):e[i]=n[i])},t.helper.deepClone=function(e){return"object"==typeof e?JSON.parse(JSON.stringify(e)):e},t.helper.getPrototypeOf=function(e){var t;if("object"==typeof e.__proto__)t=e.__proto__;else{var n,i=e.constructor;"function"==typeof e.constructor&&(n=i,delete e.constructor&&(i=e.constructor,e.constructor=n)),t=i?i.prototype:null}return t},t.helper.columnFactory=function(e,n){function i(){}t.helper.inherit(i,e);for(var o=0,r=n.length;r>o;o++)i.prototype[n[o]]=void 0;return i},t.helper.translateRowsToColumns=function(e){var t,n,i,o,r=[],a=0;for(t=0,n=e.length;n>t;t++)for(i=0,o=e[t].length;o>i;i++)i==a&&(r.push([]),a++),r[i].push(e[t][i]);return r},t.helper.to2dArray=function(e){for(var t=0,n=e.length;n>t;)e[t]=[e[t]],t++},t.helper.extendArray=function(e,t){for(var n=0,i=t.length;i>n;)e.push(t[n]),n++},t.helper.isInput=function(e){return["INPUT","SELECT","TEXTAREA"].indexOf(e.nodeName)>-1},t.helper.isOutsideInput=function(e){return t.helper.isInput(e)&&-1==e.className.indexOf("handsontableInput")},t.helper.keyCode={MOUSE_LEFT:1,MOUSE_RIGHT:3,MOUSE_MIDDLE:2,BACKSPACE:8,COMMA:188,INSERT:45,DELETE:46,END:35,ENTER:13,ESCAPE:27,CONTROL_LEFT:91,COMMAND_LEFT:17,COMMAND_RIGHT:93,ALT:18,HOME:36,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,SPACE:32,SHIFT:16,CAPS_LOCK:20,TAB:9,ARROW_RIGHT:39,ARROW_LEFT:37,ARROW_UP:38,ARROW_DOWN:40,F1:112,F2:113,F3:114,F4:115,F5:116,F6:117,F7:118,F8:119,F9:120,F10:121,F11:122,F12:123,A:65,X:88,C:67,V:86},t.helper.isObject=function(e){return"[object Object]"==Object.prototype.toString.call(e)},t.helper.pivot=function(e){var t=[];if(!e||0===e.length||!e[0]||0===e[0].length)return t;for(var n=e.length,i=e[0].length,o=0;n>o;o++)for(var r=0;i>r;r++)t[r]||(t[r]=[]),t[r][o]=e[o][r];return t},t.helper.proxy=function(e,t){return function(){return e.apply(t,arguments)}},t.helper.cellMethodLookupFactory=function(e,n){function i(e){var n=t.cellTypes[e];if(void 0===n)throw new Error('You declared cell type "'+e+'" as a string that is not mapped to a known object. Cell type must be an object or a string mapped to an object in Handsontable.cellTypes');return n}return n=void 0===n||n,function(o,r){return function o(r){if(r){if(r.hasOwnProperty(e)&&void 0!==r[e])return r[e];if(r.hasOwnProperty("type")&&r.type){var a;if("string"!=typeof r.type)throw new Error("Cell type must be a string ");if((a=i(r.type)).hasOwnProperty(e))return a[e];if(n)return}return o(t.helper.getPrototypeOf(r))}}("number"==typeof o?this.getCellMeta(o,r):o)}},t.helper.isMobileBrowser=function(e){return e||(e=navigator.userAgent),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(e)},t.helper.isTouchSupported=function(){return"ontouchstart"in e},t.helper.stopPropagation=function(e){"function"==typeof e.stopPropagation?e.stopPropagation():e.cancelBubble=!0},t.helper.pageX=function(e){if(e.pageX)return e.pageX;var n=t.Dom.getWindowScrollLeft();return e.clientX+n},t.helper.pageY=function(e){if(e.pageY)return e.pageY;var n=t.Dom.getWindowScrollTop();return e.clientY+n},function(e){e.DataMap=function(e,t,n){this.instance=e,this.priv=t,this.GridSettings=n,this.dataSource=this.instance.getSettings().data,this.duckSchema=this.dataSource[0]?this.recursiveDuckSchema(this.dataSource[0]):{},this.createMap()},e.DataMap.prototype.DESTINATION_RENDERER=1,e.DataMap.prototype.DESTINATION_CLIPBOARD_GENERATOR=2,e.DataMap.prototype.recursiveDuckSchema=function(e){var t;if(Array.isArray(e))t=[];else{t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]="object"!=typeof e[n]||Array.isArray(e[n])?null:this.recursiveDuckSchema(e[n]))}return t},e.DataMap.prototype.recursiveDuckColumns=function(e,t,n){var i,o;if(void 0===t&&(t=0,n=""),"object"==typeof e&&!Array.isArray(e))for(o in e)e.hasOwnProperty(o)&&(null===e[o]?(i=n+o,this.colToPropCache.push(i),this.propToColCache.set(i,t),t++):t=this.recursiveDuckColumns(e[o],t,o+"."));return t},e.DataMap.prototype.createMap=function(){var e,t,n=this.getSchema();if(void 0===n)throw new Error("trying to create `columns` definition but you didnt' provide `schema` nor `data`");this.colToPropCache=[],this.propToColCache=new MultiMap;var i=this.instance.getSettings().columns;if(i)for(e=0,t=i.length;t>e;e++)void 0!==i[e].data&&(this.colToPropCache[e]=i[e].data,this.propToColCache.set(i[e].data,e));else this.recursiveDuckColumns(n)},e.DataMap.prototype.colToProp=function(t){return t=e.hooks.run(this.instance,"modifyCol",t),this.colToPropCache&&void 0!==this.colToPropCache[t]?this.colToPropCache[t]:t},e.DataMap.prototype.propToCol=function(t){var n;return n=void 0!==this.propToColCache.get(t)?this.propToColCache.get(t):t,n=e.hooks.run(this.instance,"modifyCol",n)},e.DataMap.prototype.getSchema=function(){var e=this.instance.getSettings().dataSchema;return e?"function"==typeof e?e():e:this.duckSchema},e.DataMap.prototype.createRow=function(t,n,i){var o,r=this.instance.countCols(),a=0;n||(n=1),("number"!=typeof t||t>=this.instance.countRows())&&(t=this.instance.countRows());for(var s=this.instance.getSettings().maxRows;n>a&&this.instance.countRows()<s;){if("array"===this.instance.dataType){o=[];for(var l=0;r>l;l++)o.push(null)}else"function"===this.instance.dataType?o=this.instance.getSettings().dataSchema(t):(o={},e.helper.deepExtend(o,this.getSchema()));t===this.instance.countRows()?this.dataSource.push(o):this.dataSource.splice(t,0,o),a++,0}return e.hooks.run(this.instance,"afterCreateRow",t,a,i),this.instance.forceFullRender=!0,a},e.DataMap.prototype.createCol=function(t,n,i){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("Cannot create new column. When data source in an object, you can only have as much columns as defined in first data row, data schema or in the 'columns' setting.If you want to be able to add new columns, you have to use array datasource.");var o,r,a=this.instance.countRows(),s=this.dataSource,l=0;n||(n=1),r=t;for(var c=this.instance.getSettings().maxCols;n>l&&this.instance.countCols()<c;){if(o=e.helper.columnFactory(this.GridSettings,this.priv.columnsSettingConflicts),"number"!=typeof t||t>=this.instance.countCols()){for(d=0;a>d;d++)void 0===s[d]&&(s[d]=[]),s[d].push(null);this.priv.columnSettings.push(o)}else{for(var d=0;a>d;d++)s[d].splice(r,0,null);this.priv.columnSettings.splice(r,0,o)}l++,r++}return e.hooks.run(this.instance,"afterCreateCol",t,l,i),this.instance.forceFullRender=!0,l},e.DataMap.prototype.removeRow=function(t,n){n||(n=1),"number"!=typeof t&&(t=-n),t=(this.instance.countRows()+t)%this.instance.countRows();var i=this.physicalRowsToLogical(t,n);if(!1!==e.hooks.run(this.instance,"beforeRemoveRow",t,n)){var o=this.dataSource,r=o.filter(function(e,t){return-1==i.indexOf(t)});o.length=0,Array.prototype.push.apply(o,r),e.hooks.run(this.instance,"afterRemoveRow",t,n),this.instance.forceFullRender=!0}},e.DataMap.prototype.removeCol=function(t,n){if("object"===this.instance.dataType||this.instance.getSettings().columns)throw new Error("cannot remove column with object data source or columns option specified");if(n||(n=1),"number"!=typeof t&&(t=-n),t=(this.instance.countCols()+t)%this.instance.countCols(),!1!==e.hooks.run(this.instance,"beforeRemoveCol",t,n)){for(var i=this.dataSource,o=0,r=this.instance.countRows();r>o;o++)i[o].splice(t,n);this.priv.columnSettings.splice(t,n),e.hooks.run(this.instance,"afterRemoveCol",t,n),this.instance.forceFullRender=!0}},e.DataMap.prototype.spliceCol=function(t,n,i){var o=4<=arguments.length?[].slice.call(arguments,3):[],r=this.instance.getDataAtCol(t),a=r.slice(n,n+i),s=r.slice(n+i);e.helper.extendArray(o,s);for(var l=0;i>l;)o.push(null),l++;return e.helper.to2dArray(o),this.instance.populateFromArray(n,t,o,null,null,"spliceCol"),a},e.DataMap.prototype.spliceRow=function(t,n,i){var o=4<=arguments.length?[].slice.call(arguments,3):[],r=this.instance.getSourceDataAtRow(t),a=r.slice(n,n+i),s=r.slice(n+i);e.helper.extendArray(o,s);for(var l=0;i>l;)o.push(null),l++;return this.instance.populateFromArray(t,n,[o],null,null,"spliceRow"),a},e.DataMap.prototype.get=function(t,n){if(t=e.hooks.run(this.instance,"modifyRow",t),"string"==typeof n&&n.indexOf(".")>-1){var i=n.split("."),o=this.dataSource[t];if(!o)return null;for(var r=0,a=i.length;a>r;r++)if(void 0===(o=o[i[r]]))return null;return o}return"function"==typeof n?n(this.dataSource.slice(t,t+1)[0]):this.dataSource[t]?this.dataSource[t][n]:null};var t=e.helper.cellMethodLookupFactory("copyable",!1);e.DataMap.prototype.getCopyable=function(e,n){return t.call(this.instance,e,this.propToCol(n))?this.get(e,n):""},e.DataMap.prototype.set=function(t,n,i,o){if(t=e.hooks.run(this.instance,"modifyRow",t,o||"datamapGet"),"string"==typeof n&&n.indexOf(".")>-1){for(var r=n.split("."),a=this.dataSource[t],s=0,l=r.length-1;l>s;s++)void 0===a[r[s]]&&(a[r[s]]={}),a=a[r[s]];a[r[s]]=i}else"function"==typeof n?n(this.dataSource.slice(t,t+1)[0],i):this.dataSource[t][n]=i},e.DataMap.prototype.physicalRowsToLogical=function(t,n){for(var i,o=this.instance.countRows(),r=(o+t)%o,a=[],s=n;o>r&&s;)i=e.hooks.run(this.instance,"modifyRow",r),a.push(i),s--,r++;return a},e.DataMap.prototype.clear=function(){for(var e=0;e<this.instance.countRows();e++)for(var t=0;t<this.instance.countCols();t++)this.set(e,this.colToProp(t),"")},e.DataMap.prototype.getAll=function(){return this.dataSource},e.DataMap.prototype.getRange=function(e,t,n){var i,o,r,a,s,l=[],c=n===this.DESTINATION_CLIPBOARD_GENERATOR?this.getCopyable:this.get;for(o=Math.max(e.row,t.row),a=Math.max(e.col,t.col),i=Math.min(e.row,t.row);o>=i;i++){for(s=[],r=Math.min(e.col,t.col);a>=r;r++)s.push(c.call(this,i,this.colToProp(r)));l.push(s)}return l},e.DataMap.prototype.getText=function(e,t){return SheetClip.stringify(this.getRange(e,t,this.DESTINATION_RENDERER))},e.DataMap.prototype.getCopyableText=function(e,t){return SheetClip.stringify(this.getRange(e,t,this.DESTINATION_CLIPBOARD_GENERATOR))}}(t),function(e){e.renderers.cellDecorator=function(t,n,i,o,r,a,s){s.className&&(n.className=n.className?n.className+" "+s.className:s.className),s.readOnly&&e.Dom.addClass(n,s.readOnlyCellClassName),!1===s.valid&&s.invalidCellClassName?e.Dom.addClass(n,s.invalidCellClassName):e.Dom.removeClass(n,s.invalidCellClassName),!1===s.wordWrap&&s.noWordWrapClassName&&e.Dom.addClass(n,s.noWordWrapClassName),!a&&s.placeholder&&e.Dom.addClass(n,s.placeholderCellClassName)}}(t),function(e){var t=function(t,n,i,o,r,a,s){e.renderers.cellDecorator.apply(this,arguments),!a&&s.placeholder&&(a=s.placeholder);var l=e.helper.stringify(a);if(t.getSettings().trimWhitespace||(l=l.replace(/ /g,String.fromCharCode(160))),s.rendererTemplate){e.Dom.empty(n);var c=document.createElement("TEMPLATE");c.setAttribute("bind","{{}}"),c.innerHTML=s.rendererTemplate,HTMLTemplateElement.decorate(c),c.model=t.getSourceDataAtRow(i),n.appendChild(c)}else e.Dom.fastInnerText(n,l)};e.renderers.TextRenderer=t,e.renderers.registerRenderer("text",t)}(t),function(e){var t=document.createElement("DIV");t.className="htAutocompleteWrapper";var n=document.createElement("DIV");n.className="htAutocompleteArrow",n.appendChild(document.createTextNode(String.fromCharCode(9660)));var i=function(i,o,r,a,s,l,d){var u=(t.cloneNode(!0),n.cloneNode(!0));if(e.renderers.TextRenderer(i,o,r,a,s,l,d),o.appendChild(u),e.Dom.addClass(o,"htAutocomplete"),o.firstChild||o.appendChild(document.createTextNode(String.fromCharCode(160))),!i.acArrowListener){var h=e.eventManager(i);i.acArrowListener=function(t){e.Dom.hasClass(t.target,"htAutocompleteArrow")&&i.view.wt.getSetting("onCellDblClick",null,new c(r,a),o)},h.addEventListener(i.rootElement,"mousedown",i.acArrowListener),i.addHookOnce("afterDestroy",function(){h.clear()})}};e.AutocompleteRenderer=i,e.renderers.AutocompleteRenderer=i,e.renderers.registerRenderer("autocomplete",i)}(t),function(e){var t=document.createElement("INPUT");t.className="htCheckboxRendererInput",t.type="checkbox",t.setAttribute("autocomplete","off");var n=function(n,i,o,r,a,s,l){var c=e.eventManager(n);void 0===l.checkedTemplate&&(l.checkedTemplate=!0),void 0===l.uncheckedTemplate&&(l.uncheckedTemplate=!1),e.Dom.empty(i);var d=t.cloneNode(!1);s===l.checkedTemplate||s===e.helper.stringify(l.checkedTemplate)?(d.checked=!0,i.appendChild(d)):s===l.uncheckedTemplate||s===e.helper.stringify(l.uncheckedTemplate)?i.appendChild(d):null===s?(d.className+=" noValue",i.appendChild(d)):e.Dom.fastInnerText(i,"#bad value#"),l.readOnly?c.addEventListener(d,"click",function(e){e.preventDefault()}):(c.addEventListener(d,"mousedown",function(t){e.helper.stopPropagation(t)}),c.addEventListener(d,"mouseup",function(t){e.helper.stopPropagation(t)}),c.addEventListener(d,"change",function(){this.checked?n.setDataAtRowProp(o,a,l.checkedTemplate):n.setDataAtRowProp(o,a,l.uncheckedTemplate)})),n.CheckboxRenderer&&n.CheckboxRenderer.beforeKeyDownHookBound||(n.CheckboxRenderer={beforeKeyDownHookBound:!0},n.addHook("beforeKeyDown",function(t){if(e.Dom.enableImmediatePropagation(t),t.keyCode==e.helper.keyCode.SPACE||t.keyCode==e.helper.keyCode.ENTER)for(var i,o,r,a=n.getSelectedRange(),s=a.getTopLeftCorner(),l=a.getBottomRightCorner(),d=s.row;d<=l.row;d++)for(var u=s.col;u<=l.col;u++)if(i=n.getCell(d,u),r=n.getCellMeta(d,u),(o=i.querySelectorAll("input[type=checkbox]")).length>0&&!r.readOnly){t.isImmediatePropagationStopped()||(t.stopImmediatePropagation(),t.preventDefault());for(var h=0,p=o.length;p>h;h++)o[h].checked=!o[h].checked,c.fireEvent(o[h],"change")}}))};e.CheckboxRenderer=n,e.renderers.CheckboxRenderer=n,e.renderers.registerRenderer("checkbox",n)}(t),function(e){var t=function(t,n,i,o,r,a,s){e.helper.isNumeric(a)&&(void 0!==s.language&&numeral.language(s.language),a=numeral(a).format(s.format||"0"),e.Dom.addClass(n,"htNumeric")),e.renderers.TextRenderer(t,n,i,o,r,a,s)};e.NumericRenderer=t,e.renderers.NumericRenderer=t,e.renderers.registerRenderer("numeric",t)}(t),function(e){var t=function(t,n,i,o,r,a,s){e.renderers.TextRenderer.apply(this,arguments),a=n.innerHTML;var l,c=s.hashLength||a.length,d=s.hashSymbol||"*";for(l="";l.split(d).length-1<c;l+=d);e.Dom.fastInnerHTML(n,l)};e.PasswordRenderer=t,e.renderers.PasswordRenderer=t,e.renderers.registerRenderer("password",t)}(t),function(e){function t(t,n,i,o,r,a){e.renderers.cellDecorator.apply(this,arguments),e.Dom.fastInnerHTML(n,a)}e.renderers.registerRenderer("html",t),e.renderers.HtmlRenderer=t}(t),function(e){function t(t){this.instance=t,this.state=e.EditorState.VIRGIN,this._opened=!1,this._closeCallback=null,this.init()}e.EditorState={VIRGIN:"STATE_VIRGIN",EDITING:"STATE_EDITING",WAITING:"STATE_WAITING",FINISHED:"STATE_FINISHED"},t.prototype._fireCallbacks=function(e){this._closeCallback&&(this._closeCallback(e),this._closeCallback=null)},t.prototype.init=function(){},t.prototype.getValue=function(){throw Error("Editor getValue() method unimplemented")},t.prototype.setValue=function(){throw Error("Editor setValue() method unimplemented")},t.prototype.open=function(){throw Error("Editor open() method unimplemented")},t.prototype.close=function(){throw Error("Editor close() method unimplemented")},t.prototype.prepare=function(t,n,i,o,r,a){this.TD=o,this.row=t,this.col=n,this.prop=i,this.originalValue=r,this.cellProperties=a,this.state=e.EditorState.VIRGIN},t.prototype.extend=function(){var e=this.constructor;return function(e,t){function n(){}return n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e,e}(function(){e.apply(this,arguments)},e)},t.prototype.saveValue=function(e,t){var n,i;t?((n=this.instance.getSelected())[0]>n[2]&&(i=n[0],n[0]=n[2],n[2]=i),n[1]>n[3]&&(i=n[1],n[1]=n[3],n[3]=i),this.instance.populateFromArray(n[0],n[1],e,n[2],n[3],"edit")):this.instance.populateFromArray(this.row,this.col,e,null,null,"edit")},t.prototype.beginEditing=function(t,n){this.state==e.EditorState.VIRGIN&&(this.instance.view.scrollViewport(new c(this.row,this.col)),this.instance.view.render(),this.state=e.EditorState.EDITING,t="string"==typeof t?t:this.originalValue,this.setValue(e.helper.stringify(t)),this.open(n),this._opened=!0,this.focus(),this.instance.view.render())},t.prototype.finishEditing=function(t,n,i){var o,r=this;if(i){var a=this._closeCallback;this._closeCallback=function(e){a&&a(e),i(e)}}if(!this.isWaiting()){if(this.state==e.EditorState.VIRGIN)return void this.instance._registerTimeout(setTimeout(function(){r._fireCallbacks(!0)},0));if(this.state==e.EditorState.EDITING){if(t)return this.cancelChanges(),void this.instance.view.render();o=this.instance.getSettings().trimWhitespace?[["string"==typeof this.getValue()?String.prototype.trim.call(this.getValue()||""):this.getValue()]]:[[this.getValue()]],this.state=e.EditorState.WAITING,this.saveValue(o,n),this.instance.getCellValidator(this.cellProperties)?this.instance.addHookOnce("postAfterValidate",function(t){r.state=e.EditorState.FINISHED,r.discardEditor(t)}):(this.state=e.EditorState.FINISHED,this.discardEditor(!0))}}},t.prototype.cancelChanges=function(){this.state=e.EditorState.FINISHED,this.discardEditor()},t.prototype.discardEditor=function(t){this.state===e.EditorState.FINISHED&&(!1===t&&!0!==this.cellProperties.allowInvalid?(this.instance.selectCell(this.row,this.col),this.focus(),this.state=e.EditorState.EDITING,this._fireCallbacks(!1)):(this.close(),this._opened=!1,this.state=e.EditorState.VIRGIN,this._fireCallbacks(!0)))},t.prototype.isOpened=function(){return this._opened},t.prototype.isWaiting=function(){return this.state===e.EditorState.WAITING},e.editors.BaseEditor=t}(t),function(e){var t=e.editors.BaseEditor.prototype.extend();t.prototype.init=function(){var t=this;this.createElements(),this.eventManager=new e.eventManager(this),this.bindEvents(),this.autoResize=M(),this.instance.addHook("afterDestroy",function(){t.destroy()})},t.prototype.getValue=function(){return this.TEXTAREA.value},t.prototype.setValue=function(e){this.TEXTAREA.value=e};var n=function(t){var n,i,o=this.getActiveEditor();if(n=e.helper.keyCode,i=(t.ctrlKey||t.metaKey)&&!t.altKey,e.Dom.enableImmediatePropagation(t),t.target===o.TEXTAREA&&!t.isImmediatePropagationStopped()){if(17===t.keyCode||224===t.keyCode||91===t.keyCode||93===t.keyCode)return void t.stopImmediatePropagation();switch(t.keyCode){case n.ARROW_RIGHT:e.Dom.getCaretPosition(o.TEXTAREA)!==o.TEXTAREA.value.length&&t.stopImmediatePropagation();break;case n.ARROW_LEFT:0!==e.Dom.getCaretPosition(o.TEXTAREA)&&t.stopImmediatePropagation();break;case n.ENTER:var r=o.instance.getSelected(),a=!(r[0]===r[2]&&r[1]===r[3]);if(i&&!a||t.altKey){if(o.isOpened()){var s=e.Dom.getCaretPosition(o.TEXTAREA),l=o.getValue(),c=l.slice(0,s)+"\n"+l.slice(s);o.setValue(c),e.Dom.setCaretPosition(o.TEXTAREA,s+1)}else o.beginEditing(o.originalValue+"\n");t.stopImmediatePropagation()}t.preventDefault();break;case n.A:case n.X:case n.C:case n.V:i&&t.stopImmediatePropagation();break;case n.BACKSPACE:case n.DELETE:case n.HOME:case n.END:t.stopImmediatePropagation()}o.autoResize.resize(String.fromCharCode(t.keyCode))}};t.prototype.open=function(){this.refreshDimensions(),this.instance.addHook("beforeKeyDown",n)},t.prototype.close=function(){this.textareaParentStyle.display="none",this.autoResize.unObserve(),document.activeElement===this.TEXTAREA&&this.instance.listen(),this.instance.removeHook("beforeKeyDown",n)},t.prototype.focus=function(){this.TEXTAREA.focus(),e.Dom.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)},t.prototype.createElements=function(){this.TEXTAREA=document.createElement("TEXTAREA"),e.Dom.addClass(this.TEXTAREA,"handsontableInput"),this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,this.TEXTAREA_PARENT=document.createElement("DIV"),e.Dom.addClass(this.TEXTAREA_PARENT,"handsontableInputHolder"),this.textareaParentStyle=this.TEXTAREA_PARENT.style,this.textareaParentStyle.top=0,this.textareaParentStyle.left=0,this.textareaParentStyle.display="none",this.TEXTAREA_PARENT.appendChild(this.TEXTAREA),this.instance.rootElement.appendChild(this.TEXTAREA_PARENT);var t=this;this.instance._registerTimeout(setTimeout(function(){t.refreshDimensions()},0))},t.prototype.checkEditorSection=function(){return this.row<this.instance.getSettings().fixedRowsTop?this.col<this.instance.getSettings().fixedColumnsLeft?"corner":"top":this.col<this.instance.getSettings().fixedColumnsLeft?"left":void 0},t.prototype.getEditedCell=function(){var e;switch(this.checkEditorSection()){case"top":e=this.instance.view.wt.wtScrollbars.vertical.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=101;break;case"corner":e=this.instance.view.wt.wtScrollbars.corner.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=103;break;case"left":e=this.instance.view.wt.wtScrollbars.horizontal.clone.wtTable.getCell({row:this.row,col:this.col}),this.textareaParentStyle.zIndex=102;break;default:e=this.instance.getCell(this.row,this.col),this.textareaParentStyle.zIndex=""}return-1!=e&&-2!=e?e:void 0},t.prototype.refreshDimensions=function(){if(this.state===e.EditorState.EDITING&&(this.TD=this.getEditedCell(),this.TD)){var t,n=e.Dom.offset(this.TD),i=e.Dom.offset(this.instance.rootElement),o=n.top-i.top-1,r=n.left-i.left-1,a=this.instance.getSettings(),s=a.rowHeaders?1:0,l=a.colHeaders?1:0;switch(this.checkEditorSection()){case"top":t=e.Dom.getCssTransform(this.instance.view.wt.wtScrollbars.vertical.clone.wtTable.holder.parentNode);break;case"left":t=e.Dom.getCssTransform(this.instance.view.wt.wtScrollbars.horizontal.clone.wtTable.holder.parentNode);break;case"corner":t=e.Dom.getCssTransform(this.instance.view.wt.wtScrollbars.corner.clone.wtTable.holder.parentNode)}0>o&&(o=0),0>r&&(r=0),l&&0===this.instance.getSelected()[0]&&(o+=1),t&&-1!=t?this.textareaParentStyle[t[0]]=t[1]:e.Dom.resetCssTransform(this.textareaParentStyle),this.textareaParentStyle.top=o+"px",this.textareaParentStyle.left=r+"px";var c=this.TD.offsetTop-this.instance.view.wt.wtScrollbars.vertical.getScrollPosition(),d=this.TD.offsetLeft-this.instance.view.wt.wtScrollbars.horizontal.getScrollPosition(),u=e.Dom.innerWidth(this.TD)-8,h=this.instance.view.maximumVisibleElementWidth(d)-8,p=this.TD.scrollHeight+1,f=this.instance.view.maximumVisibleElementHeight(c)-2;parseInt(this.TD.style.borderTopWidth,10)>0&&(p-=1),parseInt(this.TD.style.borderLeftWidth,10)>0&&s>0&&(u-=1),this.TEXTAREA.style.fontSize=e.Dom.getComputedStyle(this.TD).fontSize,this.TEXTAREA.style.fontFamily=e.Dom.getComputedStyle(this.TD).fontFamily,this.autoResize.init(this.TEXTAREA,{minHeight:Math.min(p,f),maxHeight:f,minWidth:Math.min(u,h),maxWidth:h},!0),this.textareaParentStyle.display="block"}},t.prototype.bindEvents=function(){var t=this;this.eventManager.addEventListener(this.TEXTAREA,"cut",function(t){e.helper.stopPropagation(t)}),this.eventManager.addEventListener(this.TEXTAREA,"paste",function(t){e.helper.stopPropagation(t)}),this.instance.addHook("afterScrollVertically",function(){t.refreshDimensions()}),this.instance.addHook("afterColumnResize",function(){t.refreshDimensions(),t.focus()}),this.instance.addHook("afterRowResize",function(){t.refreshDimensions(),t.focus()}),this.instance.addHook("afterDestroy",function(){t.eventManager.clear()})},t.prototype.destroy=function(){this.eventManager.clear()},e.editors.TextEditor=t,e.editors.registerEditor("text",e.editors.TextEditor)}(t),function(t){var n=t.editors.BaseEditor.prototype.extend(),i={},o=function(){this.controls={},this.controls.leftButton=document.createElement("DIV"),this.controls.leftButton.className="leftButton",this.controls.rightButton=document.createElement("DIV"),this.controls.rightButton.className="rightButton",this.controls.upButton=document.createElement("DIV"),this.controls.upButton.className="upButton",this.controls.downButton=document.createElement("DIV"),this.controls.downButton.className="downButton";for(var e in this.controls)this.controls.hasOwnProperty(e)&&this.positionControls.appendChild(this.controls[e])};n.prototype.valueChanged=function(){return this.initValue!=this.getValue()},n.prototype.init=function(){var e=this;this.eventManager=new t.eventManager(this.instance),this.createElements(),this.bindEvents(),this.instance.addHook("afterDestroy",function(){e.destroy()})},n.prototype.getValue=function(){return this.TEXTAREA.value},n.prototype.setValue=function(e){this.initValue=e,this.TEXTAREA.value=e},n.prototype.createElements=function(){this.editorContainer=document.createElement("DIV"),this.editorContainer.className="htMobileEditorContainer",this.cellPointer=document.createElement("DIV"),this.cellPointer.className="cellPointer",this.moveHandle=document.createElement("DIV"),this.moveHandle.className="moveHandle",this.inputPane=document.createElement("DIV"),this.inputPane.className="inputs",this.positionControls=document.createElement("DIV"),this.positionControls.className="positionControls",this.TEXTAREA=document.createElement("TEXTAREA"),t.Dom.addClass(this.TEXTAREA,"handsontableInput"),this.inputPane.appendChild(this.TEXTAREA),this.editorContainer.appendChild(this.cellPointer),this.editorContainer.appendChild(this.moveHandle),this.editorContainer.appendChild(this.inputPane),this.editorContainer.appendChild(this.positionControls),o.call(this),document.body.appendChild(this.editorContainer)},n.prototype.onBeforeKeyDown=function(e){var n=this.getActiveEditor();if(t.Dom.enableImmediatePropagation(e),e.target===n.TEXTAREA&&!e.isImmediatePropagationStopped()){var i=t.helper.keyCode;switch(e.keyCode){case i.ENTER:n.close(),e.preventDefault();break;case i.BACKSPACE:e.stopImmediatePropagation()}}},n.prototype.open=function(){this.instance.addHook("beforeKeyDown",this.onBeforeKeyDown),t.Dom.addClass(this.editorContainer,"active"),t.Dom.removeClass(this.cellPointer,"hidden"),this.updateEditorPosition()},n.prototype.focus=function(){this.TEXTAREA.focus(),t.Dom.setCaretPosition(this.TEXTAREA,this.TEXTAREA.value.length)},n.prototype.close=function(){this.TEXTAREA.blur(),this.instance.removeHook("beforeKeyDown",this.onBeforeKeyDown),t.Dom.removeClass(this.editorContainer,"active")},n.prototype.scrollToView=function(){var e=this.instance.getSelectedRange().highlight;this.instance.view.scrollViewport(e)},n.prototype.hideCellPointer=function(){t.Dom.hasClass(this.cellPointer,"hidden")||t.Dom.addClass(this.cellPointer,"hidden")},n.prototype.updateEditorPosition=function(n,o){if(n&&o)n=parseInt(n,10),o=parseInt(o,10),this.editorContainer.style.top=o+"px",this.editorContainer.style.left=n+"px";else{var r=this.instance.getSelected(),a=this.instance.getCell(r[0],r[1]);if(i.cellPointer||(i.cellPointer={height:t.Dom.outerHeight(this.cellPointer),width:t.Dom.outerWidth(this.cellPointer)}),i.editorContainer||(i.editorContainer={width:t.Dom.outerWidth(this.editorContainer)}),void 0!==a){var s=this.instance.view.wt.wtScrollbars.horizontal.scrollHandler==e?0:t.Dom.getScrollLeft(this.instance.view.wt.wtScrollbars.horizontal.scrollHandler),l=this.instance.view.wt.wtScrollbars.vertical.scrollHandler==e?0:t.Dom.getScrollTop(this.instance.view.wt.wtScrollbars.vertical.scrollHandler),c=t.Dom.offset(a),d=t.Dom.outerWidth(a),u={x:s,y:l};this.editorContainer.style.top=parseInt(c.top+t.Dom.outerHeight(a)-u.y+i.cellPointer.height,10)+"px",this.editorContainer.style.left=parseInt(e.innerWidth/2-i.editorContainer.width/2,10)+"px",c.left+d/2>parseInt(this.editorContainer.style.left,10)+i.editorContainer.width?this.editorContainer.style.left=e.innerWidth-i.editorContainer.width+"px":c.left+d/2<parseInt(this.editorContainer.style.left,10)+20&&(this.editorContainer.style.left="0px"),this.cellPointer.style.left=parseInt(c.left-i.cellPointer.width/2-t.Dom.offset(this.editorContainer).left+d/2-u.x,10)+"px"}}},n.prototype.updateEditorData=function(){var e=this.instance.getSelected(),t=this.instance.getDataAtCell(e[0],e[1]);this.row=e[0],this.col=e[1],this.setValue(t),this.updateEditorPosition()},n.prototype.prepareAndSave=function(){var e;return!this.valueChanged()||(e=this.instance.getSettings().trimWhitespace?[[String.prototype.trim.call(this.getValue())]]:[[this.getValue()]],void this.saveValue(e))},n.prototype.bindEvents=function(){var n=this;this.eventManager.addEventListener(this.controls.leftButton,"touchend",function(e){n.prepareAndSave(),n.instance.selection.transformStart(0,-1,null,!0),n.updateEditorData(),e.preventDefault()}),this.eventManager.addEventListener(this.controls.rightButton,"touchend",function(e){n.prepareAndSave(),n.instance.selection.transformStart(0,1,null,!0),n.updateEditorData(),e.preventDefault()}),this.eventManager.addEventListener(this.controls.upButton,"touchend",function(e){n.prepareAndSave(),n.instance.selection.transformStart(-1,0,null,!0),n.updateEditorData(),e.preventDefault()}),this.eventManager.addEventListener(this.controls.downButton,"touchend",function(e){n.prepareAndSave(),n.instance.selection.transformStart(1,0,null,!0),n.updateEditorData(),e.preventDefault()}),this.eventManager.addEventListener(this.moveHandle,"touchstart",function(e){if(1==e.touches.length){var t=e.touches[0],i={x:n.editorContainer.offsetLeft,y:n.editorContainer.offsetTop},o={x:t.pageX-i.x,y:t.pageY-i.y};n.eventManager.addEventListener(this,"touchmove",function(e){var t=e.touches[0];n.updateEditorPosition(t.pageX-o.x,t.pageY-o.y),n.hideCellPointer(),e.preventDefault()})}}),this.eventManager.addEventListener(document.body,"touchend",function(e){t.Dom.isChildOf(e.target,n.editorContainer)||t.Dom.isChildOf(e.target,n.instance.rootElement)||n.close()}),this.eventManager.addEventListener(this.instance.view.wt.wtScrollbars.horizontal.scrollHandler,"scroll",function(){n.instance.view.wt.wtScrollbars.horizontal.scrollHandler!=e&&n.hideCellPointer()}),this.eventManager.addEventListener(this.instance.view.wt.wtScrollbars.vertical.scrollHandler,"scroll",function(){n.instance.view.wt.wtScrollbars.vertical.scrollHandler!=e&&n.hideCellPointer()})},n.prototype.destroy=function(){this.eventManager.clear(),this.editorContainer.parentNode.removeChild(this.editorContainer)},t.editors.MobileTextEditor=n,t.editors.registerEditor("mobile",t.editors.MobileTextEditor)}(t),function(e){var t=e.editors.BaseEditor.prototype.extend();t.prototype.beginEditing=function(){var e=this.TD.querySelector('input[type="checkbox"]');e&&e.click()},t.prototype.finishEditing=function(){},t.prototype.init=function(){},t.prototype.open=function(){},t.prototype.close=function(){},t.prototype.getValue=function(){},t.prototype.setValue=function(){},t.prototype.focus=function(){},e.editors.CheckboxEditor=t,e.editors.registerEditor("checkbox",t)}(t),function(t){var n=t.editors.TextEditor.prototype.extend();n.prototype.init=function(){if("function"!=typeof moment)throw new Error("You need to include moment.js to your project.");if("function"!=typeof Pikaday)throw new Error("You need to include Pikaday to your project.");t.editors.TextEditor.prototype.init.apply(this,arguments),this.isCellEdited=!1;var e=this;this.instance.addHook("afterDestroy",function(){e.parentDestroyed=!0,e.destroyElements()})},n.prototype.createElements=function(){var e=this;t.editors.TextEditor.prototype.createElements.apply(this,arguments),this.defaultDateFormat="DD/MM/YYYY",this.datePicker=document.createElement("DIV"),this.datePickerStyle=this.datePicker.style,this.datePickerStyle.position="absolute",this.datePickerStyle.top=0,this.datePickerStyle.left=0,this.datePickerStyle.zIndex=9999,t.Dom.addClass(this.datePicker,"htDatepickerHolder"),document.body.appendChild(this.datePicker);var n=this.TEXTAREA,i={format:e.defaultDateFormat,field:n,trigger:n,container:e.datePicker,reposition:!1,bound:!1,onSelect:function(t){isNaN(t.getTime())||(t=moment(t).format(e.cellProperties.dateFormat||e.defaultDateFormat)),e.setValue(t),e.hideDatepicker()},onClose:function(){e.parentDestroyed||e.finishEditing(!1)}};this.$datePicker=new Pikaday(i),t.eventManager(this).addEventListener(this.datePicker,"mousedown",function(e){t.helper.stopPropagation(e)}),this.hideDatepicker()},n.prototype.destroyElements=function(){this.$datePicker.destroy()},n.prototype.prepare=function(){this._opened=!1,t.editors.TextEditor.prototype.prepare.apply(this,arguments)},n.prototype.open=function(e){t.editors.TextEditor.prototype.open.call(this),this.showDatepicker(e)},n.prototype.close=function(){var e=this;this._opened=!1,this.instance._registerTimeout(setTimeout(function(){e.instance.selection.refreshBorders()},0)),t.editors.TextEditor.prototype.close.apply(this,arguments)},n.prototype.finishEditing=function(e){if(e){var n=this.originalValue;void 0!==n&&this.setValue(n)}this.hideDatepicker(),t.editors.TextEditor.prototype.finishEditing.apply(this,arguments)},n.prototype.showDatepicker=function(n){var i,o=this.TD.getBoundingClientRect(),r=this.cellProperties.dateFormat||this.defaultDateFormat,a=this.$datePicker.config(),s=this.instance.view.isMouseDown(),l=!!n&&t.helper.isMetaKey(n.keyCode);this.datePickerStyle.top=e.pageYOffset+o.top+t.Dom.outerHeight(this.TD)+"px",this.datePickerStyle.left=e.pageXOffset+o.left+"px",this.$datePicker._onInputFocus=function(){},a.format=r,this.originalValue?(i=this.originalValue,moment(i,r,!0).isValid()&&this.$datePicker.setMoment(moment(i,r),!0),l||s||this.setValue("")):this.cellProperties.defaultDate&&(i=this.cellProperties.defaultDate,a.defaultDate=i,moment(i,r,!0).isValid()&&this.$datePicker.setMoment(moment(i,r),!0),l||s||this.setValue("")),this.datePickerStyle.display="block",this.$datePicker.show()},n.prototype.hideDatepicker=function(){this.datePickerStyle.display="none",this.$datePicker.hide()},t.editors.DateEditor=n,t.editors.registerEditor("date",n)}(t),function(e){var t=e.editors.TextEditor.prototype.extend();t.prototype.createElements=function(){e.editors.TextEditor.prototype.createElements.apply(this,arguments);var t=document.createElement("DIV");t.className="handsontableEditor",this.TEXTAREA_PARENT.appendChild(t),this.htContainer=t,this.htEditor=new e(t),this.assignHooks()},t.prototype.prepare=function(t,n,i,o,r,a){e.editors.TextEditor.prototype.prepare.apply(this,arguments);var s=this,l={startRows:0,startCols:0,minRows:0,minCols:0,className:"listbox",copyPaste:!1,cells:function(){return{readOnly:!0}},fillHandle:!1,afterOnCellMouseDown:function(){var e=this.getValue();void 0!==e&&s.setValue(e),s.instance.destroyEditor()}};this.cellProperties.handsontable&&e.helper.extend(l,a.handsontable),this.htEditor&&this.htEditor.destroy(),this.htEditor=new e(this.htContainer,l)};var n=function(t){if(null!=t&&null==t.isImmediatePropagationEnabled&&(t.stopImmediatePropagation=function(){this.isImmediatePropagationEnabled=!1,this.cancelBubble=!0},t.isImmediatePropagationEnabled=!0,t.isImmediatePropagationStopped=function(){return!this.isImmediatePropagationEnabled}),!t.isImmediatePropagationStopped()){var n,i=this.getActiveEditor(),o=i.htEditor.getInstance();if(t.keyCode==e.helper.keyCode.ARROW_DOWN)if(o.getSelected()){var r=o.getSelected()[0],a=o.countRows()-1;n=Math.min(a,r+1)}else n=0;else t.keyCode==e.helper.keyCode.ARROW_UP&&o.getSelected()&&(n=(r=o.getSelected()[0])-1);void 0!==n&&(0>n?o.deselectCell():o.selectCell(n,0),t.preventDefault(),t.stopImmediatePropagation(),i.instance.listen(),i.TEXTAREA.focus())}};t.prototype.open=function(){this.instance.addHook("beforeKeyDown",n),e.editors.TextEditor.prototype.open.apply(this,arguments),this.htEditor.render(),this.cellProperties.strict?(this.htEditor.selectCell(0,0),this.TEXTAREA.style.visibility="hidden"):(this.htEditor.deselectCell(),this.TEXTAREA.style.visibility="visible"),e.Dom.setCaretPosition(this.TEXTAREA,0,this.TEXTAREA.value.length)},t.prototype.close=function(){this.instance.removeHook("beforeKeyDown",n),this.instance.listen(),e.editors.TextEditor.prototype.close.apply(this,arguments)},t.prototype.focus=function(){this.instance.listen(),e.editors.TextEditor.prototype.focus.apply(this,arguments)},t.prototype.beginEditing=function(){var t=this.instance.getSettings().onBeginEditing;t&&!1===t()||e.editors.TextEditor.prototype.beginEditing.apply(this,arguments)},t.prototype.finishEditing=function(){if(this.htEditor.isListening()&&this.instance.listen(),this.htEditor.getSelected()){var t=this.htEditor.getInstance().getValue();void 0!==t&&this.setValue(t)}return e.editors.TextEditor.prototype.finishEditing.apply(this,arguments)},t.prototype.assignHooks=function(){var e=this;this.instance.addHook("afterDestroy",function(){e.htEditor&&e.htEditor.destroy()})},e.editors.HandsontableEditor=t,e.editors.registerEditor("handsontable",t)}(t),function(t){var n=t.editors.HandsontableEditor.prototype.extend();n.prototype.init=function(){t.editors.HandsontableEditor.prototype.init.apply(this,arguments),this.htEditor.getInstance().updateSettings({height:1}),this.query=null,this.choices=[]},n.prototype.createElements=function(){t.editors.HandsontableEditor.prototype.createElements.apply(this,arguments);t.Dom.addClass(this.htContainer,"autocompleteEditor"),t.Dom.addClass(this.htContainer,-1!=e.navigator.platform.indexOf("Mac")?"htMacScroll":"")};var i=!1,o=function(e){i=!1;var n=this.getActiveEditor(),o=t.helper.keyCode;if(t.helper.isPrintableChar(e.keyCode)||e.keyCode===o.BACKSPACE||e.keyCode===o.DELETE||e.keyCode===o.INSERT){var r=0;if(e.keyCode===o.C&&(e.ctrlKey||e.metaKey))return;n.isOpened()||(r+=10),n.instance._registerTimeout(setTimeout(function(){n.queryChoices(n.TEXTAREA.value),i=!0},r))}};n.prototype.prepare=function(){this.instance.addHook("beforeKeyDown",o),t.editors.HandsontableEditor.prototype.prepare.apply(this,arguments)},n.prototype.open=function(){t.editors.HandsontableEditor.prototype.open.apply(this,arguments),this.TEXTAREA.style.visibility="visible",this.focus(),this.htContainer.style.overflow="hidden";var e=this;this.htEditor.getInstance().updateSettings({colWidths:[t.Dom.outerWidth(this.TEXTAREA)-2],afterRenderer:function(t,n,i,o,r){var a=!0===this.getCellMeta(n,i).filteringCaseSensitive;if(r){var s=a?r.indexOf(this.query):r.toLowerCase().indexOf(e.query.toLowerCase());if(-1!=s){var l=r.substr(s,e.query.length);t.innerHTML=r.replace(l,"<strong>"+l+"</strong>")}}}}),i&&(i=!1),e.instance._registerTimeout(setTimeout(function(){e.queryChoices(e.TEXTAREA.value),e.htContainer.style.overflow="auto"},0))},n.prototype.close=function(){t.editors.HandsontableEditor.prototype.close.apply(this,arguments)},n.prototype.queryChoices=function(e){if(this.query=e,"function"==typeof this.cellProperties.source){var t=this;this.cellProperties.source(e,function(e){t.updateChoicesList(e)})}else if(Array.isArray(this.cellProperties.source)){var n;if(e&&!1!==this.cellProperties.filter){var i=!0===this.cellProperties.filteringCaseSensitive,o=e.toLowerCase();n=this.cellProperties.source.filter(function(t){return i?-1!=t.indexOf(e):-1!=t.toLowerCase().indexOf(o)})}else n=this.cellProperties.source;this.updateChoicesList(n)}else this.updateChoicesList([])},n.prototype.updateChoicesList=function(e){var i,o=t.Dom.getCaretPosition(this.TEXTAREA),r=t.Dom.getSelectionEndPosition(this.TEXTAREA),a=n.sortByRelevance(this.getValue(),e,this.cellProperties.filteringCaseSensitive);if(0!=this.cellProperties.filter){for(var s=[],l=0,c=a.length;c>l;l++)s.push(e[a[l]]);i=0,e=s}else i=a[0];this.choices=e,this.htEditor.loadData(t.helper.pivot([e])),this.htEditor.updateSettings({height:this.getDropdownHeight()}),!0===this.cellProperties.strict&&this.highlightBestMatchingChoice(i),this.instance.listen(),this.TEXTAREA.focus(),t.Dom.setCaretPosition(this.TEXTAREA,o,o!=r?r:void 0)},n.prototype.finishEditing=function(e){e||this.instance.removeHook("beforeKeyDown",o),t.editors.HandsontableEditor.prototype.finishEditing.apply(this,arguments)},n.prototype.highlightBestMatchingChoice=function(e){"number"==typeof e?this.htEditor.selectCell(e,0):this.htEditor.deselectCell()},n.sortByRelevance=function(e,t,n){var i,o,r,a,s,l=[],c=e.length,d=[];if(0===c){for(a=0,s=t.length;s>a;a++)d.push(a);return d}for(a=0,s=t.length;s>a;a++)i=t[a],-1!=(o=n?i.indexOf(e):i.toLowerCase().indexOf(e.toLowerCase()))&&(r=i.length-o-c,l.push({baseIndex:a,index:o,charsLeft:r,value:i}));for(l.sort(function(e,t){return-1===t.index?-1:-1===e.index?1:e.index<t.index?-1:t.index<e.index?1:e.index===t.index?e.charsLeft<t.charsLeft?-1:e.charsLeft>t.charsLeft?1:0:void 0}),a=0,s=l.length;s>a;a++)d.push(l[a].baseIndex);return d},n.prototype.getDropdownHeight=function(){var e=this.htEditor.getInstance().getRowHeight(0)||23;return this.choices.length>=10?10*e:this.choices.length*e+8},t.editors.AutocompleteEditor=n,t.editors.registerEditor("autocomplete",n)}(t),function(e){var t=e.editors.TextEditor.prototype.extend();t.prototype.createElements=function(){e.editors.TextEditor.prototype.createElements.apply(this,arguments),this.TEXTAREA=document.createElement("input"),this.TEXTAREA.setAttribute("type","password"),this.TEXTAREA.className="handsontableInput",this.textareaStyle=this.TEXTAREA.style,this.textareaStyle.width=0,this.textareaStyle.height=0,e.Dom.empty(this.TEXTAREA_PARENT),this.TEXTAREA_PARENT.appendChild(this.TEXTAREA)},e.editors.PasswordEditor=t,e.editors.registerEditor("password",t)}(t),function(e){var t=e.editors.BaseEditor.prototype.extend();t.prototype.init=function(){this.select=document.createElement("SELECT"),e.Dom.addClass(this.select,"htSelectEditor"),this.select.style.display="none",this.instance.rootElement.appendChild(this.select)},t.prototype.prepare=function(){e.editors.BaseEditor.prototype.prepare.apply(this,arguments);var t,n=this.cellProperties.selectOptions;t=this.prepareOptions("function"==typeof n?n(this.row,this.col,this.prop):n),e.Dom.empty(this.select);for(var i in t)if(t.hasOwnProperty(i)){var o=document.createElement("OPTION");o.value=i,e.Dom.fastInnerHTML(o,t[i]),this.select.appendChild(o)}},t.prototype.prepareOptions=function(e){var t={};if(Array.isArray(e))for(var n=0,i=e.length;i>n;n++)t[e[n]]=e[n];else"object"==typeof e&&(t=e);return t},t.prototype.getValue=function(){return this.select.value},t.prototype.setValue=function(e){this.select.value=e};var n=function(t){var n=this.getActiveEditor();switch(t.keyCode){case e.helper.keyCode.ARROW_UP:var i=n.select.find("option:selected").prev();1==i.length&&i.prop("selected",!0),t.stopImmediatePropagation(),t.preventDefault();break;case e.helper.keyCode.ARROW_DOWN:var o=n.select.find("option:selected").next();1==o.length&&o.prop("selected",!0),t.stopImmediatePropagation(),t.preventDefault()}};t.prototype.checkEditorSection=function(){return this.row<this.instance.getSettings().fixedRowsTop?this.col<this.instance.getSettings().fixedColumnsLeft?"corner":"top":this.col<this.instance.getSettings().fixedColumnsLeft?"left":void 0},t.prototype.open=function(){var t,i=e.Dom.outerWidth(this.TD),o=e.Dom.outerHeight(this.TD),r=e.Dom.offset(this.instance.rootElement),a=e.Dom.offset(this.TD);switch(this.checkEditorSection()){case"top":t=e.Dom.getCssTransform(this.instance.view.wt.wtScrollbars.vertical.clone.wtTable.holder.parentNode);break;case"left":t=e.Dom.getCssTransform(this.instance.view.wt.wtScrollbars.horizontal.clone.wtTable.holder.parentNode);break;case"corner":t=e.Dom.getCssTransform(this.instance.view.wt.wtScrollbars.corner.clone.wtTable.holder.parentNode)}var s=this.select.style;t&&-1!=t?s[t[0]]=t[1]:e.Dom.resetCssTransform(this.select),s.height=o+"px",s.minWidth=i+"px",s.top=a.top-r.top+"px",s.left=a.left-r.left+"px",s.margin="0px",s.display="",this.instance.addHook("beforeKeyDown",n)},t.prototype.close=function(){this.select.style.display="none",this.instance.removeHook("beforeKeyDown",n)},t.prototype.focus=function(){this.select.focus()},e.editors.SelectEditor=t,e.editors.registerEditor("select",t)}(t),function(e){var t=e.editors.AutocompleteEditor.prototype.extend();t.prototype.prepare=function(){e.editors.AutocompleteEditor.prototype.prepare.apply(this,arguments),this.cellProperties.filter=!1,this.cellProperties.strict=!0},e.editors.DropdownEditor=t,e.editors.registerEditor("dropdown",t)}(t),function(e){var t=e.editors.TextEditor.prototype.extend();t.prototype.beginEditing=function(t){var n=e.editors.TextEditor.prototype;if(void 0===t&&this.originalValue){var i=""+this.originalValue;void 0!==this.cellProperties.language&&numeral.language(this.cellProperties.language);var o=numeral.languageData().delimiters.decimal;i=i.replace(".",o),n.beginEditing.apply(this,[i])}else n.beginEditing.apply(this,arguments)},e.editors.NumericEditor=t,e.editors.registerEditor("numeric",t)}(t),t.NumericValidator=function(e,t){null===e&&(e=""),t(/^-?\d*(\.|\,)?\d*$/.test(e))},t.DateValidator=function(e,n){var i=null,o=!0,r=t.editors.getEditor("date",this.instance);null===e&&(e="");var a=moment(new Date(e)).isValid(),s=moment(e,this.dateFormat||r.defaultDateFormat,!0).isValid();a||(o=!1),!a&&s&&(o=!0),a&&!s&&(!0===this.correctFormat?(i=A(e,this.dateFormat),this.instance.setDataAtCell(this.row,this.col,i,"dateValidator"),o=!0):o=!1),n(o)};var A=function(e,t){return e=moment(new Date(e)).format(t)},N=function(e,t){var n=e,i="string"==typeof n?n.toLowerCase():null;return function(e){for(var o=!1,r=0,a=e.length;a>r;r++){if(n===e[r]){o=!0;break}if(i===e[r].toLowerCase()){o=!0;break}}t(o)}};t.AutocompleteValidator=function(e,t){this.strict&&this.source?"function"==typeof this.source?this.source(e,N(e,t)):N(e,t)(this.source):t(!0)},t.mobileBrowser=t.helper.isMobileBrowser(),t.AutocompleteCell={editor:t.editors.AutocompleteEditor,renderer:t.renderers.AutocompleteRenderer,validator:t.AutocompleteValidator},t.CheckboxCell={editor:t.editors.CheckboxEditor,renderer:t.renderers.CheckboxRenderer},t.TextCell={editor:t.mobileBrowser?t.editors.MobileTextEditor:t.editors.TextEditor,renderer:t.renderers.TextRenderer},t.NumericCell={editor:t.editors.NumericEditor,renderer:t.renderers.NumericRenderer,validator:t.NumericValidator,dataType:"number"},t.DateCell={editor:t.editors.DateEditor,validator:t.DateValidator,renderer:t.renderers.AutocompleteRenderer},t.HandsontableCell={editor:t.editors.HandsontableEditor,renderer:t.renderers.AutocompleteRenderer},t.PasswordCell={editor:t.editors.PasswordEditor,renderer:t.renderers.PasswordRenderer,copyable:!1},t.DropdownCell={editor:t.editors.DropdownEditor,renderer:t.renderers.AutocompleteRenderer,validator:t.AutocompleteValidator},t.cellTypes={text:t.TextCell,date:t.DateCell,numeric:t.NumericCell,checkbox:t.CheckboxCell,autocomplete:t.AutocompleteCell,handsontable:t.HandsontableCell,password:t.PasswordCell,dropdown:t.DropdownCell},t.cellLookup={validator:{numeric:t.NumericValidator,autocomplete:t.AutocompleteValidator}};var M=function(){var n,i={minHeight:200,maxHeight:300,minWidth:100,maxWidth:300},o=document.body,r=document.createTextNode(""),a=document.createElement("SPAN"),s=function(t,n,i){e.attachEvent?t.attachEvent("on"+n,i):t.addEventListener(n,i,!1)},l=function(t,n,i){e.removeEventListener?t.removeEventListener(n,i,!1):t.detachEvent("on"+n,i)},c=function(e){var s,l;e?/^[a-zA-Z \.,\\\/\|0-9]$/.test(e)||(e="."):e="",void 0!==r.textContent?r.textContent=n.value+e:r.data=n.value+e,a.style.fontSize=t.Dom.getComputedStyle(n).fontSize,a.style.fontFamily=t.Dom.getComputedStyle(n).fontFamily,a.style.whiteSpace="pre",o.appendChild(a),s=a.clientWidth+2,o.removeChild(a),n.style.height=i.minHeight+"px",n.style.width=i.minWidth>s?i.minWidth+"px":s>i.maxWidth?i.maxWidth+"px":s+"px",l=n.scrollHeight?n.scrollHeight-1:0,i.minHeight>l?n.style.height=i.minHeight+"px":i.maxHeight<l?(n.style.height=i.maxHeight+"px",n.style.overflowY="visible"):n.style.height=l+"px"},d=function(){e.setTimeout(c,0)},u=function(e){if(e&&e.minHeight)if("inherit"==e.minHeight)i.minHeight=n.clientHeight;else{var t=parseInt(e.minHeight);isNaN(t)||(i.minHeight=t)}if(e&&e.maxHeight)if("inherit"==e.maxHeight)i.maxHeight=n.clientHeight;else{var o=parseInt(e.maxHeight);isNaN(o)||(i.maxHeight=o)}if(e&&e.minWidth)if("inherit"==e.minWidth)i.minWidth=n.clientWidth;else{var s=parseInt(e.minWidth);isNaN(s)||(i.minWidth=s)}if(e&&e.maxWidth)if("inherit"==e.maxWidth)i.maxWidth=n.clientWidth;else{var l=parseInt(e.maxWidth);isNaN(l)||(i.maxWidth=l)}a.firstChild||(a.className="autoResize",a.style.display="inline-block",a.appendChild(r))},h=function(e,t,o){n=e,u(t),"TEXTAREA"==n.nodeName&&(n.style.resize="none",n.style.overflowY="",n.style.height=i.minHeight+"px",n.style.minWidth=i.minWidth+"px",n.style.maxWidth=i.maxWidth+"px",n.style.overflowY="hidden"),o&&(s(n,"change",c),s(n,"cut",d),s(n,"paste",d),s(n,"drop",d),s(n,"keydown",d)),c()};return{init:function(e,t,n){h(e,t,n)},unObserve:function(){l(n,"change",c),l(n,"cut",d),l(n,"paste",d),l(n,"drop",d),l(n,"keydown",d)},resize:c}};!function(e){function t(e){return e.split('"').length-1}e.SheetClip={parse:function(e){var n,i,o,r,a,s,l,c=[],d=0;for((o=e.split("\n")).length>1&&""===o[o.length-1]&&o.pop(),n=0,i=o.length;i>n;n+=1){for(o[n]=o[n].split("\t"),r=0,a=o[n].length;a>r;r+=1)c[d]||(c[d]=[]),s&&0===r?(l=c[d].length-1,c[d][l]=c[d][l]+"\n"+o[n][0],s&&1&t(o[n][0])&&(s=!1,c[d][l]=c[d][l].substring(0,c[d][l].length-1).replace(/""/g,'"'))):r===a-1&&0===o[n][r].indexOf('"')?(c[d].push(o[n][r].substring(1).replace(/""/g,'"')),s=!0):(c[d].push(o[n][r].replace(/""/g,'"')),s=!1);s||(d+=1)}return c},stringify:function(e){var t,n,i,o,r,a="";for(t=0,n=e.length;n>t;t+=1){for(o=e[t].length,i=0;o>i;i+=1)i>0&&(a+="\t"),r=e[t][i],a+="string"==typeof r?r.indexOf("\n")>-1?'"'+r.replace(/"/g,'""')+'"':r:null===r||void 0===r?"":r;a+="\n"}return a}}}(e);var O=function(){var e;return{getInstance:function(){return e?e.hasBeenDestroyed()&&e.init():e=new n,e.refCounter++,e}}}();n.prototype.init=function(){var e,n;this.copyCallbacks=[],this.cutCallbacks=[],this.pasteCallbacks=[],this._eventManager=t.eventManager(this),n=document.body,document.getElementById("CopyPasteDiv")?(this.elDiv=document.getElementById("CopyPasteDiv"),this.elTextarea=this.elDiv.firstChild):(this.elDiv=document.createElement("DIV"),this.elDiv.id="CopyPasteDiv",e=this.elDiv.style,e.position="fixed",e.top="-10000px",e.left="-10000px",n.appendChild(this.elDiv),this.elTextarea=document.createElement("TEXTAREA"),this.elTextarea.className="copyPaste",this.elTextarea.onpaste=function(e){return"WebkitAppearance"in document.documentElement.style?(this.value=e.clipboardData.getData("Text"),!1):void 0},e=this.elTextarea.style,e.width="10000px",e.height="10000px",e.overflow="hidden",this.elDiv.appendChild(this.elTextarea),void 0!==e.opacity&&(e.opacity=0)),this.keyDownRemoveEvent=this._eventManager.addEventListener(document.documentElement,"keydown",this.onKeyDown.bind(this),!1)},n.prototype.onKeyDown=function(e){var t=this,n=!1;if(e.metaKey?n=!0:e.ctrlKey&&-1===navigator.userAgent.indexOf("Mac")&&(n=!0),n){if(document.activeElement!==this.elTextarea&&(""!==this.getSelectionText()||-1!==["INPUT","SELECT","TEXTAREA"].indexOf(document.activeElement.nodeName)))return;this.selectNodeText(this.elTextarea),setTimeout(function(){t.selectNodeText(t.elTextarea)},0)}!n||67!==e.keyCode&&86!==e.keyCode&&88!==e.keyCode||(88===e.keyCode?setTimeout(function(){t.triggerCut(e)},0):86===e.keyCode&&setTimeout(function(){t.triggerPaste(e)},0))},n.prototype.selectNodeText=function(e){e&&e.select()},n.prototype.getSelectionText=function(){var t="";return e.getSelection?t=e.getSelection().toString():document.selection&&"Control"!=document.selection.type&&(t=document.selection.createRange().text),t},n.prototype.copyable=function(e){if("string"!=typeof e&&void 0===e.toString)throw new Error("copyable requires string parameter");this.elTextarea.value=e},n.prototype.onCut=function(e){this.cutCallbacks.push(e)},n.prototype.onPaste=function(e){this.pasteCallbacks.push(e)},n.prototype.removeCallback=function(e){var t,n;for(t=0,n=this.copyCallbacks.length;n>t;t++)if(this.copyCallbacks[t]===e)return this.copyCallbacks.splice(t,1),!0;for(t=0,n=this.cutCallbacks.length;n>t;t++)if(this.cutCallbacks[t]===e)return this.cutCallbacks.splice(t,1),!0;for(t=0,n=this.pasteCallbacks.length;n>t;t++)if(this.pasteCallbacks[t]===e)return this.pasteCallbacks.splice(t,1),!0;return!1},n.prototype.triggerCut=function(e){var t=this;t.cutCallbacks&&setTimeout(function(){for(var n=0,i=t.cutCallbacks.length;i>n;n++)t.cutCallbacks[n](e)},50)},n.prototype.triggerPaste=function(e,t){var n=this;n.pasteCallbacks&&setTimeout(function(){for(var i=t||n.elTextarea.value,o=0,r=n.pasteCallbacks.length;r>o;o++)n.pasteCallbacks[o](i,e)},50)},n.prototype.destroy=function(){this.hasBeenDestroyed()||0!=--this.refCounter||(this.elDiv&&this.elDiv.parentNode&&(this.elDiv.parentNode.removeChild(this.elDiv),this.elDiv=null,this.elTextarea=null),this.keyDownRemoveEvent())},n.prototype.hasBeenDestroyed=function(){return!this.refCounter};var I;!function(t){function n(e){return-1===e.indexOf("/")&&-1===e.indexOf("~")?e:e.replace(/~/g,"~0").replace(/\//g,"~1")}function i(e,t){var o;for(var r in e)if(e.hasOwnProperty(r)){if(e[r]===t)return n(r)+"/";if("object"==typeof e[r]&&""!=(o=i(e[r],t)))return n(r)+"/"+o}return""}function o(e,t){if(e===t)return"/";var n=i(e,t);if(""===n)throw new Error("Object not found in root");return"/"+n}function r(e){for(var t=0,n=v.length;n>t;t++)if(v[t].obj===e)return v[t]}function a(e,t){for(var n=0,i=e.observers.length;i>n;n++)if(e.observers[n].callback===t)return e.observers[n].observer}function s(e,t){for(var n=0,i=e.observers.length;i>n;n++)if(e.observers[n].observer===t)return void e.observers.splice(n,1)}function l(e,t){if(Object.observe){Object.observe(t,e);for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];i&&"object"==typeof i&&l(e,i)}}return e}function c(e,t){if(Object.observe){Object.unobserve(t,e);for(var n in t)if(t.hasOwnProperty(n)){var i=t[n];i&&"object"==typeof i&&c(e,i)}}return e}function d(e){if(Object.observe)Object.deliverChangeRecords(e);else{for(var t,n=0,i=v.length;i>n;n++)if(v[n].obj===e.object){t=v[n];break}u(t.value,e.object,e.patches,"")}var o=e.patches;return o.length>0&&(e.patches=[],e.callback&&e.callback(o)),o}function u(e,t,i,o){for(var r=w(t),a=w(e),s=!1,l=a.length-1;l>=0;l--){var c=e[h=a[l]];if(t.hasOwnProperty(h)){var d=t[h];c instanceof Object?u(c,d,i,o+"/"+n(h)):c!=d&&(!0,i.push({op:"replace",path:o+"/"+n(h),value:d}),e[h]=d)}else i.push({op:"remove",path:o+"/"+n(h)}),delete e[h],s=!0}if(s||r.length!=a.length)for(l=0;l<r.length;l++){var h=r[l];e.hasOwnProperty(h)||(i.push({op:"add",path:o+"/"+n(h),value:t[h]}),e[h]=JSON.parse(JSON.stringify(t[h])))}}function h(e,t){for(var n,i=!1,o=0,r=t.length;r>o;){for(var a=(n=t[o]).path.split("/"),s=e,l=1,c=a.length;;)if(b(s)){var d=parseInt(a[l],10);if(++l>=c){i=f[n.op].call(n,s,d,e);break}s=s[d]}else{var u=a[l];if(-1!=u.indexOf("~")&&(u=u.replace(/~1/g,"/").replace(/~0/g,"~")),++l>=c){i=p[n.op].call(n,s,u,e);break}s=s[u]}o++}return i}var p={add:function(e,t){return e[t]=this.value,!0},remove:function(e,t){return delete e[t],!0},replace:function(e,t){return e[t]=this.value,!0},move:function(e,t,n){var i={op:"_get",path:this.from};return h(n,[i]),h(n,[{op:"remove",path:this.from}]),h(n,[{op:"add",path:this.path,value:i.value}]),!0},copy:function(e,t,n){var i={op:"_get",path:this.from};return h(n,[i]),h(n,[{op:"add",path:this.path,value:i.value}]),!0},test:function(e,t){return JSON.stringify(e[t])===JSON.stringify(this.value)},_get:function(e,t){this.value=e[t]}},f={add:function(e,t){return e.splice(t,0,this.value),!0},remove:function(e,t){return e.splice(t,1),!0},replace:function(e,t){return e[t]=this.value,!0},move:p.move,copy:p.copy,test:p.test,_get:p._get},g={add:function(e,t){var i={op:"add",path:t+n(this.name),value:this.object[this.name]};e.push(i)},delete:function(e,t){var i={op:"remove",path:t+n(this.name)};e.push(i)},update:function(e,t){var i={op:"replace",path:t+n(this.name),value:this.object[this.name]};e.push(i)}},v=[];t.intervals;var m=function(){return function(e){this.observers=[],this.obj=e}}(),y=function(){return function(e,t){this.callback=e,this.observer=t}}();t.unobserve=function(e,t){d(t),Object.observe?c(t,e):clearTimeout(t.next),s(r(e),t)},t.observe=function(t,n){var i,s=[],u=t,h=r(t);if(h?i=a(h,n):(h=new m(t),v.push(h)),i)return i;if(Object.observe)i=function(e){c(i,t),l(i,t);for(var r=0,a=e.length;a>r;){if(("length"!==e[r].name||!b(e[r].object))&&"__Jasmine_been_here_before__"!==e[r].name){var d=e[r].type;switch(d){case"new":d="add";break;case"deleted":d="delete";break;case"updated":d="update"}g[d].call(e[r],s,o(u,e[r].object))}r++}s&&n&&n(s),i.patches=s,s=[]};else if(i={},h.value=JSON.parse(JSON.stringify(t)),n){i.callback=n,i.next=null;var p=this.intervals||[100,1e3,1e4,6e4],f=0,w=function(){d(i)},C=function(){clearTimeout(i.next),i.next=setTimeout(function(){w(),f=0,i.next=setTimeout(x,p[f++])},0)},x=function(){w(),f==p.length&&(f=p.length-1),i.next=setTimeout(x,p[f++])};void 0!==e&&(e.addEventListener?(e.addEventListener("mousedown",C),e.addEventListener("mouseup",C),e.addEventListener("keydown",C)):(e.attachEvent("onmousedown",C),e.attachEvent("onmouseup",C),e.attachEvent("onkeydown",C))),i.next=setTimeout(x,p[f++])}return i.patches=s,i.object=t,h.observers.push(new y(n,i)),l(i,t)},t.generate=d;var w;w=Object.keys?Object.keys:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(n);return t};var b;b=Array.isArray?Array.isArray:function(e){return e.push&&"number"==typeof e.length},t.apply=h}(I||(I={})),"undefined"!=typeof exports&&(exports.apply=I.apply,exports.observe=I.observe,exports.unobserve=I.unobserve,exports.generate=I.generate),t.PluginHookClass=function(){function e(){this.hooks=t(),this.globalBucket={},this.legacy=n}var t=function(){return{beforeInitWalkontable:[],beforeInit:[],beforeRender:[],beforeSetRangeEnd:[],beforeDrawBorders:[],beforeChange:[],beforeChangeRender:[],beforeRemoveCol:[],beforeRemoveRow:[],beforeValidate:[],beforeGetCellMeta:[],beforeAutofill:[],beforeKeyDown:[],beforeOnCellMouseDown:[],beforeTouchScroll:[],afterInit:[],afterLoadData:[],afterUpdateSettings:[],afterRender:[],afterRenderer:[],afterChange:[],afterValidate:[],afterGetCellMeta:[],afterSetCellMeta:[],afterGetColHeader:[],afterGetRowHeader:[],afterDestroy:[],afterRemoveRow:[],afterCreateRow:[],afterRemoveCol:[],afterCreateCol:[],afterDeselect:[],afterSelection:[],afterSelectionByProp:[],afterSelectionEnd:[],afterSelectionEndByProp:[],afterOnCellMouseDown:[],afterOnCellMouseOver:[],afterOnCellCornerMouseDown:[],afterScrollVertically:[],afterScrollHorizontally:[],afterCellMetaReset:[],afterIsMultipleSelectionCheck:[],afterDocumentKeyDown:[],afterMomentumScroll:[],beforeCellAlignment:[],modifyColWidth:[],modifyRowHeight:[],modifyRow:[],modifyCol:[]}},n={onBeforeChange:"beforeChange",onChange:"afterChange",onCreateRow:"afterCreateRow",onCreateCol:"afterCreateCol",onSelection:"afterSelection",onCopyLimit:"afterCopyLimit",onSelectionEnd:"afterSelectionEnd",onSelectionByProp:"afterSelectionByProp",onSelectionEndByProp:"afterSelectionEndByProp"};return e.prototype.getBucket=function(e){return e?(e.pluginHookBucket||(e.pluginHookBucket={}),e.pluginHookBucket):this.globalBucket},e.prototype.add=function(e,t,i){if(Array.isArray(t))for(var o=0,r=t.length;r>o;o++)this.add(e,t[o]);else{e in n&&(e=n[e]);var a=this.getBucket(i);void 0===a[e]&&(a[e]=[]),t.skip=!1,-1==a[e].indexOf(t)&&a[e].push(t)}return this},e.prototype.once=function(e,t,n){if(Array.isArray(t))for(var i=0,o=t.length;o>i;i++)t[i].runOnce=!0,this.add(e,t[i],n);else t.runOnce=!0,this.add(e,t,n)},e.prototype.remove=function(e,t,i){var o=!1;e in n&&(e=n[e]);var r=this.getBucket(i);if(void 0!==r[e])for(var a=0,s=r[e].length;s>a;a++)if(r[e][a]==t){r[e][a].skip=!0,o=!0;break}return o},e.prototype.run=function(e,t,i,o,r,a,s,l){return t in n&&(t=n[t]),i=this._runBucket(this.globalBucket,e,t,i,o,r,a,s,l),i=this._runBucket(this.getBucket(e),e,t,i,o,r,a,s,l)},e.prototype._runBucket=function(e,t,n,i,o,r,a,s,l){var c,d,u,h=e[n];if(h)for(d=0,u=h.length;u>d;d++)h[d].skip||(void 0!==(c=h[d].call(t,i,o,r,a,s,l))&&(i=c),h[d].runOnce&&this.remove(n,h[d],e===this.globalBucket?null:t));return i},e.prototype.destroy=function(e){var t=this.getBucket(e);for(var n in t)if(t.hasOwnProperty(n))for(var i=0,o=t[n].length;o>i;i++)this.remove(n,t[n],e)},e.prototype.register=function(e){this.isRegistered(e)||(this.hooks[e]=[])},e.prototype.deregister=function(e){delete this.hooks[e]},e.prototype.isRegistered=function(e){return void 0!==this.hooks[e]},e.prototype.getRegistered=function(){return Object.keys(this.hooks)},e}(),t.hooks=new t.PluginHookClass,t.PluginHooks=t.hooks,function(e){var t=new function(){function n(e){var t=document,n=this;n.table=t.createElement("table"),n.theadTh=t.createElement("th"),n.table.appendChild(t.createElement("thead")).appendChild(t.createElement("tr")).appendChild(n.theadTh),n.tableStyle=n.table.style,n.tableStyle.tableLayout="auto",n.tableStyle.width="auto",n.tbody=t.createElement("tbody"),n.table.appendChild(n.tbody),n.container=t.createElement("div"),n.container.className=e.rootElement.className+" hidden",n.containerStyle=n.container.style,n.container.appendChild(n.table)}var i=this;this.beforeInit=function(){var e=this;e.autoColumnWidths=[],!1!==e.getSettings().autoColumnSize?e.autoColumnSizeTmp||(e.autoColumnSizeTmp={table:null,tableStyle:null,theadTh:null,tbody:null,container:null,containerStyle:null,determineBeforeNextRender:!0},e.addHook("beforeRender",t.determineIfChanged),e.addHook("modifyColWidth",t.modifyColWidth),e.addHook("afterDestroy",t.afterDestroy),e.determineColumnWidth=i.determineColumnWidth):e.autoColumnSizeTmp&&(e.removeHook("beforeRender",t.determineIfChanged),e.removeHook("modifyColWidth",t.modifyColWidth),e.removeHook("afterDestroy",t.afterDestroy),delete e.determineColumnWidth,i.afterDestroy.call(e))},this.determineIfChanged=function(e){e&&t.determineColumnsWidth.apply(this,arguments)},this.determineColumnWidth=function(t){var i=this,o=i.autoColumnSizeTmp;o.container||n.call(o,i),o.container.className=i.rootElement.className+" htAutoColumnSize",o.table.className=i.table.className;for(var r=i.countRows(),a={},s=0,l=0;r>l;l++){var c=e.helper.stringify(i.getDataAtCell(l,t)),d=c.length;d>s&&(s=d),a[d]||(a[d]={needed:5,strings:[]}),a[d].needed&&(a[d].strings.push({value:c,row:l}),a[d].needed--)}i.getSettings().colHeaders&&i.view.appendColHeader(t,o.theadTh),e.Dom.empty(o.tbody);for(var u in a)if(a.hasOwnProperty(u))for(var h=0,p=a[u].strings.length;p>h;h++){var f=a[u].strings[h].row,g=i.getCellMeta(f,t);g.col=t,g.row=f;var v=i.getCellRenderer(g),m=document.createElement("tr"),y=document.createElement("td");v(i,y,f,t,i.colToProp(t),a[u].strings[h].value,g),l++,m.appendChild(y),o.tbody.appendChild(m)}var w=i.rootElement.parentNode;w.appendChild(o.container);var b=e.Dom.outerWidth(o.table);return w.removeChild(o.container),b},this.determineColumnsWidth=function(){var e=this,t=this.getSettings();if(t.autoColumnSize||!t.colWidths)for(var n=this.countCols(),o=0;n>o;o++)e._getColWidthFromSettings(o)||(this.autoColumnWidths[o]=i.determineColumnWidth.call(e,o))},this.modifyColWidth=function(e,t){return this.autoColumnWidths[t]&&this.autoColumnWidths[t]>e?this.autoColumnWidths[t]:e},this.afterDestroy=function(){var e=this;e.autoColumnSizeTmp&&e.autoColumnSizeTmp.container&&e.autoColumnSizeTmp.container.parentNode&&e.autoColumnSizeTmp.container.parentNode.removeChild(e.autoColumnSizeTmp.container),e.autoColumnSizeTmp=null}};e.hooks.add("beforeInit",t.beforeInit),e.hooks.add("afterUpdateSettings",t.beforeInit)}(t);var L=new function(){function e(){var e=this;e._registerTimeout(setTimeout(function(){e.updateSettings({observeChanges:!0})},0))}function n(e){return function(t,n){return"string"==typeof t[1]&&(t[1]=t[1].toLowerCase()),"string"==typeof n[1]&&(n[1]=n[1].toLowerCase()),t[1]===n[1]?0:null===t[1]||""===t[1]?1:null===n[1]||""===n[1]?-1:t[1]<n[1]?e?-1:1:t[1]>n[1]?e?1:-1:0}}function i(e){return function(t,n){if(t[1]===n[1])return 0;if(null===t[1])return 1;if(null===n[1])return-1;var i=new Date(t[1]),o=new Date(n[1]);return o>i?e?-1:1:i>o?e?1:-1:0}}function o(e){return void 0!==e.sortColumn}var r=this;this.init=function(t){var n,i,o=this,a=o.getSettings().columnSorting;if(o.sortingEnabled=!!a,o.sortingEnabled){o.sortIndex=[];var c=s.call(o);void 0!==c?(n=c.sortColumn,i=c.sortOrder):(n=a.column,i=a.sortOrder),r.sortByColumn.call(o,n,i),o.sort=function(){var e=Array.prototype.slice.call(arguments);return r.sortByColumn.apply(o,e)},void 0===o.getSettings().observeChanges&&e.call(o),"afterInit"==t&&(l.call(o),o.addHook("afterCreateRow",r.afterCreateRow),o.addHook("afterRemoveRow",r.afterRemoveRow),o.addHook("afterLoadData",r.init))}else delete o.sort,o.removeHook("afterCreateRow",r.afterCreateRow),o.removeHook("afterRemoveRow",r.afterRemoveRow),o.removeHook("afterLoadData",r.init)},this.setSortingColumn=function(e,t){var n=this;return void 0===e?(delete n.sortColumn,void delete n.sortOrder):(n.sortOrder=n.sortColumn===e&&void 0===t?!n.sortOrder:void 0===t||t,void(n.sortColumn=e))},this.sortByColumn=function(e,n){var i=this;r.setSortingColumn.call(i,e,n),void 0!==i.sortColumn&&(t.hooks.run(i,"beforeColumnSort",i.sortColumn,i.sortOrder),r.sort.call(i),i.render(),a.call(i),t.hooks.run(i,"afterColumnSort",i.sortColumn,i.sortOrder))};var a=function(){var e=this,n={};void 0!==e.sortColumn&&(n.sortColumn=e.sortColumn),void 0!==e.sortOrder&&(n.sortOrder=e.sortOrder),(n.hasOwnProperty("sortColumn")||n.hasOwnProperty("sortOrder"))&&t.hooks.run(e,"persistentStateSave","columnSorting",n)},s=function(){var e=this,n={};return t.hooks.run(e,"persistentStateLoad","columnSorting",n),n.value},l=function(){function e(){return i.view.TBODY.querySelector("tr").querySelectorAll("th").length}function n(n){var i=t.Dom.closest(n,"TH");return t.Dom.index(i)-e()}var i=this;t.eventManager(i).addEventListener(i.rootElement,"click",function(e){if(t.Dom.hasClass(e.target,"columnSorting")){var o=n(e.target);r.sortByColumn.call(i,o)}})};this.sort=function(){var e=this;if(void 0!==e.sortOrder){e.sortingEnabled=!1,e.sortIndex.length=0;for(var t=this.colOffset(),o=0,r=this.countRows()-e.getSettings().minSpareRows;r>o;o++)this.sortIndex.push([o,e.getDataAtCell(o,this.sortColumn+t)]);var a;switch(e.getCellMeta(0,e.sortColumn).type){case"date":a=i;break;default:a=n}for(this.sortIndex.sort(a(e.sortOrder)),o=this.sortIndex.length;o<e.countRows();o++)this.sortIndex.push([o,e.getDataAtCell(o,this.sortColumn+t)]);e.sortingEnabled=!0}},this.translateRow=function(e){var t=this;return t.sortingEnabled&&t.sortIndex&&t.sortIndex.length&&t.sortIndex[e]?t.sortIndex[e][0]:e},this.untranslateRow=function(e){var t=this;if(t.sortingEnabled&&t.sortIndex&&t.sortIndex.length)for(var n=0;n<t.sortIndex.length;n++)if(t.sortIndex[n][0]==e)return n},this.getColHeader=function(e,n){this.getSettings().columnSorting&&e>=0&&t.Dom.addClass(n.querySelector(".colHeader"),"columnSorting")},this.afterCreateRow=function(e,t){var n=this;if(o(n)){for(i=0;i<n.sortIndex.length;i++)n.sortIndex[i][0]>=e&&(n.sortIndex[i][0]+=t);for(var i=0;t>i;i++)n.sortIndex.splice(e+i,0,[e+i,n.getData()[e+i][n.sortColumn+n.colOffset()]]);a.call(n)}},this.afterRemoveRow=function(e,t){var n=this;if(o(n)){var i=r.translateRow.call(n,e);n.sortIndex.splice(e,t);for(var s=0;s<n.sortIndex.length;s++)n.sortIndex[s][0]>i&&(n.sortIndex[s][0]-=t);a.call(n)}},this.afterChangeSort=function(e){var t=this,n=!1,i={};if(e){for(var o=0;o<e.length;o++)if(e[o][1]==t.sortColumn){n=!0,i.row=r.translateRow.call(t,e[o][0]),i.col=e[o][1];break}n&&t._registerTimeout(setTimeout(function(){r.sort.call(t),t.render(),t.selectCell(r.untranslateRow.call(t,i.row),i.col)},0))}}};t.hooks.add("afterInit",function(){L.init.call(this,"afterInit")}),t.hooks.add("afterUpdateSettings",function(){L.init.call(this,"afterUpdateSettings")}),t.hooks.add("modifyRow",L.translateRow),t.hooks.add("afterGetColHeader",L.getColHeader),t.hooks.register("beforeColumnSort"),t.hooks.register("afterColumnSort"),function(e){function t(e,t){return-1!=e.indexOf(t)?e:(e=e.replace("htTop","").replace("htMiddle","").replace("htBottom","").replace("  ",""),e+=" "+t)}function n(e,t){return-1!=e.indexOf(t)?e:(e=e.replace("htLeft","").replace("htCenter","").replace("htRight","").replace("htJustify","").replace("  ",""),e+=" "+t)}function i(e){for(var t={},n=e.from.row;n<=e.to.row;n++)for(var i=e.from.col;i<=e.to.col;i++)t[n]||(t[n]=[]),t[n][i]=this.getCellMeta(n,i).className;return t}function o(e,i,o,r){var a=this.getCellMeta(e,i),s=r;a.className&&(s="vertical"===o?t(a.className,r):n(a.className,r)),this.setCellMeta(e,i,"className",s)}function r(e,t,n){var r=i.call(this,e);if(this.runHooks("beforeCellAlignment",r,e,t,n),e.from.row==e.to.row&&e.from.col==e.to.col)o.call(this,e.from.row,e.from.col,t,n);else for(var a=e.from.row;a<=e.to.row;a++)for(var s=e.from.col;s<=e.to.col;s++)o.call(this,a,s,t,n);this.render()}function a(t){this.instance=t;var n=this;if(n.menus=[],n.htMenus={},n.triggerRows=[],n.eventManager=e.eventManager(n),this.enabled=!0,this.instance.addHook("afterDestroy",function(){n.destroy()}),this.defaultOptions={items:[{key:"row_above",name:"Insert row above",callback:function(e,t){this.alter("insert_row",t.start.row)},disabled:function(){var e=this.getSelected(),t=[0,e[1],this.countRows()-1,e[1]].join(",")==e.join(",");return e[0]<0||this.countRows()>=this.getSettings().maxRows||t}},{key:"row_below",name:"Insert row below",callback:function(e,t){this.alter("insert_row",t.end.row+1)},disabled:function(){var e=this.getSelected(),t=[0,e[1],this.countRows()-1,e[1]].join(",")==e.join(",");return this.getSelected()[0]<0||this.countRows()>=this.getSettings().maxRows||t}},a.SEPARATOR,{key:"col_left",name:"Insert column on the left",callback:function(e,t){this.alter("insert_col",t.start.col)},disabled:function(){var e=this.getSelected(),t=[e[0],0,e[0],this.countCols()-1].join(",")==e.join(",");return this.getSelected()[1]<0||this.countCols()>=this.getSettings().maxCols||t}},{key:"col_right",name:"Insert column on the right",callback:function(e,t){this.alter("insert_col",t.end.col+1)},disabled:function(){var e=this.getSelected(),t=[e[0],0,e[0],this.countCols()-1].join(",")==e.join(",");return e[1]<0||this.countCols()>=this.getSettings().maxCols||t}},a.SEPARATOR,{key:"remove_row",name:"Remove row",callback:function(e,t){var n=t.end.row-t.start.row+1;this.alter("remove_row",t.start.row,n)},disabled:function(){var e=this.getSelected(),t=[0,e[1],this.countRows()-1,e[1]].join(",")==e.join(",");return e[0]<0||t}},{key:"remove_col",name:"Remove column",callback:function(e,t){var n=t.end.col-t.start.col+1;this.alter("remove_col",t.start.col,n)},disabled:function(){var e=this.getSelected(),t=[e[0],0,e[0],this.countCols()-1].join(",")==e.join(",");return e[1]<0||t}},a.SEPARATOR,{key:"undo",name:"Undo",callback:function(){this.undo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isUndoAvailable()}},{key:"redo",name:"Redo",callback:function(){this.redo()},disabled:function(){return this.undoRedo&&!this.undoRedo.isRedoAvailable()}},a.SEPARATOR,{key:"make_read_only",name:function(){var e="Read only";return n.checkSelectionReadOnlyConsistency(this)&&(e=n.markSelected(e)),e},callback:function(){var e=n.checkSelectionReadOnlyConsistency(this),t=this;this.getSelectedRange().forAll(function(n,i){t.getCellMeta(n,i).readOnly=!e}),this.render()}},a.SEPARATOR,{key:"alignment",name:"Alignment",submenu:{items:[{name:function(){var e="Left";return n.checkSelectionAlignment(this,"htLeft")&&(e=n.markSelected(e)),e},callback:function(){r.call(this,this.getSelectedRange(),"horizontal","htLeft")},disabled:!1},{name:function(){var e="Center";return n.checkSelectionAlignment(this,"htCenter")&&(e=n.markSelected(e)),e},callback:function(){r.call(this,this.getSelectedRange(),"horizontal","htCenter")},disabled:!1},{name:function(){var e="Right";return n.checkSelectionAlignment(this,"htRight")&&(e=n.markSelected(e)),e},callback:function(){r.call(this,this.getSelectedRange(),"horizontal","htRight")},disabled:!1},{name:function(){var e="Justify";return n.checkSelectionAlignment(this,"htJustify")&&(e=n.markSelected(e)),e},callback:function(){r.call(this,this.getSelectedRange(),"horizontal","htJustify")},disabled:!1},a.SEPARATOR,{name:function(){var e="Top";return n.checkSelectionAlignment(this,"htTop")&&(e=n.markSelected(e)),e},callback:function(){r.call(this,this.getSelectedRange(),"vertical","htTop")},disabled:!1},{name:function(){var e="Middle";return n.checkSelectionAlignment(this,"htMiddle")&&(e=n.markSelected(e)),e},callback:function(){r.call(this,this.getSelectedRange(),"vertical","htMiddle")},disabled:!1},{name:function(){var e="Bottom";return n.checkSelectionAlignment(this,"htBottom")&&(e=n.markSelected(e)),e},callback:function(){r.call(this,this.getSelectedRange(),"vertical","htBottom")},disabled:!1}]}}]},n.options={},e.helper.extend(n.options,this.options),this.bindMouseEvents(),this.markSelected=function(e){return"<span class='selected'>"+String.fromCharCode(10003)+"</span>"+e},this.checkSelectionAlignment=function(e,t){var n=!1;return e.getSelectedRange().forAll(function(i,o){var r=e.getCellMeta(i,o).className;return r&&-1!=r.indexOf(t)?(n=!0,!1):void 0}),n},!this.instance.getSettings().allowInsertRow){var i=l(this.defaultOptions.items,"row_above");this.defaultOptions.items.splice(i,1);var o=l(this.defaultOptions.items,"row_above");this.defaultOptions.items.splice(o,1),this.defaultOptions.items.splice(o,1)}if(!this.instance.getSettings().allowInsertColumn){var s=l(this.defaultOptions.items,"col_left");this.defaultOptions.items.splice(s,1);var c=l(this.defaultOptions.items,"col_right");this.defaultOptions.items.splice(c,1),this.defaultOptions.items.splice(c,1)}var d,u,h=!1,p=!1;this.instance.getSettings().allowRemoveRow||(d=l(this.defaultOptions.items,"remove_row"),this.defaultOptions.items.splice(d,1),h=!0),this.instance.getSettings().allowRemoveColumn||(u=l(this.defaultOptions.items,"remove_col"),this.defaultOptions.items.splice(u,1),p=!0),h&&p&&this.defaultOptions.items.splice(u,1),this.checkSelectionReadOnlyConsistency=function(e){var t=!1;return e.getSelectedRange().forAll(function(n,i){return e.getCellMeta(n,i).readOnly?(t=!0,!1):void 0}),t},e.hooks.run(t,"afterContextMenuDefaultOptions",this.defaultOptions)}function s(e,t){for(var n=0,i=e.length;i>n;n++)if(e[n].key===t)return e[n]}function l(e,t){for(var n=0,i=e.length;i>n;n++)if(e[n].key===t)return n}function c(){var t=this,n=t.getSettings().contextMenu,i=e.helper.isObject(n)?n:{};n?(t.contextMenu||(t.contextMenu=new a(t,i)),t.contextMenu.enable()):t.contextMenu&&(t.contextMenu.destroy(),delete t.contextMenu)}a.prototype.createMenu=function(t,n){t&&(t=t.replace(/ /g,"_"),t="htContextSubMenu_"+t);var i;return(i=document.querySelector(t?".htContextMenu."+t:".htContextMenu"))||(i=document.createElement("DIV"),e.Dom.addClass(i,"htContextMenu"),t&&e.Dom.addClass(i,t),document.getElementsByTagName("body")[0].appendChild(i)),this.menus.indexOf(i)<0&&(this.menus.push(i),n=n||0,this.triggerRows.push(n)),i},a.prototype.bindMouseEvents=function(){e.eventManager(this.instance).addEventListener(this.instance.rootElement,"contextmenu",e.helper.proxy(function(t){var n=this.instance.getSettings();this.closeAll(),t.preventDefault(),e.helper.stopPropagation(t);var i=this.instance.getSettings().rowHeaders,o=this.instance.getSettings().colHeaders;if(i||o){if(i&&o&&t.target.parentNode.querySelectorAll(".cornerHeader").length>0)return}else if(!("TD"==t.target.nodeName||e.Dom.hasClass(t.target,"current")&&e.Dom.hasClass(t.target,"wtBorder")))return;var r=this.createMenu(),s=this.getItems(n.contextMenu);this.show(r,s),this.setMenuPosition(t,r),this.eventManager.addEventListener(document.documentElement,"mousedown",e.helper.proxy(a.prototype.closeAll,this))},this))},a.prototype.bindTableEvents=function(){this._afterScrollCallback=function(){},this.instance.addHook("afterScrollVertically",this._afterScrollCallback),this.instance.addHook("afterScrollHorizontally",this._afterScrollCallback)},a.prototype.unbindTableEvents=function(){this._afterScrollCallback&&(this.instance.removeHook("afterScrollVertically",this._afterScrollCallback),this.instance.removeHook("afterScrollHorizontally",this._afterScrollCallback),this._afterScrollCallback=null)},a.prototype.performAction=function(e,t){var n=this,i=t.getSelected()[0],o=t.getData()[i];if(!0!==o.disabled&&("function"!=typeof o.disabled||!0!==o.disabled.call(this.instance))&&!o.hasOwnProperty("submenu")){if("function"!=typeof o.callback)return;var r=this.instance.getSelectedRange(),s=a.utils.normalizeSelection(r);o.callback.call(this.instance,o.key,s,e),n.closeAll()}},a.prototype.unbindMouseEvents=function(){this.eventManager.clear(),e.eventManager(this.instance).removeEventListener(this.instance.rootElement,"contextmenu")},a.prototype.show=function(t,n){var i=this;t.removeAttribute("style"),t.style.display="block";var o={data:n,colHeaders:!1,colWidths:[200],readOnly:!0,copyPaste:!1,columns:[{data:"name",renderer:e.helper.proxy(this.renderer,this)}],renderAllRows:!0,beforeKeyDown:function(e){i.onBeforeKeyDown(e,r)},afterOnCellMouseOver:function(e,t,n){i.onCellMouseOver(e,t,n,r)}},r=new e(t,o);this.eventManager.removeEventListener(t,"mousedown"),this.eventManager.addEventListener(t,"mousedown",function(e){i.performAction(e,r)}),this.bindTableEvents(),r.listen(),this.htMenus[r.guid]=r},a.prototype.close=function(e){this.hide(e),this.eventManager.clear(),this.unbindTableEvents(),this.instance.listen()},a.prototype.closeAll=function(){for(;this.menus.length>0;){var e=this.menus.pop();e&&this.close(e)}this.triggerRows=[]},a.prototype.closeLastOpenedSubMenu=function(){var e=this.menus.pop();e&&this.hide(e)},a.prototype.hide=function(e){e.style.display="none",this.htMenus[e.id].destroy(),delete this.htMenus[e.id]},a.prototype.renderer=function(t,n,i,o,r,s){var l=this,c=t.getData()[i],d=document.createElement("DIV");"function"==typeof s&&(s=s.call(this.instance)),e.Dom.empty(n),n.appendChild(d),function(e){return new RegExp(a.SEPARATOR.name,"i").test(e.name)}(c)?e.Dom.addClass(n,"htSeparator"):e.Dom.fastInnerHTML(d,s),function(e){return!0===e.disabled||"function"==typeof e.disabled&&!0===e.disabled.call(l.instance)}(c)?(e.Dom.addClass(n,"htDisabled"),this.eventManager.addEventListener(d,"mouseenter",function(){t.deselectCell()})):function(e){return e.hasOwnProperty("submenu")}(c)?(e.Dom.addClass(n,"htSubmenu"),this.eventManager.addEventListener(d,"mouseenter",function(){t.selectCell(i,o)})):(e.Dom.removeClass(n,"htSubmenu"),e.Dom.removeClass(n,"htDisabled"),this.eventManager.addEventListener(d,"mouseenter",function(){t.selectCell(i,o)}))},a.prototype.onCellMouseOver=function(e,t,n,i){var o=this.menus.length;if(o>0?this.menus[o-1].id!=i.guid&&this.closeLastOpenedSubMenu():this.closeLastOpenedSubMenu(),-1!=n.className.indexOf("htSubmenu")){var r=i.getData()[t.row],a=this.getItems(r.submenu),s=this.createMenu(r.name,t.row),l=n.getBoundingClientRect();this.show(s,a),this.setSubMenuPosition(l,s)}},a.prototype.onBeforeKeyDown=function(t,n){function i(e,t,n){var o=e+1,r=o<n.countRows()?n.getCell(o,t):null;r&&(a.utils.isSeparator(r)||a.utils.isDisabled(r)?i(o,t,n):n.selectCell(o,t))}function o(e,t,n){var i=e-1,r=i>=0?n.getCell(i,t):null;r&&(a.utils.isSeparator(r)||a.utils.isDisabled(r)?o(i,t,n):n.selectCell(i,t))}e.Dom.enableImmediatePropagation(t);var r=this,s=n.getSelected();switch(t.keyCode){case e.helper.keyCode.ESCAPE:r.closeAll(),t.preventDefault(),t.stopImmediatePropagation();break;case e.helper.keyCode.ENTER:s&&r.performAction(t,n);break;case e.helper.keyCode.ARROW_DOWN:s?i(s[0],s[1],n,r):function(e){var t=e.getCell(0,0);a.utils.isSeparator(t)||a.utils.isDisabled(t)?i(0,0,e):e.selectCell(0,0)}(n),t.preventDefault(),t.stopImmediatePropagation();break;case e.helper.keyCode.ARROW_UP:s?o(s[0],s[1],n,r):function(e){var t=e.countRows()-1,n=e.getCell(t,0);a.utils.isSeparator(n)||a.utils.isDisabled(n)?o(t,0,e):e.selectCell(t,0)}(n),t.preventDefault(),t.stopImmediatePropagation();break;case e.helper.keyCode.ARROW_RIGHT:if(s){var l=s[0],c=n.getCell(s[0],0);a.utils.hasSubMenu(c)&&function(e,t,n,i){var o=e.getData()[i],r=t.getItems(o.submenu),a=t.createMenu(o.name,i),s=n.getBoundingClientRect(),l=t.show(a,r);t.setSubMenuPosition(s,a),l.selectCell(0,0)}(n,r,c,l)}t.preventDefault(),t.stopImmediatePropagation();break;case e.helper.keyCode.ARROW_LEFT:if(s){if(-1!=n.rootElement.className.indexOf("htContextSubMenu_")){r.closeLastOpenedSubMenu();var d=r.menus.length;if(d>0){var u=r.menus[d-1],h=r.triggerRows.pop();(n=this.htMenus[u.id]).selectCell(h,0)}}t.preventDefault(),t.stopImmediatePropagation()}}},a.prototype.getItems=function(t){function n(t){"string"==typeof t?this.name=t:e.helper.extend(this,t)}var i,o;n.prototype=t,t&&t.items&&(t=t.items),!0===t&&(t=this.defaultOptions.items),i=[];for(var r in t)t.hasOwnProperty(r)&&((o="string"==typeof t[r]?s(this.defaultOptions.items,t[r]):s(this.defaultOptions.items,r))||(o=t[r]),o=new n(o),"object"==typeof t[r]&&e.helper.extend(o,t[r]),o.key||(o.key=r),i.push(o));return i},a.prototype.setSubMenuPosition=function(t,n){var i=e.Dom.getWindowScrollTop(),o=e.Dom.getWindowScrollLeft(),r={top:i+t.top,topRelative:t.top,left:t.left,leftRelative:t.left-o,scrollTop:i,scrollLeft:o,cellHeight:t.height,cellWidth:t.width};this.menuFitsBelowCursor(r,n,document.body.clientWidth)?this.positionMenuBelowCursor(r,n,!0):this.menuFitsAboveCursor(r,n)?this.positionMenuAboveCursor(r,n,!0):this.positionMenuBelowCursor(r,n,!0),this.menuFitsOnRightOfCursor(r,n,document.body.clientWidth)?this.positionMenuOnRightOfCursor(r,n,!0):this.positionMenuOnLeftOfCursor(r,n,!0)},a.prototype.setMenuPosition=function(t,n){var i=e.Dom.getWindowScrollTop(),o=e.Dom.getWindowScrollLeft(),r=t.pageY||t.clientY+i,a=t.pageX||t.clientX+o,s={top:r,topRelative:r-i,left:a,leftRelative:a-o,scrollTop:i,scrollLeft:o,cellHeight:t.target.clientHeight,cellWidth:t.target.clientWidth};this.menuFitsBelowCursor(s,n,document.body.clientHeight)?this.positionMenuBelowCursor(s,n):this.menuFitsAboveCursor(s,n)?this.positionMenuAboveCursor(s,n):this.positionMenuBelowCursor(s,n),this.menuFitsOnRightOfCursor(s,n,document.body.clientWidth)?this.positionMenuOnRightOfCursor(s,n):this.positionMenuOnLeftOfCursor(s,n)},a.prototype.menuFitsAboveCursor=function(e,t){return e.topRelative>=t.offsetHeight},a.prototype.menuFitsBelowCursor=function(e,t,n){return e.topRelative+t.offsetHeight<=n},a.prototype.menuFitsOnRightOfCursor=function(e,t,n){return e.leftRelative+t.offsetWidth<=n},a.prototype.positionMenuBelowCursor=function(e,t){t.style.top=e.top+"px"},a.prototype.positionMenuAboveCursor=function(e,t,n){t.style.top=n?e.top+e.cellHeight-t.offsetHeight+"px":e.top-t.offsetHeight+"px"},a.prototype.positionMenuOnRightOfCursor=function(e,t,n){t.style.left=n?1+e.left+e.cellWidth+"px":1+e.left+"px"},a.prototype.positionMenuOnLeftOfCursor=function(e,t,n){t.style.left=e.left-t.offsetWidth+"px"},a.utils={},a.utils.normalizeSelection=function(e){return{start:e.getTopLeftCorner(),end:e.getBottomRightCorner()}},a.utils.isSeparator=function(t){return e.Dom.hasClass(t,"htSeparator")},a.utils.hasSubMenu=function(t){return e.Dom.hasClass(t,"htSubmenu")},a.utils.isDisabled=function(t){return e.Dom.hasClass(t,"htDisabled")},a.prototype.enable=function(){this.enabled||(this.enabled=!0,this.bindMouseEvents())},a.prototype.disable=function(){this.enabled&&(this.enabled=!1,this.closeAll(),this.unbindMouseEvents(),this.unbindTableEvents())},a.prototype.destroy=function(){for(this.closeAll();this.menus.length>0;){var e=this.menus.pop();this.triggerRows.pop(),e&&(this.close(e),this.isMenuEnabledByOtherHotInstance()||this.removeMenu(e))}this.unbindMouseEvents(),this.unbindTableEvents()},a.prototype.isMenuEnabledByOtherHotInstance=function(){for(var e=document.querySelectorAll(".handsontable"),t=!1,n=0,i=e.length;i>n;n++){var o=this.htMenus[e[n].id];if(o&&o.getSettings().contextMenu){t=!0;break}}return t},a.prototype.removeMenu=function(e){e.parentNode&&this.menu.parentNode.removeChild(e)},a.prototype.align=function(e,t,n){r.call(this,e,t,n)},a.SEPARATOR={name:"---------"},e.hooks.add("afterInit",c),e.hooks.add("afterUpdateSettings",c),e.hooks.add("afterInit",function(){if(!this.rootElement.className.indexOf("htContextMenu")){for(var e=0,t=0,n=this.getSettings().data.length,i=0;n>i;i++)this.getSettings().data[i].name==a.SEPARATOR.name?e+=2:t+=26;this.view.wt.wtScrollbars.vertical.fixedContainer.style.height=t+e+"px"}}),e.PluginHooks.register("afterContextMenuDefaultOptions"),e.ContextMenu=a}(t);var H=function(){var e=this;e.getSettings().comments&&(t.Comments=new i(e),t.Comments.init())},B=function(e,n,i,o,r,a){a.comment&&t.Dom.addClass(e,a.commentedCellClassName)};t.hooks.add("beforeInit",H),t.hooks.add("afterContextMenuDefaultOptions",function(e){this.getSettings().comments&&(e.items.push(t.ContextMenu.SEPARATOR),e.items.push({key:"commentsAddEdit",name:function(){return t.Comments.checkSelectionCommentsConsistency()?"Edit Comment":"Add Comment"},callback:function(){t.Comments.showComment(this.getSelectedRange())},disabled:function(){return!1}}),e.items.push({key:"commentsRemove",name:function(){return"Delete Comment"},callback:function(e,n){t.Comments.removeComment(n.start.row,n.start.col)},disabled:function(){return!t.Comments.checkSelectionCommentsConsistency()}}))}),t.hooks.add("afterRenderer",B),function(t){var n=new function(){function n(e){h=this,p=e;var t=this.view.wt.wtTable.getCoords(e).col;if(t>=0){u=t;var n=p.getBoundingClientRect();d=n.left,f.style.top=n.top+"px",f.style.left=d+"px",h.rootElement.appendChild(f)}}function i(e,t){var n=e.getBoundingClientRect();f.style.left=t>0?n.left+n.width-6+"px":n.left+"px"}function o(){var e=this;t.Dom.addClass(f,"active"),t.Dom.addClass(g,"active");var n=p.getBoundingClientRect();g.style.width=n.width+"px",g.style.height=e.view.maximumVisibleElementHeight(0)+"px",g.style.top=f.style.top,g.style.left=d+"px",e.rootElement.appendChild(g)}function r(e){g.style.left=d+e+"px"}function a(){t.Dom.removeClass(f,"active"),t.Dom.removeClass(g,"active")}var s,l,c,d,u,h,p,f=document.createElement("DIV"),g=document.createElement("DIV"),v=t.eventManager(this);f.className="manualColumnMover",g.className="manualColumnMoverGuide";var m=function(){var e=this;t.hooks.run(e,"persistentStateSave","manualColumnPositions",e.manualColumnPositions)},y=function(){var e=this,n={};return t.hooks.run(e,"persistentStateLoad","manualColumnPositions",n),n.value},w=function(e){return"BODY"!=e.tagName&&("THEAD"==e.parentNode.tagName||(e=e.parentNode,w(e)))},b=function(e){return"TABLE"!=e.tagName?"TH"==e.tagName?e:b(e.parentNode):null},C=function(){var d,h=this;v.addEventListener(h.rootElement,"mouseover",function(e){if(w(e.target)){var t=b(e.target);if(t)if(d){var o=h.view.wt.wtTable.getCoords(t).col;o>=0&&(l=o,i(e.target,l-s))}else n.call(h,t)}}),v.addEventListener(h.rootElement,"mousedown",function(e){t.Dom.hasClass(e.target,"manualColumnMover")&&(c=t.helper.pageX(e),o.call(h),d=h,s=u,l=u)}),v.addEventListener(e,"mousemove",function(e){d&&r(t.helper.pageX(e)-c)}),v.addEventListener(e,"mouseup",function(){d&&(a(),d=!1,E(h.manualColumnPositions,h.countCols()),h.manualColumnPositions.splice(l,0,h.manualColumnPositions.splice(s,1)[0]),h.forceFullRender=!0,h.view.render(),m.call(h),t.hooks.run(h,"afterColumnMove",s,l),n.call(h,p))}),h.addHook("afterDestroy",x)},x=function(){v.clear()},E=function(e,t){if(e.length<t)for(var n=e.length;t>n;n++)e[n]=n};this.beforeInit=function(){this.manualColumnPositions=[]},this.init=function(e){var t=this;if(this.getSettings().manualColumnMove){var n=this.getSettings().manualColumnMove,i=y.call(t);this.manualColumnPositions=void 0!==i?i:Array.isArray(n)?n:[],"afterInit"==e&&(void 0!==t.manualColumnPositionsPluginUsages?t.manualColumnPositionsPluginUsages.push("manualColumnMove"):t.manualColumnPositionsPluginUsages=["manualColumnMove"],C.call(this),this.manualColumnPositions.length>0&&(this.forceFullRender=!0,this.render()))}else{var o=t.manualColumnPositionsPluginUsages?t.manualColumnPositionsPluginUsages.indexOf("manualColumnMove"):-1;o>-1&&(x.call(this),this.manualColumnPositions=[],t.manualColumnPositionsPluginUsages[o]=void 0)}},this.modifyCol=function(e){return this.getSettings().manualColumnMove?(void 0===this.manualColumnPositions[e]&&E(this.manualColumnPositions,e+1),this.manualColumnPositions[e]):e},this.afterRemoveCol=function(e,t){if(this.getSettings().manualColumnMove){var n,i=this.manualColumnPositions;n=i.splice(e,t),i=i.map(function(e){var t,i=e;for(t=0;t<n.length;t++)e>n[t]&&i--;return i}),this.manualColumnPositions=i}},this.afterCreateCol=function(e,t){if(this.getSettings().manualColumnMove){var n=this.manualColumnPositions;if(n.length){for(var i=[],o=0;t>o;o++)i.push(e+o);e>=n.length?n.concat(i):(n=n.map(function(n){return n>=e?n+t:n})).splice.apply(n,[e,0].concat(i)),this.manualColumnPositions=n}}}};t.hooks.add("beforeInit",n.beforeInit),t.hooks.add("afterInit",function(){n.init.call(this,"afterInit")}),t.hooks.add("afterUpdateSettings",function(){n.init.call(this,"afterUpdateSettings")}),t.hooks.add("modifyCol",n.modifyCol),t.hooks.add("afterRemoveCol",n.afterRemoveCol),t.hooks.add("afterCreateCol",n.afterCreateCol),t.hooks.register("afterColumnMove")}(t),function(t){var n=new function(){function n(e){d=this,s=e;var t=this.view.wt.wtTable.getCoords(e).col;if(t>=0){l=t;var n=s.getBoundingClientRect();f=n.left-6,p=parseInt(n.width,10),g.style.top=n.top+"px",g.style.left=f+p+"px",d.rootElement.appendChild(g)}}function i(){g.style.left=f+c+"px"}function o(){var e=this;t.Dom.addClass(g,"active"),t.Dom.addClass(v,"active"),v.style.top=g.style.top,v.style.left=g.style.left,v.style.height=e.view.maximumVisibleElementHeight(0)+"px",e.rootElement.appendChild(v)}function r(){v.style.left=g.style.left}function a(){t.Dom.removeClass(g,"active"),t.Dom.removeClass(v,"active")}var s,l,c,d,u,h,p,f,g=document.createElement("DIV"),v=document.createElement("DIV"),m=t.eventManager(this);g.className="manualColumnResizer",v.className="manualColumnResizerGuide";var y=function(){var e=this;t.hooks.run(e,"persistentStateSave","manualColumnWidths",e.manualColumnWidths)},w=function(){var e=this,n={};return t.hooks.run(e,"persistentStateLoad","manualColumnWidths",n),n.value},b=function(e){return"BODY"!=e.tagName&&("THEAD"==e.parentNode.tagName||(e=e.parentNode,b(e)))},C=function(e){return"TABLE"!=e.tagName?"TH"==e.tagName?e:C(e.parentNode):null},x=function(){var d,f=this,g=0,v=null;m.addEventListener(f.rootElement,"mouseover",function(e){if(b(e.target)){var t=C(e.target);t&&(d||n.call(f,t))}}),m.addEventListener(f.rootElement,"mousedown",function(e){t.Dom.hasClass(e.target,"manualColumnResizer")&&(o.call(f),d=f,null==v&&(v=setTimeout(function(){g>=2&&(u=f.determineColumnWidth.call(f,l),_(l,u),f.forceFullRender=!0,f.view.render(),t.hooks.run(f,"afterColumnResize",l,u)),g=0,v=null},500),f._registerTimeout(v)),g++,h=t.helper.pageX(e),u=p)}),m.addEventListener(e,"mousemove",function(e){d&&(c=p+(t.helper.pageX(e)-h),u=_(l,c),i(),r())}),m.addEventListener(e,"mouseup",function(){d&&(a(),d=!1,u!=p&&(f.forceFullRender=!0,f.view.render(),y.call(f),t.hooks.run(f,"afterColumnResize",l,u)),n.call(f,s))}),f.addHook("afterDestroy",E)},E=function(){m.clear()};this.beforeInit=function(){this.manualColumnWidths=[]},this.init=function(e){var t=this;if(this.getSettings().manualColumnResize){var n=this.getSettings().manualColumnResize,i=w.call(t);void 0!==t.manualColumnWidthsPluginUsages?t.manualColumnWidthsPluginUsages.push("manualColumnResize"):t.manualColumnWidthsPluginUsages=["manualColumnResize"],this.manualColumnWidths=void 0!==i?i:Array.isArray(n)?n:[],"afterInit"==e&&(x.call(this),this.manualColumnWidths.length>0&&(this.forceFullRender=!0,this.render()))}else(t.manualColumnWidthsPluginUsages?t.manualColumnWidthsPluginUsages.indexOf("manualColumnResize"):-1)>-1&&(E.call(this),this.manualColumnWidths=[])};var _=function(e,n){return n=Math.max(n,20),e=t.hooks.run(d,"modifyCol",e),d.manualColumnWidths[e]=n,n};this.modifyColWidth=function(e,t){return t=this.runHooks("modifyCol",t),this.getSettings().manualColumnResize&&this.manualColumnWidths[t]?this.manualColumnWidths[t]:e}};t.hooks.add("beforeInit",n.beforeInit),t.hooks.add("afterInit",function(){n.init.call(this,"afterInit")}),t.hooks.add("afterUpdateSettings",function(){n.init.call(this,"afterUpdateSettings")}),t.hooks.add("modifyColWidth",n.modifyColWidth),t.hooks.register("afterColumnResize")}(t),function(t){var n=new function(){function n(e){d=this,s=e;var t=this.view.wt.wtTable.getCoords(e).row;if(t>=0){l=t;var n=s.getBoundingClientRect();f=n.top-6,p=parseInt(n.height,10),g.style.left=n.left+"px",g.style.top=f+p+"px",d.rootElement.appendChild(g)}}function i(){g.style.top=f+c+"px"}function o(){var e=this;t.Dom.addClass(g,"active"),t.Dom.addClass(v,"active"),v.style.top=g.style.top,v.style.left=g.style.left,v.style.width=e.view.maximumVisibleElementWidth(0)+"px",e.rootElement.appendChild(v)}function r(){v.style.top=g.style.top}function a(){t.Dom.removeClass(g,"active"),t.Dom.removeClass(v,"active")}var s,l,c,d,u,h,p,f,g=document.createElement("DIV"),v=document.createElement("DIV"),m=t.eventManager(this);g.className="manualRowResizer",v.className="manualRowResizerGuide";var y=function(){var e=this;t.hooks.run(e,"persistentStateSave","manualRowHeights",e.manualRowHeights)},w=function(){var e=this,n={};return t.hooks.run(e,"persistentStateLoad","manualRowHeights",n),n.value},b=function(e){return"BODY"!=e.tagName&&("TBODY"==e.parentNode.tagName||(e=e.parentNode,b(e)))},C=function(e){return"TABLE"!=e.tagName?"TH"==e.tagName?e:C(e.parentNode):null},x=function(){var d,f=this,g=0,v=null;m.addEventListener(f.rootElement,"mouseover",function(e){if(b(e.target)){var t=C(e.target);t&&(d||n.call(f,t))}}),m.addEventListener(f.rootElement,"mousedown",function(e){t.Dom.hasClass(e.target,"manualRowResizer")&&(o.call(f),d=f,null==v&&(v=setTimeout(function(){g>=2&&(_(l,null),f.forceFullRender=!0,f.view.render(),t.hooks.run(f,"afterRowResize",l,u)),g=0,v=null},500),f._registerTimeout(v)),g++,h=t.helper.pageY(e),u=p)}),m.addEventListener(e,"mousemove",function(e){d&&(c=p+(t.helper.pageY(e)-h),u=_(l,c),i(),r())}),m.addEventListener(e,"mouseup",function(){d&&(a(),d=!1,u!=p&&(f.forceFullRender=!0,f.view.render(),y.call(f),t.hooks.run(f,"afterRowResize",l,u)),n.call(f,s))}),f.addHook("afterDestroy",E)},E=function(){m.clear()};this.beforeInit=function(){this.manualRowHeights=[]},this.init=function(e){var t=this;if(this.getSettings().manualRowResize){var n=this.getSettings().manualRowResize,i=w.call(t);void 0!==t.manualRowHeightsPluginUsages?t.manualRowHeightsPluginUsages.push("manualRowResize"):t.manualRowHeightsPluginUsages=["manualRowResize"],this.manualRowHeights=void 0!==i?i:Array.isArray(n)?n:[],"afterInit"===e?(x.call(this),this.manualRowHeights.length>0&&(this.forceFullRender=!0,this.render())):(this.forceFullRender=!0,this.render())}else{var o=t.manualRowHeightsPluginUsages?t.manualRowHeightsPluginUsages.indexOf("manualRowResize"):-1;o>-1&&(E.call(this),this.manualRowHeights=[],t.manualRowHeightsPluginUsages[o]=void 0)}};var _=function(e,n){return e=t.hooks.run(d,"modifyRow",e),d.manualRowHeights[e]=n,n};this.modifyRowHeight=function(e,t){return this.getSettings().manualRowResize&&(t=this.runHooks("modifyRow",t),void 0!==this.manualRowHeights[t])?this.manualRowHeights[t]:e}};t.hooks.add("beforeInit",n.beforeInit),t.hooks.add("afterInit",function(){n.init.call(this,"afterInit")}),t.hooks.add("afterUpdateSettings",function(){n.init.call(this,"afterUpdateSettings")}),t.hooks.add("modifyRowHeight",n.modifyRowHeight),t.hooks.register("afterRowResize")}(t),function(){function e(){var e=this,t=e.getSettings().observeChanges;t?(e.observer&&o.call(e),n.call(e),a.call(e)):t||o.call(e)}function n(){var e=this;e.observeChangesActive=!0,e.pauseObservingChanges=function(){e.observeChangesActive=!1},e.resumeObservingChanges=function(){e.observeChangesActive=!0},e.observedData=e.getData(),e.observer=I.observe(e.observedData,function(t){e.observeChangesActive&&(i.call(e,t),e.render()),e.runHooks("afterChangesObserved")})}function i(e){function t(e){var t=[];return e.filter(function(e){var n=i(e.path);if(-1!=["add","remove"].indexOf(e.op)&&!isNaN(n.col)){if(-1!=t.indexOf(n.col))return!1;t.push(n.col)}return!0})}function n(e){return e.filter(function(e){return!/[/]length/gi.test(e.path)})}function i(e){var t=e.match(/^\/(\d+)\/?(.*)?$/);return{row:parseInt(t[1],10),col:/^\d*$/.test(t[2])?parseInt(t[2],10):t[2]}}for(var o=this,r=function(e){var i;return i=n(e),i=t(i)}(e),a=0,s=r.length;s>a;a++){var l=r[a],c=i(l.path);switch(l.op){case"add":isNaN(c.col)?o.runHooks("afterCreateRow",c.row):o.runHooks("afterCreateCol",c.col);break;case"remove":isNaN(c.col)?o.runHooks("afterRemoveRow",c.row,1):o.runHooks("afterRemoveCol",c.col,1);break;case"replace":o.runHooks("afterChange",[c.row,c.col,null,l.value],"external")}}}function o(){var e=this;e.observer&&(r.call(e),s.call(e))}function r(){var e=this;I.unobserve(e.observedData,e.observer),delete e.observeChangesActive,delete e.pauseObservingChanges,delete e.resumeObservingChanges}function a(){var e=this;e.addHook("afterDestroy",o),e.addHook("afterCreateRow",l),e.addHook("afterRemoveRow",l),e.addHook("afterCreateCol",l),e.addHook("afterRemoveCol",l),e.addHook("afterChange",function(e,t){"loadData"!=t&&l.call(this)})}function s(){var e=this;e.removeHook("afterDestroy",o),e.removeHook("afterCreateRow",l),e.removeHook("afterRemoveRow",l),e.removeHook("afterCreateCol",l),e.removeHook("afterRemoveCol",l),e.removeHook("afterChange",l)}function l(){var e=this;e.pauseObservingChanges(),e.addHookOnce("afterChangesObserved",function(){e.resumeObservingChanges()})}t.hooks.add("afterLoadData",e),t.hooks.add("afterUpdateSettings",e),t.hooks.register("afterChangesObserved")}(),function(e){var n=new function(){function n(){var e=this;for(var t in r)r.hasOwnProperty(t)&&e.addHook(t,r[t])}function i(){var e=this;for(var t in r)r.hasOwnProperty(t)&&e.removeHook(t,r[t])}var o=this;this.init=function(){var t=this,r=t.getSettings().persistentState;return o.enabled=!!r,o.enabled?(t.storage||(t.storage=new e(t.rootElement.id)),t.resetState=o.resetValue,void n.call(t)):void i.call(t)},this.saveValue=function(e,t){this.storage.saveValue(e,t)},this.loadValue=function(e,t){var n=this;t.value=n.storage.loadValue(e)},this.resetValue=function(e){var t=this;void 0!==e?t.storage.reset(e):t.storage.resetAll()};var r={persistentStateSave:o.saveValue,persistentStateLoad:o.loadValue,persistentStateReset:o.resetValue};for(var a in r)r.hasOwnProperty(a)&&t.hooks.register(a)};t.hooks.add("beforeInit",n.init),t.hooks.add("afterUpdateSettings",n.init)}(function(t){var n,i=function(){e.localStorage[t+"__persistentStateKeys"]=JSON.stringify(n)},o=function(){n=[],i()};(function(){var i=e.localStorage[t+"__persistentStateKeys"],o="string"==typeof i?JSON.parse(i):void 0;n=o||[]})(),this.saveValue=function(o,r){e.localStorage[t+"_"+o]=JSON.stringify(r),-1==n.indexOf(o)&&(n.push(o),i())},this.loadValue=function(n,i){n=void 0!==n?n:i;var o=e.localStorage[t+"_"+n];return void 0===o?void 0:JSON.parse(o)},this.reset=function(n){e.localStorage.removeItem(t+"_"+n)},this.resetAll=function(){for(var i=0;i<n.length;i++)e.localStorage.removeItem(t+"_"+n[i]);o()}}),function(e){e.UndoRedo=function(t){var n=this;this.instance=t,this.doneActions=[],this.undoneActions=[],this.ignoreNewActions=!1,t.addHook("afterChange",function(t){if(t){var i=new e.UndoRedo.ChangeAction(t);n.done(i)}}),t.addHook("afterCreateRow",function(t,i,o){if(!o){var r=new e.UndoRedo.CreateRowAction(t,i);n.done(r)}}),t.addHook("beforeRemoveRow",function(t,i){var o=n.instance.getData();t=(o.length+t)%o.length;var r=o.slice(t,t+i),a=new e.UndoRedo.RemoveRowAction(t,r);n.done(a)}),t.addHook("afterCreateCol",function(t,i,o){if(!o){var r=new e.UndoRedo.CreateColumnAction(t,i);n.done(r)}}),t.addHook("beforeRemoveCol",function(i,o){var r=n.instance.getData();i=(n.instance.countCols()+i)%n.instance.countCols();for(var a=[],s=0,l=r.length;l>s;s++)a[s]=r[s].slice(i,i+o);var c;Array.isArray(t.getSettings().colHeaders)&&(c=t.getSettings().colHeaders.slice(i,i+a.length));var d=new e.UndoRedo.RemoveColumnAction(i,a,c);n.done(d)}),t.addHook("beforeCellAlignment",function(t,i,o,r){var a=new e.UndoRedo.CellAlignmentAction(t,i,o,r);n.done(a)})},e.UndoRedo.prototype.done=function(e){this.ignoreNewActions||(this.doneActions.push(e),this.undoneActions.length=0)},e.UndoRedo.prototype.undo=function(){if(this.isUndoAvailable()){var e=this.doneActions.pop();this.ignoreNewActions=!0;var t=this;e.undo(this.instance,function(){t.ignoreNewActions=!1,t.undoneActions.push(e)})}},e.UndoRedo.prototype.redo=function(){if(this.isRedoAvailable()){var e=this.undoneActions.pop();this.ignoreNewActions=!0;var t=this;e.redo(this.instance,function(){t.ignoreNewActions=!1,t.doneActions.push(e)})}},e.UndoRedo.prototype.isUndoAvailable=function(){return this.doneActions.length>0},e.UndoRedo.prototype.isRedoAvailable=function(){return this.undoneActions.length>0},e.UndoRedo.prototype.clear=function(){this.doneActions.length=0,this.undoneActions.length=0},e.UndoRedo.Action=function(){},e.UndoRedo.Action.prototype.undo=function(){},e.UndoRedo.Action.prototype.redo=function(){},e.UndoRedo.ChangeAction=function(e){this.changes=e},e.helper.inherit(e.UndoRedo.ChangeAction,e.UndoRedo.Action),e.UndoRedo.ChangeAction.prototype.undo=function(t,n){for(var i=e.helper.deepClone(this.changes),o=t.countEmptyRows(!0),r=t.countEmptyCols(!0),a=0,s=i.length;s>a;a++)i[a].splice(3,1);t.addHookOnce("afterChange",n),t.setDataAtRowProp(i,null,null,"undo");for(var a=0,s=i.length;s>a;a++)t.getSettings().minSpareRows&&i[a][0]+1+t.getSettings().minSpareRows===t.countRows()&&o==t.getSettings().minSpareRows&&(t.alter("remove_row",parseInt(i[a][0]+1,10),t.getSettings().minSpareRows),t.undoRedo.doneActions.pop()),t.getSettings().minSpareCols&&i[a][1]+1+t.getSettings().minSpareCols===t.countCols()&&r==t.getSettings().minSpareCols&&(t.alter("remove_col",parseInt(i[a][1]+1,10),t.getSettings().minSpareCols),t.undoRedo.doneActions.pop())},e.UndoRedo.ChangeAction.prototype.redo=function(t,n){for(var i=e.helper.deepClone(this.changes),o=0,r=i.length;r>o;o++)i[o].splice(2,1);t.addHookOnce("afterChange",n),t.setDataAtRowProp(i,null,null,"redo")},e.UndoRedo.CreateRowAction=function(e,t){this.index=e,this.amount=t},e.helper.inherit(e.UndoRedo.CreateRowAction,e.UndoRedo.Action),e.UndoRedo.CreateRowAction.prototype.undo=function(e,t){var n=e.countRows(),i=e.getSettings().minSpareRows;this.index>=n&&this.index-i<n&&(this.index-=i),e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.amount)},e.UndoRedo.CreateRowAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateRow",t),e.alter("insert_row",this.index+1,this.amount)},e.UndoRedo.RemoveRowAction=function(e,t){this.index=e,this.data=t},e.helper.inherit(e.UndoRedo.RemoveRowAction,e.UndoRedo.Action),e.UndoRedo.RemoveRowAction.prototype.undo=function(e,t){var n=[this.index,0];Array.prototype.push.apply(n,this.data),Array.prototype.splice.apply(e.getData(),n),e.addHookOnce("afterRender",t),e.render()},e.UndoRedo.RemoveRowAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveRow",t),e.alter("remove_row",this.index,this.data.length)},e.UndoRedo.CreateColumnAction=function(e,t){this.index=e,this.amount=t},e.helper.inherit(e.UndoRedo.CreateColumnAction,e.UndoRedo.Action),e.UndoRedo.CreateColumnAction.prototype.undo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount)},e.UndoRedo.CreateColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterCreateCol",t),e.alter("insert_col",this.index+1,this.amount)},e.UndoRedo.CellAlignmentAction=function(e,t,n,i){this.stateBefore=e,this.range=t,this.type=n,this.alignment=i},e.UndoRedo.CellAlignmentAction.prototype.undo=function(e,t){if(e.contextMenu){for(var n=this.range.from.row;n<=this.range.to.row;n++)for(var i=this.range.from.col;i<=this.range.to.col;i++)e.setCellMeta(n,i,"className",this.stateBefore[n][i]||" htLeft");e.addHookOnce("afterRender",t),e.render()}},e.UndoRedo.CellAlignmentAction.prototype.redo=function(e,t){if(e.contextMenu){for(var n=this.range.from.row;n<=this.range.to.row;n++)for(var i=this.range.from.col;i<=this.range.to.col;i++)e.contextMenu.align.call(e,this.range,this.type,this.alignment);e.addHookOnce("afterRender",t),e.render()}},e.UndoRedo.RemoveColumnAction=function(e,t,n){this.index=e,this.data=t,this.amount=this.data[0].length,this.headers=n},e.helper.inherit(e.UndoRedo.RemoveColumnAction,e.UndoRedo.Action),e.UndoRedo.RemoveColumnAction.prototype.undo=function(e,t){for(var n,i,o=0,r=e.getData().length;r>o;o++)n=e.getSourceDataAtRow(o),i=[this.index,0],Array.prototype.push.apply(i,this.data[o]),Array.prototype.splice.apply(n,i);void 0!==this.headers&&(i=[this.index,0],Array.prototype.push.apply(i,this.headers),Array.prototype.splice.apply(e.getSettings().colHeaders,i)),e.addHookOnce("afterRender",t),e.render()},e.UndoRedo.RemoveColumnAction.prototype.redo=function(e,t){e.addHookOnce("afterRemoveCol",t),e.alter("remove_col",this.index,this.amount)}}(t),function(e){function t(){var t=this;void 0===t.getSettings().undo||t.getSettings().undo?t.undoRedo||(t.undoRedo=new e.UndoRedo(t),o(t),t.addHook("beforeKeyDown",n),t.addHook("afterChange",i)):t.undoRedo&&(delete t.undoRedo,r(t),t.removeHook("beforeKeyDown",n),t.removeHook("afterChange",i))}function n(e){var t=this;(e.ctrlKey||e.metaKey)&&!e.altKey&&(89===e.keyCode||e.shiftKey&&90===e.keyCode?(t.undoRedo.redo(),e.stopImmediatePropagation()):90===e.keyCode&&(t.undoRedo.undo(),e.stopImmediatePropagation()))}function i(e,t){var n=this;return"loadData"==t?n.undoRedo.clear():void 0}function o(e){e.undo=function(){return e.undoRedo.undo()},e.redo=function(){return e.undoRedo.redo()},e.isUndoAvailable=function(){return e.undoRedo.isUndoAvailable()},e.isRedoAvailable=function(){return e.undoRedo.isRedoAvailable()},e.clearUndo=function(){return e.undoRedo.clear()}}function r(e){delete e.undo,delete e.redo,delete e.isUndoAvailable,delete e.isRedoAvailable,delete e.clearUndo}e.hooks.add("afterInit",t),e.hooks.add("afterUpdateSettings",t)}(t),o.prototype.setBoundaries=function(e){this.boundaries=e},o.prototype.setCallback=function(e){this.callback=e},o.prototype.check=function(e,t){var n=0,i=0;t<this.boundaries.top?i=t-this.boundaries.top:t>this.boundaries.bottom&&(i=t-this.boundaries.bottom),e<this.boundaries.left?n=e-this.boundaries.left:e>this.boundaries.right&&(n=e-this.boundaries.right),this.callback(n,i)};var F,z;if(void 0!==t){var V=function(t){t.dragToScrollListening=!1;var n=t.view.wt.wtScrollbars.vertical.scrollHandler;F=new o,n!==e&&(F.setBoundaries(n.getBoundingClientRect()),F.setCallback(function(e,t){0>e?n.scrollLeft-=50:e>0&&(n.scrollLeft+=50),0>t?n.scrollTop-=20:t>0&&(n.scrollTop+=20)}),t.dragToScrollListening=!0)};t.hooks.add("afterInit",function(){var e=this,n=t.eventManager(this);n.addEventListener(document,"mouseup",function(){e.dragToScrollListening=!1}),n.addEventListener(document,"mousemove",function(t){e.dragToScrollListening&&F.check(t.clientX,t.clientY)})}),t.hooks.add("afterDestroy",function(){t.eventManager(this).clear()}),t.hooks.add("afterOnCellMouseDown",function(){V(this)}),t.hooks.add("afterOnCellCornerMouseDown",function(){V(this)}),t.plugins.DragToScroll=o}if(function(e,t,n){function i(i){function o(){i.isListening()&&i.selection.empty()}function r(e){var t,o,r,a,s,l,u,h,p,f;i.isListening()&&i.selection.isSelected()&&(t=e,o=n.parse(t),r=i.getSelected(),a=new c(r[0],r[1]),s=new c(r[2],r[3]),l=new d(a,a,s),u=l.getTopLeftCorner(),h=l.getBottomRightCorner(),p=u,f=new c(Math.max(h.row,o.length-1+u.row),Math.max(h.col,o[0].length-1+u.col)),i.addHookOnce("afterChange",function(e){e&&e.length&&this.selectCell(p.row,p.col,f.row,f.col)}),i.populateFromArray(p.row,p.col,o,f.row,f.col,"paste",i.getSettings().pasteMode))}function a(t){var n;if(i.getSelected()){if(e.helper.isCtrlKey(t.keyCode))return s.setCopyableText(),void t.stopImmediatePropagation();n=(t.ctrlKey||t.metaKey)&&!t.altKey,t.keyCode==e.helper.keyCode.A&&n&&i._registerTimeout(setTimeout(e.helper.proxy(s.setCopyableText,s),0))}}var s=this;this.copyPasteInstance=t.getInstance(),this.copyPasteInstance.onCut(o),this.copyPasteInstance.onPaste(r),i.addHook("beforeKeyDown",a),this.destroy=function(){this.copyPasteInstance.removeCallback(o),this.copyPasteInstance.removeCallback(r),this.copyPasteInstance.destroy(),i.removeHook("beforeKeyDown",a)},i.addHook("afterDestroy",e.helper.proxy(this.destroy,this)),this.triggerPaste=e.helper.proxy(this.copyPasteInstance.triggerPaste,this.copyPasteInstance),this.triggerCut=e.helper.proxy(this.copyPasteInstance.triggerCut,this.copyPasteInstance),this.setCopyableText=function(){var t=i.getSettings(),n=t.copyRowsLimit,o=t.copyColsLimit,r=i.getSelectedRange(),a=r.getTopLeftCorner(),s=r.getBottomRightCorner(),l=a.row,c=a.col,d=s.row,u=s.col,h=Math.min(d,l+n-1),p=Math.min(u,c+o-1);i.copyPaste.copyPasteInstance.copyable(i.getCopyableData(l,c,h,p)),(d!==h||u!==p)&&e.hooks.run(i,"afterCopyLimit",d-l+1,u-c+1,n,o)}}function o(){var e=this,t=!1!==e.getSettings().copyPaste;t&&!e.copyPaste?e.copyPaste=new i(e):!t&&e.copyPaste&&(e.copyPaste.destroy(),delete e.copyPaste)}e.hooks.add("afterInit",o),e.hooks.add("afterUpdateSettings",o),e.hooks.register("afterCopyLimit")}(t,O,SheetClip),function(e){function t(){var t=this;!!t.getSettings().search?t.search=new e.Search(t):delete t.search}e.Search=function(t){this.query=function(n,i,o){var r=t.countRows(),a=t.countCols(),s=[];i||(i=e.Search.global.getDefaultCallback()),o||(o=e.Search.global.getDefaultQueryMethod());for(var l=0;r>l;l++)for(var c=0;a>c;c++){var d=t.getDataAtCell(l,c),u=t.getCellMeta(l,c),h=u.search.callback||i,p=(u.search.queryMethod||o)(n,d);if(p){var f={row:l,col:c,data:d};s.push(f)}h&&h(t,l,c,d,p)}return s}},e.Search.DEFAULT_CALLBACK=function(e,t,n,i,o){e.getCellMeta(t,n).isSearchResult=o},e.Search.DEFAULT_QUERY_METHOD=function(e,t){return!(void 0===e||null==e||!e.toLowerCase||0===e.length)&&(void 0!==t&&null!=t&&-1!=t.toString().toLowerCase().indexOf(e.toLowerCase()))},e.Search.DEFAULT_SEARCH_RESULT_CLASS="htSearchResult",e.Search.global=function(){var t=e.Search.DEFAULT_CALLBACK,n=e.Search.DEFAULT_QUERY_METHOD,i=e.Search.DEFAULT_SEARCH_RESULT_CLASS;return{getDefaultCallback:function(){return t},setDefaultCallback:function(e){t=e},getDefaultQueryMethod:function(){return n},setDefaultQueryMethod:function(e){n=e},getDefaultSearchResultClass:function(){return i},setDefaultSearchResultClass:function(e){i=e}}}(),e.SearchCellDecorator=function(t,n,i,o,r,a,s){var l="object"==typeof s.search&&s.search.searchResultClass||e.Search.global.getDefaultSearchResultClass();s.isSearchResult?e.Dom.addClass(n,l):e.Dom.removeClass(n,l)};var n=e.renderers.cellDecorator;e.renderers.cellDecorator=function(){n.apply(this,arguments),e.SearchCellDecorator.apply(this,arguments)},e.hooks.add("afterInit",t),e.hooks.add("afterUpdateSettings",t)}(t),a.prototype.canMergeRange=function(e){return!e.isSingle()},a.prototype.mergeRange=function(e){if(this.canMergeRange(e)){var t=e.getTopLeftCorner(),n=e.getBottomRightCorner(),i={};i.row=t.row,i.col=t.col,i.rowspan=n.row-t.row+1,i.colspan=n.col-t.col+1,this.mergedCellInfoCollection.setInfo(i)}},a.prototype.mergeOrUnmergeSelection=function(e){this.mergedCellInfoCollection.getInfo(e.from.row,e.from.col)?this.unmergeSelection(e.from):this.mergeSelection(e)},a.prototype.mergeSelection=function(e){this.mergeRange(e)},a.prototype.unmergeSelection=function(e){var t=this.mergedCellInfoCollection.getInfo(e.row,e.col);this.mergedCellInfoCollection.removeInfo(t.row,t.col)},a.prototype.applySpanProperties=function(e,t,n){var i=this.mergedCellInfoCollection.getInfo(t,n);i?i.row===t&&i.col===n?(e.setAttribute("rowspan",i.rowspan),e.setAttribute("colspan",i.colspan)):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"),e.style.display="none"):(e.removeAttribute("rowspan"),e.removeAttribute("colspan"))},a.prototype.modifyTransform=function(e,t,n){var i={row:n.row,col:n.col};if("modifyTransformStart"==e){this.lastDesiredCoords||(this.lastDesiredCoords=new c(null,null));for(var o=new c(t.highlight.row,t.highlight.col),r=this.mergedCellInfoCollection.getInfo(o.row,o.col),a=0,s=this.mergedCellInfoCollection.length;s>a;a++){var l=this.mergedCellInfoCollection[a];if(l=new c(l.row+l.rowspan-1,l.col+l.colspan-1),t.includes(l)){!0;break}}r&&(new d(f=new c(r.row,r.col),f,g=new c(r.row+r.rowspan-1,r.col+r.colspan-1)).includes(this.lastDesiredCoords)||(this.lastDesiredCoords=new c(null,null)),i.row=this.lastDesiredCoords.row?this.lastDesiredCoords.row-o.row:i.row,i.col=this.lastDesiredCoords.col?this.lastDesiredCoords.col-o.col:i.col,n.row>0?i.row=r.row+r.rowspan-1-o.row+n.row:n.row<0&&(i.row=o.row-r.row+n.row),n.col>0?i.col=r.col+r.colspan-1-o.col+n.col:n.col<0&&(i.col=o.col-r.col+n.col));var u=new c(t.highlight.row+i.row,t.highlight.col+i.col),h=this.mergedCellInfoCollection.getInfo(u.row,u.col);h&&(this.lastDesiredCoords=u,i={row:h.row-o.row,col:h.col-o.col})}else if("modifyTransformEnd"==e)for(var a=0,s=this.mergedCellInfoCollection.length;s>a;a++){var p=this.mergedCellInfoCollection[a],f=new c(p.row,p.col),g=new c(p.row+p.rowspan-1,p.col+p.colspan-1),v=new d(f,f,g),m=t.getBordersSharedWith(v);if(v.isEqual(t))t.setDirection("NW-SE");else if(m.length>0){var y=t.highlight.isEqual(v.from);m.indexOf("top")>-1?t.to.isSouthEastOf(v.from)&&y?t.setDirection("NW-SE"):t.to.isSouthWestOf(v.from)&&y&&t.setDirection("NE-SW"):m.indexOf("bottom")>-1&&(t.to.isNorthEastOf(v.from)&&y?t.setDirection("SW-NE"):t.to.isNorthWestOf(v.from)&&y&&t.setDirection("SE-NW"))}var w=function(e,t){return t.row>=e.row&&t.row<=e.row+e.rowspan-1}(p,u=function(e){return new c(t.to.row+e.row,t.to.col+e.col)}(i)),b=function(e,t){return t.col>=e.col&&t.col<=e.col+e.colspan-1}(p,u);t.includesRange(v)&&(v.includes(u)||w||b)&&(w&&(i.row<0?i.row-=p.rowspan-1:i.row>0&&(i.row+=p.rowspan-1)),b&&(i.col<0?i.col-=p.colspan-1:i.col>0&&(i.col+=p.colspan-1)))}0!==i.row&&(n.row=i.row),0!==i.col&&(n.col=i.col)},void 0===t)throw new Error("Handsontable is not defined");var B=function(e,t,n){this.mergeCells&&this.mergeCells.applySpanProperties(e,t,n)},W=function(e){return function(t){if(this.getSettings().mergeCells){var n=this.getSelectedRange();if(this.mergeCells.modifyTransform(e,n,t),"modifyTransformEnd"===e){var i=this.countRows(),o=this.countCols();n.from.row<0?n.from.row=0:n.from.row>0&&n.from.row>=i&&(n.from.row=n.from-1),n.from.col<0?n.from.col=0:n.from.col>0&&n.from.col>=o&&(n.from.col=o-1)}}}},j=function(e){if(this.getSettings().mergeCells)for(var t,n=this.countCols(),i=0;n>i;i++){if((t=this.mergeCells.mergedCellInfoCollection.getInfo(e.startRow,i))&&t.row<e.startRow)return e.startRow=t.row,j.call(this,e);if(t=this.mergeCells.mergedCellInfoCollection.getInfo(e.endRow,i)){var o=t.row+t.rowspan-1;if(o>e.endRow)return e.endRow=o,j.call(this,e)}}},U=function(e){if(this.getSettings().mergeCells)for(var t,n=this.countRows(),i=0;n>i;i++){if((t=this.mergeCells.mergedCellInfoCollection.getInfo(i,e.startColumn))&&t.col<e.startColumn)return e.startColumn=t.col,U.call(this,e);if(t=this.mergeCells.mergedCellInfoCollection.getInfo(i,e.endColumn)){var o=t.col+t.colspan-1;if(o>e.endColumn)return e.endColumn=o,U.call(this,e)}}};t.hooks.add("beforeInit",function(){var e=this,t=e.getSettings().mergeCells;t&&(e.mergeCells||(e.mergeCells=new a(t)))}),t.hooks.add("afterInit",function(){var e=this;e.mergeCells&&(e.view.wt.wtTable.getCell=function(t){if(e.getSettings().mergeCells){var n=e.mergeCells.mergedCellInfoCollection.getInfo(t.row,t.col);n&&(t=n)}return S.prototype.getCell.call(this,t)})}),t.hooks.add("beforeKeyDown",function(e){this.mergeCells&&(e.ctrlKey||e.metaKey)&&!e.altKey&&77===e.keyCode&&(this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render(),e.stopImmediatePropagation())}),t.hooks.add("modifyTransformStart",W("modifyTransformStart")),t.hooks.add("modifyTransformEnd",W("modifyTransformEnd")),t.hooks.add("beforeSetRangeEnd",function(e){if(this.lastDesiredCoords=null,this.getSettings().mergeCells){var t=this.getSelectedRange();t.highlight=new c(t.highlight.row,t.highlight.col),t.to=e;var n=!1;do{n=!1;for(var i=0,o=this.mergeCells.mergedCellInfoCollection.length;o>i;i++){var r=this.mergeCells.mergedCellInfoCollection[i],a=new c(r.row,r.col),s=new d(a,a,new c(r.row+r.rowspan-1,r.col+r.colspan-1));t.expandByRange(s)&&(e.row=t.to.row,e.col=t.to.col,n=!0)}}while(n)}}),t.hooks.add("beforeDrawBorders",function(e,t){if(t&&"area"==t&&this.getSettings().mergeCells)for(var n=this.getSelectedRange(),i=new d(n.from,n.from,n.from),o=new d(n.to,n.to,n.to),r=0,a=this.mergeCells.mergedCellInfoCollection.length;a>r;r++){var s=this.mergeCells.mergedCellInfoCollection[r],l=new c(s.row,s.col),u=new d(l,l,new c(s.row+s.rowspan-1,s.col+s.colspan-1));i.expandByRange(u)&&(e[0]=i.from.row,e[1]=i.from.col),o.expandByRange(u)&&(e[2]=o.from.row,e[3]=o.from.col)}}),t.hooks.add("afterIsMultipleSelection",function(e){if(e&&this.mergeCells){var t=this.mergeCells.mergedCellInfoCollection,n=this.getSelectedRange();for(var i in t)if(n.highlight.row==t[i].row&&n.highlight.col==t[i].col&&n.to.row==t[i].row+t[i].rowspan-1&&n.to.col==t[i].col+t[i].colspan-1)return!1}return e}),t.hooks.add("afterRenderer",B),t.hooks.add("afterContextMenuDefaultOptions",function(e){this.getSettings().mergeCells&&(e.items.push(t.ContextMenu.SEPARATOR),e.items.push({key:"mergeCells",name:function(){var e=this.getSelected();return this.mergeCells.mergedCellInfoCollection.getInfo(e[0],e[1])?"Unmerge cells":"Merge cells"},callback:function(){this.mergeCells.mergeOrUnmergeSelection(this.getSelectedRange()),this.render()},disabled:function(){return!1}}))}),t.hooks.add("afterGetCellMeta",function(e,t,n){if(this.getSettings().mergeCells){var i=this.mergeCells.mergedCellInfoCollection.getInfo(e,t);!i||i.row==e&&i.col==t||(n.copyable=!1)}}),t.hooks.add("afterViewportRowCalculatorOverride",j),t.hooks.add("afterViewportColumnCalculatorOverride",U),t.MergeCells=a,function(){function e(){}var n,i=function(e){return"boolean"==typeof e&&!0===e||"object"==typeof e&&e.length>0},o=function(e){for(var t=0;t<n.view.wt.selections.length;t++)if(n.view.wt.selections[t].settings.className==e)return t;return-1},r=function(e){var t={row:e.row,col:e.col},i=new E(e,new d(t,t,t)),r=o(e.className);r>=0?n.view.wt.selections[r]=i:n.view.wt.selections.push(i)},a=function(e,t,n){var i=c(e,t);i=u(i,n),this.setCellMeta(e,t,"borders",i),r(i)},s=function(e){for(var t=e.range,n=t.from.row;n<=t.to.row;n++)for(var i=t.from.col;i<=t.to.col;i++){var o=c(n,i),a=0;n==t.from.row&&(a++,e.hasOwnProperty("top")&&(o.top=e.top)),n==t.to.row&&(a++,e.hasOwnProperty("bottom")&&(o.bottom=e.bottom)),i==t.from.col&&(a++,e.hasOwnProperty("left")&&(o.left=e.left)),i==t.to.col&&(a++,e.hasOwnProperty("right")&&(o.right=e.right)),a>0&&(this.setCellMeta(n,i,"borders",o),r(o))}},l=function(e,t){return"border_row"+e+"col"+t},c=function(e,t){return{className:l(e,t),border:{width:1,color:"#000",cornerVisible:!1},row:e,col:t,top:{hide:!0},right:{hide:!0},bottom:{hide:!0},left:{hide:!0}}},u=function(e,t){return t.hasOwnProperty("border")&&(e.border=t.border),t.hasOwnProperty("top")&&(e.top=t.top),t.hasOwnProperty("right")&&(e.right=t.right),t.hasOwnProperty("bottom")&&(e.bottom=t.bottom),t.hasOwnProperty("left")&&(e.left=t.left),e},h=function(e){for(var t=document.querySelectorAll("."+e),n=0;n<t.length;n++)if(t[n]&&"TD"!=t[n].nodeName){var i=t[n].parentNode;i.parentNode&&i.parentNode.removeChild(i)}},p=function(e,t){var n=l(e,t);h(n),this.removeCellMeta(e,t,"borders")},f=function(e,t,n,i){var o=this.getCellMeta(e,t).borders;o&&void 0!=o.border||(o=c(e,t)),o[n]=i?{hide:!0}:{width:1,color:"#000"},this.setCellMeta(e,t,"borders",o);var a=l(e,t);h(a),r(o),this.render()},g=function(e,t,n){if(e.from.row==e.to.row&&e.from.col==e.to.col)"noBorders"==t?p.call(this,e.from.row,e.from.col):f.call(this,e.from.row,e.from.col,t,n);else switch(t){case"noBorders":for(var i=e.from.col;i<=e.to.col;i++)for(var o=e.from.row;o<=e.to.row;o++)p.call(this,o,i);break;case"top":for(var r=e.from.col;r<=e.to.col;r++)f.call(this,e.from.row,r,t,n);break;case"right":for(var a=e.from.row;a<=e.to.row;a++)f.call(this,a,e.to.col,t);break;case"bottom":for(var s=e.from.col;s<=e.to.col;s++)f.call(this,e.to.row,s,t);break;case"left":for(var l=e.from.row;l<=e.to.row;l++)f.call(this,l,e.from.col,t)}},v=function(e,t){var n=!1;return e.getSelectedRange().forAll(function(i,o){var r=e.getCellMeta(i,o).borders;if(r){if(!t)return n=!0,!1;if(!r[t].hasOwnProperty("hide"))return n=!0,!1}}),n},m=function(e){return"<span class='selected'>"+String.fromCharCode(10003)+"</span>"+e};t.hooks.add("beforeInit",function(){i(this.getSettings().customBorders)&&(this.customBorders||(n=this,this.customBorders=new e))}),t.hooks.add("afterContextMenuDefaultOptions",function(e){this.getSettings().customBorders&&(e.items.push(t.ContextMenu.SEPARATOR),e.items.push({key:"borders",name:"Borders",submenu:{items:{top:{name:function(){var e="Top";return v(this,"top")&&(e=m(e)),e},callback:function(){var e=v(this,"top");g.call(this,this.getSelectedRange(),"top",e)},disabled:!1},right:{name:function(){var e="Right";return v(this,"right")&&(e=m(e)),e},callback:function(){var e=v(this,"right");g.call(this,this.getSelectedRange(),"right",e)},disabled:!1},bottom:{name:function(){var e="Bottom";return v(this,"bottom")&&(e=m(e)),e},callback:function(){var e=v(this,"bottom");g.call(this,this.getSelectedRange(),"bottom",e)},disabled:!1},left:{name:function(){var e="Left";return v(this,"left")&&(e=m(e)),e},callback:function(){var e=v(this,"left");g.call(this,this.getSelectedRange(),"left",e)},disabled:!1},remove:{name:"Remove border(s)",callback:function(){g.call(this,this.getSelectedRange(),"noBorders")},disabled:function(){return!v(this)}}}}}))}),t.hooks.add("afterInit",function(){var e=this.getSettings().customBorders;if(e){for(var t=0;t<e.length;t++)e[t].range?s.call(this,e[t]):a.call(this,e[t].row,e[t].col,e[t]);this.render(),this.view.wt.draw(!0)}}),t.CustomBorders=e}(),function(t){var n=new function(){function n(e){z=this,h=e;var t=this.view.wt.wtTable.getCoords(e).row;if(t>=0){u=t;var n=h.getBoundingClientRect();d=n.top,p.style.top=d+"px",p.style.left=n.left+"px",z.rootElement.appendChild(p)}}function i(e,t){var n=e.getBoundingClientRect();p.style.top=t>0?n.top+n.height-6+"px":n.top+"px"}function o(){var e=this;t.Dom.addClass(p,"active"),t.Dom.addClass(f,"active");var n=h.getBoundingClientRect();f.style.width=e.view.maximumVisibleElementWidth(0)+"px",f.style.height=n.height+"px",f.style.top=d+"px",f.style.left=p.style.left,e.rootElement.appendChild(f)}function r(e){f.style.top=d+e+"px"}function a(){t.Dom.removeClass(p,"active"),t.Dom.removeClass(f,"active")}var s,l,c,d,u,h,p=document.createElement("DIV"),f=document.createElement("DIV"),g=t.eventManager(this);p.className="manualRowMover",f.className="manualRowMoverGuide";var v=function(){var e=this;t.hooks.run(e,"persistentStateSave","manualRowPositions",e.manualRowPositions)},m=function(){var e=this,n={};return t.hooks.run(e,"persistentStateLoad","manualRowPositions",n),n.value},y=function(e){return"BODY"!=e.tagName&&("TBODY"==e.parentNode.tagName||(e=e.parentNode,y(e)))},w=function(e){return"TABLE"!=e.tagName?"TH"==e.tagName?e:w(e.parentNode):null},b=function(){var d,p=this;g.addEventListener(p.rootElement,"mouseover",function(e){if(y(e.target)){var t=w(e.target);t&&(d?(l=p.view.wt.wtTable.getCoords(t).row,i(t,l-s)):n.call(p,t))}}),g.addEventListener(p.rootElement,"mousedown",function(e){t.Dom.hasClass(e.target,"manualRowMover")&&(c=t.helper.pageY(e),o.call(p),d=p,s=u,l=u)}),g.addEventListener(e,"mousemove",function(e){d&&r(t.helper.pageY(e)-c)}),g.addEventListener(e,"mouseup",function(){d&&(a(),d=!1,x(p.manualRowPositions,p.countRows()),p.manualRowPositions.splice(l,0,p.manualRowPositions.splice(s,1)[0]),p.forceFullRender=!0,p.view.render(),v.call(p),t.hooks.run(p,"afterRowMove",s,l),n.call(p,h))}),p.addHook("afterDestroy",C)},C=function(){g.clear()},x=function(e,t){if(e.length<t)for(var n=e.length;t>n;n++)e[n]=n};this.beforeInit=function(){this.manualRowPositions=[]},this.init=function(e){var t=this;if(t.getSettings().manualRowMove){var n=t.getSettings().manualRowMove,i=m.call(t);void 0!==t.manualRowPositionsPluginUsages?t.manualRowPositionsPluginUsages.push("manualColumnMove"):t.manualRowPositionsPluginUsages=["manualColumnMove"],this.manualRowPositions=void 0!==i?i:Array.isArray(n)?n:[],"afterInit"===e&&(b.call(this),this.manualRowPositions.length>0&&(t.forceFullRender=!0,t.render()))}else{var o=t.manualRowPositionsPluginUsages?t.manualRowPositionsPluginUsages.indexOf("manualColumnMove"):-1;o>-1&&(C.call(this),t.manualRowPositions=[],t.manualRowPositionsPluginUsages[o]=void 0)}},this.modifyRow=function(e){var t=this;return t.getSettings().manualRowMove?(void 0===t.manualRowPositions[e]&&x(this.manualRowPositions,e+1),t.manualRowPositions[e]):e}};t.hooks.add("beforeInit",n.beforeInit),t.hooks.add("afterInit",function(){n.init.call(this,"afterInit")}),t.hooks.add("afterUpdateSettings",function(){n.init.call(this,"afterUpdateSettings")}),t.hooks.add("modifyRow",n.modifyRow),t.hooks.register("afterRowMove")}(t),function(t){function n(n){this.instance=n,this.addingStarted=!1;var i,o,r=!1,a=this,s=t.eventManager(n),l=function(){return!n.autofill||void(n.autofill.handle&&n.autofill.handle.isDragged&&(n.autofill.handle.isDragged>1&&n.autofill.apply(),n.autofill.handle.isDragged=0,r=!1))};s.addEventListener(document,"mouseup",function(e){l()}),s.addEventListener(document,"mousemove",function(n){if(!a.instance.autofill)return 0;var i=t.Dom.offset(a.instance.table).top-(e.pageYOffset||document.documentElement.scrollTop)+t.Dom.outerHeight(a.instance.table),o=t.Dom.offset(a.instance.table).left-(e.pageXOffset||document.documentElement.scrollLeft)+t.Dom.outerWidth(a.instance.table);!1===a.addingStarted&&a.instance.autofill.handle.isDragged>0&&n.clientY>i&&n.clientX<=o?(this.mouseDragOutside=!0,a.addingStarted=!0):this.mouseDragOutside=!1,this.mouseDragOutside&&setTimeout(function(){a.addingStarted=!1,a.instance.alter("insert_row")},200)}),i=this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown,this.instance.view.wt.wtSettings.settings.onCellCornerMouseDown=function(e){n.autofill.handle.isDragged=1,r=!0,i(e)},o=this.instance.view.wt.wtSettings.settings.onCellMouseOver,this.instance.view.wt.wtSettings.settings.onCellMouseOver=function(e,t,i,a){n.autofill&&r&&!n.view.isMouseDown()&&n.autofill.handle&&n.autofill.handle.isDragged&&(n.autofill.handle.isDragged++,n.autofill.showBorder(t),n.autofill.checkIfNewRowNeeded()),o(e,t,i,a)},this.instance.view.wt.wtSettings.settings.onCellCornerDblClick=function(){n.autofill.selectAdjacent()}}n.prototype.init=function(){this.handle={}},n.prototype.disable=function(){this.handle.disabled=!0},n.prototype.selectAdjacent=function(){var e,t,n,i,o;e=this.instance.selection.isMultiple()?this.instance.view.wt.selections.area.getCorners():this.instance.view.wt.selections.current.getCorners(),t=this.instance.getData();e:for(n=e[2]+1;n<this.instance.countRows();n++){for(o=e[1];o<=e[3];o++)if(t[n][o])break e;(t[n][e[1]-1]||t[n][e[3]+1])&&(i=n)}i&&(this.instance.view.wt.selections.fill.clear(),this.instance.view.wt.selections.fill.add(new c(e[0],e[1])),this.instance.view.wt.selections.fill.add(new c(i,e[3])),this.apply())},n.prototype.apply=function(){var e,n,i,o,r;if(this.handle.isDragged=0,e=this.instance.view.wt.selections.fill.getCorners()){this.instance.view.wt.selections.fill.clear(),n=this.instance.selection.isMultiple()?this.instance.view.wt.selections.area.getCorners():this.instance.view.wt.selections.current.getCorners();var a;if(e[0]===n[0]&&e[1]<n[1]?(a="left",i=new c(e[0],e[1]),o=new c(e[2],n[1]-1)):e[0]===n[0]&&e[3]>n[3]?(a="right",i=new c(e[0],n[3]+1),o=new c(e[2],e[3])):e[0]<n[0]&&e[1]===n[1]?(a="up",i=new c(e[0],e[1]),o=new c(n[0]-1,e[3])):e[2]>n[2]&&e[1]===n[1]&&(a="down",i=new c(n[2]+1,e[1]),o=new c(e[2],e[3])),i&&i.row>-1&&i.col>-1){var s={from:this.instance.getSelectedRange().from,to:this.instance.getSelectedRange().to},l=function(e,t,n,i){var o,r,a,s=n.length,l=n?n[0].length:0,c=[],d=t.row-e.row,u=t.col-e.col,h=[];if(-1!==["down","up"].indexOf(i)){for(var p=0;u>=p;p++)o=parseInt(n[0][p],10),r=parseInt(n[s-1][p],10),a=("down"===i?r-o:o-r)/(s-1)||0,h.push(a);c.push(h)}if(-1!==["right","left"].indexOf(i))for(var f=0;d>=f;f++)o=parseInt(n[f][0],10),r=parseInt(n[f][l-1],10),a=("right"===i?r-o:o-r)/(l-1)||0,(h=[]).push(a),c.push(h);return c}(i,o,r=this.instance.getData(s.from.row,s.from.col,s.to.row,s.to.col),a);t.hooks.run(this.instance,"beforeAutofill",i,o,r),this.instance.populateFromArray(i.row,i.col,r,o.row,o.col,"autofill",null,a,l),this.instance.selection.setRangeStart(new c(e[0],e[1])),this.instance.selection.setRangeEnd(new c(e[2],e[3]))}else this.instance.selection.refreshBorders()}},n.prototype.showBorder=function(e){var t=this.instance.getSelectedRange().getTopLeftCorner(),n=this.instance.getSelectedRange().getBottomRightCorner();if("horizontal"!==this.instance.getSettings().fillHandle&&(n.row<e.row||t.row>e.row))e=new c(e.row,n.col);else{if("vertical"===this.instance.getSettings().fillHandle)return;e=new c(n.row,e.col)}this.instance.view.wt.selections.fill.clear(),this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().from),this.instance.view.wt.selections.fill.add(this.instance.getSelectedRange().to),this.instance.view.wt.selections.fill.add(e),this.instance.view.render()},n.prototype.checkIfNewRowNeeded=function(){var e,t,n=this.instance.countRows(),i=this;this.instance.view.wt.selections.fill.cellRange&&!1===this.addingStarted&&(t=this.instance.getSelected(),e=this.instance.view.wt.selections.fill.getCorners(),t[2]<n-1&&e[2]===n-1&&(this.addingStarted=!0,this.instance._registerTimeout(setTimeout(function(){i.instance.alter("insert_row"),i.addingStarted=!1},200))))},t.hooks.add("afterInit",function(){var e=new n(this);void 0!==this.getSettings().fillHandle&&(e.handle&&!1===this.getSettings().fillHandle?e.disable():e.handle||!1===this.getSettings().fillHandle||(this.autofill=e,this.autofill.init()))}),t.Autofill=n}(t);var G=function(e){var n=[],i={rows:0,cols:0},o={rows:0,cols:0},r=[],a=[],s={groupIndicatorContainer:"htGroupIndicatorContainer",groupIndicator:function(e){return"ht"+e+"Group"},groupStart:"htGroupStart",collapseButton:"htCollapseButton",expandButton:"htExpandButton",collapseGroupId:function(e){return"htCollapse-"+e},collapseFromLevel:function(e,t){return"htCollapse"+e+"FromLevel-"+t},clickable:"clickable",levelTrigger:"htGroupLevelTrigger"},l=function(e,t){return function(n,i){return void 0===t||"asc"===t?n[e]-i[e]:i[e]-n[e]}},d=function(e,t){for(var n=[];t>=e;)n.push(e++);return n},u=function(e,t,n){var i=[],o={row:null,col:null};if("cols"==e)for(;n>=t;)o={row:-1,col:t++},i.push(o);else for(;n>=t;)o={row:t++,col:-1},i.push(o);for(var r=h(i),a=0,s=0,l=0;l<r.length;l++)a+=r[l].filter(function(e){return e.rows}).length,s+=r[l].filter(function(e){return e.cols}).length;return{total:{rows:a,cols:s},groups:r}},h=function(e){for(var t=[],n=0;n<e.length;n++)t.push(p(e[n]));return t},p=function(e,t,i){for(var o=e.row,r=e.col,a=-1===o?0:o,s=-1===r?0:r,l=[],c=0;c<n.length;c++){var d=n[c],u=d.id,h=(d.level,d.rows||[]),p=d.cols||[];-1===l.indexOf(u)&&(-1!==h.indexOf(a)||-1!==p.indexOf(s))&&l.push(d)}-1===r?l=l.concat(m()):-1===o&&(l=l.concat(w())),t&&(l=l.filter(function(e){return e.level===t})),i&&("cols"===i?l=l.filter(function(e){return e.cols}):"rows"===i&&(l=l.filter(function(e){return e.rows})));var f=[];return l.filter(function(e){return-1===f.indexOf(e.id)?(f.push(e.id),e):void 0})},f=function(e){for(var t=0,i=n.length;i>t;t++)if(n[t].id==e)return n[t];return!1},g=function(e,t){for(var i=0,o=n.length;o>i;i++)if(n[i].level==t&&n[i].rows&&n[i].rows.indexOf(e)>-1)return n[i];return!1},v=function(e,t){for(var i=0,o=n.length;o>i;i++)if(n[i].level==t&&n[i].cols&&n[i].cols.indexOf(e)>-1)return n[i];return!1},m=function(){for(var e=[],t=0,i=n.length;i>t;t++)Array.isArray(n[t].cols)&&e.push(n[t]);return e},y=function(e){for(var t=[],i=0,o=n.length;o>i;i++)n[i].cols&&n[i].level===e&&t.push(n[i]);return t},w=function(){for(var e=[],t=0,i=n.length;i>t;t++)Array.isArray(n[t].rows)&&e.push(n[t]);return e},b=function(e){for(var t=[],i=0,o=n.length;o>i;i++)n[i].rows&&n[i].level===e&&t.push(n[i]);return t},C=function(e){var t=0;return e.length&&e.forEach(function(e){if((e=e.filter(function(e){return e.cols})).length){var n=e.sort(l("level","desc"))[0].level;n>t&&(t=n)}}),t},x=function(e){var t=0;return e.length&&e.forEach(function(e){if((e=e.filter(function(e){return e.rows})).length){var n=e.sort(l("level","desc"))[0].level;n>t&&(t=n)}}),t},E=function(e,t){var r=u("cols",e,t),a=C(r.groups);a===o.cols?o.cols++:a>o.cols&&(o.cols=a+1),i.cols||(i.cols=m().length),i.cols++,n.push({id:"c"+i.cols,level:a+1,cols:d(e,t),hidden:0})},_=function(e,t){var r=u("rows",e,t),a=x(r.groups);o.rows=Math.max(o.rows,a+1),i.rows||(i.rows=w().length),i.rows++,n.push({id:"r"+i.rows,level:a+1,rows:d(e,t),hidden:0})},S=function(e,t){for(var n,i=0,o=t.length;o>i;i++)if(t[i].hidden=e,n=t[i].level,r[n]||(r[n]=[]),a[n]||(a[n]=[]),t[i].rows)for(var s=0,l=t[i].rows.length;l>s;s++)r[n][t[i].rows[s]]=e>0||void 0;else if(t[i].cols)for(var s=0,c=t[i].cols.length;c>s;s++)a[n][t[i].cols[s]]=e>0||void 0},k=function(e,n,i,o){var r,a;switch(e){case"rows":r=g(n+1,i).id,a=t.Grouping.getGroupLevelsByRows();break;case"cols":r=v(n+1,i).id,a=t.Grouping.getGroupLevelsByCols()}return!!(a[n+1]&&a[n+1].indexOf(i)>-1&&o==r)},T=function(e,n,i,o){var r,a;switch(e){case"rows":r=g(n-1,i).id,a=t.Grouping.getGroupLevelsByRows();break;case"cols":r=v(n-1,i).id,a=t.Grouping.getGroupLevelsByCols()}return!!(a[n-1]&&a[n-1].indexOf(i)>-1&&o==r)},D=function(n,i,s,l){if(0===i)return!1;var c,d,u=T(n,i,s,l),h=k(n,i,s,l),p=!1;switch(n){case"rows":c=t.Grouping.getGroupLevelsByRows(),d=e.countRows();for(f=0;f<=o.rows;f++)if(r[f]&&r[f][i+1]){p=!0;break}break;case"cols":c=t.Grouping.getGroupLevelsByCols(),d=e.countCols();for(var f=0;f<=o.cols;f++)if(a[f]&&a[f][i+1]){p=!0;break}}if(u){if(i==d-1)return!0;if(!h||h&&p)return!0;if(!c[i+1])return!0}return!1},R=function(t){var n;switch(t){case"rows":n=o.rows;for(i=0;n>=i;i++)if(r[i]&&r[i][e.countRows()-1])return!0;break;case"cols":n=o.cols;for(var i=0;n>=i;i++)if(a[i]&&a[i][e.countCols()-1])return!0}return!1},P=function(n,i,s,l){var c,d,u,h=f(l),p=!1,g=function(e){for(var t=!1,n="rows"==e?r:a,s=0;s<=o[e];s++){for(u=i;h[e].indexOf(u)>-1;)t=!(!n[s]||!n[s][u]),u--;if(t)break}return t},v=T(n,i,s,l),m=k(n,i,s,l);switch(n){case"rows":c=t.Grouping.getGroupLevelsByRows(),d=e.countRows(),p=g(n);break;case"cols":c=t.Grouping.getGroupLevelsByCols(),d=e.countCols(),p=g(n)}if(i==d-1)return!1;if(0===i){if(m)return!0}else if(!v||v&&p){if(m)return!0}else if(!c[i-1]&&m)return!0;return!1},A=function(e,n,i,o,r){var a;switch(e){case"rows":a=g(n-1,i).id;break;case"cols":a=v(n-1,i).id}if(!a)return null;if(n>0&&T(e,n-1,i,a)&&a!=o){var l=document.createElement("DIV");return t.Dom.addClass(l,s.expandButton),l.id="htExpand-"+a,l.appendChild(document.createTextNode("+")),l.setAttribute("data-level",i),l.setAttribute("data-type",e),l.setAttribute("data-hidden","1"),r.appendChild(l),l}return null},N=function(e){for(var t=w(),n=m(),i=0,o=t.length;o>i;i++)if(t[i].rows.indexOf(e.row)>-1&&t[i].hidden)return!0;if(null===e.col)return!1;for(var i=0,r=n.length;r>i;i++)if(n[i].cols.indexOf(e.col)>-1&&n[i].hidden)return!0;return!1};return{getGroups:function(){return n},getLevels:function(){return o},instance:e,baseSpareRows:e.getSettings().minSpareRows,baseSpareCols:e.getSettings().minSpareCols,getRowGroups:w,getColGroups:m,init:function(){var n=e.getSettings().groups;n&&Array.isArray(n)&&t.Grouping.initGroups(n)},initGroups:function(e){n=[],e.forEach(function(e){var t=[],n=!1,i=!1;Array.isArray(e.rows)?(t=e.rows,n=!0):Array.isArray(e.cols)&&(t=e.cols,i=!0);var o=t[0],r=t[t.length-1];n?_(o,r):i&&E(o,r)})},resetGroups:function(){n=[],i={rows:0,cols:0},o={rows:0,cols:0};var e;for(var r in s)if("function"!=typeof s[r])for(var a=0,l=(e=document.querySelectorAll("."+s[r])).length;l>a;a++)t.Dom.removeClass(e[a],s[r]);for(var c=["htGroupColClosest","htGroupCol"],r=0,d=c.length;d>r;r++)for(var a=0,l=(e=document.querySelectorAll("."+c[r])).length;l>a;a++)t.Dom.removeClass(e[a],c[r])},updateGroups:function(){var e=this.getSettings().groups;t.Grouping.resetGroups(),t.Grouping.initGroups(e)},afterGetRowHeader:function(e,n){for(var i=!1,o=0,a=r.length;a>o;o++)r[o]&&!0===r[o][e]&&(i=!0);i?t.Dom.addClass(n.parentNode,"hidden"):!i&&t.Dom.hasClass(n.parentNode,"hidden")&&t.Dom.removeClass(n.parentNode,"hidden")},afterGetColHeader:function(n){var i=this.view.wt.wtSettings.getSetting("rowHeaders").length,o=e.rootElement.querySelectorAll("colgroup col:nth-child("+parseInt(n+i+1,10)+")");if(0!==o.length){for(var r=!1,s=0,l=a.length;l>s;s++)a[s]&&!0===a[s][n]&&(r=!0);if(r)for(var s=0,c=o.length;c>s;s++)t.Dom.addClass(o[s],"hidden");else if(!r&&t.Dom.hasClass(o[0],"hidden"))for(var s=0,c=o.length;c>s;s++)t.Dom.removeClass(o[s],"hidden")}},groupIndicatorsFactory:function(e,n){var r,a,l,c,d,u;switch(n){case"horizontal":r=t.Grouping.getGroupLevelsByCols(),function(e){return Array.prototype.indexOf.call(e.parentNode.parentNode.childNodes,e.parentNode)+1},a=function(e,t){return v(e,t).id},l="cols",c=function(e,t){return v(e-1,t)},"columnHeaders",d=function(e){if(1===e.length){var n=e[0];e[0]=function(e,i,o){-1>e?p()(e,i,o):(t.Dom.removeClass(i,s.groupIndicatorContainer),n(e,i,o))}}return function(){return e}},u=!0;break;case"vertical":r=t.Grouping.getGroupLevelsByRows(),function(e){return t.Dom.index(e)+1},a=function(e,t){return g(e,t).id},l="rows",c=function(e,t){return g(e-1,t)},"rowHeaders",d=function(e){return e}}var h=function(e){var n=document.createElement("div");return e.appendChild(n),{button:n,addClass:function(e){t.Dom.addClass(n,e)}}},p=function(){var e=n.charAt(0).toUpperCase()+n.slice(1);return function(n,i,o){o++;for(var d,p;d=i.lastChild;)i.removeChild(d);t.Dom.addClass(i,s.groupIndicatorContainer);var f=a(n,o);if(n>-1&&r[n]&&r[n].indexOf(o)>-1&&((p=h(i)).addClass(s.groupIndicator(e)),P(l,n,o,f)&&p.addClass(s.groupStart),D(l,n,o,f)&&(p.button.appendChild(document.createTextNode("-")),p.addClass(s.collapseButton),p.button.id=s.collapseGroupId(f),p.button.setAttribute("data-level",o),p.button.setAttribute("data-type",l))),u){var g=t.Dom.index(i.parentNode);if(-1===n||-1>n&&g===t.Grouping.getLevels().cols+1||0===g&&0===t.Grouping.getLevels().cols)if((p=h(i)).addClass(s.levelTrigger),-1===n)p.button.id=s.collapseFromLevel("Cols",o),p.button.appendChild(document.createTextNode(o));else if(-1>n&&g===t.Grouping.getLevels().cols+1||0===g&&0===t.Grouping.getLevels().cols){var v=t.Dom.index(i)+1;p.button.id=s.collapseFromLevel("Rows",v),p.button.appendChild(document.createTextNode(v))}}var m=A(l,n,o,f,i);if(n>0){var y=c(n-1,o);m&&y.hidden&&t.Dom.addClass(m,s.clickable)}$()}};if(e=d(e),i[l]>0)for(var f=0;f<o[l]+1;f++)Array.isArray(e)||(e="function"==typeof e?e():new Array(e)),e.unshift(p())},getGroupLevelsByRows:function(){for(var e=w(),t=[],n=0,i=e.length;i>n;n++)if(e[n].rows)for(var o=0,r=e[n].rows.length;r>o;o++)t[e[n].rows[o]]||(t[e[n].rows[o]]=[]),t[e[n].rows[o]].push(e[n].level);return t},getGroupLevelsByCols:function(){for(var e=m(),t=[],n=0,i=e.length;i>n;n++)if(e[n].cols)for(var o=0,r=e[n].cols.length;r>o;o++)t[e[n].cols[o]]||(t[e[n].cols[o]]=[]),t[e[n].cols[o]].push(e[n].level);return t},toggleGroupVisibility:function(n){if(t.Dom.hasClass(n.target,s.expandButton)||t.Dom.hasClass(n.target,s.collapseButton)||t.Dom.hasClass(n.target,s.levelTrigger)){var i,r,a,l,c=n.target,d=c.id.split("-"),u=[];if(c.className.indexOf(s.levelTrigger)>-1){for(var h,p=[],g=[],v=c.id.indexOf("Rows")>-1?"rows":"cols",m=1,w=o[v];w>=m;m++)if(h="rows"==v?b(m):y(m),m>=parseInt(d[1],10))for(var C=0,x=h.length;x>C;C++)g.push(h[C]);else for(var C=0,x=h.length;x>C;C++)p.push(h[C]);S(!0,g),S(!1,p)}else(function(e){e&&(c=e),d=c.id.split("-"),i=d[1],r=parseInt(c.getAttribute("data-level"),10),a=c.getAttribute("data-type"),l=parseInt(c.getAttribute("data-hidden")),l=isNaN(l)?1:l?0:1,c.setAttribute("data-hidden",l.toString()),u.push(f(i))})(),S(l,u);var E=R(a=a||v),_=a.charAt(0).toUpperCase()+a.slice(1),k=t.Grouping["baseSpare"+_];E?0==k&&(e.alter("insert_"+a.slice(0,-1),e["count"+_]()),t.Grouping["dummy"+a.slice(0,-1)]=!0):0==k&&t.Grouping["dummy"+a.slice(0,-1)]&&(e.alter("remove_"+a.slice(0,-1),e["count"+_]()-1),t.Grouping["dummy"+a.slice(0,-1)]=!1),e.render(),n.stopImmediatePropagation()}},modifySelectionFactory:function(e){var t,n=this.instance,i=new c(0,0),o=function(e,t){var n=0;switch(e){case"down":for(;N(t);)n++,t.row+=1;break;case"up":for(;N(t);)n--,t.row-=1;break;case"right":for(;N(t);)n++,t.col+=1;break;case"left":for(;N(t);)n--,t.col-=1}return n},r=function(e,t){e.row>0?N(t)&&(e.row+=o("down",t)):e.row<0&&N(t)&&(e.row+=o("up",t)),e.col>0?N(t)&&(e.col+=o("right",t)):e.col<0&&N(t)&&(e.col+=o("left",t))};switch(e){case"start":return function(e){t=n.getSelected(),i.row=t[0]+e.row,i.col=t[1]+e.col,r(e,i)};case"end":return function(e){t=n.getSelected(),i.row=t[2]+e.row,i.col=t[3]+e.col,r(e,i)}}},modifyRowHeight:function(t,n){return e.view.wt.wtTable.rowFilter&&N({row:n,col:null})?0:void 0},validateGroups:function(){for(var t=function(e,t){return e[0]<t[0]&&e[1]<t[1]&&t[0]<=e[1]||e[0]>t[0]&&t[1]<e[1]&&e[0]<=t[1]||void 0},n=e.getSettings().groups,i=[],o=[],r=0,a=n.length;a>r;r++)if(n[r].rows){if(1===n[r].rows.length)throw new Error("Grouping error:  Group {"+n[r].rows[0]+"} is invalid. Cannot define single-entry groups.");if(0===n[r].rows.length)throw new Error("Grouping error:  Cannot define empty groups.");o.push(n[r].rows);for(var s=0,l=o.length;l>s;s++)if(t(n[r].rows,o[s]))throw new Error("Grouping error:  ranges {"+n[r].rows[0]+", "+n[r].rows[1]+"} and {"+o[s][0]+", "+o[s][1]+"} are overlapping.")}else if(n[r].cols){if(1===n[r].cols.length)throw new Error("Grouping error:  Group {"+n[r].cols[0]+"} is invalid. Cannot define single-entry groups.");if(0===n[r].cols.length)throw new Error("Grouping error:  Cannot define empty groups.");i.push(n[r].cols);for(var s=0,c=i.length;c>s;s++)if(t(n[r].cols,i[s]))throw new Error("Grouping error:  ranges {"+n[r].cols[0]+", "+n[r].cols[1]+"} and {"+i[s][0]+", "+i[s][1]+"} are overlapping.")}return!0},afterGetRowHeaderRenderers:function(e){t.Grouping.groupIndicatorsFactory(e,"vertical")},afterGetColumnHeaderRenderers:function(e){t.Grouping.groupIndicatorsFactory(e,"horizontal")},hookProxy:function(n,i){return function(){return e.getSettings().groups?i?t.Grouping[n](i).apply(this,arguments):t.Grouping[n].apply(this,arguments):void 0}}}},H=function(){var e=this;if(!!e.getSettings().groups){var n={};if(t.Grouping=new G(e),e.getSettings().rowHeaders||(n.rowHeaders=!0),e.getSettings().colHeaders||(n.colHeaders=!0),(n.colHeaders||n.rowHeaders)&&e.updateSettings(n),!t.Grouping.validateGroups())return;e.addHook("beforeInit",t.Grouping.hookProxy("init")),e.addHook("afterUpdateSettings",t.Grouping.hookProxy("updateGroups")),e.addHook("afterGetColumnHeaderRenderers",t.Grouping.hookProxy("afterGetColumnHeaderRenderers")),e.addHook("afterGetRowHeaderRenderers",t.Grouping.hookProxy("afterGetRowHeaderRenderers")),e.addHook("afterGetRowHeader",t.Grouping.hookProxy("afterGetRowHeader")),e.addHook("afterGetColHeader",t.Grouping.hookProxy("afterGetColHeader")),e.addHook("beforeOnCellMouseDown",t.Grouping.hookProxy("toggleGroupVisibility")),e.addHook("modifyTransformStart",t.Grouping.hookProxy("modifySelectionFactory","start")),e.addHook("modifyTransformEnd",t.Grouping.hookProxy("modifySelectionFactory","end")),e.addHook("modifyRowHeight",t.Grouping.hookProxy("modifyRowHeight"))}},$=function(){for(var e=document.querySelectorAll("colgroup"),n=0,i=e.length;i>n;n++){var o=e[n].querySelectorAll("col.rowHeader");if(0===o.length)return;for(var r=0,a=o.length+1;a>r;r++){if(2==a)return;r<t.Grouping.getLevels().rows+1&&(r==t.Grouping.getLevels().rows?t.Dom.addClass(o[r],"htGroupColClosest"):t.Dom.addClass(o[r],"htGroupCol"))}}};t.hooks.add("beforeInit",H),t.hooks.add("afterUpdateSettings",function(){this.getSettings().groups&&!t.Grouping?H.call(this,arguments):!this.getSettings().groups&&t.Grouping&&(t.Grouping.resetGroups(),t.Grouping=void 0)}),t.plugins.Grouping=G,function(e){function t(){this.zeroClipboardInstance=null,this.instance=null}t.prototype.prepareZeroClipboard=function(){this.swfPath&&ZeroClipboard.config({swfPath:this.swfPath})},t.prototype.copy=function(){return this.instance.copyPaste.setCopyableText(),this.instance.copyPaste.copyPasteInstance.elTextarea.value},t.prototype.addToContextMenu=function(t){this.getSettings().contextMenuCopyPaste&&t.items.unshift({key:"copy",name:"Copy"},{key:"paste",name:"Paste",callback:function(){this.copyPaste.triggerPaste()}},e.ContextMenu.SEPARATOR)},t.prototype.setupZeroClipboard=function(t){var i=this;if(this.cmInstance=t,e.Dom.hasClass(this.cmInstance.rootElement,"htContextMenu"))for(var o=t.getData(),r=0,a=o.length;a>r;r++)if("copy"===o[r].key){this.zeroClipboardInstance=new ZeroClipboard(t.getCell(r,0)),this.zeroClipboardInstance.off(),this.zeroClipboardInstance.on("copy",function(e){e.clipboardData.setData("text/plain",i.copy()),i.instance.getSettings().outsideClickDeselects=i.outsideClickDeselectsCache}),n.bindEvents();break}},t.prototype.bindEvents=function(){var t=this;if(t.cmInstance){var n=new e.eventManager(this.instance),i=function(){var n=t.cmInstance.rootElement.querySelector("td.current");n&&e.Dom.removeClass(n,"current"),t.outsideClickDeselectsCache=t.instance.getSettings().outsideClickDeselects,t.instance.getSettings().outsideClickDeselects=!1},o=function(){var n=t.cmInstance.rootElement.querySelector("td.zeroclipboard-is-hover");n&&e.Dom.removeClass(n,"zeroclipboard-is-hover"),t.instance.getSettings().outsideClickDeselects=t.outsideClickDeselectsCache};n.removeEventListener(document,"mouseenter",function(){i()}),n.addEventListener(document,"mouseenter",function(){i()}),n.removeEventListener(document,"mouseleave",function(){o()}),n.addEventListener(document,"mouseleave",function(){o()})}},t.prototype.init=function(){if(this.getSettings().contextMenuCopyPaste){if("object"==typeof this.getSettings().contextMenuCopyPaste&&(n.swfPath=this.getSettings().contextMenuCopyPaste.swfPath),"undefined"==typeof ZeroClipboard)throw new Error("To be able to use the Copy/Paste feature from the context menu, you need to manualy include ZeroClipboard.js file to your website.");try{new ActiveXObject("ShockwaveFlash.ShockwaveFlash")}catch(e){if(void 0===navigator.mimeTypes["application/x-shockwave-flash"])throw new Error("To be able to use the Copy/Paste feature from the context menu, your browser needs to have Flash Plugin installed.")}n.instance=this,n.prepareZeroClipboard()}};var n=new t;e.hooks.add("afterRender",function(){n.setupZeroClipboard(this)}),e.hooks.add("afterInit",n.init),e.hooks.add("afterContextMenuDefaultOptions",n.addToContextMenu),e.ContextMenuCopyPaste=t}(t),function(e){function t(t){this.instance=t,this.dragged=[],this.eventManager=e.eventManager(t),this.bindTouchEvents()}t.prototype.getCurrentRangeCoords=function(e,t,n,i,o){var r=e.getTopLeftCorner(),a=e.getBottomRightCorner(),s=e.getBottomLeftCorner(),l=e.getTopRightCorner(),d={start:null,end:null};switch(n){case"NE-SW":switch(i){case"NE-SW":case"NW-SE":d="topLeft"==o?{start:new c(t.row,e.highlight.col),end:new c(s.row,t.col)}:{start:new c(e.highlight.row,t.col),end:new c(t.row,r.col)};break;case"SE-NW":"bottomRight"==o&&(d={start:new c(a.row,t.col),end:new c(t.row,r.col)})}break;case"NW-SE":switch(i){case"NE-SW":"topLeft"==o?d={start:t,end:s}:d.end=t;break;case"NW-SE":"topLeft"==o?d={start:t,end:a}:d.end=t;break;case"SE-NW":"topLeft"==o?d={start:t,end:r}:d.end=t;break;case"SW-NE":"topLeft"==o?d={start:t,end:l}:d.end=t}break;case"SW-NE":switch(i){case"NW-SE":d="bottomRight"==o?{start:new c(t.row,r.col),end:new c(s.row,t.col)}:{start:new c(r.row,t.col),end:new c(t.row,a.col)};break;case"SW-NE":d="topLeft"==o?{start:new c(e.highlight.row,t.col),end:new c(t.row,a.col)}:{start:new c(t.row,r.col),end:new c(r.row,t.col)};break;case"SE-NW":"bottomRight"==o?d={start:new c(t.row,l.col),end:new c(r.row,t.col)}:"topLeft"==o&&(d={start:s,end:t})}break;case"SE-NW":switch(i){case"NW-SE":case"NE-SW":case"SW-NE":"topLeft"==o&&(d.end=t);break;case"SE-NW":"topLeft"==o?d.end=t:d={start:t,end:r}}}return d},t.prototype.bindTouchEvents=function(){var t=this,n=function(e){if(1==this.dragged.length)return this.dragged=[],!0;var t=this.dragged.indexOf(e);return-1!=t&&void(0===t?this.dragged=this.dragged.slice(0,1):1==t&&(this.dragged=this.dragged.slice(-1)))};this.eventManager.addEventListener(this.instance.rootElement,"touchstart",function(n){if(e.Dom.hasClass(n.target,"topLeftSelectionHandle-HitArea")){t.dragged.push("topLeft");i=t.instance.getSelectedRange();return t.touchStartRange={width:i.getWidth(),height:i.getHeight(),direction:i.getDirection()},n.preventDefault(),!1}if(e.Dom.hasClass(n.target,"bottomRightSelectionHandle-HitArea")){t.dragged.push("bottomRight");var i=t.instance.getSelectedRange();return t.touchStartRange={width:i.getWidth(),height:i.getHeight(),direction:i.getDirection()},n.preventDefault(),!1}}),this.eventManager.addEventListener(this.instance.rootElement,"touchend",function(i){return e.Dom.hasClass(i.target,"topLeftSelectionHandle-HitArea")?(n.call(t,"topLeft"),t.touchStartRange=void 0,i.preventDefault(),!1):e.Dom.hasClass(i.target,"bottomRightSelectionHandle-HitArea")?(n.call(t,"bottomRight"),t.touchStartRange=void 0,i.preventDefault(),!1):void 0}),this.eventManager.addEventListener(this.instance.rootElement,"touchmove",function(n){var i=e.Dom.getWindowScrollTop(),o=e.Dom.getWindowScrollLeft();if(t.dragged.length>0){var r=document.elementFromPoint(n.touches[0].screenX-o,n.touches[0].screenY-i);if(!r)return;if("TD"==r.nodeName||"TH"==r.nodeName){var a=t.instance.getCoords(r);-1==a.col&&(a.col=0);var s=t.instance.getSelectedRange(),l=s.getWidth(),c=s.getHeight(),d=s.getDirection();1==l&&1==c&&t.instance.selection.setRangeEnd(a);var u=t.getCurrentRangeCoords(s,a,t.touchStartRange.direction,d,t.dragged[0]);null!=u.start&&t.instance.selection.setRangeStart(u.start),t.instance.selection.setRangeEnd(u.end)}n.preventDefault()}})},t.prototype.isDragged=function(){return 0!==this.dragged.length};e.hooks.add("afterInit",function(){var n=this;e.plugins.multipleSelectionHandles=new t(n)})}(t);var X=new(function(){function e(){}return e.prototype.init=function(e){this.instance=e,this.bindEvents(),this.scrollbars=[this.instance.view.wt.wtScrollbars.vertical,this.instance.view.wt.wtScrollbars.horizontal,this.instance.view.wt.wtScrollbars.corner],this.clones=[this.instance.view.wt.wtScrollbars.vertical.clone.wtTable.holder.parentNode,this.instance.view.wt.wtScrollbars.horizontal.clone.wtTable.holder.parentNode,this.instance.view.wt.wtScrollbars.corner.clone.wtTable.holder.parentNode]},e.prototype.bindEvents=function(){var e=this;this.instance.addHook("beforeTouchScroll",function(){t.freezeOverlays=!0;for(var n=0,i=e.clones.length;i>n;n++)t.Dom.addClass(e.clones[n],"hide-tween")}),this.instance.addHook("afterMomentumScroll",function(){t.freezeOverlays=!1;for(var n=0,i=e.clones.length;i>n;n++)t.Dom.removeClass(e.clones[n],"hide-tween");for(var n=0,i=e.clones.length;i>n;n++)t.Dom.addClass(e.clones[n],"show-tween");setTimeout(function(){for(var n=0,i=e.clones.length;i>n;n++)t.Dom.removeClass(e.clones[n],"show-tween")},400);for(var n=0,i=e.scrollbars.length;i>n;n++)e.scrollbars[n].refresh(),e.scrollbars[n].resetFixedPosition()})},e}());if(t.hooks.add("afterInit",function(){X.init.call(X,this)}),function(e){function t(t){function n(n){n.items.push(e.ContextMenu.SEPARATOR,{key:"freeze_column",name:function(){return t.getSelected()[1]>f-1?"Freeze this column":"Unfreeze this column"},disabled:function(){var e=t.getSelected();return e[1]!==e[3]},callback:function(){var e=t.getSelected()[1];e>f-1?c(e):d(e)}})}function i(){t.updateSettings({fixedColumnsLeft:f+1}),f++}function o(){t.updateSettings({fixedColumnsLeft:f-1}),f--}function r(e){t.manualColumnPositions&&0!==t.manualColumnPositions.length||t.manualColumnPositions||(t.manualColumnPositions=[]),e?t.manualColumnPositions[e]||a(e+1):a(t.countCols())}function a(e){if(t.manualColumnPositions.length<e)for(var n=t.manualColumnPositions.length;e>n;n++)t.manualColumnPositions[n]=n}function s(e,n,i,o){null==i&&(i=e),"freeze"===o?t.manualColumnPositions.splice(f,0,t.manualColumnPositions.splice(n,1)[0]):"unfreeze"===o&&t.manualColumnPositions.splice(i,0,t.manualColumnPositions.splice(n,1)[0])}function l(e){for(var t=f,n=u(t),i=u(e);i>n;)t++,n=u(t);return t-1}function c(e){if(!(f-1>=e)){var t=u(e)||e;r(t),s(t,e,null,"freeze"),i()}}function d(e){if(!(e>f-1)){var t=l(e),n=u(e)||e;r(n),s(n,e,t,"unfreeze"),o()}}function u(e){return t.manualColumnPositions[e]}function h(e){return this.manualColumnPositionsPluginUsages.length>1?e:u(e)}function p(){t.addHook("modifyCol",h),t.addHook("afterContextMenuDefaultOptions",n)}var f=t.getSettings().fixedColumnsLeft;return{init:function(){void 0!==t.manualColumnPositionsPluginUsages?t.manualColumnPositionsPluginUsages.push("manualColumnFreeze"):t.manualColumnPositionsPluginUsages=["manualColumnFreeze"],p()},freezeColumn:c,unfreezeColumn:d,helpers:{addFixedColumn:i,removeFixedColumn:o,checkPositionData:r,modifyColumnOrder:s,getBestColumnReturnPosition:l}}}e.hooks.add("beforeInit",function(){this.getSettings().manualColumnFreeze&&(e.plugins.manualColumnFreeze=t,this.manualColumnFreeze=new t(this),this.manualColumnFreeze.init.call(this))})}(t),s.prototype.init=function(){this.TABLE=this.instance.wtTable.TABLE,this.fixed=this.instance.wtTable.hider,this.fixedContainer=this.instance.wtTable.holder,this.scrollHandler=this.getScrollableElement(this.TABLE)},s.prototype.makeClone=function(e){var t=document.createElement("DIV");t.className="ht_clone_"+e+" handsontable",t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.overflow="hidden";var n=document.createElement("TABLE");return n.className=this.instance.wtTable.TABLE.className,t.appendChild(n),this.instance.wtTable.holder.parentNode.appendChild(t),new p({cloneSource:this.instance,cloneOverlay:this,table:n})},s.prototype.getScrollableElement=function(t){for(var n=t.parentNode;n&&n.style&&document.body!==n;){if("visible"!==n.style.overflow&&""!==n.style.overflow)return n;if(e.getComputedStyle){var i=e.getComputedStyle(n);if("visible"!==i.getPropertyValue("overflow")&&""!==i.getPropertyValue("overflow"))return n}if(this instanceof b&&"visible"!==n.style.overflowX&&""!==n.style.overflowX)return n;n=n.parentNode}return e},s.prototype.refresh=function(e){this.clone&&this.clone.draw(e)},s.prototype.destroy=function(){t.eventManager(this.clone).clear()},l.prototype.appear=function(e){var n,i,o,r,a,s,l,d,u,h,p,f;if(!this.disabled){var g,v,m,y,b,x,E,_=this.instance,S=function(){return!(!this.instance.selections.area.cellRange||m==this.instance.selections.area.cellRange.to.row&&y==this.instance.selections.area.cellRange.to.col)};for(x=_.cloneOverlay instanceof C||_.cloneOverlay instanceof w?_.getSetting("fixedRowsTop"):_.wtTable.getRenderedRowsCount(),b=0;x>b;b++)if((E=_.wtTable.rowFilter.renderedToSource(b))>=e[0]&&E<=e[2]){g=E;break}for(b=x-1;b>=0;b--)if((E=_.wtTable.rowFilter.renderedToSource(b))>=e[0]&&E<=e[2]){m=E;break}for(x=_.wtTable.getRenderedColumnsCount(),b=0;x>b;b++)if((E=_.wtTable.columnFilter.renderedToSource(b))>=e[1]&&E<=e[3]){v=E;break}for(b=x-1;b>=0;b--)if((E=_.wtTable.columnFilter.renderedToSource(b))>=e[1]&&E<=e[3]){y=E;break}if(void 0===g||void 0===v)return void this.disappear();n=g!==m||v!==y,i=_.wtTable.getCell(new c(g,v)),o=n?_.wtTable.getCell(new c(m,y)):i,r=t.Dom.offset(i),a=n?t.Dom.offset(o):r,s=t.Dom.offset(_.wtTable.TABLE),d=r.top,p=a.top+t.Dom.outerHeight(o)-d,h=r.left,f=a.left+t.Dom.outerWidth(o)-h,l=d-s.top-1,u=h-s.left-1;var k=t.Dom.getComputedStyle(i);parseInt(k.borderTopWidth,10)>0&&(l+=1,p=p>0?p-1:0),parseInt(k.borderLeftWidth,10)>0&&(u+=1,f=f>0?f-1:0),this.topStyle.top=l+"px",this.topStyle.left=u+"px",this.topStyle.width=f+"px",this.topStyle.display="block",this.leftStyle.top=l+"px",this.leftStyle.left=u+"px",this.leftStyle.height=p+"px",this.leftStyle.display="block";var T=Math.floor(this.settings.border.width/2);if(this.bottomStyle.top=l+p-T+"px",this.bottomStyle.left=u+"px",this.bottomStyle.width=f+"px",this.bottomStyle.display="block",this.rightStyle.top=l+"px",this.rightStyle.left=u+f-T+"px",this.rightStyle.height=p+1+"px",this.rightStyle.display="block",t.mobileBrowser||!this.hasSetting(this.settings.border.cornerVisible)||S.call(this))this.cornerStyle.display="none";else if(this.cornerStyle.top=l+p-4+"px",this.cornerStyle.left=u+f-4+"px",this.cornerStyle.borderRightWidth=this.cornerDefaultStyle.borderWidth,this.cornerStyle.width=this.cornerDefaultStyle.width,this.cornerStyle.display="block",y===this.instance.getSetting("totalColumns")-1){var D=t.Dom.getScrollableElement(_.wtTable.TABLE);o.offsetLeft+t.Dom.outerWidth(o)>=t.Dom.innerWidth(D)&&(this.cornerStyle.left=Math.floor(u+f-3-parseInt(this.cornerDefaultStyle.width)/2)+"px",this.cornerStyle.borderRightWidth=0)}t.mobileBrowser&&function(e,t,n,i){var o=parseInt(this.selectionHandles.styles.topLeft.width,10),r=parseInt(this.selectionHandles.styles.topLeftHitArea.width,10);this.selectionHandles.styles.topLeft.top=parseInt(e-o,10)+"px",this.selectionHandles.styles.topLeft.left=parseInt(t-o,10)+"px",this.selectionHandles.styles.topLeftHitArea.top=parseInt(e-r/4*3,10)+"px",this.selectionHandles.styles.topLeftHitArea.left=parseInt(t-r/4*3,10)+"px",this.selectionHandles.styles.bottomRight.top=parseInt(e+i,10)+"px",this.selectionHandles.styles.bottomRight.left=parseInt(t+n,10)+"px",this.selectionHandles.styles.bottomRightHitArea.top=parseInt(e+i-r/4,10)+"px",this.selectionHandles.styles.bottomRightHitArea.left=parseInt(t+n-r/4,10)+"px",this.settings.border.multipleSelectionHandlesVisible&&this.settings.border.multipleSelectionHandlesVisible()?(this.selectionHandles.styles.topLeft.display="block",this.selectionHandles.styles.topLeftHitArea.display="block",S.call(this)?(this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"):(this.selectionHandles.styles.bottomRight.display="block",this.selectionHandles.styles.bottomRightHitArea.display="block")):(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none",this.selectionHandles.styles.topLeftHitArea.display="none",this.selectionHandles.styles.bottomRightHitArea.display="none"),g==this.instance.wtSettings.getSetting("fixedRowsTop")||v==this.instance.wtSettings.getSetting("fixedColumnsLeft")?(this.selectionHandles.styles.topLeft.zIndex="9999",this.selectionHandles.styles.topLeftHitArea.zIndex="9999"):(this.selectionHandles.styles.topLeft.zIndex="",this.selectionHandles.styles.topLeftHitArea.zIndex="")}.call(this,l,u,f,p)}},l.prototype.disappear=function(){this.topStyle.display="none",this.leftStyle.display="none",this.bottomStyle.display="none",this.rightStyle.display="none",this.cornerStyle.display="none",t.mobileBrowser&&(this.selectionHandles.styles.topLeft.display="none",this.selectionHandles.styles.bottomRight.display="none")},l.prototype.hasSetting=function(e){return"function"==typeof e?e():!!e},c.prototype.isValid=function(e){return!(this.row<0||this.col<0)&&!(this.row>=e.getSetting("totalRows")||this.col>=e.getSetting("totalColumns"))},c.prototype.isEqual=function(e){return e===this||this.row===e.row&&this.col===e.col},c.prototype.isSouthEastOf=function(e){return this.row>=e.row&&this.col>=e.col},c.prototype.isNorthWestOf=function(e){return this.row<=e.row&&this.col<=e.col},c.prototype.isSouthWestOf=function(e){return this.row>=e.row&&this.col<=e.col},c.prototype.isNorthEastOf=function(e){return this.row<=e.row&&this.col>=e.col},e.WalkontableCellCoords=c,d.prototype.isValid=function(e){return this.from.isValid(e)&&this.to.isValid(e)},d.prototype.isSingle=function(){return this.from.row===this.to.row&&this.from.col===this.to.col},d.prototype.getHeight=function(){return Math.max(this.from.row,this.to.row)-Math.min(this.from.row,this.to.row)+1},d.prototype.getWidth=function(){return Math.max(this.from.col,this.to.col)-Math.min(this.from.col,this.to.col)+1},d.prototype.includes=function(e){var t=this.getTopLeftCorner(),n=this.getBottomRightCorner();return e.row<0&&(e.row=0),e.col<0&&(e.col=0),t.row<=e.row&&n.row>=e.row&&t.col<=e.col&&n.col>=e.col},d.prototype.includesRange=function(e){return this.includes(e.getTopLeftCorner())&&this.includes(e.getBottomRightCorner())},d.prototype.isEqual=function(e){return Math.min(this.from.row,this.to.row)==Math.min(e.from.row,e.to.row)&&Math.max(this.from.row,this.to.row)==Math.max(e.from.row,e.to.row)&&Math.min(this.from.col,this.to.col)==Math.min(e.from.col,e.to.col)&&Math.max(this.from.col,this.to.col)==Math.max(e.from.col,e.to.col)},d.prototype.overlaps=function(e){return e.isSouthEastOf(this.getTopLeftCorner())&&e.isNorthWestOf(this.getBottomRightCorner())},d.prototype.isSouthEastOf=function(e){return this.getTopLeftCorner().isSouthEastOf(e)||this.getBottomRightCorner().isSouthEastOf(e)},d.prototype.isNorthWestOf=function(e){return this.getTopLeftCorner().isNorthWestOf(e)||this.getBottomRightCorner().isNorthWestOf(e)},d.prototype.expand=function(e){var t=this.getTopLeftCorner(),n=this.getBottomRightCorner();return(e.row<t.row||e.col<t.col||e.row>n.row||e.col>n.col)&&(this.from=new c(Math.min(t.row,e.row),Math.min(t.col,e.col)),this.to=new c(Math.max(n.row,e.row),Math.max(n.col,e.col)),!0)},d.prototype.expandByRange=function(e){if(this.includesRange(e)||!this.overlaps(e))return!1;var t=this.getTopLeftCorner(),n=this.getBottomRightCorner(),i=(this.getTopRightCorner(),this.getBottomLeftCorner(),e.getTopLeftCorner()),o=e.getBottomRightCorner(),r=Math.min(t.row,i.row),a=Math.min(t.col,i.col),s=Math.max(n.row,o.row),l=Math.max(n.col,o.col),u=new c(r,a),h=new c(s,l),p=new d(u,u,h).isCorner(this.from,e),f=e.isEqual(new d(u,u,h));return p&&!f&&(this.from.col>u.col&&(u.col=l,h.col=a),this.from.row>u.row&&(u.row=s,h.row=r)),this.from=u,this.to=h,!0},d.prototype.getDirection=function(){return this.from.isNorthWestOf(this.to)?"NW-SE":this.from.isNorthEastOf(this.to)?"NE-SW":this.from.isSouthEastOf(this.to)?"SE-NW":this.from.isSouthWestOf(this.to)?"SW-NE":void 0},d.prototype.setDirection=function(e){switch(e){case"NW-SE":this.from=this.getTopLeftCorner(),this.to=this.getBottomRightCorner();break;case"NE-SW":this.from=this.getTopRightCorner(),this.to=this.getBottomLeftCorner();break;case"SE-NW":this.from=this.getBottomRightCorner(),this.to=this.getTopLeftCorner();break;case"SW-NE":this.from=this.getBottomLeftCorner(),this.to=this.getTopRightCorner()}},d.prototype.getTopLeftCorner=function(){return new c(Math.min(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},d.prototype.getBottomRightCorner=function(){return new c(Math.max(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},d.prototype.getTopRightCorner=function(){return new c(Math.min(this.from.row,this.to.row),Math.max(this.from.col,this.to.col))},d.prototype.getBottomLeftCorner=function(){return new c(Math.max(this.from.row,this.to.row),Math.min(this.from.col,this.to.col))},d.prototype.isCorner=function(e,t){return!!(t&&t.includes(e)&&(this.getTopLeftCorner().isEqual(new c(t.from.row,t.from.col))||this.getTopRightCorner().isEqual(new c(t.from.row,t.to.col))||this.getBottomLeftCorner().isEqual(new c(t.to.row,t.from.col))||this.getBottomRightCorner().isEqual(new c(t.to.row,t.to.col))))||(e.isEqual(this.getTopLeftCorner())||e.isEqual(this.getTopRightCorner())||e.isEqual(this.getBottomLeftCorner())||e.isEqual(this.getBottomRightCorner()))},d.prototype.getOppositeCorner=function(e,t){if(!(e instanceof c))return!1;if(t&&t.includes(e)){if(this.getTopLeftCorner().isEqual(new c(t.from.row,t.from.col)))return this.getBottomRightCorner();if(this.getTopRightCorner().isEqual(new c(t.from.row,t.to.col)))return this.getBottomLeftCorner();if(this.getBottomLeftCorner().isEqual(new c(t.to.row,t.from.col)))return this.getTopRightCorner();if(this.getBottomRightCorner().isEqual(new c(t.to.row,t.to.col)))return this.getTopLeftCorner()}return e.isEqual(this.getBottomRightCorner())?this.getTopLeftCorner():e.isEqual(this.getTopLeftCorner())?this.getBottomRightCorner():e.isEqual(this.getTopRightCorner())?this.getBottomLeftCorner():e.isEqual(this.getBottomLeftCorner())?this.getTopRightCorner():void 0},d.prototype.getBordersSharedWith=function(e){if(!this.includesRange(e))return[];var t={top:Math.min(this.from.row,this.to.row),bottom:Math.max(this.from.row,this.to.row),left:Math.min(this.from.col,this.to.col),right:Math.max(this.from.col,this.to.col)},n={top:Math.min(e.from.row,e.to.row),bottom:Math.max(e.from.row,e.to.row),left:Math.min(e.from.col,e.to.col),right:Math.max(e.from.col,e.to.col)},i=[];return t.top==n.top&&i.push("top"),t.right==n.right&&i.push("right"),t.bottom==n.bottom&&i.push("bottom"),t.left==n.left&&i.push("left"),i},d.prototype.getInner=function(){for(var e=this.getTopLeftCorner(),t=this.getBottomRightCorner(),n=[],i=e.row;i<=t.row;i++)for(var o=e.col;o<=t.col;o++)this.from.row===i&&this.from.col===o||this.to.row===i&&this.to.col===o||n.push(new c(i,o));return n},d.prototype.getAll=function(){for(var e=this.getTopLeftCorner(),t=this.getBottomRightCorner(),n=[],i=e.row;i<=t.row;i++)for(var o=e.col;o<=t.col;o++)n.push(e.row===i&&e.col===o?e:t.row===i&&t.col===o?t:new c(i,o));return n},d.prototype.forAll=function(e){for(var t=this.getTopLeftCorner(),n=this.getBottomRightCorner(),i=t.row;i<=n.row;i++)for(var o=t.col;o<=n.col;o++)if(!1===e(i,o))return},e.WalkontableCellRange=d,u.prototype.offsetted=function(e){return e+this.offset},u.prototype.unOffsetted=function(e){return e-this.offset},u.prototype.renderedToSource=function(e){return this.offsetted(e)},u.prototype.sourceToRendered=function(e){return this.unOffsetted(e)},u.prototype.offsettedTH=function(e){return e-this.countTH},u.prototype.unOffsettedTH=function(e){return e+this.countTH},u.prototype.visibleRowHeadedColumnToSourceColumn=function(e){return this.renderedToSource(this.offsettedTH(e))},u.prototype.sourceColumnToVisibleRowHeadedColumn=function(e){return this.unOffsettedTH(this.sourceToRendered(e))},h.prototype.getContainerSize=function(){return"function"==typeof this.containerSizeFn?this.containerSizeFn():this.containerSizeFn},h.prototype.getSize=function(e){return this.cellSizes[e]+(this.cellStretch[e]||0)},h.prototype.stretch=function(){var e=this.getContainerSize(),t=0;if(this.remainingSize=this.cellSizesSum-e,this.cellStretch.length=0,"all"===this.strategy){if(this.remainingSize<0){for(var n,i=e/this.cellSizesSum;t<this.cellCount-1;)n=Math.floor(i*this.cellSizes[t]),this.remainingSize+=n-this.cellSizes[t],this.cellStretch[t]=n-this.cellSizes[t],t++;this.cellStretch[this.cellCount-1]=-this.remainingSize,this.remainingSize=0}}else"last"===this.strategy&&this.remainingSize<0&&1/0!==e&&(this.cellStretch[this.cellCount-1]=-this.remainingSize,this.remainingSize=0)},h.prototype.countVisible=function(){return this.visibleCellCount},h.prototype.isLastIncomplete=function(){var e=this.instance.wtTable.getFirstVisibleRow(),n=this.instance.wtTable.getLastVisibleColumn(),i=this.instance.wtTable.getCell(new c(e,n)),o=t.Dom.offset(i),r=t.Dom.outerWidth(i),a=o.left+r;return this.instance.wtScrollbars.vertical.getScrollPosition()+this.instance.wtViewport.getViewportWidth()>=a},p.prototype.draw=function(e){return this.drawInterrupted=!1,e||t.Dom.isVisible(this.wtTable.TABLE)?(this.wtTable.draw(e),this):void(this.drawInterrupted=!0)},p.prototype.getCell=function(e,t){if(t){var n=this.wtSettings.getSetting("fixedRowsTop"),i=this.wtSettings.getSetting("fixedColumnsLeft");return e.row<n&&e.col<i?this.wtScrollbars.corner.clone.wtTable.getCell(e):e.row<n?this.wtScrollbars.vertical.clone.wtTable.getCell(e):e.col<i?this.wtScrollbars.horizontal.clone.wtTable.getCell(e):this.wtTable.getCell(e)}return this.wtTable.getCell(e)},p.prototype.update=function(e,t){return this.wtSettings.update(e,t)},p.prototype.scrollVertical=function(e){return this.wtScrollbars.vertical.scrollTo(e),this.getSetting("onScrollVertically"),this},p.prototype.scrollHorizontal=function(e){return this.wtScrollbars.horizontal.scrollTo(e),this.getSetting("onScrollHorizontally"),this},p.prototype.scrollViewport=function(e){return this.wtScroll.scrollViewport(e),this},p.prototype.getViewport=function(){return[this.wtTable.getFirstVisibleRow(),this.wtTable.getFirstVisibleColumn(),this.wtTable.getLastVisibleRow(),this.wtTable.getLastVisibleColumn()]},p.prototype.getSetting=function(e,t,n,i,o){return this.wtSettings.getSetting(e,t,n,i,o)},p.prototype.hasSetting=function(e){return this.wtSettings.has(e)},p.prototype.destroy=function(){this.wtScrollbars.destroy(),this.wtEvent&&this.wtEvent.destroy()},f.prototype=new s,f.prototype.destroy=function(){s.prototype.destroy.call(this),clearTimeout(this.lastTimeout)},g.prototype.parentCell=function(e){var n={},i=this.instance.wtTable.TABLE,o=t.Dom.closest(e,["TD","TH"],i);return o&&t.Dom.isChildOf(o,i)?(n.coords=this.instance.wtTable.getCoords(o),n.TD=o):t.Dom.hasClass(e,"wtBorder")&&t.Dom.hasClass(e,"current")?(n.coords=this.instance.selections.current.cellRange.highlight,n.TD=this.instance.wtTable.getCell(n.coords)):t.Dom.hasClass(e,"wtBorder")&&t.Dom.hasClass(e,"area")&&this.instance.selections.area.cellRange&&(n.coords=this.instance.selections.area.cellRange.to,n.TD=this.instance.wtTable.getCell(n.coords)),n},e.requestAnimFrame=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.oRequestAnimationFrame||e.msRequestAnimationFrame||function(t){return e.setTimeout(t,1e3/60)},e.cancelRequestAnimFrame=e.cancelAnimationFrame||e.webkitCancelRequestAnimationFrame||e.mozCancelRequestAnimationFrame||e.oCancelRequestAnimationFrame||e.msCancelRequestAnimationFrame||clearTimeout,e.getComputedStyle||function(){var t,n={getPropertyValue:function(e){return"float"==e&&(e="styleFloat"),t.currentStyle[e.toUpperCase()]||null}};e.getComputedStyle=function(e){return t=e,n}}(),!String.prototype.trim){var Y=/^\s+|\s+$/g;String.prototype.trim=function(){return this.replace(Y,"")}}m.prototype.offsetted=function(e){return e+this.offset},m.prototype.unOffsetted=function(e){return e-this.offset},m.prototype.renderedToSource=function(e){return this.offsetted(e)},m.prototype.sourceToRendered=function(e){return this.unOffsetted(e)},m.prototype.offsettedTH=function(e){return e-this.countTH},m.prototype.visibleColHeadedRowToSourceRow=function(e){return this.renderedToSource(this.offsettedTH(e))},m.prototype.sourceRowToVisibleColHeadedRow=function(e){return this.unOffsettedTH(this.sourceToRendered(e))},y.prototype.scrollViewport=function(e){if(this.instance.drawn){var t=this.instance.getSetting("totalRows"),n=this.instance.getSetting("totalColumns");if(e.row<0||e.row>t-1)throw new Error("row "+e.row+" does not exist");if(e.col<0||e.col>n-1)throw new Error("column "+e.col+" does not exist");e.row>this.instance.wtTable.getLastVisibleRow()?this.instance.wtScrollbars.vertical.scrollTo(e.row,!0):e.row>=this.instance.getSetting("fixedRowsTop")&&e.row<this.instance.wtTable.getFirstVisibleRow()&&this.instance.wtScrollbars.vertical.scrollTo(e.row),e.col>this.instance.wtTable.getLastVisibleColumn()?this.instance.wtScrollbars.horizontal.scrollTo(e.col,!0):e.col>=this.instance.getSetting("fixedColumnsLeft")&&e.col<this.instance.wtTable.getFirstVisibleColumn()&&this.instance.wtScrollbars.horizontal.scrollTo(e.col)}},w.prototype=new s,w.prototype.resetFixedPosition=function(){if(this.instance.wtTable.holder.parentNode){var n,i,o=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===e){var r=this.instance.wtTable.holder.getBoundingClientRect(),a=Math.ceil(r.top),s=Math.ceil(r.left),l=Math.ceil(r.bottom),c=Math.ceil(r.right);n=0>s&&c-o.offsetWidth>0?-s+"px":"0",i=0>a&&l-o.offsetHeight>0?-a+"px":"0"}else t.freezeOverlays||(n=this.instance.wtScrollbars.horizontal.getScrollPosition()+"px",i=this.instance.wtScrollbars.vertical.getScrollPosition()+"px");t.Dom.setOverlayPosition(o,n,i),o.style.width=t.Dom.outerWidth(this.clone.wtTable.TABLE)+4+"px",o.style.height=t.Dom.outerHeight(this.clone.wtTable.TABLE)+4+"px"}},b.prototype=new s,b.prototype.resetFixedPosition=function(){var n,i;if(this.instance.wtTable.holder.parentNode){var o=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===e){var r=this.instance.wtTable.holder.getBoundingClientRect(),a=Math.ceil(r.left),s=Math.ceil(r.right);n=0>a&&s-o.offsetWidth>0?-a+"px":"0",i=this.instance.wtTable.hider.style.top}else t.freezeOverlays||(n=this.getScrollPosition()+"px",i=this.instance.wtTable.hider.style.top);t.Dom.setOverlayPosition(o,n,i),o.style.height=t.Dom.outerHeight(this.clone.wtTable.TABLE)+"px",o.style.width=t.Dom.outerWidth(this.clone.wtTable.TABLE)+4+"px"}},b.prototype.refresh=function(e){this.applyToDOM(),s.prototype.refresh.call(this,e)},b.prototype.getScrollPosition=function(){return t.Dom.getScrollLeft(this.scrollHandler)},b.prototype.setScrollPosition=function(n){this.scrollHandler===e?e.scrollTo(n,t.Dom.getWindowScrollTop()):this.scrollHandler.scrollLeft=n},b.prototype.onScroll=function(){this.instance.getSetting("onScrollHorizontally")},b.prototype.sumCellSizes=function(e,t){for(var n=0;t>e;)n+=this.instance.wtTable.getStretchedColumnWidth(e)||this.instance.wtSettings.defaultColumnWidth,e++;return n},b.prototype.applyToDOM=function(){var e=this.instance.getSetting("totalColumns"),t=this.instance.wtViewport.getRowHeaderWidth();if(this.fixedContainer.style.width=t+this.sumCellSizes(0,e)+"px","number"==typeof this.instance.wtViewport.columnsRenderCalculator.startPosition)this.fixed.style.left=this.instance.wtViewport.columnsRenderCalculator.startPosition+"px";else{if(0!==e)throw new Error("Incorrect value of the columnsRenderCalculator");this.fixed.style.left="0"}this.fixed.style.right=""},b.prototype.scrollTo=function(e,t){var n=this.getTableParentOffset();if(t)n+=this.sumCellSizes(0,e+1),n-=this.instance.wtViewport.getViewportWidth();else{var i=this.instance.getSetting("fixedColumnsLeft");n+=this.sumCellSizes(i,e)}this.setScrollPosition(n)},b.prototype.getTableParentOffset=function(){return this.scrollHandler===e?this.instance.wtTable.holderOffset.left:0},C.prototype=new s,C.prototype.resetFixedPosition=function(){var n,i;if(this.instance.wtTable.holder.parentNode){var o=this.clone.wtTable.holder.parentNode;if(this.scrollHandler===e){var r=this.instance.wtTable.holder.getBoundingClientRect(),a=Math.ceil(r.top),s=Math.ceil(r.bottom);n=this.instance.wtTable.hider.style.left,i=0>a&&s-o.offsetHeight>0?-a+"px":"0"}else t.freezeOverlays||(i=this.getScrollPosition()+"px",n=this.instance.wtTable.hider.style.left);t.Dom.setOverlayPosition(o,n,i),o.style.width=this.instance.wtScrollbars.horizontal.scrollHandler===e?this.instance.wtViewport.getWorkspaceActualWidth()+"px":t.Dom.outerWidth(this.clone.wtTable.TABLE)+"px",o.style.height=t.Dom.outerHeight(this.clone.wtTable.TABLE)+4+"px"}},C.prototype.getScrollPosition=function(){return t.Dom.getScrollTop(this.scrollHandler)},C.prototype.setScrollPosition=function(n){this.scrollHandler===e?e.scrollTo(t.Dom.getWindowScrollLeft(),n):this.scrollHandler.scrollTop=n},C.prototype.onScroll=function(){this.instance.getSetting("onScrollVertically")},C.prototype.sumCellSizes=function(e,t){for(var n=0;t>e;)n+=this.instance.wtTable.getRowHeight(e)||this.instance.wtSettings.settings.defaultRowHeight,e++;return n},C.prototype.refresh=function(e){this.applyToDOM(),s.prototype.refresh.call(this,e)},C.prototype.applyToDOM=function(){var e=this.instance.getSetting("totalRows"),t=this.instance.wtViewport.getColumnHeaderHeight();if(this.fixedContainer.style.height=t+this.sumCellSizes(0,e)+"px","number"==typeof this.instance.wtViewport.rowsRenderCalculator.startPosition)this.fixed.style.top=this.instance.wtViewport.rowsRenderCalculator.startPosition+"px";else{if(0!==e)throw new Error("Incorrect value of the rowsRenderCalculator");this.fixed.style.top="0"}this.fixed.style.bottom=""},C.prototype.scrollTo=function(e,t){var n=this.getTableParentOffset();if(t)n+=this.sumCellSizes(0,e+1),n-=this.instance.wtViewport.getViewportHeight(),n+=1;else{var i=this.instance.getSetting("fixedRowsTop");n+=this.sumCellSizes(i,e)}this.setScrollPosition(n)},C.prototype.getTableParentOffset=function(){return this.scrollHandler===e?this.instance.wtTable.holderOffset.top:0},x.prototype.registerListeners=function(){var n=this;this.refreshAll=function(){if(n.instance.drawn){if(!n.instance.wtTable.holder.parentNode)return void n.destroy();n.instance.draw(!0),n.vertical.onScroll(),n.horizontal.onScroll()}};var i=t.eventManager(n.instance);i.addEventListener(this.vertical.scrollHandler,"scroll",this.refreshAll),this.vertical.scrollHandler!==this.horizontal.scrollHandler&&i.addEventListener(this.horizontal.scrollHandler,"scroll",this.refreshAll),this.vertical.scrollHandler!==e&&this.horizontal.scrollHandler!==e&&i.addEventListener(e,"scroll",this.refreshAll)},x.prototype.destroy=function(){var n=t.eventManager(this.instance);this.vertical&&(this.vertical.destroy(),n.removeEventListener(this.vertical.scrollHandler,"scroll",this.refreshAll)),this.horizontal&&(this.horizontal.destroy(),n.removeEventListener(this.horizontal.scrollHandler,"scroll",this.refreshAll)),n.removeEventListener(e,"scroll",this.refreshAll),this.corner&&this.corner.destroy(),this.debug&&this.debug.destroy()},x.prototype.refresh=function(e){this.horizontal&&this.horizontal.refresh(e),this.vertical&&this.vertical.refresh(e),this.corner&&this.corner.refresh(e),this.debug&&this.debug.refresh(e)},x.prototype.applyToDOM=function(){this.horizontal&&this.horizontal.applyToDOM(),this.vertical&&this.vertical.applyToDOM()},E.prototype.getBorder=function(e){return this.instanceBorders[e.guid]?this.instanceBorders[e.guid]:void(this.instanceBorders[e.guid]=new l(e,this.settings))},E.prototype.isEmpty=function(){return null===this.cellRange},E.prototype.add=function(e){this.isEmpty()?this.cellRange=new d(e,e,e):this.cellRange.expand(e)},E.prototype.replace=function(e,t){if(!this.isEmpty()){if(this.cellRange.from.isEqual(e))return this.cellRange.from=t,!0;if(this.cellRange.to.isEqual(e))return this.cellRange.to=t,!0}return!1},E.prototype.clear=function(){this.cellRange=null},E.prototype.getCorners=function(){var e=this.cellRange.getTopLeftCorner(),t=this.cellRange.getBottomRightCorner();return[e.row,e.col,t.row,t.col]},E.prototype.addClassAtCoords=function(e,n,i,o){var r=e.wtTable.getCell(new c(n,i));"object"==typeof r&&t.Dom.addClass(r,o)},E.prototype.draw=function(e){var n,i,o,r,a,s=this,l=e.wtTable.getRenderedRowsCount(),c=e.wtTable.getRenderedColumnsCount();if(this.isEmpty())this.settings.border&&(r=this.getBorder(e))&&r.disappear();else{n=this.getCorners();for(u=0;c>u;u++)(o=e.wtTable.columnFilter.renderedToSource(u))>=n[1]&&o<=n[3]&&(a=e.wtTable.getColumnHeader(o))&&s.settings.highlightColumnClassName&&t.Dom.addClass(a,s.settings.highlightColumnClassName);for(var d=0;l>d;d++){(i=e.wtTable.rowFilter.renderedToSource(d))>=n[0]&&i<=n[2]&&(a=e.wtTable.getRowHeader(i))&&s.settings.highlightRowClassName&&t.Dom.addClass(a,s.settings.highlightRowClassName);for(var u=0;c>u;u++)o=e.wtTable.columnFilter.renderedToSource(u),i>=n[0]&&i<=n[2]&&o>=n[1]&&o<=n[3]?s.settings.className&&s.addClassAtCoords(e,i,o,s.settings.className):i>=n[0]&&i<=n[2]?s.settings.highlightRowClassName&&s.addClassAtCoords(e,i,o,s.settings.highlightRowClassName):o>=n[1]&&o<=n[3]&&s.settings.highlightColumnClassName&&s.addClassAtCoords(e,i,o,s.settings.highlightColumnClassName)}e.getSetting("onBeforeDrawBorders",n,this.settings.className),this.settings.border&&(r=this.getBorder(e))&&r.appear(n)}},_.prototype.update=function(e,t){if(void 0===t)for(var n in e)e.hasOwnProperty(n)&&(this.settings[n]=e[n]);else this.settings[e]=t;return this.instance},_.prototype.getSetting=function(e,t,n,i,o){return"function"==typeof this.settings[e]?this.settings[e](t,n,i,o):void 0!==t&&Array.isArray(this.settings[e])?this.settings[e][t]:this.settings[e]},_.prototype.has=function(e){return!!this.settings[e]},S.prototype.isWorkingOnClone=function(){return!!this.instance.cloneSource},S.prototype.draw=function(e){if(this.isWorkingOnClone()||(this.holderOffset=t.Dom.offset(this.holder),e=this.instance.wtViewport.createRenderCalculators(e)),e)this.isWorkingOnClone()||this.instance.wtViewport.createVisibleCalculators(),this.instance.wtScrollbars&&this.instance.wtScrollbars.refresh(!0);else{this.tableOffset=this.isWorkingOnClone()?this.instance.cloneSource.wtTable.tableOffset:t.Dom.offset(this.TABLE);var n;n=this.instance.cloneOverlay instanceof f||this.instance.cloneOverlay instanceof C||this.instance.cloneOverlay instanceof w?0:this.instance.wtViewport.rowsRenderCalculator.startRow;var i;i=this.instance.cloneOverlay instanceof f||this.instance.cloneOverlay instanceof b||this.instance.cloneOverlay instanceof w?0:this.instance.wtViewport.columnsRenderCalculator.startColumn,this.rowFilter=new m(n,this.instance.getSetting("totalRows"),this.instance.getSetting("columnHeaders").length),this.columnFilter=new u(i,this.instance.getSetting("totalColumns"),this.instance.getSetting("rowHeaders").length),this._doDraw()}return this.refreshSelections(e),this.isWorkingOnClone()||(this.instance.wtScrollbars.vertical.resetFixedPosition(),this.instance.wtScrollbars.horizontal.resetFixedPosition(),this.instance.wtScrollbars.corner.resetFixedPosition()),this.instance.drawn=!0,this},S.prototype._doDraw=function(){new k(this).render()},S.prototype.removeClassFromCells=function(e){for(var n=this.TABLE.querySelectorAll("."+e),i=0,o=n.length;o>i;i++)t.Dom.removeClass(n[i],e)},S.prototype.refreshSelections=function(e){var t,n;if(this.instance.selections){if(n=this.instance.selections.length,e)for(t=0;n>t;t++)this.instance.selections[t].settings.className&&this.removeClassFromCells(this.instance.selections[t].settings.className),this.instance.selections[t].settings.highlightRowClassName&&this.removeClassFromCells(this.instance.selections[t].settings.highlightRowClassName),this.instance.selections[t].settings.highlightColumnClassName&&this.removeClassFromCells(this.instance.selections[t].settings.highlightColumnClassName);for(t=0;n>t;t++)this.instance.selections[t].draw(this.instance,e)}},S.prototype.getCell=function(e){if(this.isRowBeforeRenderedRows(e.row))return-1;if(this.isRowAfterRenderedRows(e.row))return-2;var t=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e.row)];return t?t.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e.col)]:void 0},S.prototype.getColumnHeader=function(e,t){t||(t=0);var n=this.THEAD.childNodes[t];return n?n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(e)]:void 0},S.prototype.getRowHeader=function(e){if(0===this.columnFilter.sourceColumnToVisibleRowHeadedColumn(0))return null;var t=this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)];return t?t.childNodes[0]:void 0},S.prototype.getCoords=function(e){var n=e.parentNode,i=t.Dom.index(n);return i=n.parentNode===this.THEAD?this.rowFilter.visibleColHeadedRowToSourceRow(i):this.rowFilter.renderedToSource(i),new c(i,this.columnFilter.visibleRowHeadedColumnToSourceColumn(e.cellIndex))},S.prototype.getTrForRow=function(e){return this.TBODY.childNodes[this.rowFilter.sourceToRendered(e)]},S.prototype.getFirstRenderedRow=function(){return this.instance.wtViewport.rowsRenderCalculator.startRow},S.prototype.getFirstVisibleRow=function(){return this.instance.wtViewport.rowsVisibleCalculator.startRow},S.prototype.getFirstRenderedColumn=function(){return this.instance.wtViewport.columnsRenderCalculator.startColumn},S.prototype.getFirstVisibleColumn=function(){return this.instance.wtViewport.columnsVisibleCalculator.startColumn},S.prototype.getLastRenderedRow=function(){return this.instance.wtViewport.rowsRenderCalculator.endRow},S.prototype.getLastVisibleRow=function(){return this.instance.wtViewport.rowsVisibleCalculator.endRow},S.prototype.getLastRenderedColumn=function(){return this.instance.wtViewport.columnsRenderCalculator.endColumn},S.prototype.getLastVisibleColumn=function(){return this.instance.wtViewport.columnsVisibleCalculator.endColumn},S.prototype.isRowBeforeRenderedRows=function(e){return this.rowFilter.sourceToRendered(e)<0&&e>=0},S.prototype.isRowAfterViewport=function(e){return e>this.getLastVisibleRow()},S.prototype.isRowAfterRenderedRows=function(e){return e>this.getLastRenderedRow()},S.prototype.isColumnBeforeViewport=function(e){return this.columnFilter.sourceToRendered(e)<0&&e>=0},S.prototype.isColumnAfterViewport=function(e){return e>this.getLastVisibleColumn()},S.prototype.isLastRowFullyVisible=function(){return this.getLastVisibleRow()===this.getLastRenderedRow()},S.prototype.isLastColumnFullyVisible=function(){return this.getLastVisibleColumn()===this.getLastRenderedColumn},S.prototype.getRenderedColumnsCount=function(){return this.instance.cloneOverlay instanceof f?this.instance.getSetting("totalColumns"):this.instance.cloneOverlay instanceof b||this.instance.cloneOverlay instanceof w?this.instance.getSetting("fixedColumnsLeft"):this.instance.wtViewport.columnsRenderCalculator.count},S.prototype.getRenderedRowsCount=function(){return this.instance.cloneOverlay instanceof f?this.instance.getSetting("totalRows"):this.instance.cloneOverlay instanceof C||this.instance.cloneOverlay instanceof w?this.instance.getSetting("fixedRowsTop"):this.instance.wtViewport.rowsRenderCalculator.count},S.prototype.getVisibleRowsCount=function(){return this.instance.wtViewport.rowsVisibleCalculator.count},S.prototype.allRowsInViewport=function(){return this.instance.getSetting("totalRows")==this.getVisibleRowsCount()},S.prototype.getRowHeight=function(e){var t=this.instance.wtSettings.settings.rowHeight(e),n=this.instance.wtViewport.oversizedRows[e];return void 0!==n&&(t=t?Math.max(t,n):n),t},S.prototype.getColumnHeaderHeight=function(e){var t=this.instance.wtSettings.settings.defaultRowHeight,n=this.instance.wtViewport.oversizedColumnHeaders[e];return void 0!==n&&(t=t?Math.max(t,n):n),t},S.prototype.getVisibleColumnsCount=function(){return this.instance.wtViewport.columnsVisibleCalculator.count},S.prototype.allColumnsInViewport=function(){return this.instance.getSetting("totalColumns")==this.getVisibleColumnsCount()},S.prototype.getColumnWidth=function(e){var t=this.instance.wtSettings.settings.columnWidth;"function"==typeof t?t=t(e):"object"==typeof t&&(t=t[e]);var n=this.instance.wtViewport.oversizedCols[e];return void 0!==n&&(t=t?Math.max(t,n):n),t},S.prototype.getStretchedColumnWidth=function(e){var t,n=this.getColumnWidth(e)||this.instance.wtSettings.settings.defaultColumnWidth,i=this.instance.wtViewport.columnsRenderCalculator;return i&&(t=i.getStretchedColumnWidth(e,n))&&(n=t),n},k.prototype.render=function(){this.wtTable.isWorkingOnClone()||this.instance.getSetting("beforeDraw",!0),this.rowHeaders=this.instance.getSetting("rowHeaders"),this.rowHeaderCount=this.rowHeaders.length,this.fixedRowsTop=this.instance.getSetting("fixedRowsTop"),this.columnHeaders=this.instance.getSetting("columnHeaders"),this.columnHeaderCount=this.columnHeaders.length;var e,t,n=this.instance.getSetting("totalRows"),i=this.instance.getSetting("totalColumns"),o=!1,r=this.wtTable.getRenderedRowsCount();if(i>0&&(this.adjustAvailableNodes(),o=!0,this.renderColGroups(),this.renderColumnHeaders(),e=this.wtTable.getRenderedColumnsCount(),this.renderRows(n,r,e),this.wtTable.isWorkingOnClone()?this.adjustColumnHeaderHeights():(t=this.instance.wtViewport.getWorkspaceWidth(),this.instance.wtViewport.containerWidth=null),this.adjustColumnWidths(e)),o||this.adjustAvailableNodes(),this.removeRedundantRows(r),!this.wtTable.isWorkingOnClone()){if(this.markOversizedRows(),this.instance.wtViewport.createVisibleCalculators(),this.instance.wtScrollbars.applyToDOM(),t!==this.instance.wtViewport.getWorkspaceWidth()){this.instance.wtViewport.containerWidth=null;for(var a=this.wtTable.getFirstRenderedColumn(),s=this.wtTable.getLastRenderedColumn(),l=a;s>l;l++){var c=this.wtTable.getStretchedColumnWidth(l),d=this.columnFilter.sourceToRendered(l);this.COLGROUP.childNodes[d+this.rowHeaderCount].style.width=c+"px"}}this.instance.wtScrollbars.refresh(!1),this.instance.getSetting("onDraw",!0)}},k.prototype.removeRedundantRows=function(e){for(;this.wtTable.tbodyChildrenLength>e;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--},k.prototype.renderRows=function(e,t,n){for(var i,o=0,r=this.rowFilter.renderedToSource(o),a=this.wtTable.isWorkingOnClone();e>r&&r>=0;){if(o>1e3)throw new Error("Security brake: Too much TRs. Please define height for your table, which will enforce scrollbars.");if(void 0!==t&&o===t)break;if(i=this.getOrCreateTrForRow(o,i),this.renderRowHeaders(r,i),this.adjustColumns(i,n+this.rowHeaderCount),this.renderCells(r,i,n),a||this.resetOversizedRow(r),i.firstChild){var s=this.instance.wtTable.getRowHeight(r);i.firstChild.style.height=s?s+"px":""}o++,r=this.rowFilter.renderedToSource(o)}},k.prototype.resetOversizedRow=function(e){this.instance.wtViewport.oversizedRows&&this.instance.wtViewport.oversizedRows[e]&&(this.instance.wtViewport.oversizedRows[e]=void 0)},k.prototype.markOversizedRows=function(){for(var e,n,i,o,r=this.instance.wtTable.TBODY.childNodes.length;r;)r--,i=this.instance.wtTable.rowFilter.renderedToSource(r),e=this.instance.wtTable.getRowHeight(i),o=this.instance.wtTable.getTrForRow(i),n=t.Dom.innerHeight(o)-1,(!e&&this.instance.wtSettings.settings.defaultRowHeight<n||n>e)&&(this.instance.wtViewport.oversizedRows[i]=n)},k.prototype.adjustColumnHeaderHeights=function(){for(var e=0,t=this.instance.getSetting("columnHeaders").length;t>e;e++)if(this.instance.wtViewport.oversizedColumnHeaders[e]){if(0===this.instance.wtTable.THEAD.childNodes[e].childNodes.length)return;this.instance.wtTable.THEAD.childNodes[e].childNodes[0].style.height=this.instance.wtViewport.oversizedColumnHeaders[e]+"px"}},k.prototype.markIfOversizedColumnHeader=function(e){var n,i,o,r,a=(0!==this.instance.wtTable.THEAD.childNodes.length&&this.instance.wtTable.THEAD.childNodes[0].childNodes.length,this.instance.getSetting("columnHeaders")).length;for(n=this.instance.wtTable.columnFilter.renderedToSource(e);a;)a--,i=this.instance.wtTable.getColumnHeaderHeight(a),(o=this.instance.wtTable.getColumnHeader(n,a))&&(r=t.Dom.innerHeight(o)-1,(!i&&this.instance.wtSettings.settings.defaultRowHeight<r||r>i)&&(this.instance.wtViewport.oversizedColumnHeaders[a]=r))},k.prototype.renderCells=function(e,n,i){for(var o,r,a=0;i>a;a++)r=this.columnFilter.renderedToSource(a),"TH"==(o=0===a?n.childNodes[this.columnFilter.sourceColumnToVisibleRowHeadedColumn(r)]:o.nextSibling).nodeName&&(o=this.utils.replaceThWithTd(o,n)),t.Dom.hasClass(o,"hide")||(o.className=""),o.removeAttribute("style"),this.instance.wtSettings.settings.cellRenderer(e,r,o);return o},k.prototype.adjustColumnWidths=function(e){var t;this.instance.wtViewport.columnsRenderCalculator.refreshStretching(this.instance.wtViewport.getViewportWidth());for(var n=0;e>n;n++)t=this.wtTable.getStretchedColumnWidth(this.columnFilter.renderedToSource(n)),this.COLGROUP.childNodes[n+this.rowHeaderCount].style.width=t+"px"},k.prototype.appendToTbody=function(e){this.TBODY.appendChild(e),this.wtTable.tbodyChildrenLength++},k.prototype.getOrCreateTrForRow=function(e,t){var n;return e>=this.wtTable.tbodyChildrenLength?(n=this.createRow(),this.appendToTbody(n)):n=0===e?this.TBODY.firstChild:t.nextSibling,n},k.prototype.createRow=function(){for(var e=document.createElement("TR"),t=0;t<this.rowHeaderCount;t++)e.appendChild(document.createElement("TH"));return e},k.prototype.renderRowHeader=function(e,t,n){n.className="",n.removeAttribute("style"),this.rowHeaders[t](e,n,t)},k.prototype.renderRowHeaders=function(e,t){for(var n=t.firstChild,i=0;i<this.rowHeaderCount;i++)n?"TD"==n.nodeName&&(n=this.utils.replaceTdWithTh(n,t)):(n=document.createElement("TH"),t.appendChild(n)),this.renderRowHeader(e,i,n),n=n.nextSibling},k.prototype.adjustAvailableNodes=function(){this.adjustColGroups(),this.adjustThead()},k.prototype.renderColumnHeaders=function(){if(this.columnHeaderCount)for(var e,t,n=this.wtTable.getRenderedColumnsCount(),i=0;i<this.columnHeaderCount;i++)for(e=this.getTrForColumnHeaders(i),t=-1*this.rowHeaderCount;n>t;t++){var o=this.columnFilter.renderedToSource(t);this.renderColumnHeader(i,o,e.childNodes[t+this.rowHeaderCount]),this.wtTable.isWorkingOnClone()||this.markIfOversizedColumnHeader(t)}},k.prototype.adjustColGroups=function(){for(var e=this.wtTable.getRenderedColumnsCount();this.wtTable.colgroupChildrenLength<e+this.rowHeaderCount;)this.COLGROUP.appendChild(document.createElement("COL")),this.wtTable.colgroupChildrenLength++;for(;this.wtTable.colgroupChildrenLength>e+this.rowHeaderCount;)this.COLGROUP.removeChild(this.COLGROUP.lastChild),this.wtTable.colgroupChildrenLength--},k.prototype.adjustThead=function(){var e=this.wtTable.getRenderedColumnsCount(),n=this.THEAD.firstChild;if(this.columnHeaders.length){for(var i=0,o=this.columnHeaders.length;o>i;i++){for((n=this.THEAD.childNodes[i])||(n=document.createElement("TR"),this.THEAD.appendChild(n)),this.theadChildrenLength=n.childNodes.length;this.theadChildrenLength<e+this.rowHeaderCount;)n.appendChild(document.createElement("TH")),this.theadChildrenLength++;for(;this.theadChildrenLength>e+this.rowHeaderCount;)n.removeChild(n.lastChild),this.theadChildrenLength--}var r=this.THEAD.childNodes.length;if(r>this.columnHeaders.length)for(i=this.columnHeaders.length;r>i;i++)this.THEAD.removeChild(this.THEAD.lastChild)}else n&&t.Dom.empty(n)},k.prototype.getTrForColumnHeaders=function(e){return this.THEAD.childNodes[e]},k.prototype.renderColumnHeader=function(e,t,n){return n.className="",n.removeAttribute("style"),this.columnHeaders[e](t,n,e)},k.prototype.renderColGroups=function(){for(var e=0;e<this.wtTable.colgroupChildrenLength;e++)e<this.rowHeaderCount?t.Dom.addClass(this.COLGROUP.childNodes[e],"rowHeader"):t.Dom.removeClass(this.COLGROUP.childNodes[e],"rowHeader")},k.prototype.adjustColumns=function(e,t){for(var n=e.childNodes.length;t>n;){var i=document.createElement("TD");e.appendChild(i),n++}for(;n>t;)e.removeChild(e.lastChild),n--},k.prototype.removeRedundantColumns=function(e){for(;this.wtTable.tbodyChildrenLength>e;)this.TBODY.removeChild(this.TBODY.lastChild),this.wtTable.tbodyChildrenLength--},k.utils={},k.utils.replaceTdWithTh=function(e,t){var n;return n=document.createElement("TH"),t.insertBefore(n,e),t.removeChild(e),n},k.utils.replaceThWithTd=function(e,t){var n=document.createElement("TD");return t.insertBefore(n,e),t.removeChild(e),n},T.prototype.getWorkspaceHeight=function(){var n=this.instance.wtScrollbars.vertical.scrollHandler;return n===e?document.documentElement.clientHeight:t.Dom.outerHeight(n)>0&&n.clientHeight>0?n.clientHeight:1/0},T.prototype.getWorkspaceWidth=function(){var n,i,o=this.instance.getSetting("totalColumns"),r=this.instance.wtScrollbars.horizontal.scrollHandler,a=this.instance.getSetting("stretchH");return n=t.freezeOverlays?Math.min(document.documentElement.offsetWidth-this.getWorkspaceOffset().left,document.documentElement.offsetWidth):Math.min(this.getContainerFillWidth(),document.documentElement.offsetWidth-this.getWorkspaceOffset().left,document.documentElement.offsetWidth),r===e&&o>0&&this.sumColumnWidths(0,o-1)>n?document.documentElement.clientWidth:r===e||"scroll"!=(i=this.instance.wtScrollbars.horizontal.scrollHandler.style.overflow)&&"hidden"!=i&&"auto"!=i?"none"!==a&&a?n:Math.max(n,t.Dom.outerWidth(this.instance.wtTable.TABLE)):Math.max(n,r.clientWidth)},T.prototype.sumColumnWidths=function(e,t){for(var n=0;t>e;)n+=this.instance.wtTable.getColumnWidth(e)||this.instance.wtSettings.defaultColumnWidth,e++;return n},T.prototype.getContainerFillWidth=function(){if(this.containerWidth)return this.containerWidth;for(var e,t,n=this.instance.wtTable.holder;n.parentNode!=document.body&&null!=n.parentNode&&-1===n.className.indexOf("handsontable");)n=n.parentNode;return t=document.createElement("DIV"),t.style.width="100%",t.style.height="1px",n.appendChild(t),e=t.offsetWidth,this.containerWidth=e,n.removeChild(t),e},T.prototype.getWorkspaceOffset=function(){return t.Dom.offset(this.instance.wtTable.TABLE)},T.prototype.getWorkspaceActualHeight=function(){return t.Dom.outerHeight(this.instance.wtTable.TABLE)},T.prototype.getWorkspaceActualWidth=function(){return t.Dom.outerWidth(this.instance.wtTable.TABLE)||t.Dom.outerWidth(this.instance.wtTable.TBODY)||t.Dom.outerWidth(this.instance.wtTable.THEAD)},T.prototype.getColumnHeaderHeight=function(){return isNaN(this.columnHeaderHeight)&&(this.columnHeaderHeight=t.Dom.outerHeight(this.instance.wtTable.THEAD)),this.columnHeaderHeight},T.prototype.getViewportHeight=function(){var e=this.getWorkspaceHeight();if(1/0===e)return e;var t=this.getColumnHeaderHeight();return t>0&&(e-=t),e},T.prototype.getRowHeaderWidth=function(){if(this.instance.cloneSource)return this.instance.cloneSource.wtViewport.getRowHeaderWidth();if(isNaN(this.rowHeaderWidth)){var e=this.instance.getSetting("rowHeaders");if(e.length){var n=this.instance.wtTable.TABLE.querySelector("TH");this.rowHeaderWidth=0;for(var i=0,o=e.length;o>i;i++)n?(this.rowHeaderWidth+=t.Dom.outerWidth(n),n=n.nextSibling):this.rowHeaderWidth+=50}else this.rowHeaderWidth=0}return this.rowHeaderWidth},T.prototype.getViewportWidth=function(){var e,t=this.getWorkspaceWidth();return 1/0===t?t:(e=this.getRowHeaderWidth())>0?t-e:t},T.prototype.createRowsCalculator=function(e){this.rowHeaderWidth=NaN;var t;t=this.instance.wtSettings.settings.renderAllRows?1/0:this.getViewportHeight();var n=this.instance.wtScrollbars.vertical.getScrollPosition()-this.instance.wtScrollbars.vertical.getTableParentOffset();0>n&&(n=0);var i=this.instance.getSetting("fixedRowsTop");if(i){var o=this.instance.wtScrollbars.vertical.sumCellSizes(0,i);n+=o,t-=o}var r=this;return new R(t,n,this.instance.getSetting("totalRows"),function(e){return r.instance.wtTable.getRowHeight(e)},e?null:this.instance.wtSettings.settings.viewportRowCalculatorOverride,!!e)},T.prototype.createColumnsCalculator=function(e){this.columnHeaderHeight=NaN;var t=this.getViewportWidth(),n=this.instance.wtScrollbars.horizontal.getScrollPosition()-this.instance.wtScrollbars.vertical.getTableParentOffset();0>n&&(n=0);var i=this.instance.getSetting("fixedColumnsLeft");if(i){var o=this.instance.wtScrollbars.horizontal.sumCellSizes(0,i);n+=o,t-=o}var r=this;return new D(t,n,this.instance.getSetting("totalColumns"),function(e){return r.instance.wtTable.getColumnWidth(e)},e?null:this.instance.wtSettings.settings.viewportColumnCalculatorOverride,!!e,this.instance.getSetting("stretchH"))},T.prototype.createRenderCalculators=function(e){if(e){var t=this.createRowsCalculator(!0),n=this.createColumnsCalculator(!0);this.areAllProposedVisibleRowsAlreadyRendered(t)&&this.areAllProposedVisibleColumnsAlreadyRendered(n)||(e=!1)}return e||(this.rowsRenderCalculator=this.createRowsCalculator(),this.columnsRenderCalculator=this.createColumnsCalculator()),this.rowsVisibleCalculator=null,this.columnsVisibleCalculator=null,e},T.prototype.createVisibleCalculators=function(){this.rowsVisibleCalculator=this.createRowsCalculator(!0),this.columnsVisibleCalculator=this.createColumnsCalculator(!0)},T.prototype.areAllProposedVisibleRowsAlreadyRendered=function(e){return!!this.rowsVisibleCalculator&&(!(e.startRow<this.rowsRenderCalculator.startRow||e.startRow===this.rowsRenderCalculator.startRow&&e.startRow>0)&&!(e.endRow>this.rowsRenderCalculator.endRow||e.endRow===this.rowsRenderCalculator.endRow&&e.endRow<this.instance.getSetting("totalRows")-1))},T.prototype.areAllProposedVisibleColumnsAlreadyRendered=function(e){return!!this.columnsVisibleCalculator&&(!(e.startColumn<this.columnsRenderCalculator.startColumn||e.startColumn===this.columnsRenderCalculator.startColumn&&e.startColumn>0)&&!(e.endColumn>this.columnsRenderCalculator.endColumn||e.endColumn===this.columnsRenderCalculator.endColumn&&e.endColumn<this.instance.getSetting("totalColumns")-1))},e.jQuery&&function(e,t,n){jQuery.fn.handsontable=function(e){var t,i,o,r,a,s=this.first(),l=s.data("handsontable");if("string"!=typeof e)return a=e||{},l?l.updateSettings(a):(l=new n.Core(s[0],a),s.data("handsontable",l),l.init()),s;if(o=[],arguments.length>1)for(t=1,i=arguments.length;i>t;t++)o.push(arguments[t]);if(l){if(void 0===l[e])throw new Error("Handsontable do not provide action: "+e);r=l[e].apply(l,o),"destroy"===e&&s.removeData()}return r}}(0,0,t)}(window,Handsontable),function(){function e(e){this._value=e}function t(e,t,n,i){var o,r,a=Math.pow(10,t);return r=(n(e*a)/a).toFixed(t),i&&(o=new RegExp("0{1,"+i+"}$"),r=r.replace(o,"")),r}function n(e,t,n){return t.indexOf("$")>-1?o(e,t,n):t.indexOf("%")>-1?r(e,t,n):t.indexOf(":")>-1?a(e):l(e._value,t,n)}function i(e,t){var n,i,o,r,a,l=t,c=["KB","MB","GB","TB","PB","EB","ZB","YB"],d=!1;if(t.indexOf(":")>-1)e._value=s(t);else if(t===g)e._value=0;else{for("."!==p[f].delimiters.decimal&&(t=t.replace(/\./g,"").replace(p[f].delimiters.decimal,".")),n=new RegExp("[^a-zA-Z]"+p[f].abbreviations.thousand+"(?:\\)|(\\"+p[f].currency.symbol+")?(?:\\))?)?$"),i=new RegExp("[^a-zA-Z]"+p[f].abbreviations.million+"(?:\\)|(\\"+p[f].currency.symbol+")?(?:\\))?)?$"),o=new RegExp("[^a-zA-Z]"+p[f].abbreviations.billion+"(?:\\)|(\\"+p[f].currency.symbol+")?(?:\\))?)?$"),r=new RegExp("[^a-zA-Z]"+p[f].abbreviations.trillion+"(?:\\)|(\\"+p[f].currency.symbol+")?(?:\\))?)?$"),a=0;a<=c.length&&!(d=t.indexOf(c[a])>-1&&Math.pow(1024,a+1));a++);e._value=(d||1)*(l.match(n)?Math.pow(10,3):1)*(l.match(i)?Math.pow(10,6):1)*(l.match(o)?Math.pow(10,9):1)*(l.match(r)?Math.pow(10,12):1)*(t.indexOf("%")>-1?.01:1)*((t.split("-").length+Math.min(t.split("(").length-1,t.split(")").length-1))%2?1:-1)*Number(t.replace(/[^0-9\.]+/g,"")),e._value=d?Math.ceil(e._value):e._value}return e._value}function o(e,t,n){var i,o,r=t.indexOf("$"),a=t.indexOf("("),s=t.indexOf("-"),c="";return t.indexOf(" $")>-1?(c=" ",t=t.replace(" $","")):t.indexOf("$ ")>-1?(c=" ",t=t.replace("$ ","")):t=t.replace("$",""),o=l(e._value,t,n),1>=r?o.indexOf("(")>-1||o.indexOf("-")>-1?(o=o.split(""),i=1,(a>r||s>r)&&(i=0),o.splice(i,0,p[f].currency.symbol+c),o=o.join("")):o=p[f].currency.symbol+c+o:o.indexOf(")")>-1?((o=o.split("")).splice(-1,0,c+p[f].currency.symbol),o=o.join("")):o=o+c+p[f].currency.symbol,o}function r(e,t,n){var i,o="",r=100*e._value;return t.indexOf(" %")>-1?(o=" ",t=t.replace(" %","")):t=t.replace("%",""),(i=l(r,t,n)).indexOf(")")>-1?((i=i.split("")).splice(-1,0,o+"%"),i=i.join("")):i=i+o+"%",i}function a(e){var t=Math.floor(e._value/60/60),n=Math.floor((e._value-60*t*60)/60),i=Math.round(e._value-60*t*60-60*n);return t+":"+(10>n?"0"+n:n)+":"+(10>i?"0"+i:i)}function s(e){var t=e.split(":"),n=0;return 3===t.length?(n+=60*Number(t[0])*60,n+=60*Number(t[1]),n+=Number(t[2])):2===t.length&&(n+=60*Number(t[0]),n+=Number(t[1])),Number(n)}function l(e,n,i){var o,r,a,s,l,c,d=!1,u=!1,h=!1,v="",m=!1,y=!1,w=!1,b=!1,C=!1,x="",E="",_=Math.abs(e),S=["B","KB","MB","GB","TB","PB","EB","ZB","YB"],k="",T=!1;if(0===e&&null!==g)return g;if(n.indexOf("(")>-1?(d=!0,n=n.slice(1,-1)):n.indexOf("+")>-1&&(u=!0,n=n.replace(/\+/g,"")),n.indexOf("a")>-1&&(m=n.indexOf("aK")>=0,y=n.indexOf("aM")>=0,w=n.indexOf("aB")>=0,b=n.indexOf("aT")>=0,C=m||y||w||b,n.indexOf(" a")>-1?(v=" ",n=n.replace(" a","")):n=n.replace("a",""),_>=Math.pow(10,12)&&!C||b?(v+=p[f].abbreviations.trillion,e/=Math.pow(10,12)):_<Math.pow(10,12)&&_>=Math.pow(10,9)&&!C||w?(v+=p[f].abbreviations.billion,e/=Math.pow(10,9)):_<Math.pow(10,9)&&_>=Math.pow(10,6)&&!C||y?(v+=p[f].abbreviations.million,e/=Math.pow(10,6)):(_<Math.pow(10,6)&&_>=Math.pow(10,3)&&!C||m)&&(v+=p[f].abbreviations.thousand,e/=Math.pow(10,3))),n.indexOf("b")>-1)for(n.indexOf(" b")>-1?(x=" ",n=n.replace(" b","")):n=n.replace("b",""),a=0;a<=S.length;a++)if(o=Math.pow(1024,a),r=Math.pow(1024,a+1),e>=o&&r>e){x+=S[a],o>0&&(e/=o);break}return n.indexOf("o")>-1&&(n.indexOf(" o")>-1?(E=" ",n=n.replace(" o","")):n=n.replace("o",""),E+=p[f].ordinal(e)),n.indexOf("[.]")>-1&&(h=!0,n=n.replace("[.]",".")),s=e.toString().split(".")[0],l=n.split(".")[1],c=n.indexOf(","),l?(l.indexOf("[")>-1?(l=l.replace("]",""),l=l.split("["),k=t(e,l[0].length+l[1].length,i,l[1].length)):k=t(e,l.length,i),s=k.split(".")[0],k=k.split(".")[1].length?p[f].delimiters.decimal+k.split(".")[1]:"",h&&0===Number(k.slice(1))&&(k="")):s=t(e,null,i),s.indexOf("-")>-1&&(s=s.slice(1),T=!0),c>-1&&(s=s.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1"+p[f].delimiters.thousands)),0===n.indexOf(".")&&(s=""),(d&&T?"(":"")+(!d&&T?"-":"")+(!T&&u?"+":"")+s+k+(E||"")+(v||"")+(x||"")+(d&&T?")":"")}function c(e,t){p[e]=t}function d(e){var t=e.toString().split(".");return t.length<2?1:Math.pow(10,t[1].length)}function u(){return Array.prototype.slice.call(arguments).reduce(function(e,t){var n=d(e),i=d(t);return n>i?n:i},-1/0)}var h,p={},f="en",g=null,v="0,0",m="undefined"!=typeof module&&module.exports;(h=function(t){return h.isNumeral(t)?t=t.value():0===t||void 0===t?t=0:Number(t)||(t=h.fn.unformat(t)),new e(Number(t))}).version="1.5.3",h.isNumeral=function(t){return t instanceof e},h.language=function(e,t){if(!e)return f;if((e=e.toLowerCase())&&!t){if(!p[e])throw new Error("Unknown language : "+e);f=e}return(t||!p[e])&&c(e,t),h},h.languageData=function(e){if(!e)return p[f];if(!p[e])throw new Error("Unknown language : "+e);return p[e]},h.language("en",{delimiters:{thousands:",",decimal:"."},abbreviations:{thousand:"k",million:"m",billion:"b",trillion:"t"},ordinal:function(e){var t=e%10;return 1==~~(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th"},currency:{symbol:"$"}}),h.zeroFormat=function(e){g="string"==typeof e?e:null},h.defaultFormat=function(e){v="string"==typeof e?e:"0.0"},h.validate=function(e,t){var n,i,o,r,a,s,l,c;if("string"!=typeof e&&(e+="",console.warn&&console.warn("Numeral.js: Value is not string. It has been co-erced to: ",e)),""===(e=e.trim()))return!1;e=e.replace(/^[+-]?/,"");try{l=h.languageData(t)}catch(e){l=h.languageData(h.language())}return o=l.currency.symbol,a=l.abbreviations,n=l.delimiters.decimal,i="."===l.delimiters.thousands?"\\.":l.delimiters.thousands,(null===(c=e.match(/^[^\d]+/))||(e=e.substr(1),c[0]===o))&&!(null!==(c=e.match(/[^\d]+$/))&&(e=e.slice(0,-1),c[0]!==a.thousand&&c[0]!==a.million&&c[0]!==a.billion&&c[0]!==a.trillion)||!e.match(/^\d+$/)&&(s=new RegExp(i+"{2}"),e.match(/[^\d.,]/g)||(r=e.split(n)).length>2||(r.length<2?!r[0].match(/^\d+.*\d$/)||r[0].match(s):1===r[0].length?!r[0].match(/^\d+$/)||r[0].match(s)||!r[1].match(/^\d+$/):!r[0].match(/^\d+.*\d$/)||r[0].match(s)||!r[1].match(/^\d+$/))))},"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(e,t){"use strict";if(null===this||void 0===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof e)throw new TypeError(e+" is not a function");var n,i,o=this.length>>>0,r=!1;for(1<arguments.length&&(i=t,r=!0),n=0;o>n;++n)this.hasOwnProperty(n)&&(r?i=e(i,this[n],n,this):(i=this[n],r=!0));if(!r)throw new TypeError("Reduce of empty array with no initial value");return i}),h.fn=e.prototype={clone:function(){return h(this)},format:function(e,t){return n(this,e||v,void 0!==t?t:Math.round)},unformat:function(e){return"[object Number]"===Object.prototype.toString.call(e)?e:i(this,e||v)},value:function(){return this._value},valueOf:function(){return this._value},set:function(e){return this._value=Number(e),this},add:function(e){var t=u.call(null,this._value,e);return this._value=[this._value,e].reduce(function(e,n){return e+t*n},0)/t,this},subtract:function(e){var t=u.call(null,this._value,e);return this._value=[e].reduce(function(e,n){return e-t*n},this._value*t)/t,this},multiply:function(e){return this._value=[this._value,e].reduce(function(e,t){var n=u(e,t);return e*n*t*n/(n*n)},1),this},divide:function(e){return this._value=[this._value,e].reduce(function(e,t){var n=u(e,t);return e*n/(t*n)}),this},difference:function(e){return Math.abs(h(this._value).subtract(e).value())}},m&&(module.exports=h),"undefined"==typeof ender&&(this.numeral=h),"function"==typeof define&&define.amd&&define([],function(){return h})}.call(this);var bind=function(e,t){return function(){return e.apply(t,arguments)}};!function(e,t){var n;n=function(){function t(t,n,i){this.onEvent=bind(this.onEvent,this);var o,r,a;o=e(t),r=this,a={root:"/",script:"/files/filetree",folderEvent:"click",expandSpeed:500,collapseSpeed:500,expandEasing:"swing",collapseEasing:"swing",multiFolder:!0,loadMessage:"Loading...",errorMessage:"Unable to get file tree information",multiSelect:!1,onlyFolders:!1,onlyFiles:!1,preventLinkAction:!1},this.jqft={container:o},this.options=e.extend(a,n),this.callback=i,this.data={},o.html('<ul class="jqueryFileTree start"><li class="wait">'+this.options.loadMessage+"<li></ul>"),r.showTree(o,escape(this.options.root),function(){return r._trigger("filetreeinitiated",{})}),o.delegate("li a",this.options.folderEvent,r.onEvent)}return t.prototype.onEvent=function(t){var n,i,o,r,a,s;return n=e(t.target),a=this.options,r=this.jqft,i=this,o=this.callback,i.data={},i.data.li=n.closest("li"),i.data.type=null!=(s=i.data.li.hasClass("directory"))?s:{directory:"file"},i.data.value=n.text(),i.data.rel=n.prop("rel"),i.data.container=r.container,a.preventLinkAction&&t.preventDefault(),n.parent().hasClass("directory")?n.parent().hasClass("collapsed")?(a.multiFolder||(n.parent().parent().find("UL").slideUp({duration:a.collapseSpeed,easing:a.collapseEasing}),n.parent().parent().find("LI.directory").removeClass("expanded").addClass("collapsed")),n.parent().removeClass("collapsed").addClass("expanded"),n.parent().find("UL").remove(),i.showTree(n.parent(),n.attr("rel"),function(){return i._trigger("filetreeexpanded",i.data),null!=o})):n.parent().find("UL").slideUp({duration:a.collapseSpeed,easing:a.collapseEasing,start:function(){return i._trigger("filetreecollapse",i.data)},complete:function(){return n.parent().removeClass("expanded").addClass("collapsed"),i._trigger("filetreecollapsed",i.data),null!=o}}):(a.multiSelect?n.parent().find("input").is(":checked")?(n.parent().find("input").prop("checked",!1),n.parent().removeClass("selected")):(n.parent().find("input").prop("checked",!0),n.parent().addClass("selected")):(r.container.find("li").removeClass("selected"),n.parent().addClass("selected")),i._trigger("filetreeclicked",i.data),"function"==typeof o?o(n.attr("rel")):void 0)},t.prototype.showTree=function(t,n,i){var o,r,a,s,l,c,d;return o=e(t),c=this.options,r=this,o.addClass("wait"),e(".jqueryFileTree.start").remove(),a={dir:n,onlyFolders:c.onlyFolders,onlyFiles:c.onlyFiles,multiSelect:c.multiSelect},l=function(t){var a;return o.find(".start").html(""),o.removeClass("wait").append(t),c.root===n?o.find("UL:hidden").show("undefined"!=typeof callback&&null!==callback):(void 0===jQuery.easing[c.expandEasing]&&(console.log("Easing library not loaded. Include jQueryUI or 3rd party lib."),c.expandEasing="swing"),o.find("UL:hidden").slideDown({duration:c.expandSpeed,easing:c.expandEasing,start:function(){return r._trigger("filetreeexpand",r.data)},complete:i})),a=e('[rel="'+decodeURIComponent(n)+'"]').parent(),c.multiSelect&&a.children("input").is(":checked")&&a.find("ul li input").each(function(){return e(this).prop("checked",!0),e(this).parent().addClass("selected")}),!1},s=function(){return o.find(".start").html(""),o.removeClass("wait").append("<p>"+c.errorMessage+"</p>"),!1},"function"==typeof c.script?"string"==typeof(d=c.script(a))||d instanceof jQuery?l(d):s():e.ajax({url:c.script,type:"POST",dataType:"HTML",data:a}).done(function(e){return l(e)}).fail(function(){return s()})},t.prototype._trigger=function(e,t){return this.jqft.container.triggerHandler(e,t)},t}(),e.fn.extend({fileTree:function(t,i){return this.each(function(){var o,r;return o=e(this),(r=o.data("fileTree"))||o.data("fileTree",r=new n(this,t,i)),"string"==typeof t?r[option].apply(r):void 0})}})}(window.jQuery,window),function(e,t){var n,i=function(){var e=n.length;t(".fileDialogDialog .ui-dialog-buttonpane .nbFiles").html(e+" file"+(1==e?"":"s")+" selected.")};(window.JflowBrowser=window.JflowWfformRules||{}).exec=function(e,o){n=[],t("#fileDialog").remove(),t("body").append("<div id='fileDialog'>");var r="#fileDialog";t(r).addClass("modal fade").attr("role","dialog"),t(r).append("<div class='modal-dialog'>"),t(r+" .modal-dialog").append("<div class='modal-content'>"),t(r+" .modal-content").append("<div class='modal-header'>"),t(r+" .modal-header").append('<button type="button" class="close" data-dismiss="modal">&times;</button>'),t(r+" .modal-header").append('<h4 class="modal-title">'+(o?"Choose files":"Choose one file")+"</h4>"),t(r+" .modal-content").append("<div class='modal-body'>"),t(r+" .modal-content").append('<div class="modal-footer">             <button type="button" class="btn btn-default" id="open-server-file" data-dismiss="modal">Open</button>             <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>         </div>'),t(r+" .modal-body").append("<div id='filetree'>"),t(r+" div#filetree").fileTree({script:"/get_user_files",multiSelect:!0}).on("filetreeclicked",function(e,r){var a=r.li.find("a").attr("rel");if(r.li.find("input[type=checkbox]").is(":checked"))o||(n=[],t("div#filetree input[type=checkbox]:checked").prop("checked",!1),t("div#filetree li").removeClass("selected"),r.li.addClass("selected"),r.li.find("input[type=checkbox]").prop("checked",!0)),n.push(a);else{var s=n.indexOf(a);s>-1&&n.splice(s,1)}i()}),t(r).modal("show"),t("#open-server-file").click(function(){e&&e(n)}),t(".ui-dialog-buttonpane").append("<div class='nbFiles'>"),t(".nbFiles").html("0 files selected."),t(".fileDialogDialog .ui-dialog-buttonpane .nbFiles").off("click").on("click",function(){if(n.length>0){t("#filesSelected").remove(),t("body").append("<div id='filesSelected'>");for(var e="<label class='checkAll'><input class='checkAll' type='checkbox'/> Check all</label>",o=0;o<n.length;o++){var r=n[o];e+="<label rel='"+r+"' class='labelBlock'><input rel='"+r+"' type='checkbox' class='files'/> "+r+"</label>"}t("#filesSelected").html(e),t("#filesSelected").dialog({title:"You selected these files",width:430,closeText:null,dialogClass:"filesSelectedDialog",buttons:[{text:"Unselect",click:function(){t("#filesSelected input.files[type=checkbox]:checked").each(function(){var e=t(this).attr("rel");t("#fileDialog a[rel='"+e+"']").parent("li").removeClass("selected"),t("#fileDialog a[rel='"+e+"']").parent("li").find("input[type=checkbox]").prop("checked",!1),t("#filesSelected label[rel='"+e+"']").remove(),n.splice(n.indexOf(e),1),i()})}},{text:"Close",click:function(){t(this).dialog("close")}}]}),t("#filesSelected input.checkAll").off("change").on("change",function(){t(this).is(":checked")?t("#filesSelected input.files[type=checkbox]").prop("checked",!0):t("#filesSelected input.files[type=checkbox]").prop("checked",!1)})}})}}(0,window.jQuery),function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.activewf.defaults,n),""==this.options.serverURL&&(this.options.serverURL=e.fn.activewf.defaults.serverURL),this.reload()};t.prototype.reload=function(){var t=this,n=['<div class="container-fluid"><div class="row"><div class="col-md-1 col-md-offset-2"><div class="inline floatingBarsG">','<div class="blockG" id="rotateG_01"></div>','<div class="blockG" id="rotateG_02"></div>','<div class="blockG" id="rotateG_03"></div>','<div class="blockG" id="rotateG_04"></div>','<div class="blockG" id="rotateG_05"></div>','<div class="blockG" id="rotateG_06"></div>','<div class="blockG" id="rotateG_07"></div>','<div class="blockG" id="rotateG_08"></div>','</div></div> <div class="col-md-8">Please wait until module is being loaded!</div></div></div>'].join("\n"),i=this.options.serverURL+"/get_workflows_status?";this.options.metadataFilter.length>0&&(i+="metadata_filter="+this.options.metadataFilter.join(",")+"&"),i+="callback=?",t.$element.html(n),e.ajax({url:i,dataType:"json",timeout:2e4,error:function(e,n,i){var o=['<div class="alert alert-danger" role="alert">',"<strong>Error!</strong>","Jflow failed to connect to the specified server <strong>"+t.options.serverURL+"</strong>","</div>"].join("\n");t.$element.html(o)},success:function(n){var i={},o=new Array,r=new Array;for(var a in n)i[n[a].id]=n[a],o.push(n[a].id);o.sort(function(e,t){return t-e});for(var a in o)r.push(i[o[a]]);t.$element.html(""),e.tmpl(t.options.template,{workflows:r}).appendTo(t.$element),e("[id^=activewf_btn_]").click(function(){var n=e(this).attr("id").split("activewf_btn_")[1];t.$element.trigger("select.activewf",i[n])}),e("[id^=activewf_refresh_]").click(function(){t.reload()}),e("[id^=activewf_delete_]").click(function(){var n=e(this).attr("id").split("activewf_delete_")[1];e.ajax({url:t.options.serverURL+"/delete_workflow?workflow_id="+n+"&callback=?",dataType:"json",timeout:2e4,error:function(e,n,i){var o=['<div class="alert alert-danger" role="alert">',"<strong>Error!</strong>","Jflow failed to connect to the specified server <strong>"+t.options.serverURL+"</strong>","</div>"].join("\n");t.$element.html(o)},success:function(e){t.reload()}})})}})};e.fn.activewf;e.fn.activewf=function(n){return this.each(function(){var i=e(this),o=i.data("activewf"),r=e.extend({},e.fn.activewf.defaults,"object"==typeof n&&n),a="string"==typeof n?n:null;o||i.data("activewf",o=new t(this,r)),a&&o[a]()})},e.fn.activewf.defaults={serverURL:"",template:['<table class="table table-striped table-striped">',"<thead>","<tr>","<th>ID<th>","<th>Name</th>","<th>Status</th>","<th>Start time</th>","<th>End time</th>","<th>Actions</th>","</tr>","</thead>","{{each(index, workflow) workflows}}","<tr>",'<td><a id="activewf_btn_${workflow.id}" href="#">${workflow.id}</a><td>',"<td>${workflow.name}</td>",'{{if workflow.status == "completed"}}','<td> <span class="label label-success">${workflow.status}</span></td>','{{else workflow.status == "failed"}}','<td> <span class="label label-danger">${workflow.status}</span></td>','{{else workflow.status == "aborted"}}','<td> <span class="label label-danger">${workflow.status}</span></td>','{{else workflow.status == "started"}}','<td> <span class="label label-info">${workflow.status}</span></td>','{{else workflow.status == "reseted"}}','<td> <span class="label label-default">${workflow.status}</span></td>',"{{else}}","<td>${workflow.status}</td>","{{/if}}","<td>${workflow.start_time}</td>","<td>${workflow.end_time}</td>","<td>",'  <div class="btn-group">','    {{if workflow.status == "started"}}','      <button type="button" id="activewf_refresh_${workflow.id}" class="btn btn-default btn-xs" aria-label="Left Align">',"    {{else}}",'      <button type="button" id="activewf_refresh_${workflow.id}" disabled class="btn btn-default btn-xs" aria-label="Left Align">',"    {{/if}}",'      <span class="glyphicon glyphicon-refresh"></span>',"    </button>",'    {{if workflow.status == "started"}}','      <button type="button" id="activewf_delete_${workflow.id}" disabled class="btn btn-default btn-xs" aria-label="Left Align">',"    {{else}}",'      <button type="button" id="activewf_delete_${workflow.id}" class="btn btn-default btn-xs" aria-label="Left Align">',"    {{/if}}",'      <span class="glyphicon glyphicon-remove"></span>',"    </button>","  </div>","</td>","</tr>","{{/each}}","</table>"].join("\n"),metadataFilter:[]},e.fn.activewf.Constructor=t}(window.jQuery),function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.availablewf.defaults,n),""==this.options.serverURL&&(this.options.serverURL=e.fn.availablewf.defaults.serverURL),this.reload()};t.prototype.reload=function(){var t=this,n=['<div class="container-fluid"><div class="row"><div class="col-md-1 col-md-offset-2"><div class="inline floatingBarsG">','<div class="blockG" id="rotateG_01"></div>','<div class="blockG" id="rotateG_02"></div>','<div class="blockG" id="rotateG_03"></div>','<div class="blockG" id="rotateG_04"></div>','<div class="blockG" id="rotateG_05"></div>','<div class="blockG" id="rotateG_06"></div>','<div class="blockG" id="rotateG_07"></div>','<div class="blockG" id="rotateG_08"></div>','</div></div> <div class="col-md-8">Please wait until module is being loaded!</div></div></div>'].join("\n");t.$element.html(n),e.ajax({url:this.options.serverURL+"/get_available_workflows?filter_groups="+this.options.filter_groups.join(",")+"&select="+this.options.select+"&callback=?",dataType:"json",timeout:2e4,error:function(e,n,i){var o=['<div class="alert alert-danger" role="alert">',"<strong>Error!</strong>","Jflow failed to connect to the specified server <strong>"+t.options.serverURL+"</strong>","</div>"].join("\n");t.$element.html(o)},success:function(n){var i={};for(var o in n)i[n[o].class]=n[o];t.$element.html(""),e.tmpl(t.options.template,{workflows:n,filters:t.options.filters}).appendTo(t.$element),e("[id^=availablewf_btn_]").click(function(){var n=e(this).attr("id").split("availablewf_btn_")[1];t.$element.trigger("select.availablewf",i[n])})}})};e.fn.availablewf;e.fn.availablewf=function(n){return this.each(function(){var i=e(this),o=i.data("availablewf"),r=e.extend({},e.fn.availablewf.defaults,"object"==typeof n&&n),a="string"==typeof n?n:null;o||i.data("availablewf",o=new t(this,r)),a&&o[a]()})},e.fn.availablewf.defaults={serverURL:"",template:['<table class="table table-striped table-striped">',"<thead>","<tr>","<th>Name</th>","<th>Description</th>","</tr>","</thead>","{{each(index, workflow) workflows}}","  {{if filters.indexOf(workflow.class) == -1 }}","  <tr>",'    <td><a id="availablewf_btn_${workflow.class}" href="#">${workflow.name}</a></td>',"    <td>${workflow.help}</td>","  </tr>","  {{/if}}","{{/each}}","</dl>"].join("\n"),filters:[],filter_groups:[],select:!1},e.fn.availablewf.Constructor=t}(window.jQuery),function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.wfoutputs.defaults,n),""==this.options.serverURL&&(this.options.serverURL=e.fn.wfoutputs.defaults.serverURL)};t.prototype.reload=function(){var t=this,n="",i=['<div class="container-fluid"><div class="row"><div class="col-md-1 col-md-offset-2"><div class="inline floatingBarsG">','<div class="blockG" id="rotateG_01"></div>','<div class="blockG" id="rotateG_02"></div>','<div class="blockG" id="rotateG_03"></div>','<div class="blockG" id="rotateG_04"></div>','<div class="blockG" id="rotateG_05"></div>','<div class="blockG" id="rotateG_06"></div>','<div class="blockG" id="rotateG_07"></div>','<div class="blockG" id="rotateG_08"></div>','</div></div> <div class="col-md-8">Please wait until module is being loaded!</div></div></div>'].join("\n");t.$element.html(i),this.options.workflowID&&(n="workflow_id="+this.options.workflowID+"&"),e.ajax({url:this.options.serverURL+"/get_workflow_outputs?"+n+"callback=?",dataType:"json",timeout:2e4,error:function(e,n,i){var o=['<div class="alert alert-danger" role="alert">',"<strong>Error!</strong>","Jflow failed to connect to the specified server <strong>"+t.options.serverURL+"</strong>","</div>"].join("\n");t.$element.html(o)},success:function(n){t.$element.html(""),e.tmpl(t.options.template,{data:n}).appendTo(t.$element);var i=new Array;e.each(n,function(n,o){e.each(o,function(n,o){-1==e.inArray(o.extension,i)&&-1==e.inArray(o.extension,t.options.logFile)&&i.push(o.extension)})}),e.each(i,function(t,n){e("#jflow_file_type").append(e("<option>",{text:n}))}),e(".output-file").each(function(){var n=e(this).find("A").text().substr(e(this).find("A").text().lastIndexOf("."));-1==e.inArray(n,t.options.logFile)?e(this).addClass("output"):(e(this).addClass("log"),e(this).hide())}),e("#jflow_log_on").click(function(){e(".log").each(function(){e(this).fadeIn(500)}),e("#jflow_log_on").hide(),e("#jflow_log_off").show()}),e("#jflow_log_off").click(function(){e(".log").each(function(){e(this).fadeOut(500)}),e("#jflow_log_off").hide(),e("#jflow_log_on").show()}),e("#jflow_file_type").on("change",function(){var t=e("#jflow_file_type option:selected").val(),n=new RegExp(t);e(".output").each(function(){"all"==t?e(this).fadeIn(500):n.test(e(this).text())?e(this).fadeIn(500):e(this).fadeOut(500)})})}})};e.fn.wfoutputs;e.fn.wfoutputs=function(n){return this.each(function(){var i=e(this),o=i.data("wfoutputs"),r=e.extend({},e.fn.wfoutputs.defaults,"object"==typeof n&&n),a="string"==typeof n?n:null;o?r.workflowID&&(o.options.workflowID=r.workflowID):i.data("wfoutputs",o=new t(this,r)),a?o[a]():o.reload()})},e.fn.wfoutputs.defaults={serverURL:"",template:['<div style="float:right;margin-bottom:14px">','  <button id="jflow_log_on"  class="btn btn-default btn-xs" type="button"><span class="glyphicon glyphicon-eye-open"></span> View log files</button>','  <button id="jflow_log_off" style="display:none" class="btn btn-default btn-xs" type="button"><span class="glyphicon glyphicon-eye-close"></span> Mask log files</button>','  <span class="btn-xs">- View:</span>','  <select id="jflow_file_type" class="btn  btn-default btn-xs" style="width:auto">',"   view: <option>all</option>",'  </select><span class="btn-xs"> files.</span>',"</div>",'<div style="clear:both;">','  <dl "style=margin-bottom:15px">',"  {{each(component_name, files) data}}",'    <div style="clear:both"></div>','    <dt style="margin-top:15px;background-color: #eee">','      <span class="glyphicon glyphicon-play" style="color:white;left:-3px"></span>',"      ${component_name}","    </dt>","    {{each(file_name, href) files}}",'      <dd class="output-file" style="float:left;margin-left:20px;width:265px;overflow:hidden;white-space: nowrap;text-overflow:ellipsis;">','        <span class="glyphicon glyphicon-file"></span>','        <a href="${href.url}" download>${file_name}</a>','        <span style="color:grey">| ${href.size}</span>',"      </dd>","    {{/each}}","  {{/each}}</dl>","</div>"].join("\n"),logFile:[".stderr",".stdout",".log"],workflowID:null},e.fn.wfoutputs.Constructor=t}(window.jQuery),function(e,t){var n=window.JflowWfformRules=window.JflowWfformRules||{},i=function(e,n){for(var i in e){var o=t("#"+e[i]),r="";o.attr("exclude-by")&&o.attr("exclude-by").length>0&&(r=o.attr("exclude-by")),-1==r.indexOf(n+";")&&o.attr("exclude-by",r+n+";")}},o=function(e,n){for(var i in e){var o=t("#"+e[i]),r="";o.attr("to-be-required-by")&&o.attr("to-be-required-by").length>0&&(r=o.attr("to-be-required-by")),-1==r.indexOf(n+";")&&o.attr("to-be-required-by",r+n+";")}},r=function(e,n){for(var i in e){var o=t("#"+e[i]);o.attr("exclude-by")&&o.attr("exclude-by",o.attr("exclude-by").replace(n+";",""))}},a=function(e,n){for(var i in e){var o=t("#"+e[i]);o.attr("to-be-required-by")&&o.attr("to-be-required-by",o.attr("to-be-required-by").replace(n+";",""))}},s=function(e){var n=t("#"+e);return n.attr("exclude-by")&&n.attr("exclude-by").length>0},l=function(e){var n=t("#"+e);return n.attr("to-be-required-by")&&n.attr("to-be-required-by").length>0},c=function(e){e.prop("disabled",!0);var t=e.closest(".input-group");t.length>0&&t.find(".btn").prop("disabled",!0)},d=function(e){e.prop("disabled",!1);var t=e.closest(".input-group");t.length>0&&t.find(".btn").prop("disabled",!1)},u=function(e,n){var i=!1,o=!0;for(var r in e){var a;if(-1==r.indexOf(">"))a=t("#"+r);else{var s=r.split(">");a=t("#"+s[0]+"___"+s[1].replace("_","-"))}var l;if(a.length>0)l=a.val(),a.is("input[type=checkbox]")&&(l=a.is(":checked")?"True":"False");else if(r.indexOf(">")>-1){var c=t("#handsontable_"+r.split(">")[0]).handsontable("getData"),d=r.replace("_","-").replace(">","___");l="";for(var u in c){var h=c[u];null!=h[d]&&""!=h[d]&&(l="*")}}else if("ALL"==n){o=!1;break}if(void 0!==l){var p=e[r].values;if(e[r].equal&&(p.indexOf("*")>-1&&""!=l||p.indexOf(l)>-1||p.indexOf("None")>-1&&""==l)||!e[r].equal&&-1==p.indexOf(l)){if("ANY"==n){i=!0;break}}else if("ALL"==n){o=!1;break}}}return"ALL"==n&&o&&(i=!0),i},h=function(e,n,i){for(var o in n){var r=n[o];if(-1==r.indexOf(">"))t("#"+r).on("change",function(){e()});else{var a=r.split(">"),s=t("#"+a[0]+"___"+a[1].replace("_","-"));0==s.length?i.$element.off("change_"+r.replace("_","-").replace(">","___")).on("change_"+r.replace("_","-").replace(">","___"),function(t,n){e()}):s.off("change").on("change",function(){e()})}}};n.add_event_rule_to_parameter=function(e,n,p,f){var g,v,m,y,w,b,C=/Exclude=(.+)/,x=/ToBeRequired=(.+)/,E=/RequiredIf\?(ANY|ALL)\[(.+)\]/,_=/DisabledIf\?(ANY|ALL)\[(.+)\]/,S=function(e,n){n.splice(n.indexOf(e.attr("id")),1);var o=t("#"+n.join(", #"));if("bool"!=p&&e.val().length>0||"bool"==p&&e.is(":checked"))c(o),i(n,e.attr("id"));else{r(n,e.attr("id"));for(var a in n){var l=n[a];s(l)||d(t("#"+l))}}},k=function(e,n){o(n,e.attr("id"));for(var i in n){var r=n[i],a=t("#"+r),s=a.rules();"required"in s&&!0===s.required&&void 0===a.attr("initial_requirement")?a.attr("initial_requirement","TRUE"):a.attr("initial_requirement","FALSE"),a.rules("add",{required:!0})}},T=function(e,n){a(n,e.attr("id"));for(var i in n){var o=n[i],r=t("#"+o),s=r.rules();"required"in s&&!0===s.required&&(void 0!==r.attr("initial_requirement")&&"FALSE"!=r.attr("initial_requirement")||l(o)||(r.rules("remove","required"),r.valid()))}},D=function(e,t){e.length>0?"bool"!=p&&e.val().length>0||"bool"==p&&e.is(":checked")?k(e,t):T(e,t):console.warn("Unable to change required option for parameter: "+O)},R=function(){u(b,y)?(m.closest("div.form-group").addClass("hidden-exclude").hide(),m.addClass("hidden-exclude")):(m.closest("div.form-group").removeClass("hidden-exclude").show(),m.removeClass("hidden-exclude")),0==m.closest("fieldset").find(".param-field").not(".hidden-exclude").length?m.closest("fieldset").hide():m.closest("fieldset").show()},P=function(){var e=u(b,y),n=m.selector.substr(1);if(e)-1==n.indexOf("___")?m.rules("add",{required:!0}):handsontables[n.split("___")[0]].allRequired[n]=!0;else if(-1==n.indexOf("___"))m.rules("remove","required"),m.valid();else{handsontables[n.split("___")[0]].allRequired[n]=!1;for(var i=handsontables[n.split("___")[0]].handsontable("getData").length,o=0;o<i;o++)f.handsontable_errors[n+"."+o]=void 0,t(handsontables.sample.handsontable("getCell",o,handsontables[n.split("___")[0]].columns.indexOf(n))).removeClass("htInvalid")}},A=function(){var t={},n=/([\w>]+)(!)?=(.*)/;for(var i in w){var o=null;if(o=w[i].match(n)){var r="self"!=o[1]?o[1]:e;r in t||(t[r]={},t[r].equal=void 0===o[2]),"values"in t[r]||(t[r].values=[]),t[r].values.push(o[3])}}return t};if(g=n.match(C)){(v=g[1].split(",")).push(e);var N="#"+v.join(", #");t(N).on("change",function(){var e=v.slice(0);S(t(this),e)});for(var M in v){var O=v[M],I=t("#"+O);if(I.val().length>0){var L=v.slice(0);S(I,L)}}}else(g=n.match(x))?(v=g[1].split(","),(m=t("#"+e)).on("change",function(){D(m,v)}),D(m,v)):(g=n.match(_))?(y=g[1],w=g[2].split(","),b=A(),m=t("#"+e),h(R,Object.keys(b),f),R()):(g=n.match(E))&&(y=g[1],w=g[2].split(","),b=A(),m=t("#"+e),h(P,Object.keys(b),f),P())},n.check_parameters_rules=function(e,t){var i={};for(var o in e){var r=e[o];i[r.name]=r;var a,s,l;if(r.rules&&null!==r.rules){a=r.rules.split(";");for(s in a)l=a[s],n.add_event_rule_to_parameter(r.name,l,r.type,t)}if("MultipleParameters"==r.type&&r.sub_parameters)for(var c in r.sub_parameters){var d=r.sub_parameters[c];if(d.rules&&null!==d.rules){a=d.rules.split(";");for(s in a)l=a[s],n.add_event_rule_to_parameter(d.name,l,d.type,t)}i[d.name]=d}}return i}}(0,jQuery);var get_parent_with_class=function(e,t){return null==e.parent()||e.parent().is("html")?null:e.parent().hasClass(t)?e.parent():get_parent_with_class(e.parent(),t)},getDate=function(e,t){var n=e.split("/"),i=new Date;return"dd/mm/yyyy"==t?(i.setDate(n[0]),i.setYear(n[2])):"dd/mm/yy"==t?(i.setDate(n[0]),i.setYear(n[2])):"yyyy/mm/dd"==t?(i.setDate(n[2]),i.setYear(n[0])):"yy/mm/dd"==t&&(i.setDate(n[2]),i.setYear(n[0])),i.setMonth(n[1]),i},rc4_encrypt=function(e){var t=function(e,t){for(var n="",i=e;i>0;--i)n+=t[Math.round(Math.random()*(t.length-1))];return n}(16,"0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ");return encodeURIComponent(t+function(e,t){for(var n,i=[],o=0,r="",a=0;a<256;a++)i[a]=a;for(a=0;a<256;a++)o=(o+i[a]+t.charCodeAt(a%t.length))%256,n=i[a],i[a]=i[o],i[o]=n;a=0,o=0;for(var s=0;s<e.length;s++)o=(o+i[a=(a+1)%256])%256,n=i[a],i[a]=i[o],i[o]=n,r+=String.fromCharCode(e.charCodeAt(s)^i[(i[a]+i[o])%256]);return r}(e,"anything"+t)).replace(/\(/g,"%28").replace(/\)/g,"%29")},_isSet=function(e){var t=!1;return e.is(":input")?e.is(":checkbox")?e.is(":checked")&&(t=!0):t=""!=e.val():e.has("[id^=handsontable_]")?e.find("[id^=handsontable_]").each(function(){for(var e=$(this).handsontable("getData"),n=0;n<e.length;n++)for(var i in e[n])null!=e[n][i]&&""!=e[n][i]&&(t=!0)}):e.find(":input").each(function(){$(this).is(":button")||_isSet($(this))&&(t=!0)}),t};$.validator.setDefaults({highlight:function(e,t,n){var i;i="radio"===e.type?this.findByName(e.name):$(e);var o=get_parent_with_class(i,"param-field");null!=o&&(o.removeClass(n).addClass(t),buttons=o.find(".btn").addClass("btn-danger"))},unhighlight:function(e,t,n){var i;i="radio"===e.type?this.findByName(e.name):$(e);var o=get_parent_with_class(i,"param-field");null!=o&&(o.removeClass(t).addClass(n),buttons=o.find(".btn").removeClass("btn-danger"))},errorPlacement:function(e,t){e.addClass("help-block"),t.parent("div.input-group").parent("div.input-group").parent("div.input-group").length>0?e.insertAfter(t.parent("div.input-group").parent("div.input-group").parent("div.input-group")):t.parent("div.input-group").parent("div.input-group").length>0?e.insertAfter(t.parent("div.input-group").parent("div.input-group")):t.parent("div.input-group").length>0?e.insertAfter(t.parent("div.input-group")):e.insertAfter(t)},errorElement:"span",errorClass:"has-error"}),jQuery.validator.addMethod("maxfilesize",function(e,t,n){if(0!=n[0]){if(1==$(t).data("data2upload").files.length)return this.optional(t)||$(t).data("data2upload").files[0].size<n[0];var i=!0;for(var o in $(t).data("data2upload").files)if($(t).data("data2upload").files[o].size>=n[0]){i=!1;break}return this.optional(t)||i}return!0},jQuery.validator.format("Selected file(s) exceeds size limits: {1}")),jQuery.validator.addMethod("multinumber",function(e,t,n){var i=e.split(/\n/),o=!0;for(var r in i)valid=this.optional(t)||/^-?(?:\d+|\d{1,3}(?:,\d{3})+)?(?:\.\d+)?$/.test(i[r]),valid||(o=!1);return o},jQuery.validator.format("Please enter only one valid number per line.")),jQuery.validator.addMethod("jfdate",function(e,t,n){var i=getDate(e,n);return this.optional(t)||!/Invalid|NaN/.test(i.toString())},jQuery.validator.format("Please enter a valid date.")),jQuery.validator.addMethod("multidate",function(e,t,n){var i=e.split(","),o=!0;for(var r in i)cdate=getDate(i[r],n),valid=this.optional(t)||!/Invalid|NaN/.test(cdate.toString()),valid||(o=!1);return o},jQuery.validator.format("Please enter only valid dates, splited by a coma.")),jQuery.validator.addMethod("mparam",function(e,t,n){return!0}),jQuery.validator.addMethod("inputfiles",function(e,t,n){return!0});var handsontables={};!function(e){var t,n=e.editors.TextEditor.prototype.extend();n.prototype.init=function(){if("undefined"==typeof jQuery)throw new Error("You need to include jQuery to your project in order to use the jQuery UI Datepicker.");t=jQuery,e.editors.TextEditor.prototype.init.apply(this,arguments),this.isCellEdited=!1;var n=this;this.instance.addHook("afterDestroy",function(){n.destroyElements()})},n.prototype.createElements=function(){e.editors.TextEditor.prototype.createElements.apply(this,arguments),this.datePicker=document.createElement("DIV"),e.Dom.addClass(this.datePicker,"datepicker"),e.Dom.addClass(this.datePicker,"datepicker-dropdown"),e.Dom.addClass(this.datePicker,"dropdown-menu"),e.Dom.addClass(this.datePicker,"datepicker-orient-left"),e.Dom.addClass(this.datePicker,"datepicker-orient-top"),document.body.appendChild(this.datePicker),this.$datePicker=t(this.datePicker),this.$datePicker.css("position","absolute"),this.$datePicker.css("top",0),this.$datePicker.css("left",0),this.$datePicker.css("zIndex",1060);var n=this,i=n.instance.getSettings(),o=n.instance.getSelected()[1];this.$datePicker.datepicker({format:i.columns[o].dateFormat}).on("changeDate",function(e){n.setValue(e.format()),n.finishEditing(!1)}),e.eventManager(this).addEventListener(this.datePicker,"mousedown",function(t){e.helper.stopPropagation(t)}),this.hideDatepicker()},n.prototype.destroyElements=function(){this.$datePicker.datepicker("remove"),this.$datePicker.remove()},n.prototype.open=function(){e.editors.TextEditor.prototype.open.call(this),this.showDatepicker()},n.prototype.finishEditing=function(t,n){this.hideDatepicker(),e.editors.TextEditor.prototype.finishEditing.apply(this,arguments)},n.prototype.showDatepicker=function(){var t=this.TD.getBoundingClientRect();this.originalValue&&this.$datePicker.datepicker("update",this.originalValue),this.$datePicker.css("top",window.pageYOffset+t.top+e.Dom.outerHeight(this.TD)),this.$datePicker.css("left",window.pageXOffset+t.left),this.$datePicker.show()},n.prototype.hideDatepicker=function(){var e=this,t=e.instance.getSettings(),n=e.col;void 0!=n&&""==e.getValue()&&e.setValue(t.columns[n].defaultValue),this.$datePicker.hide()},e.editors.BootstrapDateEditor=n,e.editors.registerEditor("bootdate",n)}(Handsontable),Handsontable.BootstrapDateCell={editor:Handsontable.editors.BootstrapDateEditor,renderer:Handsontable.renderers.AutocompleteRenderer},Handsontable.cellTypes.bootdate=Handsontable.BootstrapDateCell,function(e){"use strict";var t,n,i=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.wfform.defaults,n),this.uploadfiles={},this.nbfileuploaded=0,this.handsontable_errors={},""==this.options.serverURL&&(this.options.serverURL=e.fn.wfform.defaults.serverURL)};i.prototype.reset=function(){for(var t in this.workflow.parameters)this.workflow.parameters[t].default?e("#"+this.workflow.parameters[t].name).val(this.workflow.parameters[t].default):e("#"+this.workflow.parameters[t].name).val("")};var o=function(n,i){var o=!0,r=new Array;e(".fileupload").each(function(){var t=e(this).fileupload("progress").loaded,n=e(this).fileupload("progress").total,i=e(this).attr("id").split("_"),a=i.slice(1,i.length).join("_");t!=n&&(o=!1),0!=n&&r.push({param:a.split("_").join(" "),param_id:a,loaded:t,total:n})}),o&&!i&&(clearInterval(t),n.$element.trigger("uploaded.wfform")),i&&(e("#workflow_form").hide(),e("#progress").html(""),e.tmpl(n.options.progressTemplate,{upload_file_status:r}).appendTo(e("#progress")))},r=function(e,t){t==e.nbfileuploaded&&(clearInterval(n),e.$element.trigger("uploaded.wfform"))},a=function(i){if(i.$element.find(".error-wf").remove(),e("#workflow_form").valid()){var a=!1;if(e("[id^=handsontable_]").each(function(){e(this).is(":visible")&&e(this).find("td.htInvalid").length>0&&(a=!0)}),!a){var s="",l={},c=function(){s="",l={},e(":checkbox").each(function(){e(this).prop("checked")&&e(this).val(!0)}),e.each(e("#workflow_form").serializeArray(),function(t,n){(0==e("#"+n.name).length||e("#"+n.name).is(":enabled")&&!e("#"+n.name).hasClass("hidden-exclude"))&&(""!=n.value&&"password"==e("#"+n.name).attr("type")&&(n.value=rc4_encrypt(n.value)),l.hasOwnProperty(n.name)?l[n.name].push(n.value):""!=n.value&&(e("#"+n.name).hasClass("list")&&~e("#"+n.name).val().indexOf("\n")?l[n.name]=e("#"+n.name).val().split(/\n/):l[n.name]=new Array(n.value)))}),e("[id^=handsontable_]").each(function(){if(e(this).is(":visible"))for(var t=e(this).handsontable("getData"),n=0;n<t.length;n++)for(var i in t[n])null!=t[n][i]&&""!==t[n][i]&&(l[i+"___"+n]=new Array,l[i+"___"+n].push(t[n][i]))});for(var t in l){for(var n="",o=0;o<l[t].length;o++)i.options.parameters.hasOwnProperty(t)?null!=i.options.parameters[t]&&(n+=encodeURI(l[t][o]+"::-::")):n+=encodeURI(l[t][o]+"::-::");n&&(s=(s+=t+"="+n).substring(0,s.length-5)+"&")}e("#workflow_form :checkbox").each(function(){e(this).is(":visible")&&0==e(this).parents("[id^=handsontable_]").length&&(e(this).prop("checked")||(s+=e(this).attr("name")+"=false&"))})};c(),e("#run_workflow,#reset_workflow").prop("disabled",!0),e.ajax({url:i.options.serverURL+"/validate_workflow?"+s,dataType:"json",success:function(t){if(e("#run_workflow,#reset_workflow").prop("disabled",!1),0==t.status)i.$element.trigger("validated.wfform");else{var n=['<div class="alert alert-danger error-wf" role="alert">',"<strong>Error!</strong>",t.content,"</div>"].join("\n");i.$element.prepend(n),e("#setAndRunModalBody").animate({scrollTop:0},"slow")}}}),i.$element.off("validated.wfform").on("validated.wfform",function(){i.$element.off("uploaded.wfform").on("uploaded.wfform",function(){e.ajax({url:i.options.serverURL+"/run_workflow?"+s+"callback=?",dataType:"json",success:function(e){if(0==e.status)i.$element.trigger("run.wfform",e.content);else{var t=['<div class="alert alert-danger" role="alert">',"<strong>Error!</strong>","Jflow failed to connect to the specified server <strong>"+i.options.serverURL+"</strong>","</div>"].join("\n");i.$element.html(t)}}})}),e("[id^=urlfile_btn_]").each(function(){var t=e(this).attr("id").split("_"),n=t.slice(2,t.lenght).join("_");if(e("#"+n).hasClass("to-readonly")&&e("#"+n).val())if(e("#"+n).hasClass("list")){var o=e("#"+n).val();~o.indexOf("\n")&&(o=o.split(/\n/));for(var r="",a=0;a<o.length;a++)(r+=i.uploadfiles[n]+"/"+o[a]).replace(/C:\\fakepath\\/i,"").replace(/C:\\fake_path\\/i,""),r+="::-::";r=r.substring(0,r.length-5),e("#"+n).val(r),e("#"+n).removeClass("list")}else e("#"+n).val(i.uploadfiles[n]+"/"+e("#"+n).val()),e("#"+n).val(e("#"+n).val().replace(/C:\\fakepath\\/i,"").replace(/C:\\fake_path\\/i,""))}),c(),i.$element.trigger("uploading.wfform");var a=0;if(e(".fileupload").each(function(){var t=e(this).attr("id").split("_"),n=t.slice(1,t.length).join("_");e("#"+n).data("data2upload")&&(e("#"+n).data("data2upload").submit(),a+=1)}),a>0)if(i.options.forceIframeTransport)o(i,!0),t=setInterval(function(){o(i,!1)},i.options.timer);else{var l=new Array;e(".fileupload").each(function(){var t=e(this).attr("id").split("_"),n=t.slice(1,t.length).join("_");l.push({param:n.split("_").join(" "),param_id:n,loaded:0,total:100})}),e("#workflow_form").hide(),e("#progress").html(""),e.tmpl(i.options.progressTemplate,{upload_file_status:l}).appendTo(e("#progress")),n=setInterval(function(){r(i,a)},i.options.timer)}else i.$element.trigger("uploaded.wfform")})}}},s=function(t){var n=e.Deferred();return e("#"+t).handsontable("validateCells",function(){n.resolve()}),n.promise()};i.prototype.run=function(){var t=this;if(0==e("[id^=handsontable_]").length)a(t);else{var n=new Array;e("[id^=handsontable_]").each(function(){var t=e(this).attr("id");n.push(s(t))}),e.when.apply(e,n).done(function(){e("[id^=handsontable_]").each(function(){e(this).handsontable("render")}),a(t)})}},i.prototype.render=function(){e(document).off("focusin.bs.modal"),e("[id^=handsontable_]").each(function(){e(this).handsontable("render")})},i.prototype.load=function(){var t=this,n=['<div class="container-fluid"><div class="row"><div class="col-md-1 col-md-offset-2"><div class="inline floatingBarsG">','<div class="blockG" id="rotateG_01"></div>','<div class="blockG" id="rotateG_02"></div>','<div class="blockG" id="rotateG_03"></div>','<div class="blockG" id="rotateG_04"></div>','<div class="blockG" id="rotateG_05"></div>','<div class="blockG" id="rotateG_06"></div>','<div class="blockG" id="rotateG_07"></div>','<div class="blockG" id="rotateG_08"></div>','</div></div> <div class="col-md-8">Please wait until module is being loaded!</div></div></div>'].join("\n");t.$element.html(n),e.ajax({url:this.options.serverURL+"/get_available_workflows?callback=?",dataType:"json",timeout:2e4,error:function(e,n,i){var o=['<div class="alert alert-danger" role="alert">',"<strong>Error!</strong>","Jflow failed to connect to the specified server <strong>"+t.options.serverURL+"</strong>","</div>"].join("\n");t.$element.html(o)},success:function(n){var i={};for(var o in n)if(n[o].class==t.options.workflowClass){t.workflow=n[o];break}t.$element.trigger("loaded.wfform",t.workflow),t.$element.html(""),e.tmpl(l,{workflow:t.workflow,display_form_type:t.options.displayFormType,display_run_button:t.options.displayRunButton,display_reset_button:t.options.displayResetButton,parameters:t.options.parameters,getParameterDisplay:t._getParameterDisplay,getTplName:t._getTplName,templates:{parameterTemplate:t.options.parameterTemplate,dateTemplate:t.options.dateTemplate,choiceTemplate:t.options.choiceTemplate,inputfileTemplate:t.options.inputfileTemplate,browsefileTemplate:t.options.browsefileTemplate,regexpfilesTemplate:t.options.regexpfilesTemplate,booleanTemplate:t.options.booleanTemplate,passwordTemplate:t.options.passwordTemplate,textTemplate:t.options.textTemplate}}).appendTo(t.$element);var r=function(t){e("[id^=urlfile_btn_]").off("click").on("click",function(){var n=e(this).attr("id").split("_"),i=n.slice(2,n.lenght).join("_"),o=e(this).attr("id").replace("urlfile_btn_","");JflowBrowser.exec(function(t){e("#"+i).val(t.join("\n")),e("#"+i).trigger("change")},t[o].type.startsWith("inputfiles"))})};e(".fileupload").each(function(){var n=e(this).attr("id").split("_"),i=n.slice(1,n.length).join("_");e(this);t.uploadfiles[i]=+new Date+"_"+Math.floor(1e4*Math.random()+1),e(this).fileupload({url:t.options.serverURL+"/upload",formData:{uniq_directory:t.uploadfiles[i]},forceIframeTransport:t.options.forceIframeTransport,add:function(t,n){if(n.files=n.originalFiles,1==n.files.length)e("#"+i).val(n.files[0].name);else{var o="";for(var r in n.files)o+=n.files[r].name+"\n";e("#"+i).val(o.substring(0,o.length-1))}e("#"+i).data("data2upload",n),e("#"+i).focusout()},progressall:function(n,o){var r=parseInt(o.loaded/o.total*100,10);e("#"+i+"_pbar").css("width",r+"%"),100==r&&(t.nbfileuploaded+=1)}})}),e(".date").datepicker().on("changeDate",function(t){e(this).hasClass("list")||e(".date").datepicker("hide");var n=e(this).attr("id").split("date_")[1];e("#"+n).focusout()});var a={},s={};for(var o in t.workflow.parameters)a[t.workflow.parameters[o].name]=t.workflow.parameters[o],s.hasOwnProperty(t.workflow.parameters[o].group)||(s[t.workflow.parameters[o].group]=new Array),s[t.workflow.parameters[o].group].push(t.workflow.parameters[o].name);for(var o in t.workflow.parameters)if("MultipleParameters"==t.workflow.parameters[o].type)for(var c in t.workflow.parameters[o].sub_parameters)i[t.workflow.parameters[o].sub_parameters[c].name]=t._getParameterRule(t.workflow.parameters[o].sub_parameters[c],t.options.serverURL);else i[t.workflow.parameters[o].name]=t._getParameterRule(t.workflow.parameters[o],t.options.serverURL);e("#workflow_form").validate({rules:i}),e("a[class^=inputfile_]").click(function(){e("#"+e(this).attr("class")).html(e(this).html());var n=e(this).attr("class").split("_"),i=n.slice(1,n.lenght).join("_"),o=e("#"+i).rules().mparam.type.split("__sl")[1];if(e("#"+i).val(""),e("#"+i).rules("remove","remote maxfilesize"),"local file"==e(this).html())e("#urlfile_btn_"+i).show(),e("#"+i).on("focusin",function(t){e(this).prop("readonly",!0)}),e("#"+i).on("focusout",function(t){e(this).prop("readonly",!1)}),e("#"+i).addClass("to-readonly"),"0"!=o&&e("#"+i).rules("add",{maxfilesize:[t.getNbOctet(o),o]}),e("[id^=urlfile_btn_]").off("click").on("click",function(){var t=e(this).attr("id").split("_"),n=t.slice(2,t.lenght).join("_");e("#browse_"+n).click()});else if("server file"==e(this).html())e("#urlfile_btn_"+i).show(),r(d);else{e("#urlfile_btn_"+i).hide(),e("#"+i).on("focusin",function(t){e(this).prop("readonly",!1)}),e("#"+i).on("focusout",function(t){e(this).prop("readonly",!1)}),e("#"+i).removeClass("to-readonly"),e("#"+i).data("data2upload")&&e("#"+i).removeData("data2upload");var a=null;a="url"==e(this).html()?"urlfile":"server regexp"==e(this).html()?"regexpfiles":"append"==e("#"+i).rules().mparam.action?"inputfiles":"inputfile",e("#"+i).rules("add",{remote:{url:t.options.serverURL+"/validate_field?callback=?",type:"post",data:{type:a+"__sl"+o,action:e("#"+i).rules().mparam.action}}}),e("#"+i).trigger("change")}}),r(a),e(".selectMultipleFiles").click(function(){for(var n=e(this).attr("paired_columns").match(/(.+)\[(.+)]/),i=n[1],o=n[2].split(","),r=e(this).attr("for"),a=0;a<o.length;a++)o[a]=r+"___"+o[a].replace("_","-");return JflowBrowser.exec(function(n){for(var a={},s=[],l=RegExp("(.+)(1|2)."+i),c=0;c<n.length;c++){var d;if(d=(y=n[c]).match(l)){var u=d[1],h=parseInt(d[2]);u in a||(a[u]=[]),a[u][h-1]=y}else s.push(y)}var p=[];for(var f in a){for(var g={},v=a[f],m=0;m<2;m++)if(m<v.length){var y=v[m];g[o[m]]=void 0!==y?y:""}else g[o[m]]="";p.push(g)}for(var w=0;w<s.length;w++){var b={};b[o[0]]=s[w];for(var C=1;C<o.length;C++)b[o[C]]="";p.push(b)}var x=e("#handsontable_"+r),E=x.handsontable("getData");x.handsontable("loadData",E.slice(0,E.length-1).concat(p));for(var _ in o)t.$element.trigger("change_"+o[_])},!0),!1}),e(".to-readonly").on("focusin",function(t){e(this).prop("readonly",!0)}),e(".to-readonly").on("focusout",function(t){e(this).prop("readonly",!1)});var d=null;e("[id^=handsontable_]").each(function(){function n(e,t){if(t<e.countRows()-1)for(var n=e.getData()[t],i=0,o=n.length;i<o;i++)if(null!==n[i])return!1;return!0}var i=e(this).attr("id").split("handsontable_"),o=i.slice(1,i.length),r={},s=new Array,l=new Array,c=new Array,u={},h={},p={},f={};handsontables[o]=e.extend(e(this),{allRequired:p,columns:[]}),f[o]=a[o].help;for(var g in a[o].sub_parameters)handsontables[o].columns.push(a[o].sub_parameters[g].name),r[a[o].sub_parameters[g].name]=null,c.push(a[o].sub_parameters[g].default),s.push(a[o].sub_parameters[g].display_name),f[a[o].sub_parameters[g].name]=a[o].sub_parameters[g].help,"bool"==a[o].sub_parameters[g].type?l.push({data:a[o].sub_parameters[g].name,type:"checkbox"}):"date"==a[o].sub_parameters[g].type?l.push({data:a[o].sub_parameters[g].name,type:"bootdate",defaultValue:a[o].sub_parameters[g].default,dateFormat:a[o].sub_parameters[g].format,validator:function(e,t){var n=getDate(e,a[o].sub_parameters[g].format);t("[object Date]"===Object.prototype.toString.call(n)?isNaN(n.getTime())?!1:!0:!1)}}):null!=a[o].sub_parameters[g].choices?l.push({data:a[o].sub_parameters[g].name,editor:"select",selectOptions:a[o].sub_parameters[g].choices.map(String)}):(u[a[o].sub_parameters[g].name]=a[o].sub_parameters[g].type,h[a[o].sub_parameters[g].name]=a[o].sub_parameters[g].action,p[a[o].sub_parameters[g].name]=a[o].sub_parameters[g].required,l.push({data:a[o].sub_parameters[g].name,validator:function(n,i){var r=this;!p[r.prop]||null!=n&&""!=n.trim()?p[r.prop]||null!=n&&""!=n?"append"!=h[r.prop]&&~n.indexOf("\n")?(e("#error_handsontable_"+o).show(),e("#error_handsontable_"+o).html("This field does not accept multiple values."),e("#error_handsontable_"+o).parent().addClass("has-error"),i(!1)):e.ajax({url:t.options.serverURL+"/validate_field?callback=?",dataType:"json",data:{type:u[r.prop],action:h[r.prop],value:n},success:function(t){1==t?(i(!0),0==e("#handsontable_"+o).find("td.htInvalid").length&&e("#error_handsontable_"+o).hide()):(e("#error_handsontable_"+o).show(),e("#error_handsontable_"+o).html(t),e("#error_handsontable_"+o).parent().addClass("has-error"),i(!1))}}):(i(!0),e("#error_handsontable_"+o).hide()):(e("#error_handsontable_"+o).show(),e("#error_handsontable_"+o).html("This field is required."),e("#error_handsontable_"+o).parent().addClass("has-error"),i(!1))}}));e("#help_handsontable_"+o).html(f[o]),e(this).handsontable({data:[],currentRowClassName:"currentRow",currentColClassName:"currentCol",autoWrapRow:!0,dataSchema:r,colHeaders:s,minSpareRows:1,stretchH:"all",columns:l,contextMenu:["row_above","row_below","---------","remove_row","---------","undo","redo"],afterSelectionByProp:function(n){void 0==t.handsontable_errors[arguments[1]+"."+n]?e("#error_handsontable_"+o).hide():(e("#error_handsontable_"+o).show(),e("#error_handsontable_"+o).html(t.handsontable_errors[arguments[1]+"."+n]),e("#error_handsontable_"+o).parent().addClass("has-error")),e("#help_handsontable_"+o).html(f[arguments[1]])},afterDeselect:function(t){e("#help_handsontable_"+o).html(f[o]),e("#error_handsontable_"+o).hide()},afterValidate:function(n,i,o,r,a){if(n)try{delete t.handsontable_errors[r+"."+o]}catch(e){}else 1!=this.countRows()&&this.countRows()-1==o||(t.handsontable_errors[r+"."+o]=e("#error_handsontable_"+r.split("___")[0]).html());var s=r.split("___")[0],l=!1;for(var c in t.handsontable_errors)0==c.indexOf(s)&&(l=!0);l||e("#error_handsontable_"+r.split("___")[0]).parent().removeClass("has-error")},afterRender:function(n){for(var i=0;i<this.countCols();i++)1!=this.countRows()&&e(this.getCell(this.countRows()-1,i)).removeClass("htInvalid");null==d&&(d=JflowWfformRules.check_parameters_rules(t.workflow.parameters,t))},cells:function(e,t,i){var o=this.renderer;return{renderer:function(e,t,i,r,a,s,d){if(null===s&&n(e,i)&&(s="checkbox"==l[r].type?!(!c[r]||0==c[r].length):c[r],t.style.color="#999"),s&&s.constructor==Array&&(s=s.join("\n")),o)o(e,t,i,r,a,s,d);else{var u=arguments;u[5]=s,u[1]=t,Handsontable.renderers.TextRenderer.apply(this,u)}}}},beforeChange:function(e){var t,i,o,r=this,a=e.length,s=r.countCols(),l={},d={};for(t=0;t<a;t++)null===e[t][2]&&null!==e[t][3]&&n(r,e[t][0])&&(l[e[t][0]+"/"+e[t][1]]=!0,d[e[t][0]]=!0);for(var u in d)if(d.hasOwnProperty(u))for(i=0;i<s;i++)l[u+"/"+r.colToProp(i)]||((o=c[i])&&o.constructor==Array&&(o=c[i].join("\n")),e.push([parseInt(u),r.colToProp(i),null,o]))},afterChange:function(e){if(e)for(var n=[],i=0;i<e.length;i++){var o=e[i][1];e[i][2]!=e[i][3]&&-1==n.indexOf(o)&&(t.$element.trigger("change_"+o),n.push(o))}}})}),t.options.displayRunButton&&e("#wfform_run_btn").click(function(){t.run()}),t.options.displayResetButton&&e("#wfform_reset_btn").click(function(){t.reset()}),0==e("[id^=handsontable_]").length&&(d=JflowWfformRules.check_parameters_rules(t.workflow.parameters,t)),"collapse"==t.options.displayFormType&&e(".btn-moreless").click(function(){var t=e(this);t.children().hasClass("glyphicon-chevron-down")?t.html('<span class="glyphicon glyphicon-chevron-up"></span>'):t.html('<span class="glyphicon glyphicon-chevron-down"></span>')})}})},i.prototype.getOctetStringRepresentation=function(e){var t=["bytes","Kb","Mb","Gb","Tb","Pb","Eb","Zb"],n=Math.ceil(e.toString().length/3-1),i=10*n,o=(e/(i=Math.pow(2,i))).toString(),r=o.split(".");return o=r[0]+"."+r[1].substring(0,2)+" "+t[n]},i.prototype.getNbOctet=function(e){var t=["bytes","Kb","Mb","Gb","Tb","Pb","Eb","Zb"],n=e.substring(e.length-2,e.length),i=10*parseInt(t.indexOf(n)),o=Math.pow(2,i);return e.substring(0,e.length-2)*o},i.prototype._getParameterRule=function(e,t){var n={};if(n.mparam=e,"int"==e.type&&"append"==e.action)n.multinumber=!0;else if("int"==e.type)n.number=!0;else if("date"==e.type&&"append"==e.action)n.multidate=e.format;else if("date"==e.type)n.jfdate=e.format;else if(0===e.type.indexOf("browsefile")){var i=e.type.split("__sl")[1];n.maxfilesize=[this.getNbOctet(i),i]}else 0===e.type.indexOf("inputfiles")&&"append"==e.action&&"undefined"!=e.choices?n.inputfiles=!0:"str"!=e.type&&"password"!=e.type&&(n.remote={url:t+"/validate_field?callback=?",type:"post",data:{type:e.type,action:e.action}});return n.required=e.required,n},i.prototype._getTplName=function(e){return e.choices?"choiceTemplate":"date"==e.type?"dateTemplate":"bool"==e.type?"booleanTemplate":"password"==e.type?"passwordTemplate":0===e.type.indexOf("inputfile")?"inputfileTemplate":0===e.type.indexOf("browsefile")?"browsefileTemplate":0===e.type.indexOf("regexpfiles")?"regexpfilesTemplate":"textTemplate"},i.prototype._getParameterDisplay=function(t,n,i,o){return o=o||"",n=n||"textTemplate",e.tmpl(t[n],{param:i,check_title:o,templates:t,getParameterDisplay:this._getParameterDisplay}).html()};e.fn.wfform;e.fn.wfform=function(t){return this.each(function(){var n=e(this),o=n.data("wfform"),r=e.extend({},e.fn.wfform.defaults,"object"==typeof t&&t),a="string"==typeof t?t:null;o?o.options.workflowClass=r.workflowClass:n.data("wfform",o=new i(this,r)),a?o[a]():o.load()})};var l=['<form id="workflow_form" class="form-horizontal" role="form">',"    {{each(gindex, group) workflow.groups}}","    <fieldset>",'        {{if group != "default" }}','        <div class="row"><div class="col-sm-8"><legend>',"           ${group}","        </legend></div>",'        <div class="col-sm-4">','           {{if display_form_type == "collapse"}}','              <button class="btn btn-default btn-moreless" type="button" data-toggle="collapse" data-target="#collapse${gindex}" aria-expanded="false" aria-controls="collapse${gindex}">',"              {{if gindex <= 1 }}",'                   <span class="glyphicon glyphicon-chevron-up"></span>',"              {{else}}",'                   <span class="glyphicon glyphicon-chevron-down"></span>',"              {{/if}}","              </button>","           {{/if}}","           </div>","        </div>","        {{/if}}",'        {{if display_form_type == "collapse"}}','        <div id="collapse${gindex}" class="collapse {{if gindex <= 1 }} in{{/if}}">',"        {{/if}}","        {{each(index, param) workflow.parameters_per_groups[group]}}","            {{if Object.keys(parameters).indexOf(param.name) == -1 }}",'            <div class="form-group param-field">','                <label id="label_${param.group}" class="col-sm-2 control-label" for="${param.name}">${param.display_name}</label>','                <div class="col-sm-10">','                {{if param.type == "MultipleParameters"}}','                    <blockquote style="font-size:14px;">',"                    {{if param.paired_columns}}",'                        <button class="selectMultipleFiles" for="${param.name}" paired_columns="${param.paired_columns}"></button>',"                    {{/if}}",'                    {{if param.action == "MiltipleAppendAction"}}','                        <div id="handsontable_${param.name}" > </div>','                        <span id="error_handsontable_${param.name}" class="help-block" for="read_2"></span>','                        <span id="help_handsontable_${param.name}" class="help-block">${param.help}</span>',"                    {{else}}","                        {{each(spindex, sub_param) param.sub_parameters}}",'                           <div class="param-field">','                           {{if sub_param.type == "bool"}}',"                              {{html getParameterDisplay(templates, getTplName(sub_param), sub_param, sub_param.display_name)}}","                           {{else}}",'                              <div class="input-group">','                                  <span class="input-group-addon">${sub_param.display_name}</span>',"                                  {{html getParameterDisplay(templates, getTplName(sub_param), sub_param)}}","                              </div>","                           {{/if}}",'                              <span class="help-block">${sub_param.help}</span> <br />',"                           </div>","                        {{/each}}","                    {{/if}}","                    </blockquote>","                {{else}}","                    {{html getParameterDisplay(templates, getTplName(param), param)}}",'                    <span class="help-block">${param.help}</span>',"                {{/if}}","                </div>","            </div>","            {{else}}",'              {{if param.action == "append"}}','                <input id="${param.name}" name="${param.name}" value="${parameters[param.name].join("::-::")}" type="hidden">',"              {{else}}",'                <input id="${param.name}" name="${param.name}" value="${parameters[param.name]}" type="hidden">',"              {{/if}}","            {{/if}}","        {{/each}}",'       {{if display_form_type == "collapse"}}',"       </div>","       {{/if}}","       </fieldset>","    {{/each}}","    <fieldset>",'        <input name="workflow_class" value="${workflow.class}" type="hidden">',"        {{if display_reset_button || display_run_button}}",'            <div class="row"> <div class="col-md-3 col-md-offset-9">','                <div class="btn-group launch-wf">',"                {{if display_reset_button}}",'                    <button id="wfform_reset_btn" type="button" class="btn btn-default"><span class="glyphicon glyphicon-refresh"></span> Reset</button>',"                {{/if}}","                {{if display_run_button}}",'                    <button id="wfform_run_btn" type="button" class="btn btn-primary"><span class="glyphicon glyphicon-cog"></span> Run</button>',"                {{/if}}","                </div>","            </div>","        {{/if}}","    </fieldset>","</form>",'<form method="post" enctype="multipart/form-data" style="display:none;">',"  {{each(gindex, group) workflow.groups}}","    {{each(index, param) workflow.parameters_per_groups[group]}}",'\t\t{{if param.type.indexOf("inputfile") === 0 || param.type.indexOf("browsefile") === 0}}','\t\t  {{if param.action == "append"}}','\t\t\t<input name="browse_${param.name}" id="browse_${param.name}" class="fileupload" multiple type="file">',"\t\t  {{else}}",'\t\t\t<input name="browse_${param.name}" id="browse_${param.name}" class="fileupload" type="file">',"\t\t  {{/if}}",'       {{else param.type == "MultipleParameters"}}',"        {{each(spindex, sub_param) param.sub_parameters}}",'\t\t   {{if sub_param.type.indexOf("inputfile") === 0 || sub_param.type.indexOf("browsefile") === 0}}','\t     \t  {{if param.action == "append"}}','\t\t\t    <input name="browse_${sub_param.name}" id="browse_${sub_param.name}" multiple class="fileupload" type="file">',"\t\t      {{else}}",'\t\t\t    <input name="browse_${sub_param.name}" id="browse_${sub_param.name}" class="fileupload" type="file">',"\t\t      {{/if}}","\t\t   {{/if}}","        {{/each}}","\t\t{{/if}}","    {{/each}}","  {{/each}}","</form>",'<div id="progress"></div>'].join("\n");e.fn.wfform.defaults={serverURL:"",dateTemplate:["<div>",'{{if param.action == "append"}}','  <div id="date_${param.name}" class="input-group date list" data-date="${param.default}" data-date-multidate-separator=", " data-date-multidate="true" data-date-format="${param.format}">',"{{else}}",'  <div id="date_${param.name}" class="input-group date" data-date="${param.default}" data-date-format="${param.format}">',"{{/if}}",'    <input id="${param.name}" name="${param.name}" class="form-control" type="text" value="${param.default}">','    <span class="input-group-btn">','      <button class="btn btn-default" type="button"><span class="glyphicon glyphicon-calendar"></span>&nbsp;</button>',"    </span>","  </div>","</div>"].join("\n"),choiceTemplate:["<div>",'{{if param.action == "append"}}','  <select id="${param.name}" multiple name="${param.name}" class="form-control list">',"{{else}}",'  <select id="${param.name}" name="${param.name}" class="form-control">',"{{/if}}","  {{each(j, choice) param.choices}}","    {{if choice == param.default}}",'    <option {{if $.type(param.choices) === "object"}} value=${j} {{/if}} selected>${choice}</option>',"    {{else}}",'    <option {{if $.type(param.choices) === "object"}} value=${j} {{/if}} >${choice}</option>',"    {{/if}}","  {{/each}}","  </select>","</div>"].join("\n"),inputfileTemplate:["<div>",'  <div class="input-group">','    <div class="input-group-btn">','      <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown">','        <span id="inputfile_${param.name}">server file</span>','        <span class="caret"></span>',"      </button>",'      <ul class="dropdown-menu" role="menu">','        <li><a class="inputfile_${param.name}" href="#">server file</a></li>','        {{if param.action == "append"}}','        <li><a class="inputfile_${param.name}" href="#">server regexp</a></li>',"        {{/if}}",'        <li><a class="inputfile_${param.name}" href="#">local file</a></li>','        <li><a class="inputfile_${param.name}" href="#">url</a></li>',"      </ul>","    </div>",'    {{if param.action == "append"}}','    <textarea id="${param.name}" style="resize:none" name="${param.name}" class="list form-control">${param.default.join("\n")}</textarea>',"    {{else}}",'    <input id="${param.name}" name="${param.name}" class="form-control" type="text" value="${param.default}">',"    {{/if}}",'    <span class="input-group-btn">','      <button id="urlfile_btn_${param.name}" class="btn btn-default" type="button"><span class="glyphicon glyphicon-folder-open"></span>&nbsp;</button>',"    </span>","  </div>","</div>"].join("\n"),browsefileTemplate:["<div>",'  <div class="input-group">','    {{if param.action == "append"}}','    <textarea id="${param.name}" style="resize:none" name="${param.name}" class="list form-control to-readonly">${param.default.join("\n")}</textarea>',"    {{else}}",'    <input id="${param.name}" name="${param.name}" class="form-control to-readonly" type="text" value="${param.default}">',"    {{/if}}",'    <span class="input-group-btn">','      <button id="urlfile_btn_${param.name}" class="btn btn-default" type="button"><span class="glyphicon glyphicon-folder-open"></span>&nbsp;</button>',"    </span>","  </div>","</div>"].join("\n"),regexpfilesTemplate:["<div>",'  <textarea id="${param.name}" style="resize:none" name="${param.name}" class="list form-control">${param.default.join("\n")}</textarea>',"</div>"].join("\n"),booleanTemplate:["<div>","    {{if param.default == true}}",'      <input id="${param.name}" name="${param.name}" value="${param.default}" type="checkbox" checked> ${check_title}',"    {{else}}",'      <input id="${param.name}" name="${param.name}" value="${param.default}" type="checkbox"> ${check_title}',"    {{/if}}","</div>"].join("\n"),textTemplate:["<div>",'  {{if param.action == "append"}}','    <textarea id="${param.name}" style="resize:none" name="${param.name}" class="list form-control">${param.default.join("\n")}</textarea>',"  {{else}}",'    <input id="${param.name}" name="${param.name}" value="${param.default}" class="form-control" type="text">',"  {{/if}}","</div>"].join("\n"),passwordTemplate:["<div>",'    <input id="${param.name}" name="${param.name}" value="${param.default}" class="form-control" type="password">',"</div>"].join("\n"),progressTemplate:['<dl class="dl-horizontal">','<div class="container-fluid"><div class="row"><div class="col-md-1 col-md-offset-2"><div class="inline floatingBarsG">','<div class="blockG" id="rotateG_01"></div>','<div class="blockG" id="rotateG_02"></div>','<div class="blockG" id="rotateG_03"></div>','<div class="blockG" id="rotateG_04"></div>','<div class="blockG" id="rotateG_05"></div>','<div class="blockG" id="rotateG_06"></div>','<div class="blockG" id="rotateG_07"></div>','<div class="blockG" id="rotateG_08"></div>','</div></div> <div class="col-md-8">Please wait until all files have being loaded!</div></div>',"<br/>","{{each(index, file) upload_file_status}}","<dt>${file.param}</dt>","<dd>",'<div class="progress">','<div id="${file.param_id}_pbar" class="progress-bar progress-bar-success" role="progressbar" style="width: ${parseInt((file.loaded/file.total)*100)}%;"></div>',"</div>","</dd>","{{/each}}","</dl>"].join("\n"),workflowClass:null,displayFormType:"default",displayRunButton:!0,displayResetButton:!0,workflow:null,parameters:{},timer:2e3,forceIframeTransport:!1},e.fn.wfform.Constructor=i}(window.jQuery),function(e){"use strict";var t=function(t,n){this.$element=e(t),this.options=e.extend({},e.fn.wfstatus.defaults,n),this.cytoptions={},""==this.options.serverURL&&(this.options.serverURL=e.fn.activewf.defaults.serverURL)};t.prototype.reformatWorkflowJSON=function(e){var t={name:e.name,status:e.status,elapsed_time:e.elapsed_time,end_time:e.end_time,id:e.id,start_time:e.start_time,components:new Array};for(var n in e.components){var i=0,o=0,r=0,a=0;0!=parseInt(e.components[n].total)&&(i=parseInt(100*(parseInt(e.components[n].aborted)+parseInt(e.components[n].failed))/parseInt(e.components[n].total)),o=parseInt(100*parseInt(e.components[n].completed)/parseInt(e.components[n].total)),r=parseInt(100*parseInt(e.components[n].running)/parseInt(e.components[n].total)),a=parseInt(100*parseInt(e.components[n].waiting)/parseInt(e.components[n].total))),t.components.push({name:e.components[n].name,elapsed_time:e.components[n].elapsed_time,failed:i,running:r,completed:o,waiting:a})}return t},t.prototype._listview=function(){if(this.options.forceUsingWorkflow){var t=this.reformatWorkflowJSON(this.options.forceUsingWorkflow);this.$element.html(""),e.tmpl(this.options.headTemplate,{workflow:t,verbose:this.options.verbose}).appendTo(this.$element),e.tmpl(this.options.listTemplate,{workflow:t}).appendTo(this.$element),this.options.forceUsingWorkflow=null}else if(this.options.workflowID){var i=this,o="",r=['<div class="container-fluid"><div class="row"><div class="col-md-1 col-md-offset-2"><div class="inline floatingBarsG">','<div class="blockG" id="rotateG_01"></div>','<div class="blockG" id="rotateG_02"></div>','<div class="blockG" id="rotateG_03"></div>','<div class="blockG" id="rotateG_04"></div>','<div class="blockG" id="rotateG_05"></div>','<div class="blockG" id="rotateG_06"></div>','<div class="blockG" id="rotateG_07"></div>','<div class="blockG" id="rotateG_08"></div>','</div></div> <div class="col-md-8">Please wait until module is being loaded!</div></div></div>'].join("\n");i.$element.html(r),this.options.workflowID&&(o="workflow_id="+this.options.workflowID+"&"),o+="display="+this.options.display+"&",e.ajax({url:this.options.serverURL+"/get_workflow_status?"+o+"callback=?",dataType:"json",timeout:2e4,error:function(e,t,n){var o=['<div class="alert alert-danger" role="alert">',"<strong>Error!</strong>","Jflow failed to connect to the specified server <strong>"+i.options.serverURL+"</strong>","</div>"].join("\n");i.$element.html(o)},success:function(t){var o=i.reformatWorkflowJSON(t);i.$element.html(""),e.tmpl(i.options.headTemplate,{workflow:o,verbose:i.options.verbose}).appendTo(i.$element),e.tmpl(i.options.listTemplate,{workflow:o}).appendTo(i.$element),i.$element.find("#wfstatus_error_panel").hide(),null!=t.errors&&(i.$element.find("#wfstatus_error_msg").html(t.errors.msg.join("<br/>")),i.$element.find("#wfstatus_error_location").text(t.errors.location),i.$element.find("#wfstatus_error_panel").show()),e("[id^=progress_component_]").hover(function(){var t=e(this).attr("id").split("progress_component_")[1],o=t.replace(".","\\.");e("#reset_component_"+o).children("div").css("left",e(this).width()-45),e("#info_component_"+o).children("div").css("left",e(this).width()-89),e("#reset_component_"+o).fadeIn(200),e("#info_component_"+o).fadeIn(200),e("#reset_component_"+o).bind("click",{component_name:t,element:i},n)},function(){var t=e(this).attr("id").split("progress_component_")[1].replace(".","\\.");e("#reset_component_"+t).fadeOut(200),e("#info_component_"+t).fadeOut(200),e("#reset_component_"+t).unbind("click",n)})}})}},t.prototype._createcytoscape=function(t,n,i){var o={style:cytoscape.stylesheet().selector('node[type = "component"]').css({width:"80px",height:"80px",content:"data(name)","pie-size":"100%","pie-1-background-color":"lightgrey","pie-1-background-size":"mapData(err, 0, 100, 0, 100)","pie-2-background-color":"#faa732","pie-2-background-size":"mapData(wai, 0, 100, 0, 100)","pie-3-background-color":"#0e90d2","pie-3-background-size":"mapData(run, 0, 100, 0, 100)","pie-4-background-color":"#dd514c","pie-4-background-size":"mapData(fai, 0, 100, 0, 100)","pie-5-background-color":"#7fe175","pie-5-background-size":"mapData(com, 0, 100, 0, 100)","background-color":"lightgrey","text-valign":"bottom",color:"black","font-family":'"Trebuchet MS",Verdana,"Lucida Grande", Tahoma, Helvetica, sans-serif',"border-width":"0","font-size":"10px"}).selector('node[type ^= "input"]').css({width:"62px",height:"62px",content:"data(name)","text-valign":"bottom",color:"black","font-family":'"Trebuchet MS",Verdana,"Lucida Grande", Tahoma, Helvetica, sans-serif',"font-size":"10px","border-width":"0"}).selector("edge").css({width:1,opacity:.5}),elements:{nodes:t,edges:n},layout:{name:"dagre",nodeSep:void 0,edgeSep:void 0,rankSep:void 0,rankDir:"LR",minLen:function(e){return 1},fit:!0,padding:30,animate:!1,animationDuration:500,boundingBox:void 0,ready:function(){},stop:function(){}},ready:function(){window.cy=this,cy.elements().unselectify(),cy.on("mouseover","node",function(e){var t=e.cyTarget;"component"==t._private.data.type?t.animate({css:{"background-opacity":"0.1"}},{duration:100}):t.animate({css:{"background-opacity":"0.7"}},{duration:100})}),cy.on("mouseout","node",function(e){var t=e.cyTarget;"button"==t._private.data.type?t.animate({css:{"background-opacity":"0.8"}},{duration:100}):t.animate({css:{"background-opacity":"1"}},{duration:100})}),cy.on("tap","node",function(e){var t=e.cyTarget;"reset"==t.id()?i.reset(t._private.data.cname):"info"==t.id()||"component"==t._private.data.type&&(cy.$("node[id = 'reset']").inside()?(cy.remove("node[type = 'button']"),cy.elements().unlock()):(cy.add({group:"nodes",data:{id:"reset",name:"",cname:t.id(),type:"button"},css:{width:"0px",height:"0px","background-color":"black","background-opacity":"0.8",content:"data(name)",shape:"roundrectangle"},position:{x:t.position().x+21,y:t.position().y-47}}).animate({css:{width:20,height:15}},{duration:150}),cy.$("node[type = 'button']").lock(),t.lock()))}),cy.on("tap",function(e){e.cyTarget,cy}),cy.boxSelectionEnabled(!1),cy.panzoom({})}};i.cytoptions=o,e("#cytoscape_panel").cytoscape(o)},t.prototype.render=function(){e(document).off("focusin.bs.modal"),e("#cytoscape_panel").cytoscape(this.cytoptions)},t.prototype._graphview=function(){var t=this,n="",i=['<div class="container-fluid"><div class="row"><div class="col-md-1 col-md-offset-2"><div class="inline floatingBarsG">','<div class="blockG" id="rotateG_01"></div>','<div class="blockG" id="rotateG_02"></div>','<div class="blockG" id="rotateG_03"></div>','<div class="blockG" id="rotateG_04"></div>','<div class="blockG" id="rotateG_05"></div>','<div class="blockG" id="rotateG_06"></div>','<div class="blockG" id="rotateG_07"></div>','<div class="blockG" id="rotateG_08"></div>','</div></div> <div class="col-md-8">Please wait until modul is being loaded!</div></div></div>'].join("\n");t.$element.html(i),this.options.workflowID&&(n="workflow_id="+this.options.workflowID+"&"),n+="display="+this.options.display+"&",e.ajax({url:this.options.serverURL+"/get_workflow_status?"+n+"callback=?",dataType:"json",timeout:2e4,error:function(e,n,i){var o=['<div class="alert alert-danger" role="alert">',"<strong>Error!</strong>","Jflow failed to connect to the specified server <strong>"+t.options.serverURL+"</strong>","</div>"].join("\n");t.$element.html(o)},success:function(n){var i=t.reformatWorkflowJSON(n);t.$element.html(""),e.tmpl(t.options.headTemplate,{workflow:i,verbose:t.options.verbose}).appendTo(t.$element),e.tmpl(t.options.graphTemplate,{workflow:i}).appendTo(t.$element);var o={},r=new Array,a=new Array;for(var s in n.components){var l=0,c=i.components[s].waiting,d=i.components[s].running,u=i.components[s].failed,h=i.components[s].completed;c+d+u+h==0&&(l=100),o[n.components[s].name]={name:n.components[s].name,err:l,wai:c,run:d,fai:u,com:h}}for(var s in n.nodes)"inputfile"==n.nodes[s].type||"inputfiles"==n.nodes[s].type||"inputdirectory"==n.nodes[s].type?r.push({data:{id:n.nodes[s].name,name:n.nodes[s].display_name,type:n.nodes[s].type}}):"component"==n.nodes[s].type&&r.push({data:{id:n.nodes[s].name,name:n.nodes[s].display_name,type:n.nodes[s].type,err:o[n.nodes[s].name].err,wai:o[n.nodes[s].name].wai,run:o[n.nodes[s].name].run,fai:o[n.nodes[s].name].fai,com:o[n.nodes[s].name].com}});for(var s in n.edges)null!=n.edges[s][0]&&null!=n.edges[s][1]&&a.push({data:{source:n.edges[s][0],target:n.edges[s][1]}});t.$element.find("#wfstatus_error_panel").hide(),null!=n.errors&&(t.$element.find("#wfstatus_error_msg").html(n.errors.msg.join("<br/>")),t.$element.find("#wfstatus_error_location").text(n.errors.location),t.$element.find("#wfstatus_error_panel").show()),t._createcytoscape(r,a,t)}})},t.prototype.reload=function(){"list"==this.options.display?this._listview():"graph"==this.options.display&&this._graphview()},t.prototype.rerun=function(){var t=this;e.ajax({url:this.options.serverURL+"/rerun_workflow?workflow_id="+t.options.workflowID+"&callback=?",dataType:"json",timeout:2e4,error:function(e,n,i){var o=['<div class="alert alert-danger" role="alert">',"<strong>Error!</strong>","Jflow failed to connect to the specified server <strong>"+t.options.serverURL+"</strong>","</div>"].join("\n");t.$element.html(o)},success:function(e){t.reload()}})};var n=function(e){e.data.element.reset(e.data.component_name)};t.prototype.reset=function(t){var n=this,i="";this.options.workflowID&&(i="workflow_id="+this.options.workflowID+"&"),i+="component_name="+t+"&",e.ajax({url:this.options.serverURL+"/reset_workflow_component?"+i+"&callback=?",dataType:"json",timeout:2e4,error:function(e,t,i){var o=['<div class="alert alert-danger" role="alert">',"<strong>Error!</strong>","Jflow failed to connect to the specified server <strong>"+n.options.serverURL+"</strong>","</div>"].join("\n");n.$element.html(o)},success:function(e){n.reload()}})};e.fn.wfstatus;e.fn.wfstatus=function(n){return this.each(function(){var i=e(this),o=i.data("wfstatus"),r=e.extend({},e.fn.wfstatus.defaults,"object"==typeof n&&n),a="string"==typeof n?n:null;o?r.workflowID&&(o.options.workflowID=r.workflowID):i.data("wfstatus",o=new t(this,r)),r.forceUsingWorkflow&&(o.options.forceUsingWorkflow=r.forceUsingWorkflow),a?o[a]():o.reload()})},e.fn.wfstatus.defaults={serverURL:"",headTemplate:['<dl class="dl-horizontal">',"<dt>Start</dt>","<dd>${workflow.start_time}</dd>","<dt>End</dt>","<dd>${workflow.end_time}</dd>","<dt>Elapsed time</dt>","<dd>${workflow.elapsed_time}</dd>","</dl>",'<div id="wfstatus_error_panel" class="alert alert-danger" role="alert" style="display:none;">',"    <strong>Error!</strong>",'    <span id="wfstatus_error_msg"></span><br/>',"    {{if verbose}}","      <strong>Error location:</strong><br/>",'      <span id="wfstatus_error_location"></span>',"    {{/if}}","</div>"].join("\n"),listTemplate:['<dl class="dl-horizontal">',"{{each(index, component) workflow.components}}","<dt>${component.name}</dt>","<dd>",'<div id="progress_component_${component.name}" class="progress">','  <div class="progress-bar progress-bar-success" role="progressbar" style="width:${component.completed}%;"></div>','  <div class="progress-bar progress-bar-danger" role="progressbar" style="width:${component.failed}%;"></div>','  <div class="progress-bar progress-bar-info" role="progressbar" style="width:${component.running}%;"></div>','  <div class="progress-bar progress-bar-warning" role="progressbar" style="width:${component.waiting}%;"></div>','  <div id="reset_component_${component.name}" class="tooltip in" style="position:absolute;cursor:pointer;display:none;">','    <div class="tooltip-inner" style="position:absolute;top:-5px;height:29px;padding-top:4px;"><span style="font-size:20px;" class="glyphicon glyphicon-remove"></span></div>',"  </div>","</div>","</dd>","{{/each}}","</dl>"].join("\n"),graphTemplate:['<div id="cytoscape_panel" style="background-image:url(img/grid.png);',"background-color:#f9f9f9;margin-top:20px;border:1px solid lightgrey;border-radius:5px;",'width:870px;height:393px">',"</div>"].join("\n"),workflowID:null,forceUsingWorkflow:null,verbose:!1,display:"graph"},e.fn.wfstatus.Constructor=t}(window.jQuery),function(e,t){function n(){return new Date(Date.UTC.apply(Date,arguments))}function i(){var e=new Date;return n(e.getFullYear(),e.getMonth(),e.getDate())}function o(e){return function(){return this[e].apply(this,arguments)}}function r(t,n){var i=e(t).data(),o={},r=new RegExp("^"+n.toLowerCase()+"([A-Z])");n=new RegExp("^"+n.toLowerCase());for(var a in i)n.test(a)&&(o[a.replace(r,function(e,t){return t.toLowerCase()})]=i[a]);return o}function a(t){var n={};if(f[t]||(t=t.split("-")[0],f[t])){var i=f[t];return e.each(p,function(e,t){t in i&&(n[t]=i[t])}),n}}var s=e(window),l=function(){var t={get:function(e){return this.slice(e)[0]},contains:function(e){for(var t=e&&e.valueOf(),n=0,i=this.length;n<i;n++)if(this[n].valueOf()===t)return n;return-1},remove:function(e){this.splice(e,1)},replace:function(t){t&&(e.isArray(t)||(t=[t]),this.clear(),this.push.apply(this,t))},clear:function(){this.splice(0)},copy:function(){var e=new l;return e.replace(this),e}};return function(){var n=[];return n.push.apply(n,arguments),e.extend(n,t),n}}(),c=function(t,n){this.dates=new l,this.viewDate=i(),this.focusDate=null,this._process_options(n),this.element=e(t),this.isInline=!1,this.isInput=this.element.is("input"),this.component=!!this.element.is(".date")&&this.element.find(".add-on, .input-group-addon, .btn"),this.hasInput=this.component&&this.element.find("input").length,this.component&&0===this.component.length&&(this.component=!1),this.picker=e(g.template),this._buildEvents(),this._attachEvents(),this.isInline?this.picker.addClass("datepicker-inline").appendTo(this.element):this.picker.addClass("datepicker-dropdown dropdown-menu"),this.o.rtl&&this.picker.addClass("datepicker-rtl"),this.viewMode=this.o.startView,this.o.calendarWeeks&&this.picker.find("tfoot th.today").attr("colspan",function(e,t){return parseInt(t)+1}),this._allow_update=!1,this.setStartDate(this._o.startDate),this.setEndDate(this._o.endDate),this.setDaysOfWeekDisabled(this.o.daysOfWeekDisabled),this.fillDow(),this.fillMonths(),this._allow_update=!0,this.update(),this.showMode(),this.isInline&&this.show()};c.prototype={constructor:c,_process_options:function(t){this._o=e.extend({},this._o,t);var n=this.o=e.extend({},this._o),i=n.language;switch(f[i]||(i=i.split("-")[0],f[i]||(i=h.language)),n.language=i,n.startView){case 2:case"decade":n.startView=2;break;case 1:case"year":n.startView=1;break;default:n.startView=0}switch(n.minViewMode){case 1:case"months":n.minViewMode=1;break;case 2:case"years":n.minViewMode=2;break;default:n.minViewMode=0}n.startView=Math.max(n.startView,n.minViewMode),!0!==n.multidate&&(n.multidate=Number(n.multidate)||!1,!1!==n.multidate?n.multidate=Math.max(0,n.multidate):n.multidate=1),n.multidateSeparator=String(n.multidateSeparator),n.weekStart%=7,n.weekEnd=(n.weekStart+6)%7;var o=g.parseFormat(n.format);n.startDate!==-1/0&&(n.startDate?n.startDate instanceof Date?n.startDate=this._local_to_utc(this._zero_time(n.startDate)):n.startDate=g.parseDate(n.startDate,o,n.language):n.startDate=-1/0),n.endDate!==1/0&&(n.endDate?n.endDate instanceof Date?n.endDate=this._local_to_utc(this._zero_time(n.endDate)):n.endDate=g.parseDate(n.endDate,o,n.language):n.endDate=1/0),n.daysOfWeekDisabled=n.daysOfWeekDisabled||[],e.isArray(n.daysOfWeekDisabled)||(n.daysOfWeekDisabled=n.daysOfWeekDisabled.split(/[,\s]*/)),n.daysOfWeekDisabled=e.map(n.daysOfWeekDisabled,function(e){return parseInt(e,10)});var r=String(n.orientation).toLowerCase().split(/\s+/g),a=n.orientation.toLowerCase();if(r=e.grep(r,function(e){return/^auto|left|right|top|bottom$/.test(e)}),n.orientation={x:"auto",y:"auto"},a&&"auto"!==a)if(1===r.length)switch(r[0]){case"top":case"bottom":n.orientation.y=r[0];break;case"left":case"right":n.orientation.x=r[0]}else a=e.grep(r,function(e){return/^left|right$/.test(e)}),n.orientation.x=a[0]||"auto",a=e.grep(r,function(e){return/^top|bottom$/.test(e)}),n.orientation.y=a[0]||"auto";else;},_events:[],_secondaryEvents:[],_applyEvents:function(e){for(var t,n,i,o=0;o<e.length;o++)t=e[o][0],2===e[o].length?(n=void 0,i=e[o][1]):3===e[o].length&&(n=e[o][1],i=e[o][2]),t.on(i,n)},_unapplyEvents:function(e){for(var t,n,i,o=0;o<e.length;o++)t=e[o][0],2===e[o].length?(i=void 0,n=e[o][1]):3===e[o].length&&(i=e[o][1],n=e[o][2]),t.off(n,i)},_buildEvents:function(){this.isInput?this._events=[[this.element,{focus:e.proxy(this.show,this),keyup:e.proxy(function(t){-1===e.inArray(t.keyCode,[27,37,39,38,40,32,13,9])&&this.update()},this),keydown:e.proxy(this.keydown,this)}]]:this.component&&this.hasInput?this._events=[[this.element.find("input"),{focus:e.proxy(this.show,this),keyup:e.proxy(function(t){-1===e.inArray(t.keyCode,[27,37,39,38,40,32,13,9])&&this.update()},this),keydown:e.proxy(this.keydown,this)}],[this.component,{click:e.proxy(this.show,this)}]]:this.element.is("div")?this.isInline=!0:this._events=[[this.element,{click:e.proxy(this.show,this)}]],this._events.push([this.element,"*",{blur:e.proxy(function(e){this._focused_from=e.target},this)}],[this.element,{blur:e.proxy(function(e){this._focused_from=e.target},this)}]),this._secondaryEvents=[[this.picker,{click:e.proxy(this.click,this)}],[e(window),{resize:e.proxy(this.place,this)}],[e(document),{"mousedown touchstart":e.proxy(function(e){this.element.is(e.target)||this.element.find(e.target).length||this.picker.is(e.target)||this.picker.find(e.target).length||this.hide()},this)}]]},_attachEvents:function(){this._detachEvents(),this._applyEvents(this._events)},_detachEvents:function(){this._unapplyEvents(this._events)},_attachSecondaryEvents:function(){this._detachSecondaryEvents(),this._applyEvents(this._secondaryEvents)},_detachSecondaryEvents:function(){this._unapplyEvents(this._secondaryEvents)},_trigger:function(t,n){var i=n||this.dates.get(-1),o=this._utc_to_local(i);this.element.trigger({type:t,date:o,dates:e.map(this.dates,this._utc_to_local),format:e.proxy(function(e,t){0===arguments.length?(e=this.dates.length-1,t=this.o.format):"string"==typeof e&&(t=e,e=this.dates.length-1),t=t||this.o.format;var n=this.dates.get(e);return g.formatDate(n,t,this.o.language)},this)})},show:function(){this.isInline||this.picker.appendTo("body"),this.picker.show(),this.place(),this._attachSecondaryEvents(),this._trigger("show")},hide:function(){this.isInline||this.picker.is(":visible")&&(this.focusDate=null,this.picker.hide().detach(),this._detachSecondaryEvents(),this.viewMode=this.o.startView,this.showMode(),this.o.forceParse&&(this.isInput&&this.element.val()||this.hasInput&&this.element.find("input").val())&&this.setValue(),this._trigger("hide"))},remove:function(){this.hide(),this._detachEvents(),this._detachSecondaryEvents(),this.picker.remove(),delete this.element.data().datepicker,this.isInput||delete this.element.data().date},_utc_to_local:function(e){return e&&new Date(e.getTime()+6e4*e.getTimezoneOffset())},_local_to_utc:function(e){return e&&new Date(e.getTime()-6e4*e.getTimezoneOffset())},_zero_time:function(e){return e&&new Date(e.getFullYear(),e.getMonth(),e.getDate())},_zero_utc_time:function(e){return e&&new Date(Date.UTC(e.getUTCFullYear(),e.getUTCMonth(),e.getUTCDate()))},getDates:function(){return e.map(this.dates,this._utc_to_local)},getUTCDates:function(){return e.map(this.dates,function(e){return new Date(e)})},getDate:function(){return this._utc_to_local(this.getUTCDate())},getUTCDate:function(){return new Date(this.dates.get(-1))},setDates:function(){var t=e.isArray(arguments[0])?arguments[0]:arguments;this.update.apply(this,t),this._trigger("changeDate"),this.setValue()},setUTCDates:function(){var t=e.isArray(arguments[0])?arguments[0]:arguments;this.update.apply(this,e.map(t,this._utc_to_local)),this._trigger("changeDate"),this.setValue()},setDate:o("setDates"),setUTCDate:o("setUTCDates"),setValue:function(){var e=this.getFormattedDate();this.isInput?this.element.val(e).change():this.component&&this.element.find("input").val(e).change()},getFormattedDate:function(t){void 0===t&&(t=this.o.format);var n=this.o.language;return e.map(this.dates,function(e){return g.formatDate(e,t,n)}).join(this.o.multidateSeparator)},setStartDate:function(e){this._process_options({startDate:e}),this.update(),this.updateNavArrows()},setEndDate:function(e){this._process_options({endDate:e}),this.update(),this.updateNavArrows()},setDaysOfWeekDisabled:function(e){this._process_options({daysOfWeekDisabled:e}),this.update(),this.updateNavArrows()},place:function(){if(!this.isInline){var t=this.picker.outerWidth(),n=this.picker.outerHeight(),i=s.width(),o=s.height(),r=s.scrollTop(),a=parseInt(this.element.parents().filter(function(){return"auto"!==e(this).css("z-index")}).first().css("z-index"))+10,l=this.component?this.component.parent().offset():this.element.offset(),c=this.component?this.component.outerHeight(!0):this.element.outerHeight(!1),d=this.component?this.component.outerWidth(!0):this.element.outerWidth(!1),u=l.left,h=l.top;this.picker.removeClass("datepicker-orient-top datepicker-orient-bottom datepicker-orient-right datepicker-orient-left"),"auto"!==this.o.orientation.x?(this.picker.addClass("datepicker-orient-"+this.o.orientation.x),"right"===this.o.orientation.x&&(u-=t-d)):(this.picker.addClass("datepicker-orient-left"),l.left<0?u-=l.left-10:l.left+t>i&&(u=i-t-10));var p,f,g=this.o.orientation.y;"auto"===g&&(p=-r+l.top-n,f=r+o-(l.top+c+n),g=Math.max(p,f)===f?"top":"bottom"),this.picker.addClass("datepicker-orient-"+g),"top"===g?h+=c:h-=n+parseInt(this.picker.css("padding-top")),this.picker.css({top:h,left:u,zIndex:a})}},_allow_update:!0,update:function(){if(this._allow_update){var t=this.dates.copy(),n=[],i=!1;arguments.length?(e.each(arguments,e.proxy(function(e,t){t instanceof Date&&(t=this._local_to_utc(t)),n.push(t)},this)),i=!0):(n=this.isInput?this.element.val():this.element.data("date")||this.element.find("input").val(),n=n&&this.o.multidate?n.split(this.o.multidateSeparator):[n],delete this.element.data().date),n=e.map(n,e.proxy(function(e){return g.parseDate(e,this.o.format,this.o.language)},this)),n=e.grep(n,e.proxy(function(e){return e<this.o.startDate||e>this.o.endDate||!e},this),!0),this.dates.replace(n),this.dates.length?this.viewDate=new Date(this.dates.get(-1)):this.viewDate<this.o.startDate?this.viewDate=new Date(this.o.startDate):this.viewDate>this.o.endDate&&(this.viewDate=new Date(this.o.endDate)),i?this.setValue():n.length&&String(t)!==String(this.dates)&&this._trigger("changeDate"),!this.dates.length&&t.length&&this._trigger("clearDate"),this.fill()}},fillDow:function(){var e=this.o.weekStart,t="<tr>";if(this.o.calendarWeeks){var n='<th class="cw">&nbsp;</th>';t+=n,this.picker.find(".datepicker-days thead tr:first-child").prepend(n)}for(;e<this.o.weekStart+7;)t+='<th class="dow">'+f[this.o.language].daysMin[e++%7]+"</th>";t+="</tr>",this.picker.find(".datepicker-days thead").append(t)},fillMonths:function(){for(var e="",t=0;t<12;)e+='<span class="month">'+f[this.o.language].monthsShort[t++]+"</span>";this.picker.find(".datepicker-months td").html(e)},setRange:function(t){t&&t.length?this.range=e.map(t,function(e){return e.valueOf()}):delete this.range,this.fill()},getClassNames:function(t){var n=[],i=this.viewDate.getUTCFullYear(),o=this.viewDate.getUTCMonth(),r=new Date;return t.getUTCFullYear()<i||t.getUTCFullYear()===i&&t.getUTCMonth()<o?n.push("old"):(t.getUTCFullYear()>i||t.getUTCFullYear()===i&&t.getUTCMonth()>o)&&n.push("new"),this.focusDate&&t.valueOf()===this.focusDate.valueOf()&&n.push("focused"),this.o.todayHighlight&&t.getUTCFullYear()===r.getFullYear()&&t.getUTCMonth()===r.getMonth()&&t.getUTCDate()===r.getDate()&&n.push("today"),-1!==this.dates.contains(t)&&n.push("active"),(t.valueOf()<this.o.startDate||t.valueOf()>this.o.endDate||-1!==e.inArray(t.getUTCDay(),this.o.daysOfWeekDisabled))&&n.push("disabled"),this.range&&(t>this.range[0]&&t<this.range[this.range.length-1]&&n.push("range"),-1!==e.inArray(t.valueOf(),this.range)&&n.push("selected")),n},fill:function(){var t,i=new Date(this.viewDate),o=i.getUTCFullYear(),r=i.getUTCMonth(),a=this.o.startDate!==-1/0?this.o.startDate.getUTCFullYear():-1/0,s=this.o.startDate!==-1/0?this.o.startDate.getUTCMonth():-1/0,l=this.o.endDate!==1/0?this.o.endDate.getUTCFullYear():1/0,c=this.o.endDate!==1/0?this.o.endDate.getUTCMonth():1/0,d=f[this.o.language].today||f.en.today||"",u=f[this.o.language].clear||f.en.clear||"";this.picker.find(".datepicker-days thead th.datepicker-switch").text(f[this.o.language].months[r]+" "+o),this.picker.find("tfoot th.today").text(d).toggle(!1!==this.o.todayBtn),this.picker.find("tfoot th.clear").text(u).toggle(!1!==this.o.clearBtn),this.updateNavArrows(),this.fillMonths();var h=n(o,r-1,28),p=g.getDaysInMonth(h.getUTCFullYear(),h.getUTCMonth());h.setUTCDate(p),h.setUTCDate(p-(h.getUTCDay()-this.o.weekStart+7)%7);var v=new Date(h);v.setUTCDate(v.getUTCDate()+42),v=v.valueOf();for(var m,y=[];h.valueOf()<v;){if(h.getUTCDay()===this.o.weekStart&&(y.push("<tr>"),this.o.calendarWeeks)){var w=new Date(+h+(this.o.weekStart-h.getUTCDay()-7)%7*864e5),b=new Date(Number(w)+(11-w.getUTCDay())%7*864e5),C=new Date(Number(C=n(b.getUTCFullYear(),0,1))+(11-C.getUTCDay())%7*864e5),x=(b-C)/864e5/7+1;y.push('<td class="cw">'+x+"</td>")}if((m=this.getClassNames(h)).push("day"),this.o.beforeShowDay!==e.noop){var E=this.o.beforeShowDay(this._utc_to_local(h));void 0===E?E={}:"boolean"==typeof E?E={enabled:E}:"string"==typeof E&&(E={classes:E}),!1===E.enabled&&m.push("disabled"),E.classes&&(m=m.concat(E.classes.split(/\s+/))),E.tooltip&&(t=E.tooltip)}m=e.unique(m),y.push('<td class="'+m.join(" ")+'"'+(t?' title="'+t+'"':"")+">"+h.getUTCDate()+"</td>"),h.getUTCDay()===this.o.weekEnd&&y.push("</tr>"),h.setUTCDate(h.getUTCDate()+1)}this.picker.find(".datepicker-days tbody").empty().append(y.join(""));var _=this.picker.find(".datepicker-months").find("th:eq(1)").text(o).end().find("span").removeClass("active");e.each(this.dates,function(e,t){t.getUTCFullYear()===o&&_.eq(t.getUTCMonth()).addClass("active")}),(o<a||o>l)&&_.addClass("disabled"),o===a&&_.slice(0,s).addClass("disabled"),o===l&&_.slice(c+1).addClass("disabled"),y="",o=10*parseInt(o/10,10);var S=this.picker.find(".datepicker-years").find("th:eq(1)").text(o+"-"+(o+9)).end().find("td");o-=1;for(var k,T=e.map(this.dates,function(e){return e.getUTCFullYear()}),D=-1;D<11;D++)k=["year"],-1===D?k.push("old"):10===D&&k.push("new"),-1!==e.inArray(o,T)&&k.push("active"),(o<a||o>l)&&k.push("disabled"),y+='<span class="'+k.join(" ")+'">'+o+"</span>",o+=1;S.html(y)},updateNavArrows:function(){if(this._allow_update){var e=new Date(this.viewDate),t=e.getUTCFullYear(),n=e.getUTCMonth();switch(this.viewMode){case 0:this.o.startDate!==-1/0&&t<=this.o.startDate.getUTCFullYear()&&n<=this.o.startDate.getUTCMonth()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.o.endDate!==1/0&&t>=this.o.endDate.getUTCFullYear()&&n>=this.o.endDate.getUTCMonth()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"});break;case 1:case 2:this.o.startDate!==-1/0&&t<=this.o.startDate.getUTCFullYear()?this.picker.find(".prev").css({visibility:"hidden"}):this.picker.find(".prev").css({visibility:"visible"}),this.o.endDate!==1/0&&t>=this.o.endDate.getUTCFullYear()?this.picker.find(".next").css({visibility:"hidden"}):this.picker.find(".next").css({visibility:"visible"})}}},click:function(t){t.preventDefault();var i,o,r,a=e(t.target).closest("span, td, th");if(1===a.length)switch(a[0].nodeName.toLowerCase()){case"th":switch(a[0].className){case"datepicker-switch":this.showMode(1);break;case"prev":case"next":var s=g.modes[this.viewMode].navStep*("prev"===a[0].className?-1:1);switch(this.viewMode){case 0:this.viewDate=this.moveMonth(this.viewDate,s),this._trigger("changeMonth",this.viewDate);break;case 1:case 2:this.viewDate=this.moveYear(this.viewDate,s),1===this.viewMode&&this._trigger("changeYear",this.viewDate)}this.fill();break;case"today":var l=new Date;l=n(l.getFullYear(),l.getMonth(),l.getDate(),0,0,0),this.showMode(-2);var c="linked"===this.o.todayBtn?null:"view";this._setDate(l,c);break;case"clear":var d;this.isInput?d=this.element:this.component&&(d=this.element.find("input")),d&&d.val("").change(),this.update(),this._trigger("changeDate"),this.o.autoclose&&this.hide()}break;case"span":a.is(".disabled")||(this.viewDate.setUTCDate(1),a.is(".month")?(r=1,o=a.parent().find("span").index(a),i=this.viewDate.getUTCFullYear(),this.viewDate.setUTCMonth(o),this._trigger("changeMonth",this.viewDate),1===this.o.minViewMode&&this._setDate(n(i,o,r))):(r=1,o=0,i=parseInt(a.text(),10)||0,this.viewDate.setUTCFullYear(i),this._trigger("changeYear",this.viewDate),2===this.o.minViewMode&&this._setDate(n(i,o,r))),this.showMode(-1),this.fill());break;case"td":a.is(".day")&&!a.is(".disabled")&&(r=parseInt(a.text(),10)||1,i=this.viewDate.getUTCFullYear(),o=this.viewDate.getUTCMonth(),a.is(".old")?0===o?(o=11,i-=1):o-=1:a.is(".new")&&(11===o?(o=0,i+=1):o+=1),this._setDate(n(i,o,r)))}this.picker.is(":visible")&&this._focused_from&&e(this._focused_from).focus(),delete this._focused_from},_toggle_multidate:function(e){var t=this.dates.contains(e);if(e?-1!==t?this.dates.remove(t):this.dates.push(e):this.dates.clear(),"number"==typeof this.o.multidate)for(;this.dates.length>this.o.multidate;)this.dates.remove(0)},_setDate:function(e,t){t&&"date"!==t||this._toggle_multidate(e&&new Date(e)),t&&"view"!==t||(this.viewDate=e&&new Date(e)),this.fill(),this.setValue(),this._trigger("changeDate");var n;this.isInput?n=this.element:this.component&&(n=this.element.find("input")),n&&n.change(),!this.o.autoclose||t&&"date"!==t||this.hide()},moveMonth:function(e,t){if(e){if(!t)return e;var n,i,o=new Date(e.valueOf()),r=o.getUTCDate(),a=o.getUTCMonth(),s=Math.abs(t);if(t=t>0?1:-1,1===s)i=-1===t?function(){return o.getUTCMonth()===a}:function(){return o.getUTCMonth()!==n},n=a+t,o.setUTCMonth(n),(n<0||n>11)&&(n=(n+12)%12);else{for(var l=0;l<s;l++)o=this.moveMonth(o,t);n=o.getUTCMonth(),o.setUTCDate(r),i=function(){return n!==o.getUTCMonth()}}for(;i();)o.setUTCDate(--r),o.setUTCMonth(n);return o}},moveYear:function(e,t){return this.moveMonth(e,12*t)},dateWithinRange:function(e){return e>=this.o.startDate&&e<=this.o.endDate},keydown:function(e){if(this.picker.is(":not(:visible)"))27===e.keyCode&&this.show();else{var t,n,o,r=!1,a=this.focusDate||this.viewDate;switch(e.keyCode){case 27:this.focusDate?(this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill()):this.hide(),e.preventDefault();break;case 37:case 39:if(!this.o.keyboardNavigation)break;t=37===e.keyCode?-1:1,e.ctrlKey?(n=this.moveYear(this.dates.get(-1)||i(),t),o=this.moveYear(a,t),this._trigger("changeYear",this.viewDate)):e.shiftKey?(n=this.moveMonth(this.dates.get(-1)||i(),t),o=this.moveMonth(a,t),this._trigger("changeMonth",this.viewDate)):((n=new Date(this.dates.get(-1)||i())).setUTCDate(n.getUTCDate()+t),(o=new Date(a)).setUTCDate(a.getUTCDate()+t)),this.dateWithinRange(n)&&(this.focusDate=this.viewDate=o,this.setValue(),this.fill(),e.preventDefault());break;case 38:case 40:if(!this.o.keyboardNavigation)break;t=38===e.keyCode?-1:1,e.ctrlKey?(n=this.moveYear(this.dates.get(-1)||i(),t),o=this.moveYear(a,t),this._trigger("changeYear",this.viewDate)):e.shiftKey?(n=this.moveMonth(this.dates.get(-1)||i(),t),o=this.moveMonth(a,t),this._trigger("changeMonth",this.viewDate)):((n=new Date(this.dates.get(-1)||i())).setUTCDate(n.getUTCDate()+7*t),(o=new Date(a)).setUTCDate(a.getUTCDate()+7*t)),this.dateWithinRange(n)&&(this.focusDate=this.viewDate=o,this.setValue(),this.fill(),e.preventDefault());break;case 32:break;case 13:a=this.focusDate||this.dates.get(-1)||this.viewDate,this._toggle_multidate(a),r=!0,this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.setValue(),this.fill(),this.picker.is(":visible")&&(e.preventDefault(),this.o.autoclose&&this.hide());break;case 9:this.focusDate=null,this.viewDate=this.dates.get(-1)||this.viewDate,this.fill(),this.hide()}if(r){this.dates.length?this._trigger("changeDate"):this._trigger("clearDate");var s;this.isInput?s=this.element:this.component&&(s=this.element.find("input")),s&&s.change()}}},showMode:function(e){e&&(this.viewMode=Math.max(this.o.minViewMode,Math.min(2,this.viewMode+e))),this.picker.find(">div").hide().filter(".datepicker-"+g.modes[this.viewMode].clsName).css("display","block"),this.updateNavArrows()}};var d=function(t,n){this.element=e(t),this.inputs=e.map(n.inputs,function(e){return e.jquery?e[0]:e}),delete n.inputs,e(this.inputs).datepicker(n).bind("changeDate",e.proxy(this.dateUpdated,this)),this.pickers=e.map(this.inputs,function(t){return e(t).data("datepicker")}),this.updateDates()};d.prototype={updateDates:function(){this.dates=e.map(this.pickers,function(e){return e.getUTCDate()}),this.updateRanges()},updateRanges:function(){var t=e.map(this.dates,function(e){return e.valueOf()});e.each(this.pickers,function(e,n){n.setRange(t)})},dateUpdated:function(t){if(!this.updating){this.updating=!0;var n=e(t.target).data("datepicker").getUTCDate(),i=e.inArray(t.target,this.inputs),o=this.inputs.length;if(-1!==i){if(e.each(this.pickers,function(e,t){t.getUTCDate()||t.setUTCDate(n)}),n<this.dates[i])for(;i>=0&&n<this.dates[i];)this.pickers[i--].setUTCDate(n);else if(n>this.dates[i])for(;i<o&&n>this.dates[i];)this.pickers[i++].setUTCDate(n);this.updateDates(),delete this.updating}}},remove:function(){e.map(this.pickers,function(e){e.remove()}),delete this.element.data().datepicker}};var u=e.fn.datepicker;e.fn.datepicker=function(t){var n=Array.apply(null,arguments);n.shift();var i;return this.each(function(){var o=e(this),s=o.data("datepicker"),l="object"==typeof t&&t;if(!s){var u=r(this,"date"),p=a(e.extend({},h,u,l).language),f=e.extend({},h,p,u,l);if(o.is(".input-daterange")||f.inputs){var g={inputs:f.inputs||o.find("input").toArray()};o.data("datepicker",s=new d(this,e.extend(f,g)))}else o.data("datepicker",s=new c(this,f))}if("string"==typeof t&&"function"==typeof s[t]&&void 0!==(i=s[t].apply(s,n)))return!1}),void 0!==i?i:this};var h=e.fn.datepicker.defaults={autoclose:!1,beforeShowDay:e.noop,calendarWeeks:!1,clearBtn:!1,daysOfWeekDisabled:[],endDate:1/0,forceParse:!0,format:"mm/dd/yyyy",keyboardNavigation:!0,language:"en",minViewMode:0,multidate:!1,multidateSeparator:",",orientation:"auto",rtl:!1,startDate:-1/0,startView:0,todayBtn:!1,todayHighlight:!1,weekStart:0},p=e.fn.datepicker.locale_opts=["format","rtl","weekStart"];e.fn.datepicker.Constructor=c;var f=e.fn.datepicker.dates={en:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],today:"Today",clear:"Clear"}},g={modes:[{clsName:"days",navFnc:"Month",navStep:1},{clsName:"months",navFnc:"FullYear",navStep:1},{clsName:"years",navFnc:"FullYear",navStep:10}],isLeapYear:function(e){return e%4==0&&e%100!=0||e%400==0},getDaysInMonth:function(e,t){return[31,g.isLeapYear(e)?29:28,31,30,31,30,31,31,30,31,30,31][t]},validParts:/dd?|DD?|mm?|MM?|yy(?:yy)?/g,nonpunctuation:/[^ -\/:-@\[\u3400-\u9fff-`{-~\t\n\r]+/g,parseFormat:function(e){var t=e.replace(this.validParts,"\0").split("\0"),n=e.match(this.validParts);if(!t||!t.length||!n||0===n.length)throw new Error("Invalid date format.");return{separators:t,parts:n}},parseDate:function(t,i,o){function r(){var e=this.slice(0,u[l].length);return e===u[l].slice(0,e.length)}if(t){if(t instanceof Date)return t;"string"==typeof i&&(i=g.parseFormat(i));var a,s,l,d=/([\-+]\d+)([dmwy])/,u=t.match(/([\-+]\d+)([dmwy])/g);if(/^[\-+]\d+[dmwy]([\s,]+[\-+]\d+[dmwy])*$/.test(t)){for(t=new Date,l=0;l<u.length;l++)switch(a=d.exec(u[l]),s=parseInt(a[1]),a[2]){case"d":t.setUTCDate(t.getUTCDate()+s);break;case"m":t=c.prototype.moveMonth.call(c.prototype,t,s);break;case"w":t.setUTCDate(t.getUTCDate()+7*s);break;case"y":t=c.prototype.moveYear.call(c.prototype,t,s)}return n(t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),0,0,0)}u=t&&t.match(this.nonpunctuation)||[],t=new Date;var h,p,v={},m=["yyyy","yy","M","MM","m","mm","d","dd"],y={yyyy:function(e,t){return e.setUTCFullYear(t)},yy:function(e,t){return e.setUTCFullYear(2e3+t)},m:function(e,t){if(isNaN(e))return e;for(t-=1;t<0;)t+=12;for(t%=12,e.setUTCMonth(t);e.getUTCMonth()!==t;)e.setUTCDate(e.getUTCDate()-1);return e},d:function(e,t){return e.setUTCDate(t)}};y.M=y.MM=y.mm=y.m,y.dd=y.d,t=n(t.getFullYear(),t.getMonth(),t.getDate(),0,0,0);var w=i.parts.slice();if(u.length!==w.length&&(w=e(w).filter(function(t,n){return-1!==e.inArray(n,m)}).toArray()),u.length===w.length){var b;for(l=0,b=w.length;l<b;l++){if(h=parseInt(u[l],10),a=w[l],isNaN(h))switch(a){case"MM":p=e(f[o].months).filter(r),h=e.inArray(p[0],f[o].months)+1;break;case"M":p=e(f[o].monthsShort).filter(r),h=e.inArray(p[0],f[o].monthsShort)+1}v[a]=h}var C,x;for(l=0;l<m.length;l++)(x=m[l])in v&&!isNaN(v[x])&&(C=new Date(t),y[x](C,v[x]),isNaN(C)||(t=C))}return t}},formatDate:function(t,n,i){if(!t)return"";"string"==typeof n&&(n=g.parseFormat(n));var o={d:t.getUTCDate(),D:f[i].daysShort[t.getUTCDay()],DD:f[i].days[t.getUTCDay()],m:t.getUTCMonth()+1,M:f[i].monthsShort[t.getUTCMonth()],MM:f[i].months[t.getUTCMonth()],yy:t.getUTCFullYear().toString().substring(2),yyyy:t.getUTCFullYear()};o.dd=(o.d<10?"0":"")+o.d,o.mm=(o.m<10?"0":"")+o.m,t=[];for(var r=e.extend([],n.separators),a=0,s=n.parts.length;a<=s;a++)r.length&&t.push(r.shift()),t.push(o[n.parts[a]]);return t.join("")},headTemplate:'<thead><tr><th class="prev">&laquo;</th><th colspan="5" class="datepicker-switch"></th><th class="next">&raquo;</th></tr></thead>',contTemplate:'<tbody><tr><td colspan="7"></td></tr></tbody>',footTemplate:'<tfoot><tr><th colspan="7" class="today"></th></tr><tr><th colspan="7" class="clear"></th></tr></tfoot>'};g.template='<div class="datepicker"><div class="datepicker-days"><table class=" table-condensed">'+g.headTemplate+"<tbody></tbody>"+g.footTemplate+'</table></div><div class="datepicker-months"><table class="table-condensed">'+g.headTemplate+g.contTemplate+g.footTemplate+'</table></div><div class="datepicker-years"><table class="table-condensed">'+g.headTemplate+g.contTemplate+g.footTemplate+"</table></div></div>",e.fn.datepicker.DPGlobal=g,e.fn.datepicker.noConflict=function(){return e.fn.datepicker=u,this},e(document).on("focus.datepicker.data-api click.datepicker.data-api",'[data-provide="datepicker"]',function(t){var n=e(this);n.data("datepicker")||(t.preventDefault(),n.datepicker("show"))}),e(function(){e('[data-provide="datepicker-inline"]').datepicker()})}(window.jQuery);